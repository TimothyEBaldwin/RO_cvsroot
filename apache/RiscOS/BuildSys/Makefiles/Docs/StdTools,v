head	1.2;
access;
symbols
	BuildSys-7_30:1.2
	BuildSys-7_29:1.2
	BuildSys-7_28:1.2
	BuildSys-7_27:1.2
	BuildSys-7_26:1.2
	BuildSys-7_25:1.2
	BuildSys-7_24:1.2
	BuildSys-7_23:1.2
	BuildSys-7_22:1.2
	BuildSys-7_21:1.2
	BuildSys-7_20:1.2
	BuildSys-7_19:1.2
	BuildSys-7_18:1.2
	BuildSys-7_17:1.2
	BuildSys-7_16:1.2
	BuildSys-7_15:1.2
	BuildSys-7_14:1.2
	BuildSys-7_13:1.2
	BuildSys-7_12:1.2
	BuildSys-7_11:1.2
	BuildSys-7_10:1.2
	BuildSys-7_09:1.2
	BuildSys-6_00-1_142_2_10:1.1.2.1
	BuildSys-7_08:1.2
	BuildSys-7_07:1.2
	BuildSys-7_06:1.2
	BuildSys-7_05:1.2
	BuildSys-6_00-1_142_2_9:1.1.2.1
	BuildSys-7_04:1.2
	BuildSys-7_03:1.2
	BuildSys-7_02:1.2
	BuildSys-7_01:1.2
	BuildSys-7_00:1.2
	BuildSys-6_99:1.2
	BuildSys-6_98:1.2
	BuildSys-6_97:1.2
	BuildSys-6_96:1.2
	BuildSys-6_95:1.2
	BuildSys-6_94:1.2
	BuildSys-6_93:1.2
	BuildSys-6_92:1.2
	BuildSys-6_91:1.2
	BuildSys-6_90:1.2
	BuildSys-6_89:1.2
	BuildSys-6_81-1:1.2
	BuildSys-6_88:1.2
	BuildSys-6_87:1.2
	BuildSys-6_86:1.2
	BuildSys-6_85:1.2
	BuildSys-6_84:1.2
	BuildSys-6_83:1.2
	BuildSys-6_82:1.2
	BuildSys-6_81:1.2
	BuildSys-6_80:1.2
	BuildSys-6_79:1.2
	BuildSys-6_78:1.2
	BuildSys-6_77:1.2
	BuildSys-6_76:1.2
	BuildSys-6_75:1.2
	BuildSys-6_74:1.2
	BuildSys-6_73:1.2
	BuildSys-6_72:1.2
	BuildSys-6_71:1.2
	BuildSys-6_70:1.2
	BuildSys-6_69:1.2
	BuildSys-6_68:1.2
	BuildSys-6_67:1.2
	BuildSys-6_66-1:1.2
	BuildSys-6_66:1.2
	BuildSys-6_65:1.2
	BuildSys-6_00-1_142_2_8:1.1.2.1
	BuildSys-6_00-1_142_2_7:1.1.2.1
	BuildSys-6_00-1_142_2_6:1.1.2.1
	BuildSys-6_64:1.2
	BuildSys-6_63:1.2
	BuildSys-6_62:1.2
	BuildSys-6_61:1.2
	BuildSys-6_60:1.2
	BuildSys-6_59:1.2
	BuildSys-6_58:1.2
	BuildSys-6_57:1.2
	BuildSys-6_56:1.2
	BuildSys-6_55:1.2
	BuildSys-6_54:1.2
	BuildSys-6_53:1.2
	BuildSys-6_00-1_142_2_5:1.1.2.1
	BuildSys-6_52:1.2
	BuildSys-6_51:1.2
	BuildSys-6_50:1.2
	BuildSys-6_49:1.2
	BuildSys-6_48:1.2
	BuildSys-6_47:1.2
	BuildSys-6_46:1.2
	BuildSys-6_45:1.1
	BuildSys-6_44:1.1
	BuildSys-6_43:1.1
	BuildSys-6_42:1.1
	BuildSys-6_41:1.1
	BuildSys-6_40:1.1
	BuildSys-6_39:1.1
	BuildSys-6_38:1.1
	BuildSys-6_00-1_142_2_4:1.1
	BuildSys-6_37:1.1
	BuildSys-6_36:1.1
	BuildSys-6_35:1.1
	BuildSys-6_34:1.1
	BuildSys-6_33:1.1
	BuildSys-6_32:1.1
	BuildSys-6_31:1.1
	BuildSys-6_30:1.1
	BuildSys-6_29:1.1
	BuildSys-6_28:1.1
	BuildSys-6_27:1.1
	BuildSys-6_26:1.1
	BuildSys-6_25:1.1
	BuildSys-6_24:1.1
	BuildSys-6_23:1.1
	BuildSys-6_22:1.1
	BuildSys-6_21:1.1
	BuildSys-6_20:1.1
	BuildSys-6_00-1_142_2_3:1.1
	BuildSys-6_19:1.1
	BuildSys-6_18:1.1
	BuildSys-6_17:1.1
	BuildSys-6_16:1.1
	BuildSys-6_15:1.1
	BuildSys-6_14:1.1
	BuildSys-6_13:1.1
	BuildSys-6_12:1.1
	BuildSys-6_00-1_142_2_2:1.1
	BuildSys-6_11:1.1
	BuildSys-6_10:1.1
	BuildSys-6_09:1.1
	BuildSys-6_08:1.1
	BuildSys-6_07:1.1
	BuildSys-6_06:1.1
	BuildSys-6_05:1.1
	BuildSys-6_04:1.1
	BuildSys-6_03:1.1
	BuildSys-6_02:1.1
	BuildSys-6_01:1.1
	BuildSys-6_00-1_142_2_1:1.1
	RPiFreeze:1.1.0.2
	BuildSys-6_00:1.1
	BuildSys-5_99:1.1
	BuildSys-5_98:1.1
	BuildSys-5_97:1.1
	BuildSys-5_96:1.1
	BuildSys-5_95:1.1
	BuildSys-5_94:1.1
	BuildSys-5_93:1.1
	BuildSys-5_92:1.1
	BuildSys-5_91:1.1
	BuildSys-5_90:1.1
	BuildSys-5_89:1.1
	BuildSys-5_88:1.1
	BuildSys-5_87:1.1
	BuildSys-5_86:1.1
	BuildSys-5_85:1.1
	BuildSys-5_84:1.1
	BuildSys-5_83:1.1
	BuildSys-5_82:1.1
	BuildSys-5_81:1.1
	BuildSys-5_80:1.1
	BuildSys-5_79:1.1
	BuildSys-5_78:1.1
	BuildSys-5_77:1.1
	BuildSys-5_76:1.1
	BuildSys-5_75:1.1
	BuildSys-5_74:1.1
	BuildSys-5_73:1.1
	BuildSys-5_72:1.1
	BuildSys-5_71:1.1
	BuildSys-5_70:1.1
	BuildSys-5_69:1.1
	BuildSys-5_68:1.1
	BuildSys-5_67:1.1
	BuildSys-5_66:1.1
	BuildSys-5_65:1.1
	BuildSys-5_64:1.1
	BuildSys-5_63:1.1
	BuildSys-5_62:1.1
	BuildSys-5_61:1.1
	BuildSys-5_60:1.1
	BuildSys-5_59:1.1
	BuildSys-5_58:1.1
	BuildSys-5_57:1.1
	BuildSys-5_56:1.1
	BuildSys-5_55:1.1
	BuildSys-5_54:1.1
	BuildSys-5_53:1.1
	BuildSys-5_52:1.1
	BuildSys-5_51:1.1
	BuildSys-5_50:1.1
	BuildSys-5_49:1.1
	BuildSys-5_48:1.1
	BuildSys-5_47:1.1
	BuildSys-5_46:1.1
	BuildSys-5_45:1.1
	BuildSys-5_44:1.1
	BuildSys-5_43:1.1
	BuildSys-5_42:1.1
	BuildSys-5_41:1.1
	BuildSys-5_40:1.1
	BuildSys-5_39:1.1
	BuildSys-5_38:1.1
	BuildSys-5_37:1.1
	BuildSys-5_36:1.1
	BuildSys-5_35:1.1
	BuildSys-5_34:1.1
	BuildSys-5_33:1.1
	BuildSys-5_32:1.1
	BuildSys-5_31:1.1
	BuildSys-5_30:1.1
	BuildSys-5_29:1.1
	BuildSys-5_28:1.1
	BuildSys-5_27:1.1
	BuildSys-5_26:1.1
	BuildSys-5_25:1.1
	BuildSys-5_24:1.1
	BuildSys-5_23:1.1
	BuildSys-5_22:1.1
	BuildSys-5_21:1.1
	BuildSys-5_20:1.1
	BuildSys-5_19:1.1
	BuildSys-5_18:1.1
	BuildSys-5_17:1.1
	BuildSys-5_16:1.1
	BuildSys-5_15:1.1
	BuildSys-5_14:1.1
	BuildSys-5_13:1.1
	BuildSys-5_12:1.1
	BuildSys-5_11:1.1
	BuildSys-5_10:1.1
	BuildSys-5_09:1.1
	BuildSys-5_08:1.1
	BuildSys-5_07:1.1
	BuildSys-5_06:1.1
	BuildSys-5_05:1.1
	BuildSys-5_04:1.1
	BuildSys-5_03:1.1
	BuildSys-5_02:1.1
	BuildSys-5_01:1.1
	BuildSys-5_00:1.1
	BuildSys-4_99:1.1
	BuildSys-4_98:1.1
	BuildSys-4_97:1.1
	BuildSys-4_96:1.1
	BuildSys-4_95:1.1
	BuildSys-4_94:1.1
	BuildSys-4_93:1.1
	BuildSys-4_92:1.1
	BuildSys-4_91:1.1
	BuildSys-4_90:1.1
	BuildSys-4_89:1.1
	BuildSys-4_88:1.1
	BuildSys-4_87:1.1
	BuildSys-4_86:1.1
	BuildSys-4_85:1.1
	BuildSys-4_84:1.1
	BuildSys-4_83:1.1
	BuildSys-4_82:1.1
	BuildSys-4_81:1.1
	BuildSys-4_80:1.1
	BuildSys-4_79:1.1
	BuildSys-4_78:1.1
	BuildSys-4_77:1.1
	BuildSys-4_76:1.1
	BuildSys-4_75:1.1
	BuildSys-4_74:1.1
	BuildSys-4_73:1.1
	BuildSys-4_72:1.1
	BuildSys-4_71:1.1
	BuildSys-4_70:1.1
	BuildSys-4_69:1.1
	BuildSys-4_68:1.1
	BuildSys-4_67:1.1
	BuildSys-4_66:1.1
	BuildSys-4_65:1.1
	BuildSys-4_64:1.1
	BuildSys-4_63:1.1
	BuildSys-4_62:1.1
	Batch4:1.1;
locks; strict;
comment	@# @;


1.2
date	2014.07.19.16.07.32;	author rsprowson;	state Exp;
branches;
next	1.1;
commitid	nA0HBUmfswSon0Jx;

1.1
date	2008.10.14.21.29.38;	author bavison;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2014.10.12.10.36.34;	author rsprowson;	state Exp;
branches;
next	;
commitid	tHT6hsrmkNpoOTTx;


desc
@@


1.2
log
@Drop 2 tools
tlink - a long since abandoned special tool used to link the toolbox modules against TinyStubs around RISC OS 3.50 era, no 32 bit version has ever been made, so by implication it's not being used
aasm - the sources were lost some time in the 1990's, and hasn't been supplied as part of the DDE for over a decade
Documentation updated to reflect current tools.

Version 6.46. Tagged as 'BuildSys-6_46'
@
text
@Document Status
---------------
  Distribution:  Company Confidential
         Title:  RISC OS StdTools Makefile
Drawing Number:  2503,107/T
         Issue:  A
     Author(s):  Stewart Brodie
          Date:  2001-04-17
 Change Number:  N/A
    Last Issue:  N/A


Contents
--------
Document Status
Issue History
Introduction
Key features
Makefile
Copy and wipe
Standard options



Issue History
-------------

1       17/04/01        Original version


Introduction
------------

This document describes, in outline, the StdTools shared makefile for RISC OS
builds.  It assumes that the reader has some knowledge of the RISC OS system.

THIS IS NOT A REVIEWED DOCUMENT - MERELY NOTES TO PROGRAMMERS WHO NEED THE
BENEFIT OF OUR PRIOR EXPERIENCES.

Because of this, not all the technical terms are explained fully, and there
is no glossary.


Key features
------------

The key features are:

* Avoid duplication by using shared macro definitions
* Consistent sets of tools are used
* Replacing tools with different ones can be achieved in one change


Makefile
--------

StdTools contains the basic macro definitions which determine the core
toolset used in the construction of RISC OS software.  Whilst the StdTools
file (in RiscOS/BuildSys/Makefiles) contains the definitive set, this
document contains information about the most important tools (as of revision
1.11 of the StdTools makefile fragment)

It also contains default flag settings for the assembler, compiler, cmhg and
libfile.

Copying and wiping files are handled in a peculiar way, so they are explained
in a section of their own.

Default options for the core tools are explained in a section on their own.

StdTools does NOT define any rules - only macros.  Thus after including this
Makefile, it is safe to alter any of the macro definitions that have been
provided by StdTools.  However, this should be done with care, as other
makefile fragments may be relying on the definitions made in StdTools for
correct operation.


Tools
=====

The following tools are represented by a capitalised macro of the same name
(e.g. the macro BINAOF is defined as binaof):

binaof, cc, c++, cmhg, data2aof, defmod, do, echo, fappend, modgen, modsqz,
resgen, settype, squash, squish, togpa, tokencheck, tokenise, translate,
unmodsqz, rpcgen, sed

There are other tools with specific directory prefixes to enable GNU.* and
Unix.* binaries to be located within the library directory, but with names
that match the tool names.  These are:

awk, chmod, df, diff, egrep, find, gawk, ident, ls, pwd, wc, zip, unzip

Some tools are perl scripts.  The PERL macro is defined as "do perl" to force
system variables on the command-line to be resolved before perl is invoked. 
Tools which are perl scripts invoke perl explicitly via ${PERL} using the
Build:<scriptname> to enable perl to find the script.  These tools are:

FilterComp, FilterComp2, GetVersion, Hdr2H, InstRes

The MKDIR macro is defined as "do mkdir -p", to ensure that entire directory
hierarchies can be created without having to create the hierarchy one level
at a time.  The 'do' is used to forcibly expand system variables as with
perl.


The other tools macros are:

---------------------------------------------------------------------------
Macro                 RISC OS Tool/*-command
---------------------------------------------------------------------------
AR                    libfile
AS                    objasm
CAT                   print
CPREPRO               cc -C++ -E
INSERTVERSION         awk -f Build:AwkVers
LD                    link
MAKE                  amu
NOP                   |
NUMBER                Build:Number
RM                    remove
SQZ                   squeeze
STRIPDEPEND           stripdepnd
TOUCH                 create
CD                    dir
LEX                   GNU.flex
YACC                  GNU.bison
---------------------------------------------------------------------------

Any other tools required should be added to this file.  


Copy and wipe
-------------

The copy macro (CP) and wipe macro (WIPE) are mapped to the RISC OS built-in
*-commands *copy and *wipe.  Because of the ordering of the CLI options,
users of these macros must append the flags to the two (CP) or one (WIPE)
filename parameters.  The default flags for CP are stored in CPFLAGS.  The
default flags for WIPE are stored in WFLAGS.  Usage is thus:

  ${CP} source-filespec destination-filespec ${CPFLAGS}
  ${WIPE} filespec ${WFLAGS}
  
Failure to append the flags macros will result in builds halting awaiting
user input.  The default CPFLAGS and WFLAGS settings can be overridden by
changing the macros after the inclusion of the StdTools makefile:

include StdTools
CPFLAGS = FRV~C~N

In this case, the verbose option is being switched on.  The defaults are for
CPFLAGS to be "FR~C~V~N" and WFLAGS to be "FR~C~V".  *However*, changing
these flags should not be done without good reason, as it may break
cross-compiled builds.  The UNIX version of StdTools will define CP as "cp
-fr" and WIPE as "rm -rf", and make WFLAGS and CPFLAGS as empty.


Standard options
----------------

Additionally, some standard tools have their options preset by StdTools. 
Mostly this involves the DDE tool options.  The macro STDTOOLOPTIONS is
defined to be "-depend !Depend ${THROWBACK}".  THROWBACK will be set to
-throwback by well-behaved TaskObey files and be blank during ROM builds, so
throwback windows do not pop up all over the place during ROM builds, but do
during development.

ASFLAGS (for objasm), CFLAGS (for cc) and CMHGFLAGS
(for cmhg), ARFLAGS (for libfile) are defined by StdTools using +=, thus it
will *append* these standard options to any you care to define before
including StdTools.  If you want to add things after StdTools has defined
them, you can use += to add your extra options after including StdTools.

---------------------------------------------------------------------------
Macro        Flags added
---------------------------------------------------------------------------
ASFLAGS      -Stamp -quit ${STDTOOLOPTIONS} ${ASMDEFINES} ${ASMINCLUDES}
CFLAGS       -c ${STDTOOLOPTIONS} ${CDEFINES} ${CINCLUDES}
CMHGFLAGS    -p ${STDTOOLOPTIONS} ${CMHGDEFINES} ${CMHGINCLUDES}
ARFLAGS      -c
---------------------------------------------------------------------------

==END==
@


1.1
log
@Clean reimport of the build environment directories.
This represents the version released in the Batch 4 "bbe" tarfiles.
Tagged as 'Batch4'
@
text
@a0 2


d82 1
a82 1
(e.g. the macro AASM is defined as aasm):
d84 3
a86 3
aasm, binaof, cc, c++, cmhg, decaof, do, echo, modgen, modsqz, resgen,
settype, squash, tlink, tokencheck, tokenise, translate, unmodsqz, awk,
rpcgen, sed
d92 1
a92 1
chmod, df, diff, egrep, find, gawk, ident, ls, pwd, wc, zip, unzip
d99 1
a99 1
FilterComp, GetVersion, Hdr2H, TidyDesc
d115 2
a116 1
DATA2AOF              datatoaof
d119 2
d169 1
a169 1
AASMFLAGS (for aasm), ASFLAGS (for objasm), CFLAGS (for cc) and CMHGFLAGS
a177 1
AASMFLAGS    -Stamp -quit ${STDTOOLOPTIONS} ${AASMDEFINES} ${AASMINCLUDES}
a180 1
AASMFLAGS    -Stamp -quit ${STDTOOLOPTIONS} ${AASMDEFINES} ${AASMINCLUDES}
@


1.1.2.1
log
@Merge of BuildSys-6_52 to branch

Version 6.00, 1.142.2.5. Tagged as 'BuildSys-6_00-1_142_2_5'
@
text
@d1 2
d84 1
a84 1
(e.g. the macro BINAOF is defined as binaof):
d86 3
a88 3
binaof, cc, c++, cmhg, data2aof, defmod, do, echo, fappend, modgen, modsqz,
resgen, settype, squash, squish, togpa, tokencheck, tokenise, translate,
unmodsqz, rpcgen, sed
d94 1
a94 1
awk, chmod, df, diff, egrep, find, gawk, ident, ls, pwd, wc, zip, unzip
d101 1
a101 1
FilterComp, FilterComp2, GetVersion, Hdr2H, InstRes
d117 1
a117 2
CPREPRO               cc -C++ -E
INSERTVERSION         awk -f Build:AwkVers
a119 2
NOP                   |
NUMBER                Build:Number
d168 1
a168 1
ASFLAGS (for objasm), CFLAGS (for cc) and CMHGFLAGS
d177 1
d181 1
@


