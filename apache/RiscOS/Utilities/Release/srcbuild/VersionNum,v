head	1.53;
access;
symbols
	srcbuild-0_53:1.53
	srcbuild-0_52:1.52
	srcbuild-0_51:1.51
	srcbuild-0_50:1.50
	srcbuild-0_49:1.49
	srcbuild-0_48:1.48
	srcbuild-0_47:1.47
	srcbuild-0_46:1.46
	srcbuild-0_45:1.45
	srcbuild-0_44:1.44
	srcbuild-0_43:1.43
	srcbuild-0_42:1.42
	srcbuild-0_41:1.41
	srcbuild-0_40:1.40
	srcbuild-0_39:1.39
	srcbuild-0_38:1.38
	srcbuild-0_37:1.37
	srcbuild-0_36:1.36
	srcbuild-0_35:1.35
	srcbuild-0_34:1.34
	srcbuild-0_33:1.32
	srcbuild-0_32:1.31
	srcbuild-0_31:1.30
	srcbuild-0_30:1.29
	srcbuild-0_29:1.28
	srcbuild-0_28:1.27
	srcbuild-0_27:1.26
	srcbuild-0_26:1.25
	srcbuild-0_25:1.24
	srcbuild-0_24-1_23_2_4:1.23.2.4
	srcbuild-0_24-1_23_2_3:1.23.2.3
	srcbuild-0_24-1_23_2_2:1.23.2.2
	srcbuild-0_24-1_23_2_1:1.23.2.1
	sbrodie_BBE:1.23.0.2
	sbrodie_BBE_bp:1.23
	srcbuild-0_24:1.23
	srcbuild-0_23:1.22
	srcbuild-0_22:1.21
	srcbuild-0_21:1.20
	srcbuild-0_20:1.19
	srcbuild-0_19:1.18
	srcbuild-0_18:1.17
	srcbuild-0_17:1.16
	srcbuild-0_16:1.15
	srcbuild-0_15:1.14
	srcbuild-0_14:1.13
	srcbuild-0_13:1.12
	srcbuild-0_12:1.11
	srcbuild-0_11:1.10
	srcbuild-0_10:1.9
	srcbuild-0_09:1.8
	srcbuild-0_08:1.7
	srcbuild-0_07:1.6
	srcbuild-0_06:1.5
	srcbuild-0_05:1.4
	srcbuild-0_04:1.3
	srcbuild-0_03:1.2;
locks; strict;
comment	@# @;


1.53
date	2018.11.17.09.35.53;	author rool;	state Exp;
branches;
next	1.52;
commitid	FPFAIJHBZmOjmh0B;

1.52
date	2018.11.17.09.27.12;	author rool;	state Exp;
branches;
next	1.51;
commitid	fhoX8Rh7h2Vkjh0B;

1.51
date	2015.07.03.21.18.59;	author jlee;	state Exp;
branches;
next	1.50;
commitid	6n0wzpeFD0zLSSry;

1.50
date	2014.10.01.23.54.33;	author jlee;	state Exp;
branches;
next	1.49;
commitid	qNhLvnugBRabAySx;

1.49
date	2011.03.17.19.13.45;	author srevill;	state Exp;
branches;
next	1.48;
commitid	fnYulYGnMGmFCecv;

1.48
date	2010.01.30.16.14.52;	author jlee;	state Exp;
branches;
next	1.47;

1.47
date	2009.07.13.19.35.58;	author srevill;	state Exp;
branches;
next	1.46;

1.46
date	2009.07.12.22.44.17;	author srevill;	state Exp;
branches;
next	1.45;

1.45
date	2007.05.31.00.29.26;	author srevill;	state Exp;
branches;
next	1.44;

1.44
date	2005.08.11.12.53.20;	author srevill;	state Exp;
branches;
next	1.43;

1.43
date	2004.11.12.14.23.25;	author bavison;	state Exp;
branches;
next	1.42;

1.42
date	2004.11.09.15.43.51;	author bavison;	state Exp;
branches;
next	1.41;

1.41
date	2004.03.12.16.54.31;	author srevill;	state Exp;
branches;
next	1.40;

1.40
date	2003.12.16.20.28.57;	author bavison;	state Exp;
branches;
next	1.39;

1.39
date	2003.12.11.16.32.27;	author bavison;	state Exp;
branches;
next	1.38;

1.38
date	2002.05.08.14.44.10;	author srevill;	state Exp;
branches;
next	1.37;

1.37
date	2002.02.28.20.51.08;	author srevill;	state Exp;
branches;
next	1.36;

1.36
date	2001.11.02.16.35.12;	author sbrodie;	state Exp;
branches;
next	1.35;

1.35
date	2001.10.19.12.44.34;	author srevill;	state Exp;
branches;
next	1.34;

1.34
date	2001.06.21.14.40.19;	author nbingham;	state Exp;
branches;
next	1.33;

1.33
date	2001.06.08.15.29.00;	author sbrodie;	state Exp;
branches;
next	1.32;

1.32
date	2001.05.18.09.32.36;	author nbingham;	state Exp;
branches;
next	1.31;

1.31
date	2001.03.27.13.04.02;	author sbrodie;	state Exp;
branches;
next	1.30;

1.30
date	2001.03.22.13.20.18;	author sbrodie;	state Exp;
branches;
next	1.29;

1.29
date	2001.03.12.14.10.47;	author sbrodie;	state Exp;
branches;
next	1.28;

1.28
date	2001.02.08.13.39.01;	author sbrodie;	state Exp;
branches;
next	1.27;

1.27
date	2001.02.06.19.06.13;	author nbingham;	state Exp;
branches;
next	1.26;

1.26
date	2001.02.02.11.22.11;	author sbrodie;	state Exp;
branches;
next	1.25;

1.25
date	2001.01.25.16.16.53;	author sbrodie;	state Exp;
branches;
next	1.24;

1.24
date	2000.12.15.16.26.49;	author sbrodie;	state Exp;
branches;
next	1.23;

1.23
date	2000.11.16.11.08.37;	author kbracey;	state Exp;
branches
	1.23.2.1;
next	1.22;

1.22
date	2000.10.16.10.58.31;	author sbrodie;	state Exp;
branches;
next	1.21;

1.21
date	2000.07.18.12.32.06;	author dcotton;	state Exp;
branches;
next	1.20;

1.20
date	2000.06.12.12.04.23;	author dcotton;	state Exp;
branches;
next	1.19;

1.19
date	2000.06.08.17.44.35;	author dcotton;	state Exp;
branches;
next	1.18;

1.18
date	2000.05.22.12.22.25;	author dcotton;	state Exp;
branches;
next	1.17;

1.17
date	2000.03.27.13.41.07;	author dcotton;	state Exp;
branches;
next	1.16;

1.16
date	99.11.09.10.02.39;	author dcotton;	state Exp;
branches;
next	1.15;

1.15
date	99.09.10.10.49.18;	author dcotton;	state Exp;
branches;
next	1.14;

1.14
date	99.09.09.12.54.09;	author nbingham;	state Exp;
branches;
next	1.13;

1.13
date	99.07.06.14.18.09;	author dcotton;	state Exp;
branches;
next	1.12;

1.12
date	99.05.07.12.37.23;	author kbracey;	state Exp;
branches;
next	1.11;

1.11
date	99.05.06.11.07.34;	author kbracey;	state Exp;
branches;
next	1.10;

1.10
date	99.04.30.08.23.18;	author dcotton;	state Exp;
branches;
next	1.9;

1.9
date	98.10.28.17.47.49;	author nturton;	state Exp;
branches;
next	1.8;

1.8
date	98.10.27.10.38.44;	author blaughto;	state Exp;
branches;
next	1.7;

1.7
date	98.10.27.09.40.10;	author kbracey;	state Exp;
branches;
next	1.6;

1.6
date	98.07.30.09.42.47;	author rbuckley;	state Exp;
branches;
next	1.5;

1.5
date	98.01.13.13.32.13;	author rbuckley;	state Exp;
branches;
next	1.4;

1.4
date	97.10.31.13.40.53;	author rbuckley;	state Exp;
branches;
next	1.3;

1.3
date	97.09.25.15.43.19;	author rbuckley;	state Exp;
branches;
next	1.2;

1.2
date	97.09.25.11.24.48;	author rbuckley;	state Exp;
branches;
next	1.1;

1.1
date	97.09.25.11.22.16;	author rbuckley;	state Exp;
branches;
next	;

1.23.2.1
date	2000.12.07.17.03.42;	author sbrodie;	state Exp;
branches;
next	1.23.2.2;

1.23.2.2
date	2000.12.13.17.31.32;	author sbrodie;	state Exp;
branches;
next	1.23.2.3;

1.23.2.3
date	2000.12.14.17.41.49;	author sbrodie;	state Exp;
branches;
next	1.23.2.4;

1.23.2.4
date	2000.12.15.15.33.29;	author sbrodie;	state Exp;
branches;
next	;


desc
@@


1.53
log
@Fix potential buffer overflow, report error return code
Detail:
  srcbuild.c: Follow standard practice and return a non-zero return code if the build fails.
  build.c: Space not allowed for null terminator; correct out-by-1 error.
Admin:
  Submission from Timothy Baldwin.

Version 0.53. Tagged as 'srcbuild-0_53'
@
text
@/* (0.53)
 *
 * This file is automatically maintained by srccommit, do not edit manually.
 * Last processed by srccommit version: 1.1.
 *
 */
#define Module_MajorVersion_CMHG        0.53
#define Module_MinorVersion_CMHG        
#define Module_Date_CMHG                17 Nov 2018

#define Module_MajorVersion             "0.53"
#define Module_Version                  53
#define Module_MinorVersion             ""
#define Module_Date                     "17 Nov 2018"

#define Module_ApplicationDate          "17-Nov-18"

#define Module_ComponentName            "srcbuild"
#define Module_ComponentPath            "apache/RiscOS/Utilities/Release/srcbuild"

#define Module_FullVersion              "0.53"
#define Module_HelpVersion              "0.53 (17 Nov 2018)"
#define Module_LibraryVersionInfo       "0:53"
@


1.52
log
@Suppress compiler warnings
Detail:
  * Make several variables and functions static.
  * Initialise variables.
  * Add missing return statement.
  * Add missing header include.
  * Delete declaration of non-existant static function.
Admin:
  Submission from Timothy Baldwin.

Version 0.52. Tagged as 'srcbuild-0_52'
@
text
@d1 1
a1 1
/* (0.52)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.52
d11 2
a12 2
#define Module_MajorVersion             "0.52"
#define Module_Version                  52
d21 3
a23 3
#define Module_FullVersion              "0.52"
#define Module_HelpVersion              "0.52 (17 Nov 2018)"
#define Module_LibraryVersionInfo       "0:52"
@


1.51
log
@Fix null pointer dereference in components file parsing
Detail:
  c/parse - Modify extract_word to skip trailing whitespace after the word. This ensures that the return value is only ever non-null if there's at least one more word left to extract. This avoids a null pointer dereference in srcbuild.c, where the while (cp) {...} loop at line 677 will perform a strcmp of a NULL word if there was trailing whitespace at the end of a line.
Admin:
  Tested with Iyonix ROM build


Version 0.51. Tagged as 'srcbuild-0_51'
@
text
@d1 1
a1 1
/* (0.51)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.51
d9 1
a9 1
#define Module_Date_CMHG                03 Jul 2015
d11 2
a12 2
#define Module_MajorVersion             "0.51"
#define Module_Version                  51
d14 1
a14 1
#define Module_Date                     "03 Jul 2015"
d16 1
a16 1
#define Module_ApplicationDate          "03-Jul-15"
d19 1
a19 1
#define Module_ComponentPath            "castle/RiscOS/Utilities/Release/srcbuild"
d21 3
a23 3
#define Module_FullVersion              "0.51"
#define Module_HelpVersion              "0.51 (03 Jul 2015)"
#define Module_LibraryVersionInfo       "0:51"
@


1.50
log
@Treat install build phase errors as fatal
Detail:
  c/build - Instead of ignoring install build phase errors, treat them as fatal. Should help to avoid the autobuilder spitting out bad disc/!System builds.
Admin:
  Tested with performing BuildHostDev, DiscDev, PlingSystem builds


Version 0.50. Tagged as 'srcbuild-0_50'
@
text
@d1 1
a1 1
/* (0.50)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.50
d9 1
a9 1
#define Module_Date_CMHG                02 Oct 2014
d11 2
a12 2
#define Module_MajorVersion             "0.50"
#define Module_Version                  50
d14 1
a14 1
#define Module_Date                     "02 Oct 2014"
d16 1
a16 1
#define Module_ApplicationDate          "02-Oct-14"
d21 3
a23 3
#define Module_FullVersion              "0.50"
#define Module_HelpVersion              "0.50 (02 Oct 2014)"
#define Module_LibraryVersionInfo       "0:50"
@


1.49
log
@Modified to not assume all source code is in a "Sources" directory (or relative
to that location).
Also cleaned up the makefile's clean phase.

Admin: THIS VERSION OF SRCCOMMIT WILL BREAK EXISTING BUILDS!

Version 0.49. Tagged as 'srcbuild-0_49'
@
text
@d1 1
a1 1
/* (0.49)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.49
d9 1
a9 1
#define Module_Date_CMHG                17 Mar 2011
d11 2
a12 2
#define Module_MajorVersion             "0.49"
#define Module_Version                  49
d14 1
a14 1
#define Module_Date                     "17 Mar 2011"
d16 1
a16 1
#define Module_ApplicationDate          "17-Mar-11"
d21 3
a23 3
#define Module_FullVersion              "0.49"
#define Module_HelpVersion              "0.49 (17 Mar 2011)"
#define Module_LibraryVersionInfo       "0:49"
@


1.48
log
@Fix srcbuild's handling of options strings
Detail:
  c/srcbuild - Now correctly handles the case where option strings have been removed from compnent files (i.e. it forces a clean of the component)
  Handling of null option strings has also been fixed; previously if a line ended in '-options' then the force clean flag would be set, but the option string pointer would be null - resulting in no options being written out to the shadow file, and thus the component would be cleaned on every single build.
Admin:
  Tested running on Iyonix RO5.12, while building OMAP3 ROM.
  Fixes bug #208


Version 0.48. Tagged as 'srcbuild-0_48'
@
text
@d1 1
a1 1
/* (0.48)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.48
d9 1
a9 1
#define Module_Date_CMHG                30 Jan 2010
d11 2
a12 2
#define Module_MajorVersion             "0.48"
#define Module_Version                  48
d14 1
a14 1
#define Module_Date                     "30 Jan 2010"
d16 1
a16 1
#define Module_ApplicationDate          "30-Jan-10"
d21 3
a23 3
#define Module_FullVersion              "0.48"
#define Module_HelpVersion              "0.48 (30 Jan 2010)"
#define Module_LibraryVersionInfo       "0:48"
@


1.47
log
@Doh! Forgot to rename some instances of "autobuild".

I knew the debate over whether the new phase should be called
"release_autobuild" after the fact I had already finished
implementing it as just "autobuild" would come back and bite
me on the ass. And it did. Top.

Version 0.47. Tagged as 'srcbuild-0_47'
@
text
@d1 1
a1 1
/* (0.47)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.47
d9 1
a9 1
#define Module_Date_CMHG                13 Jul 2009
d11 2
a12 2
#define Module_MajorVersion             "0.47"
#define Module_Version                  47
d14 1
a14 1
#define Module_Date                     "13 Jul 2009"
d16 1
a16 1
#define Module_ApplicationDate          "13-Jul-09"
d21 3
a23 3
#define Module_FullVersion              "0.47"
#define Module_HelpVersion              "0.47 (13 Jul 2009)"
#define Module_LibraryVersionInfo       "0:47"
@


1.46
log
@Added support for a new release_autobuild phase.

This new phase will initially only be required by a very small subset of
components which do some additional functionality at the very end of a
build process in order to wrap-up the build ready for the autobuilder to
do what it wants with the results.

Admin:
  Tested on Iyonix
Author:
  srevill

Version 0.46. Tagged as 'srcbuild-0_46'
@
text
@d1 1
a1 1
/* (0.46)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.46
d9 1
a9 1
#define Module_Date_CMHG                12 Jul 2009
d11 2
a12 2
#define Module_MajorVersion             "0.46"
#define Module_Version                  46
d14 1
a14 1
#define Module_Date                     "12 Jul 2009"
d16 1
a16 1
#define Module_ApplicationDate          "12-Jul-09"
d21 3
a23 3
#define Module_FullVersion              "0.46"
#define Module_HelpVersion              "0.46 (12 Jul 2009)"
#define Module_LibraryVersionInfo       "0:46"
@


1.45
log
@  Stopped errors about duplicate components.
Detail:
  This is something which is of particular annoyance with the "install"
  phase often meaning builds have the same component built multiple
  times (often with different options).
Admin:
  Works as expected.

Version 0.45. Tagged as 'srcbuild-0_45'
@
text
@d1 1
a1 1
/* (0.45)
d4 1
a4 1
 * Last processed by srccommit version: 1.2.
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.45
d9 1
a9 1
#define Module_Date_CMHG                31 May 2007
d11 2
a12 2
#define Module_MajorVersion             "0.45"
#define Module_Version                  45
d14 1
a14 1
#define Module_Date                     "31 May 2007"
d16 1
a16 1
#define Module_ApplicationDate          "31-May-07"
d19 1
a19 1
#define Module_ComponentPath            "RiscOS/Utilities/Release/srcbuild"
d21 3
a23 3
#define Module_FullVersion              "0.45"
#define Module_HelpVersion              "0.45 (31 May 2007)"
#define Module_LibraryVersionInfo       "0:45"
@


1.44
log
@  Bug fix/new feature.
Detail:
  When the same component is included in a build multiple times with
  different options, you can end up in a situation where the second time
  you do a build, the first instance of it isn't cleaned so you end up
  with the (incorrect) last set of options from the previous build and
  that's not good.

  Now, you can specify -clean in the components file for any component
  which you want to forcibly clean.

  I've also made some minor efficiency improvements by making the
  components list doubly-linked rather than singly-linked.
Admin:
  Tested in baseline 517 build and appears to do the job.

Version 0.44. Tagged as 'srcbuild-0_44'
@
text
@d1 1
a1 1
/* (0.44)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.44
d9 1
a9 1
#define Module_Date_CMHG                11 Aug 2005
d11 2
a12 2
#define Module_MajorVersion             "0.44"
#define Module_Version                  44
d14 1
a14 1
#define Module_Date                     "11 Aug 2005"
d16 1
a16 1
#define Module_ApplicationDate          "11-Aug-05"
d21 3
a23 3
#define Module_FullVersion              "0.44"
#define Module_HelpVersion              "0.44 (11 Aug 2005)"
#define Module_LibraryVersionInfo       "0:44"
@


1.43
log
@  Smoothed some rough edges in BBE exports; also corrects an apparent
  oversight in the clean phases.
Detail:
  * New type of component introduced, "BBE", for which only the BBE phase
    is executed, and for which no Makefile is exported to the BBE. Intended
    for use with BuildApps, BuildEnv etc.
  * Only creates "aof" subdirectory in BBE exports for "C" type components.
  * Doesn't create "rm" subdirectory in BBE exports for components of types
    "C", "RES" and "BBE".
  * Will now run clean and clean_all phases on "RES" type components.
Admin:
  Tested on a Tungsten BBE build.

Version 0.43. Tagged as 'srcbuild-0_43'
@
text
@d1 1
a1 1
/* (0.43)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.43
d9 1
a9 1
#define Module_Date_CMHG                12 Nov 2004
d11 2
a12 2
#define Module_MajorVersion             "0.43"
#define Module_Version                  43
d14 1
a14 1
#define Module_Date                     "12 Nov 2004"
d16 1
a16 1
#define Module_ApplicationDate          "12-Nov-04"
d21 3
a23 3
#define Module_FullVersion              "0.43"
#define Module_HelpVersion              "0.43 (12 Nov 2004)"
#define Module_LibraryVersionInfo       "0:43"
@


1.42
log
@  Changes to get the BBE working again.
Detail:
  * During the changes for cross-compilation, the code that reconstructed
    the pathname for ${BBE_DIR}.BBE_ROM.rom_link in order to read it back
    was broken, with the result that all C components didn't even export
    the partially-linked code to the BBE (except the few that exported it
    explicitly).
  * The auto-generated makefiles were generating phony targets for the
    rom_link phase using ${COMPONENT} instead of ${TARGET} (as used by the
    hard-coded forwarding rule). This prevented C modules from being
    installed unless the two strings were identical.
  * Changed copyright statement in auto-generated makefiles to refer to
    Castle instead of Pace; removed the auto-generated date to make life
    easier if we attempt to keep built BBEs under change control.
Admin:
  Tested on a Tungsten BBE build.

Version 0.42. Tagged as 'srcbuild-0_42'
@
text
@d1 1
a1 1
/* (0.42)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.42
d9 1
a9 1
#define Module_Date_CMHG                09 Nov 2004
d11 2
a12 2
#define Module_MajorVersion             "0.42"
#define Module_Version                  42
d14 1
a14 1
#define Module_Date                     "09 Nov 2004"
d16 1
a16 1
#define Module_ApplicationDate          "09-Nov-04"
d21 3
a23 3
#define Module_FullVersion              "0.42"
#define Module_HelpVersion              "0.42 (09 Nov 2004)"
#define Module_LibraryVersionInfo       "0:42"
@


1.41
log
@  Fixed some bugs.
Detail:
  The previous check-in broke Baseline builds (or any other build which
  has a components file within a subdirectory of the BuildSys/Components
  directory). Fixed.

  Also, where a build includes multiple instances of the same component
  to be built with dfferent options, the force clean rule was not being
  invoked if the build itself included a clean (or clean_all) phase.

  This meant that object files from the first time the component was built
  would still be resident for the next version(s). Now, duplicate components
  are flagged internally as being duplicate so their force_clean flag is not
  cleared during the clean or clean_all phases.
Admin:
  Tested in early Baseline 500 builds on Iyonix.

Version 0.41. Tagged as 'srcbuild-0_41'
@
text
@d1 1
a1 1
/* (0.41)
d4 1
a4 1
 * Last processed by srccommit version: 1.68.
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.41
d9 1
a9 1
#define Module_Date_CMHG                12 Mar 2004
d11 2
a12 2
#define Module_MajorVersion             "0.41"
#define Module_Version                  41
d14 1
a14 1
#define Module_Date                     "12 Mar 2004"
d16 1
a16 1
#define Module_ApplicationDate          "12-Mar-04"
d21 3
a23 3
#define Module_FullVersion              "0.41"
#define Module_HelpVersion              "0.41 (12 Mar 2004)"
#define Module_LibraryVersionInfo       "0:41"
@


1.40
log
@Now runs stripdepnd after every clean_all.

Version 0.40. Tagged as 'srcbuild-0_40'
@
text
@d1 1
a1 1
/* (0.40)
d4 1
a4 1
 * Last processed by srccommit version: 1.2.
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.40
d9 1
a9 1
#define Module_Date_CMHG                16 Dec 2003
d11 2
a12 2
#define Module_MajorVersion             "0.40"
#define Module_Version                  40
d14 1
a14 1
#define Module_Date                     "16 Dec 2003"
d16 1
a16 1
#define Module_ApplicationDate          "16-Dec-03"
d21 3
a23 3
#define Module_FullVersion              "0.40"
#define Module_HelpVersion              "0.40 (16 Dec 2003)"
#define Module_LibraryVersionInfo       "0:40"
@


1.39
log
@No longer goes around creating Install.<Build> directories in the CSD
whenever a build is started!

Version 0.39. Tagged as 'srcbuild-0_39'
@
text
@d1 1
a1 1
/* (0.39)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.39
d9 1
a9 1
#define Module_Date_CMHG                11 Dec 2003
d11 2
a12 2
#define Module_MajorVersion             "0.39"
#define Module_Version                  39
d14 1
a14 1
#define Module_Date                     "11 Dec 2003"
d16 1
a16 1
#define Module_ApplicationDate          "11-Dec-03"
d21 3
a23 3
#define Module_FullVersion              "0.39"
#define Module_HelpVersion              "0.39 (11 Dec 2003)"
#define Module_LibraryVersionInfo       "0:39"
@


1.38
log
@  * Added support for the clean_all phase.
  * Slight tweak to (ram) install phase.
  * Corrected utterly insignificant comment in clean phase.
Detail:
  * Some of the major libraries (i.e. Desk and RISC_OSLib) do not really clean
    themselves in their 'clean' phase; you have to run 'clean_all' on them to
    do this. This is a pain in the proverbial for Baseline builds because you
    have to export from libraries twice - once 26bit and once 32bit. You MUST
    fully 'clean_all' libraries or you get objects of the wrong APCS exported.

    Soooo, rather than having to go through all my libraries running both
    'clean' and 'clean_all' on each manually, I've added the 'clean_all'
    option to srcbuild (and !Builder), separate from a simple 'clean'.

  * If "INSTDIR=" is one of the options passed from a Components file in the
    '-options' for a component, the install phase does not add "INSTDIR=foo"
    onto the amu command line itself (resulting in two, the latter being
    valid). This results in shorter command lines (which aren't in themselves
    much of a problem) that are a little easier to read.
Admin:
  Tested in Baseline builds.

Version 0.38. Tagged as 'srcbuild-0_38'
@
text
@d1 1
a1 1
/* (0.38)
d4 1
a4 1
 * Last processed by srccommit version: 1.63.
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.38
d9 1
a9 1
#define Module_Date_CMHG                08 May 2002
d11 2
a12 2
#define Module_MajorVersion             "0.38"
#define Module_Version                  38
d14 1
a14 1
#define Module_Date                     "08 May 2002"
d16 1
a16 2
#define Module_ApplicationDate2         "08-May-02"
#define Module_ApplicationDate4         "08-May-2002"
d21 3
a23 3
#define Module_FullVersion              "0.38"
#define Module_HelpVersion              "0.38 (08 May 2002)"
#define Module_LibraryVersionInfo       "0:38"
@


1.37
log
@  Now sets environment variables based upon options.
Detail:
  You can now rely on the options passed in the components file to
  adjust the "Locale", "UserIF" and "Machine" environment variables
  for a component. This allows you to build components which use
  paths like "LocalRes:", "LocalUserIFRes:" in their Makefiles and
  get the correct resources out.

  I also fixed the install rule in the Makefile.
Admin:
  Builds and quite thoroughly tested.

  As an aside, I do occasionally see data aborts during builds, but
  this has been seen for a couple of years and on various build
  machines. An example is:

  INSTDIR = 'ADFS::Slayer2.$.Builds.Baseline.InstallAMU: *** Internal
  error: abort on data transfer at &0380D278 ***

  (line split for clarity). I don't know if this is amu's fault or
  scrbuild not terminating strings correctly. This is always where
  things seem to fail, i.e. the Kernel outputting a string which
  aborts before reaching the terminator - at the byte which should
  be it. Maybe it is the OS_NewLine code triggers callbacks in a
  task window which occasionally causes some nasty abort?

Version 0.37. Tagged as 'srcbuild-0_37'
@
text
@d1 1
a1 1
/* (0.37)
d4 1
a4 1
 * Last processed by srccommit version: 1.62.
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.37
d9 1
a9 1
#define Module_Date_CMHG                28 Feb 2002
d11 2
a12 2
#define Module_MajorVersion             "0.37"
#define Module_Version                  37
d14 1
a14 1
#define Module_Date                     "28 Feb 2002"
d16 2
a17 2
#define Module_ApplicationDate2         "28-Feb-02"
#define Module_ApplicationDate4         "28-Feb-2002"
d22 3
a24 3
#define Module_FullVersion              "0.37"
#define Module_HelpVersion              "0.37 (28 Feb 2002)"
#define Module_LibraryVersionInfo       "0:37"
@


1.36
log
@  Passes the options *after* all other options when running amu.
Detail:
  If you don't, you can't override defaults by specifying them in the
    -options part of the components file.
Admin:
  Built.


Version 0.36. Tagged as 'srcbuild-0_36'
@
text
@d1 1
a1 1
/* (0.36)
d4 1
a4 1
 * Last processed by srccommit version: 1.60.
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.36
d9 1
a9 1
#define Module_Date_CMHG                02 Nov 2001
d11 2
a12 2
#define Module_MajorVersion             "0.36"
#define Module_Version                  36
d14 1
a14 1
#define Module_Date                     "02 Nov 2001"
d16 2
a17 2
#define Module_ApplicationDate2         "02-Nov-01"
#define Module_ApplicationDate4         "02-Nov-2001"
d22 3
a24 3
#define Module_FullVersion              "0.36"
#define Module_HelpVersion              "0.36 (02 Nov 2001)"
#define Module_LibraryVersionInfo       "0:36"
@


1.35
log
@  srcbuild changes.
Detail:
  srcbuild utility modfied to cope with the Env files and Components files
  being nested inside sub-directories. This had a small impact upon the
  directory creation code.
Admin:
  Required by Builder-0_14

Version 0.35. Tagged as 'srcbuild-0_35'
@
text
@d1 1
a1 1
/* (0.35)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.35
d9 1
a9 1
#define Module_Date_CMHG                19 Oct 2001
d11 2
a12 2
#define Module_MajorVersion             "0.35"
#define Module_Version                  35
d14 1
a14 1
#define Module_Date                     "19 Oct 2001"
d16 2
a17 2
#define Module_ApplicationDate2         "19-Oct-01"
#define Module_ApplicationDate4         "19-Oct-2001"
d22 3
a24 3
#define Module_FullVersion              "0.35"
#define Module_HelpVersion              "0.35 (19 Oct 2001)"
#define Module_LibraryVersionInfo       "0:35"
@


1.34
log
@  Update to environment reading added to srcbuild-0_33 for Unix builds
Detail:
  The original environment reading function stored all grabbed environment
  variables and stored them as "<var_value"> - this confuses Make somewhat
  but only for static dependencies.
Admin:
  Tested on Linux building a ROM of 14 components with phases resources,
  rom, rom_link and join.
  Only affects Unix builds of srcbuild.

Version 0.34. Tagged as 'srcbuild-0_34'
@
text
@d1 1
a1 1
/* (0.34)
d4 1
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.34
d9 1
a9 1
#define Module_Date_CMHG                21 Jun 2001
d11 2
a12 2
#define Module_MajorVersion             "0.34"
#define Module_Version                  34
d14 1
a14 1
#define Module_Date                     "21 Jun 2001"
d16 2
a17 2
#define Module_ApplicationDate2         "21-Jun-01"
#define Module_ApplicationDate4         "21-Jun-2001"
d22 3
a24 2
#define Module_FullVersion              "0.34"
#define Module_HelpVersion              "0.34 (21 Jun 2001)"
@


1.33
log
@  messages_filename is no longer permitted to be an environment variable.
Detail:
  Fixes for Linux version.
Admin:
  Work in progress - checkin point.


Version 0.33. Not tagged
@
text
@d1 1
a1 1
/* (0.33)
d6 1
a6 1
#define Module_MajorVersion_CMHG        0.33
d8 1
a8 1
#define Module_Date_CMHG                08 Jun 2001
d10 2
a11 2
#define Module_MajorVersion             "0.33"
#define Module_Version                  33
d13 1
a13 1
#define Module_Date                     "08 Jun 2001"
d15 2
a16 2
#define Module_ApplicationDate2         "08-Jun-01"
#define Module_ApplicationDate4         "08-Jun-2001"
d21 2
a22 2
#define Module_FullVersion              "0.33"
#define Module_HelpVersion              "0.33 (08 Jun 2001)"
@


1.32
log
@  Fixed bug in 'install' target support.
Detail:
  Install behaviour broken in srcbuild-0_26.  <Install$Dir> was no longer
  being passed as part of INSTDIR, and '-inst' flag in components file was
  being ignored.  Fault affected disc builds (i.e. STB baselines) and
  podule/extension ROMS.
Admin:
  Tested on RISC OS using test product.
  Portable change, although untested on Unix.

Version 0.33. Tagged as 'srcbuild-0_33'
@
text
@d8 1
a8 1
#define Module_Date_CMHG                18 May 2001
d13 1
a13 1
#define Module_Date                     "18 May 2001"
d15 2
a16 2
#define Module_ApplicationDate2         "18-May-01"
#define Module_ApplicationDate4         "18-May-2001"
d22 1
a22 1
#define Module_HelpVersion              "0.33 (18 May 2001)"
@


1.31
log
@  Recursive deletion now used.
Detail:
  The previous change to support multiple target BBE exports broke the
    deleting of BBE_Rom and BBE_Res directories because the recursion
    option was not specifed to OS_FSControl 27 (*Wipe)
Admin:
  Tested.

Version 0.32. Tagged as 'srcbuild-0_32'
@
text
@d1 1
a1 1
/* (0.32)
d6 1
a6 1
#define Module_MajorVersion_CMHG        0.32
d8 1
a8 1
#define Module_Date_CMHG                27 Mar 2001
d10 2
a11 2
#define Module_MajorVersion             "0.32"
#define Module_Version                  32
d13 1
a13 1
#define Module_Date                     "27 Mar 2001"
d15 2
a16 2
#define Module_ApplicationDate2         "27-Mar-01"
#define Module_ApplicationDate4         "27-Mar-2001"
d21 2
a22 2
#define Module_FullVersion              "0.32"
#define Module_HelpVersion              "0.32 (27 Mar 2001)"
@


1.30
log
@  Several little updates.
Detail:
  The RESDIR setting passed down to components is now fixed to be
    <Resource$Dir>.Resources for the first 64 components,
    <Resource$Dir>.Resources2 for the next 64,
    <Resource$Dir>.Resources3 for the next 64 etc.
    Currently most components explicitly override srcbuild's suggestion,
    but this is dangerous (could cause weird resource problems on old
    build machines).  64 chosen since it is comfortably less than 77.
  If a component appears twice in the components file(s), it is warned
    about.
  The default selection of image type (rom, exprom, extrom, other) is
    delayed until all components files are parsed - previously the choice
    would have been made at the end of any included file.
  BBE builds can cope with components that host multiple targets - notably
    the territory modules.  This used to fail previously (and required the
    entire sources of the component to be shipped) since only one target,
    the last to be processed, would be written into the BBE Makefile.
Admin:
  Tested briefly with various builds.

Version 0.31. Tagged as 'srcbuild-0_31'
@
text
@d1 1
a1 1
/* (0.31)
d6 1
a6 1
#define Module_MajorVersion_CMHG        0.31
d8 1
a8 1
#define Module_Date_CMHG                22 Mar 2001
d10 2
a11 2
#define Module_MajorVersion             "0.31"
#define Module_Version                  31
d13 1
a13 1
#define Module_Date                     "22 Mar 2001"
d15 2
a16 2
#define Module_ApplicationDate2         "22-Mar-01"
#define Module_ApplicationDate4         "22-Mar-2001"
d21 2
a22 2
#define Module_FullVersion              "0.31"
#define Module_HelpVersion              "0.31 (22 Mar 2001)"
@


1.29
log
@  C+P is evil.
Detail:
  Now outputs kernel->force_position and not component->force_position when
    using a HAL (ie. fixed position kernel).
Admin:
  Tested on Customer L build machine.

Version 0.30. Tagged as 'srcbuild-0_30'
@
text
@d1 1
a1 1
/* (0.30)
d6 1
a6 1
#define Module_MajorVersion_CMHG        0.30
d8 1
a8 1
#define Module_Date_CMHG                12 Mar 2001
d10 2
a11 2
#define Module_MajorVersion             "0.30"
#define Module_Version                  30
d13 1
a13 1
#define Module_Date                     "12 Mar 2001"
d15 2
a16 2
#define Module_ApplicationDate2         "12-Mar-01"
#define Module_ApplicationDate4         "12-Mar-2001"
d21 2
a22 2
#define Module_FullVersion              "0.30"
#define Module_HelpVersion              "0.30 (12 Mar 2001)"
@


1.28
log
@  A handful of fixes to resolve problems introduced during recent work.
Detail:
  RESDIR is passed down as <Resource$Dir>.Resources (RISCOS) builds, as
    expanding the system variable causes command line buffer overflows
    in LazarusUI (without expansion the line is 249 bytes long - the
    limit is 255).
  Additionally, RESDIR is also passed as <path>/Resources - previously
    Resources was missing and resulted in the resources being exported
    to the wrong directories.
  Export.<APCS>.Lib is explicitly created (safety feature, because HdrSrc
    creates it anyway, but realistically it should be done here)
  Command-line buffer created during amu_machinef is now length checked
    to abort srcbuild if data has been overwritten.
Admin:
  Tested in Laz1UK build - fixes problems in earlier versions.

Version 0.29. Tagged as 'srcbuild-0_29'
@
text
@d1 1
a1 1
/* (0.29)
d6 1
a6 1
#define Module_MajorVersion_CMHG        0.29
d8 1
a8 1
#define Module_Date_CMHG                08 Feb 2001
d10 2
a11 2
#define Module_MajorVersion             "0.29"
#define Module_Version                  29
d13 1
a13 1
#define Module_Date                     "08 Feb 2001"
d15 2
a16 2
#define Module_ApplicationDate2         "08-Feb-01"
#define Module_ApplicationDate4         "08-Feb-2001"
d21 2
a22 2
#define Module_FullVersion              "0.29"
#define Module_HelpVersion              "0.29 (08 Feb 2001)"
@


1.27
log
@  Tidied up Unix makefile
Detail:
  Removed explicit reference to /usr/ucb/install and replaced with
  install as per objasm's makefile.


Version 0.28. Tagged as 'srcbuild-0_28'
@
text
@d1 1
a1 1
/* (0.28)
d6 1
a6 1
#define Module_MajorVersion_CMHG        0.28
d8 1
a8 1
#define Module_Date_CMHG                06 Feb 2001
d10 2
a11 2
#define Module_MajorVersion             "0.28"
#define Module_Version                  28
d13 1
a13 1
#define Module_Date                     "06 Feb 2001"
d15 2
a16 2
#define Module_ApplicationDate2         "06-Feb-01"
#define Module_ApplicationDate4         "06-Feb-2001"
d21 2
a22 2
#define Module_FullVersion              "0.28"
#define Module_HelpVersion              "0.28 (06 Feb 2001)"
@


1.26
log
@  More wide-ranging changes to srcbuild for portability and romlinker.
Detail:
  The romlinker joiner format is now defined and implemented by srcbuild.
    This means that srcbuild can invoke romlinker to join main ROMs,
    expansion ROMs or extension ROMs depending on a switch in a product's
    components file (the %format directive should specify a value of one
    of rom extrom or exprom).
  Any %-directives that are not srcbuild directives are passed through to
    romlinker as command-line options.  All target image sizes are passed
    through in bytes - see romlinker documentation for full details of the
    interfaces.
  Environment variables are set to represent the territory mappings.  This
    is done on all targets so that other tools can rely on retrieving the
    information via getenv() and not needing to prod the International
    module directly.
  extern declarations removed from .c files into .h files to remove chance
    of mismatched multiple declarations.
  Some spelling corrections in comments, system call synchronisation calls
    added, although sb_system does not implement parallel makes yet.
  Documentation added on the portability aspects, environmental aspects and
    the territory mapping stuff.  A program is provided (MkDefaults) to
    run under RISC OS to generate up-to-date source code for srcbuild's
    territory information database.
  srcbuild now keeps note of the type of image that it is generating, rather
    than relying on reverse-engineering it from the joiner and joiner format
    strings (set by %format in the component file, defaults to main ROM)
  Many comments updated to reflect the actual code, some obsolete code
    removed.
Admin:
  This version should represent a functionally complete version capable of
    running cross-compiled builds on UNIX systems.
  Tested on RISC OS.

Version 0.27. Tagged as 'srcbuild-0_27'
@
text
@d1 1
a1 1
/* (0.27)
d6 1
a6 1
#define Module_MajorVersion_CMHG        0.27
d8 1
a8 1
#define Module_Date_CMHG                02 Feb 2001
d10 2
a11 2
#define Module_MajorVersion             "0.27"
#define Module_Version                  27
d13 1
a13 1
#define Module_Date                     "02 Feb 2001"
d15 2
a16 2
#define Module_ApplicationDate2         "02-Feb-01"
#define Module_ApplicationDate4         "02-Feb-2001"
d21 2
a22 2
#define Module_FullVersion              "0.27"
#define Module_HelpVersion              "0.27 (02 Feb 2001)"
@


1.25
log
@  Portable version of srcbuild.
  Has initial knowledge of the romlinker tool - work incomplete.
Detail:
  This is a portable version of srcbuild.  It is no longer tied to various
    RISC OS concepts such as: global shared environment namespace;
    *Spool; . as directory separator (host's directory separator is read
    during program startup).
  UNIX version stores the "system variables" in a hash table and exports
    the contents of the environment hash table to new processes which it
    forks.  UNIX version does not parallelise builds currently - in theory
    with a little more intelligence in sb_system to manage the log file
    coherently, it should be possible to parallelise some actions during
    builds (because it will avoid blocking srcbuild when waiting for I/O,
    and because changing the environment in the parent srcbuild process
    won't affect any children that are still running)
  A lot of things have changed in this version - many functions have been
    renamed to avoid clashes with UNIX system calls (most calls in riscos.c
    in fact); printf/fprintf(stderr...) are no longer used directly -
    sb_printf/sb_fprintf is used instead to ensure data is copied to the
    log file.
  ROM joining works on Solaris if you supply the Install/<Build> directory
    fully populated with files from a RISC OS build which comprise the
    ROM image.  Identical images are produced (with: romlinker -format rom).
  This version of srcbuild cannot use romlinker to build anything other
    than ROM images - syntax for specifying expansion/extension images
    is yet to be implemented.  To test, set %Joiner and %JoinerFormat to
    romlinker in your Components file (and put romlinker in your library
    directory if you do not have a RiscOS/Library/Build which includes it)
  Removed some duplicated code that calculated ROM positions when an install_rom
    phase had not been run but a join had been requested - build_install_rom
    is now parameterised to enable the BBE generator, join phase and normal
    install_rom activities to be done by one function instead of three nearly
    identical bits of code.
  Anything other than list or join requires a compatible Makefile in each
    component in the build.
Admin:
  Tested, although not exhaustively, under RISC OS.
  Tested list & join phases on Intel Solaris.
  romlinker integration tested briefly.

Version 0.26. Tagged as 'srcbuild-0_26'
@
text
@d1 1
a1 1
/* (0.26)
d6 1
a6 1
#define Module_MajorVersion_CMHG        0.26
d8 1
a8 1
#define Module_Date_CMHG                25 Jan 2001
d10 2
a11 2
#define Module_MajorVersion             "0.26"
#define Module_Version                  26
d13 1
a13 1
#define Module_Date                     "25 Jan 2001"
d15 2
a16 2
#define Module_ApplicationDate2         "25-Jan-01"
#define Module_ApplicationDate4         "25-Jan-2001"
d21 2
a22 2
#define Module_FullVersion              "0.26"
#define Module_HelpVersion              "0.26 (25 Jan 2001)"
@


1.24
log
@  BBE phase added.
Detail:
  Lots of code changed - see branch logs for details.
Admin:
  The Binary Build Environment development has been done on a branch
    and is now considered stable for merge to the trunk.
  Tested in BBE.

Version 0.25. Tagged as 'srcbuild-0_25'
@
text
@d1 1
a1 1
/* (0.25)
d6 1
a6 1
#define Module_MajorVersion_CMHG        0.25
d8 1
a8 1
#define Module_Date_CMHG                15 Dec 2000
d10 2
a11 2
#define Module_MajorVersion             "0.25"
#define Module_Version                  25
d13 1
a13 1
#define Module_Date                     "15 Dec 2000"
d15 2
a16 2
#define Module_ApplicationDate2         "15-Dec-00"
#define Module_ApplicationDate4         "15-Dec-2000"
d21 2
a22 2
#define Module_FullVersion              "0.25"
#define Module_HelpVersion              "0.25 (15 Dec 2000)"
@


1.23
log
@First attempt to allow a HAL/bootloader to be placed at the bottom of the
ROM; new component type is "HAL".
Performing a Join only when DATA components are in the build should now
work again.

Version 0.24. Tagged as 'srcbuild-0_24'
@
text
@d1 1
a1 1
/* (0.24)
d6 1
a6 1
#define Module_MajorVersion_CMHG        0.24
d8 1
a8 1
#define Module_Date_CMHG                16 Nov 2000
d10 2
a11 2
#define Module_MajorVersion             "0.24"
#define Module_Version                  24
d13 1
a13 1
#define Module_Date                     "16 Nov 2000"
d15 2
a16 2
#define Module_ApplicationDate2         "16-Nov-00"
#define Module_ApplicationDate4         "16-Nov-2000"
d21 2
a22 2
#define Module_FullVersion              "0.24"
#define Module_HelpVersion              "0.24 (16 Nov 2000)"
@


1.23.2.1
log
@  Intermediate development version of the Binary Build Environment support.
Detail:
  A new action 'bbe' has been created which generates a binary build
    environment in the Install.BBE directory.  This directory contains a
    self-contained environment in which ROM builds can be performed using
    only the pre-built binaries of modules and the parts of the modules'
    resources required for a particular project.
Admin:
  Requires BuildSys 2.81 or later (RiscOS/BuildSys; tag: BuildSys-2_81)
  Requires Library 0.60 or later (RiscOS/Library; tag: Library-0_60)

  Work in progress - checkpoint only.

Version 0.24, 1.23.2.1. Tagged as 'srcbuild-0_24-1_23_2_1'
@
text
@d7 2
a8 2
#define Module_MinorVersion_CMHG        1.23.2.1
#define Module_Date_CMHG                07 Dec 2000
d12 2
a13 2
#define Module_MinorVersion             "1.23.2.1"
#define Module_Date                     "07 Dec 2000"
d15 2
a16 2
#define Module_ApplicationDate2         "07-Dec-00"
#define Module_ApplicationDate4         "07-Dec-2000"
d21 2
a22 2
#define Module_FullVersion              "0.24 (1.23.2.1)"
#define Module_HelpVersion              "0.24 (07 Dec 2000) (1.23.2.1)"
@


1.23.2.2
log
@  Another checkpoint check-in.
Detail:
  This version appears to work as desired but is now being tested.
Admin:
  Undergoing testing.

Version 0.24, 1.23.2.2. Tagged as 'srcbuild-0_24-1_23_2_2'
@
text
@d7 2
a8 2
#define Module_MinorVersion_CMHG        1.23.2.2
#define Module_Date_CMHG                13 Dec 2000
d12 2
a13 2
#define Module_MinorVersion             "1.23.2.2"
#define Module_Date                     "13 Dec 2000"
d15 2
a16 2
#define Module_ApplicationDate2         "13-Dec-00"
#define Module_ApplicationDate4         "13-Dec-2000"
d21 2
a22 2
#define Module_FullVersion              "0.24 (1.23.2.2)"
#define Module_HelpVersion              "0.24 (13 Dec 2000) (1.23.2.2)"
@


1.23.2.3
log
@  More BBE changes.
Detail:
  More fixes and improvements.
Admin:
  This is now a release candidate.

Version 0.24, 1.23.2.3. Tagged as 'srcbuild-0_24-1_23_2_3'
@
text
@d7 2
a8 2
#define Module_MinorVersion_CMHG        1.23.2.3
#define Module_Date_CMHG                14 Dec 2000
d12 2
a13 2
#define Module_MinorVersion             "1.23.2.3"
#define Module_Date                     "14 Dec 2000"
d15 2
a16 2
#define Module_ApplicationDate2         "14-Dec-00"
#define Module_ApplicationDate4         "14-Dec-2000"
d21 2
a22 2
#define Module_FullVersion              "0.24 (1.23.2.3)"
#define Module_HelpVersion              "0.24 (14 Dec 2000) (1.23.2.3)"
@


1.23.2.4
log
@  More BBE changes.
Detail:
  New CLI option: -p outputs a CSV file containing the supported phases
    and their help strings.
  Pluralises territory correctly in output messages.
  Removes BBE_Res and BBE_ROM directories from installed BBE.
Admin:
  Tested in BBE.

Version 0.24, 1.23.2.4. Tagged as 'srcbuild-0_24-1_23_2_4'
@
text
@d7 2
a8 2
#define Module_MinorVersion_CMHG        1.23.2.4
#define Module_Date_CMHG                15 Dec 2000
d12 2
a13 2
#define Module_MinorVersion             "1.23.2.4"
#define Module_Date                     "15 Dec 2000"
d15 2
a16 2
#define Module_ApplicationDate2         "15-Dec-00"
#define Module_ApplicationDate4         "15-Dec-2000"
d21 2
a22 2
#define Module_FullVersion              "0.24 (1.23.2.4)"
#define Module_HelpVersion              "0.24 (15 Dec 2000) (1.23.2.4)"
@


1.22
log
@  Spool opening and closing does nothing if spooling is already on.
  Uncommented a remove call that should not have been commented.
Detail:
  spool_open now calls OS_Byte 199 to find out whether spooling is
    already happening to avoid screwing up any higher level redirection
    that is taking place.  This should enable more meaningful log
    messages to be generated.
Admin:
  Built.

Version 0.23. Tagged as 'srcbuild-0_23'
@
text
@d1 1
a1 1
/* (0.23)
d6 1
a6 1
#define Module_MajorVersion_CMHG        0.23
d8 1
a8 1
#define Module_Date_CMHG                16 Oct 2000
d10 2
a11 2
#define Module_MajorVersion             "0.23"
#define Module_Version                  23
d13 1
a13 1
#define Module_Date                     "16 Oct 2000"
d15 2
a16 2
#define Module_ApplicationDate2         "16-Oct-00"
#define Module_ApplicationDate4         "16-Oct-2000"
d18 5
a22 2
#define Module_FullVersion              "0.23"
#define Module_HelpVersion              "0.23 (16 Oct 2000)"
@


1.21
log
@	Chnaged mechanism by which the country number is obtained.

Detail:
	SWI Territory_NameToNumber expects an internationalised country name.
This could upset the build process for countries such as Japan.
	Insted we now use Service_International 0 to obtain the country
number in a non-internationalised manner.

Admin:
	Tested in a Lazarus and Customer F 7 build.

Version 0.22. Tagged as 'srcbuild-0_22'
@
text
@d1 1
a1 1
/* (0.22)
d6 1
a6 1
#define Module_MajorVersion_CMHG        0.22
d8 1
a8 1
#define Module_Date_CMHG                18 Jul 2000
d10 2
a11 2
#define Module_MajorVersion             "0.22"
#define Module_Version                  22
d13 1
a13 1
#define Module_Date                     "18 Jul 2000"
d15 2
a16 2
#define Module_ApplicationDate2         "18-Jul-00"
#define Module_ApplicationDate4         "18-Jul-2000"
d18 2
a19 1
#define Module_FullVersion              "0.22"
@


1.20
log
@  Now works without LocaleList env variable being set.
Detail:
  If the LocaleList system variable is unset, then srcbuild now sets it to
the value contained in the Locale Env var. This is because other parts of the
system (particulalry the Messages makefile) rely on LocaleList being set.
Admin:
  Tested on a Lazarus build without LocaleList beig set.

Version 0.21. Tagged as 'srcbuild-0_21'
@
text
@d1 1
a1 1
/* (0.21)
d6 1
a6 1
#define Module_MajorVersion_CMHG        0.21
d8 1
a8 1
#define Module_Date_CMHG                12 Jun 2000
d10 2
a11 2
#define Module_MajorVersion             "0.21"
#define Module_Version                  21
d13 1
a13 1
#define Module_Date                     "12 Jun 2000"
d15 2
a16 2
#define Module_ApplicationDate2         "12-Jun-00"
#define Module_ApplicationDate4         "12-Jun-2000"
d18 1
a18 1
#define Module_FullVersion              "0.21"
@


1.19
log
@	Fixed an 'OflaOfla bug.'
	Resource directory ordering changed.

Detail:
	Fixed a bug where directories called 'oflaofla...' were being created
in the Install directory. Srcbuild iterates through all the components in the
components file, and attempts to create the relevant install directory.
Unfortunatley, many components (e.g. HdrSrc) do not have an install directory
in the ModuleDB. This was causing a string to be printed with a NULL pointer,
causing oflaofla to be created as part of the directory leaf.
	As part of the work to allow multiple territories to be present in
one build, we are altering the resource directories so they are now held in the
following manner:
	Used to be : Messages.Resources.<locale>.<build>
	Is now :     Messages.Resources.<build>.<numeric terriory list>.<locale>
	Where the numeric territory list is a list of all the territories
held in the resources directory, eg. 000106 for Common, UK and France. The
Common directory holds all resources that are common to the other territories
and is generated by the Messages module. Note that if there are three
territories, then there will be four directories held in resources, one for
each territory and one for the Common directory.

Admin:
	Used in some Lazarus builds
	Very much work in progress. Use at your peril. Being checked in early
due to the anticiapted CVS server changes.
	Obbiously when you use this latest version, you will need to run the
resources phase because the formatting has changed.

Version 0.20. Tagged as 'srcbuild-0_20'
@
text
@d1 1
a1 1
/* (0.20)
d6 1
a6 1
#define Module_MajorVersion_CMHG        0.20
d8 1
a8 1
#define Module_Date_CMHG                08 Jun 2000
d10 2
a11 2
#define Module_MajorVersion             "0.20"
#define Module_Version                  20
d13 1
a13 1
#define Module_Date                     "08 Jun 2000"
d15 2
a16 2
#define Module_ApplicationDate2         "08-Jun-00"
#define Module_ApplicationDate4         "08-Jun-2000"
d18 1
a18 1
#define Module_FullVersion              "0.20"
@


1.18
log
@	* Initial support for multiple territories in one build.

Admin:
	For the Bethany project we need to be able to build multiple resource
(territory) sets into one ROM build. The system variable LocaleList is read
and, if set, is parsed for a comma-seperated list of countries. The resources
phase is then called once for each of these countries. If the LocaleList flag
is unset then is should build the territory as set in the Locale in the Env
file.
	If the LocaleList flag is set then after the resources phase has been
run there should be one directory in the Internet.Messages path for each
territory mentioned in the LocaleList.
	To allow this to work the Common and Env files also need altering. If
the Env file does not have a LocaleList then it should have en explicit Unset
LocaleList. The common file also needs to have every *Set that references
<Locale> to be changed to a *SetMacro.

Admin:
	Work in progress for Bethany project. Only partially tested. A binary
checkin will follow after more work and testing.

Version 0.19. Tagged as 'srcbuild-0_19'
@
text
@d1 1
a1 1
/* (0.19)
d6 1
a6 1
#define Module_MajorVersion_CMHG        0.19
d8 1
a8 1
#define Module_Date_CMHG                22 May 2000
d10 2
a11 2
#define Module_MajorVersion             "0.19"
#define Module_Version                  19
d13 1
a13 1
#define Module_Date                     "22 May 2000"
d15 4
a18 1
#define Module_FullVersion              "0.19"
@


1.17
log
@	Each component can now havw a -nosources flag.

Detail:
 	There is a requirement for a customer to get a binary-only build
where they can change resources and do their own builds. To allow this we
will be providing them with a prebuilt disc image for the project with almost
all the sources deleted.
	To allow them to build images, have added the functionality to
SrcBuild whereby adding a -nosources flag to a component in the components
file causes clean, export_hdrs, export_libs and rom phases to have no effect.
This allows the client to build with resources, install_rom and join phases
and thus get an image with any changed resources in.
 	This change should only affect components that have a -nsources flag
in the component file.

Admin:
	Tested in a Lazarus build.

Version 0.18. Tagged as 'srcbuild-0_18'
@
text
@d1 1
a1 1
/* (0.18)
d6 1
a6 1
#define Module_MajorVersion_CMHG        0.18
d8 1
a8 1
#define Module_Date_CMHG                27 Mar 2000
d10 2
a11 2
#define Module_MajorVersion             "0.18"
#define Module_Version                  18
d13 1
a13 1
#define Module_Date                     "27 Mar 2000"
d15 1
a15 1
#define Module_FullVersion              "0.18"
@


1.16
log
@	Allowed APCS export directories to be created.

Detail:
	As part of the 32-bit OS work, if the APCS system variable is set
then srcbuild creates the export directories in Export.<APCS>, not Export.
This is part of the work-in-progress of the 32-bit support.

Admin:
	Tested in a Lazarus Omega build.

Version 0.17. Tagged as 'srcbuild-0_17'
@
text
@d1 1
a1 1
/* (0.17)
d6 3
a8 3
#define Module_MajorVersion_CMHG     	0.17
#define Module_MinorVersion_CMHG	
#define Module_Date_CMHG      		09 Nov 1999
d10 4
a13 4
#define Module_MajorVersion     	"0.17"
#define Module_Version                  17
#define Module_MinorVersion		""
#define Module_Date      		"09 Nov 1999"
d15 1
a15 1
#define Module_FullVersion              "0.17"
@


1.15
log
@	Changed handling of amu_machine in srcbuild.

Details:
	Changed way in which srcbuild uses amu_machine to get around RISC OS
3.7 limitions on command line length.  Now expands amu_machine alias
internally, which means that long command lines in builds will now work
correcltly.

	Tidied build system to create and clean up its "o" folder correctly,
and to clean it's dynamic dependencies.

Admin:
	Tested on several Lazarus builds. Committed on behalf of JBeranek

Version 0.16. Tagged as 'srcbuild-0_16'
@
text
@d1 1
a1 1
/* (0.16)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	0.16
d8 1
a8 1
#define Module_Date_CMHG      		10 Sep 1999
d10 2
a11 2
#define Module_MajorVersion     	"0.16"
#define Module_Version                  16
d13 1
a13 1
#define Module_Date      		"10 Sep 1999"
d15 1
a15 1
#define Module_FullVersion              "0.16"
@


1.14
log
@Summary
  *  Added support for install: targets
  *  Added support for podule ROM builds.

Detail
  *  Added support to pass 'install' as a valid parameter.  This allows
     disc builds and podule rom builds to be completed.
  *  Added knowledge of MakeExpROM as a valid joiner app.
Admin
  *  Tested install: work using a dummy Baseline 3 build.
  *  Tested MakeExpROM work using RiscOS/BuildSys/EtherI16E as a basis.
     srcbuild produces an indentical ROM to the old-style build system for
     populated roms and roms only containing podule ID information.

Version 0.15. Tagged as 'srcbuild-0_15'
@
text
@d1 1
a1 1
/* (0.15)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	0.15
d8 1
a8 1
#define Module_Date_CMHG      		09 Sep 1999
d10 2
a11 2
#define Module_MajorVersion     	"0.15"
#define Module_Version                  15
d13 1
a13 1
#define Module_Date      		"09 Sep 1999"
d15 1
a15 1
#define Module_FullVersion              "0.15"
@


1.13
log
@ 	Fixed a bug in srcbuild where a fatal error caused the
SrcBuild$ReturnCode system variable to be set to 1 (representing a successful
build) instead of 0 (representing a failed build).

Details:
	Whether the build was successful or not is determined by whether an
error is present in the error table. If the error was flagged as being a
fatal one, then exit() was being called *before* the error was added to the
error table. Hence when the atexit()-registered routine was called, there were
no errors in the error table and the system variable was being set as 1.
	Fixed by moving the exit() call that occurs in the error() routine
past the code that enters the error into the error table.

Admin:
	Tested in a deliberately-botched Customer M build.

Version 0.14. Tagged as 'srcbuild-0_14'
@
text
@d1 1
a1 1
/* (0.14)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	0.14
d8 1
a8 1
#define Module_Date_CMHG      		06 Jul 1999
d10 2
a11 2
#define Module_MajorVersion     	"0.14"
#define Module_Version                  14
d13 1
a13 1
#define Module_Date      		"06 Jul 1999"
d15 1
a15 1
#define Module_FullVersion              "0.14"
@


1.12
log
@Introduced the idea of a "DATA" module.

Version 0.13. Tagged as 'srcbuild-0_13'
@
text
@d1 1
a1 1
/* (0.13)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	0.13
d8 1
a8 1
#define Module_Date_CMHG      		07 May 1999
d10 2
a11 2
#define Module_MajorVersion     	"0.13"
#define Module_Version                  13
d13 1
a13 1
#define Module_Date      		"07 May 1999"
d15 1
a15 1
#define Module_FullVersion              "0.13"
@


1.11
log
@Adjusted clean of Messages module to cope with its new multiple component
wackyness.

Version 0.12. Tagged as 'srcbuild-0_12'
@
text
@d1 1
a1 1
/* (0.12)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	0.12
d8 1
a8 1
#define Module_Date_CMHG      		06 May 1999
d10 2
a11 2
#define Module_MajorVersion     	"0.12"
#define Module_Version                  12
d13 1
a13 1
#define Module_Date      		"06 May 1999"
d15 1
a15 1
#define Module_FullVersion              "0.12"
@


1.10
log
@Altered the code to set three system variables on program exit:
SrcBuild$ImageLocation		The location of the build image.
SrcBuild$LogfileLocation	The location of the build logfile.
SrcBuild$ReturnCode		Whether the build was successful or not.

 Also altered the install phase to install the executable in library.build instead of library, making it install into the correct place for the new library structure.
 Altered the exit(1) calls to be exit(EXIT_FAILURE)


Version 0.11. Tagged as 'srcbuild-0_11'
@
text
@d1 1
a1 1
/* (0.11)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	0.11
d8 1
a8 1
#define Module_Date_CMHG      		30 Apr 1999
d10 2
a11 2
#define Module_MajorVersion     	"0.11"
#define Module_Version                  11
d13 1
a13 1
#define Module_Date      		"30 Apr 1999"
d15 1
a15 1
#define Module_FullVersion              "0.11"
@


1.9
log
@Export modules are cleaned.  Options passed down during clean phase.

Version 0.10. Tagged as 'srcbuild-0_10'
@
text
@d1 1
a1 1
/* (0.10)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	0.10
d8 1
a8 1
#define Module_Date_CMHG      		28 Oct 1998
d10 2
a11 2
#define Module_MajorVersion     	"0.10"
#define Module_Version                  10
d13 1
a13 1
#define Module_Date      		"28 Oct 1998"
d15 1
@


1.8
log
@Summary
    Committing a couple of changes made long ago for Daytona but forgotten
    about:
      * Name of Messages module no longer hardwired.  Assumes Messages module
        is same name as leaf of Messages tag is the build's components file.
      * New 'BaseAddress' tag for components file allows base address of image
        to be specified e.g. for Daytona appflash.
Admin
    Sources compiled.
    A version merged with recent sources (version 0.07) has been tested in a
    couple of ROM builds.

Version 0.09. Tagged as 'srcbuild-0_09'
@
text
@d1 1
a1 1
/* (0.09)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	0.09
d8 1
a8 1
#define Module_Date_CMHG      		27 Oct 1998
d10 2
a11 2
#define Module_MajorVersion     	"0.09"
#define Module_Version                  9
d13 1
a13 1
#define Module_Date      		"27 Oct 1998"
@


1.7
log
@Added "-address <n>" option to place a component at a fixed address (for
nefarious purposes - it won't be linked into the module chain, so only useful
for some sort of embedded data).

Version 0.08. Tagged as 'srcbuild-0_08'
@
text
@d1 1
a1 1
/* (0.08)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	0.08
d10 2
a11 2
#define Module_MajorVersion     	"0.08"
#define Module_Version                  8
@


1.6
log
@Summary
    Allow ROM build option flags to be passed to all phases
Detail
    Phases clean, export hdrs, export libs now have component options
    passed down.
Admin
    Sources compiled, functionality tested on a build tree.

Version 0.07. Tagged as 'srcbuild-0_07'
@
text
@d1 1
a1 1
/* (0.07)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	0.07
d8 1
a8 1
#define Module_Date_CMHG      		30 Jul 1998
d10 2
a11 2
#define Module_MajorVersion     	"0.07"
#define Module_Version                  7
d13 1
a13 1
#define Module_Date      		"30 Jul 1998"
@


1.5
log
@Now passes options down to makefile during resources phase.

Version 0.06. Tagged as 'srcbuild-0_06'
@
text
@d1 1
a1 1
/* (0.06)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	0.06
d8 1
a8 1
#define Module_Date_CMHG      		13 Jan 1998
d10 2
a11 1
#define Module_MajorVersion     	"0.06"
d13 1
a13 1
#define Module_Date      		"13 Jan 1998"
@


1.4
log
@Addition of makefile variables COMPONENT and TARGET (if it exists) for all
amu calls. Enable verbose output if you want to actually see the command
line that is contructed and executed.

Version 0.05. Tagged as 'srcbuild-0_05'
@
text
@d1 1
a1 1
/* (0.05)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	0.05
d8 1
a8 1
#define Module_Date_CMHG      		31 Oct 1997
d10 1
a10 1
#define Module_MajorVersion     	"0.05"
d12 1
a12 1
#define Module_Date      		"31 Oct 1997"
@


1.3
log
@Allow multiple words for the -options field.
Support the new flags for BigSplit2 for ROM signature.

Version 0.04. Tagged as 'srcbuild-0_04'
@
text
@d1 1
a1 1
/* (0.04)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	0.04
d8 1
a8 1
#define Module_Date_CMHG      		25 Sep 1997
d10 1
a10 1
#define Module_MajorVersion     	"0.04"
d12 1
a12 1
#define Module_Date      		"25 Sep 1997"
@


1.2
log
@Modified sources to use VersionNum scheme.

Version 0.03. Tagged as 'srcbuild-0_03'
@
text
@d1 1
a1 1
/* (0.03)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	0.03
d10 1
a10 1
#define Module_MajorVersion     	"0.03"
@


1.1
log
@created by srccommit.
@
text
@d1 1
a1 1
/* (0.02)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	0.02
d10 1
a10 1
#define Module_MajorVersion     	"0.02"
@
