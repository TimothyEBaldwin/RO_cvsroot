head	4.37;
access;
symbols
	NetTime-0_43:4.37
	NetTime-0_42:4.36
	NetTime-0_41:4.35
	NetTime-0_40:4.34
	NetTime-0_39:4.33
	NetTime-0_38:4.32
	NetTime-0_37:4.31
	NetTime-0_36:4.30
	NetTime-0_35:4.29
	NetTime-0_34:4.28
	NetTime-0_33:4.27
	NetTime-0_32:4.26
	NetTime-0_31:4.25
	NetTime-0_30:4.24
	NetTime-0_29:4.23
	dellis_autobuild_BaseSW:4.22
	NetTime-0_28:4.22
	NetTime-0_26:4.21
	NetTime-0_25:4.20
	NetTime-0_24:4.19
	NetTime-0_23:4.18
	sbrodie_sedwards_16Mar2000:4.16
	NetTime-0_22:4.17
	NetTime-0_21:4.16
	NetTime-0_20:4.15
	dcotton_autobuild_BaseSW:4.23
	NetTime-0_16:4.14
	NetTime-0_15:4.13
	NetTime-0_14:4.12
	NetTime-0_13:4.11
	NetTime-0_12:4.10
	NetTime-0_11:4.9
	NetTime-0_10:4.8
	NetTime-0_09:4.7
	NetTime-0_08:4.6
	NetTime-0_07:4.5
	NetTime-0_06:4.4
	NetTime-0_05:4.3
	NetTime-0_04:4.2;
locks; strict;
comment	@# @;


4.37
date	2013.11.28.21.44.17;	author rsprowson;	state Exp;
branches;
next	4.36;
commitid	rSY16SsDgYrjJ5fx;

4.36
date	2013.11.24.12.17.12;	author rsprowson;	state Exp;
branches;
next	4.35;
commitid	kdgSEA52DRKJIwex;

4.35
date	2013.11.17.11.19.26;	author rsprowson;	state Exp;
branches;
next	4.34;
commitid	NvSppOvMaHeSCCdx;

4.34
date	2012.04.10.08.36.17;	author rsprowson;	state Exp;
branches;
next	4.33;
commitid	Tg6Nm8lS5s1Jyi0w;

4.33
date	2012.02.25.08.18.08;	author rsprowson;	state Exp;
branches;
next	4.32;
commitid	7cQZQe1cYi4cUvUv;

4.32
date	2012.02.12.15.36.18;	author rsprowson;	state Exp;
branches;
next	4.31;
commitid	Z5V6e85W3FhqKSSv;

4.31
date	2012.02.04.22.08.34;	author rsprowson;	state Exp;
branches;
next	4.30;
commitid	W0erdTttgEwVaTRv;

4.30
date	2005.01.17.22.50.51;	author jballance;	state Exp;
branches;
next	4.29;

4.29
date	2004.10.17.16.31.44;	author srevill;	state Exp;
branches;
next	4.28;

4.28
date	2004.10.14.16.12.09;	author srevill;	state Exp;
branches;
next	4.27;

4.27
date	2004.06.14.12.26.43;	author kbracey;	state Exp;
branches;
next	4.26;

4.26
date	2004.05.19.18.21.23;	author kbracey;	state Exp;
branches;
next	4.25;

4.25
date	2002.07.23.12.39.02;	author srevill;	state Exp;
branches;
next	4.24;

4.24
date	2002.04.25.15.20.52;	author srevill;	state Exp;
branches;
next	4.23;

4.23
date	2000.10.06.10.02.48;	author sbrodie;	state Exp;
branches;
next	4.22;

4.22
date	2000.09.08.15.35.40;	author mjrobert;	state Exp;
branches;
next	4.21;

4.21
date	2000.09.06.13.40.26;	author dcotton;	state Exp;
branches;
next	4.20;

4.20
date	2000.08.01.10.27.43;	author jfletche;	state Exp;
branches;
next	4.19;

4.19
date	2000.07.21.15.00.30;	author jberanek;	state Exp;
branches;
next	4.18;

4.18
date	2000.03.20.16.05.26;	author kbracey;	state Exp;
branches;
next	4.17;

4.17
date	2000.03.16.16.50.15;	author kbracey;	state Exp;
branches;
next	4.16;

4.16
date	2000.03.15.15.38.00;	author kbracey;	state Exp;
branches;
next	4.15;

4.15
date	2000.03.07.10.44.45;	author kbracey;	state Exp;
branches;
next	4.14;

4.14
date	99.07.05.18.11.14;	author dcotton;	state Exp;
branches;
next	4.13;

4.13
date	99.06.09.14.42.34;	author sforrest;	state Exp;
branches;
next	4.12;

4.12
date	99.06.09.14.30.21;	author kbracey;	state Exp;
branches;
next	4.11;

4.11
date	99.04.08.10.04.31;	author dcotton;	state Exp;
branches;
next	4.10;

4.10
date	99.03.04.16.42.55;	author nturton;	state Exp;
branches;
next	4.9;

4.9
date	99.01.13.19.12.16;	author jfarrell;	state Exp;
branches;
next	4.8;

4.8
date	98.12.14.13.53.41;	author ahodgkin;	state Exp;
branches;
next	4.7;

4.7
date	98.12.01.12.03.15;	author jfarrell;	state Exp;
branches;
next	4.6;

4.6
date	98.11.24.16.52.26;	author kbracey;	state Exp;
branches;
next	4.5;

4.5
date	98.11.24.16.26.03;	author jfarrell;	state Exp;
branches;
next	4.4;

4.4
date	98.11.24.13.15.31;	author kbracey;	state Exp;
branches;
next	4.3;

4.3
date	98.11.24.10.51.39;	author kbracey;	state Exp;
branches;
next	4.2;

4.2
date	98.11.23.19.44.47;	author smiddle;	state Exp;
branches;
next	4.1;

4.1
date	98.11.23.19.38.30;	author smiddle;	state Exp;
branches;
next	;


desc
@@


4.37
log
@Fix failure to make large time jumps when delagating
NetTime intercepts OS_Word 15, but when calling RTC_Adjust was not disabling that interception, so the time got set twice, ending up back at a copy of the (incorrect) soft clock.

Version 0.43. Tagged as 'NetTime-0_43'
@
text
@/* (0.43)
 *
 * This file is automatically maintained by srccommit, do not edit manually.
 * Last processed by srccommit version: 1.1.
 *
 */
#define Module_MajorVersion_CMHG        0.43
#define Module_MinorVersion_CMHG        
#define Module_Date_CMHG                28 Nov 2013

#define Module_MajorVersion             "0.43"
#define Module_Version                  43
#define Module_MinorVersion             ""
#define Module_Date                     "28 Nov 2013"

#define Module_ApplicationDate          "28-Nov-13"

#define Module_ComponentName            "NetTime"
#define Module_ComponentPath            "castle/RiscOS/Sources/Networking/NetTime"

#define Module_FullVersion              "0.43"
#define Module_HelpVersion              "0.43 (28 Nov 2013)"
#define Module_LibraryVersionInfo       "0:43"
@


4.36
log
@Delagate RTC adjustments to RTC module when present
When the RTC module is present don't try making the duplicate adjustments in this module, while largely harmless the status report would likely be out of sync as the two modules battle eachother for who can poke timer 0 more often.
Changed files
 machine.c: double quotes in debug text removed
 ntp.c: use some named defines for OS_Hardware calls
 Spec: typo correction
 rtcadjust.c: when RTC module is active, delagate adjustments to RTC_Adjust SWI

Tested on a Risc PC over 24 hours.

Version 0.42. Tagged as 'NetTime-0_42'
@
text
@d1 1
a1 1
/* (0.42)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.42
d9 1
a9 1
#define Module_Date_CMHG                24 Nov 2013
d11 2
a12 2
#define Module_MajorVersion             "0.42"
#define Module_Version                  42
d14 1
a14 1
#define Module_Date                     "24 Nov 2013"
d16 1
a16 1
#define Module_ApplicationDate          "24-Nov-13"
d21 3
a23 3
#define Module_FullVersion              "0.42"
#define Module_HelpVersion              "0.42 (24 Nov 2013)"
#define Module_LibraryVersionInfo       "0:42"
@


4.35
log
@Reverse the sense of the NetTime offset
Rather than requiring a unary minus in rtcadjust, simply work out the offset the other way round (+ve means the RISC OS soft clock is fast compared with real time).

Version 0.41. Tagged as 'NetTime-0_41'
@
text
@d1 1
a1 1
/* (0.41)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.41
d9 1
a9 1
#define Module_Date_CMHG                17 Nov 2013
d11 2
a12 2
#define Module_MajorVersion             "0.41"
#define Module_Version                  41
d14 1
a14 1
#define Module_Date                     "17 Nov 2013"
d16 1
a16 1
#define Module_ApplicationDate          "17-Nov-13"
d21 3
a23 3
#define Module_FullVersion              "0.41"
#define Module_HelpVersion              "0.41 (17 Nov 2013)"
#define Module_LibraryVersionInfo       "0:41"
@


4.34
log
@Past state from NetTime_States was always zero.
No longer trampled on by the current state, therefore reports the correct last state when the link is down. Also marks the last set as unsuccessful on every DNS lookup just incase someone kills the resolver too.

Version 0.40. Tagged as 'NetTime-0_40'
@
text
@d1 1
a1 1
/* (0.40)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.40
d9 1
a9 1
#define Module_Date_CMHG                10 Apr 2012
d11 2
a12 2
#define Module_MajorVersion             "0.40"
#define Module_Version                  40
d14 1
a14 1
#define Module_Date                     "10 Apr 2012"
d16 1
a16 1
#define Module_ApplicationDate          "10-Apr-12"
d21 3
a23 3
#define Module_FullVersion              "0.40"
#define Module_HelpVersion              "0.40 (10 Apr 2012)"
#define Module_LibraryVersionInfo       "0:40"
@


4.33
log
@Remove DST CMOS fiddling code.
Shortly to be handled by TerritoryManager, but the DST fiddling in this module was already broken. Aside from only knowing about Europe and Australia, the Australia rules were wrong too (since they've been changed again).
dhcp.c: use names for timezone CMOS rather than magic numbers.
Rework read_os_var() to remove the 'read length when buff = NULL' which is never used, but also wouldn't have worked because the read length call to OS_ReadVarVal returns an error which is caught by the _swix() hence you always got -1.
Put resolver variable name into a define in the header file.

Version 0.39. Tagged as 'NetTime-0_39'
@
text
@d1 1
a1 1
/* (0.39)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.39
d9 1
a9 1
#define Module_Date_CMHG                25 Feb 2012
d11 2
a12 2
#define Module_MajorVersion             "0.39"
#define Module_Version                  39
d14 1
a14 1
#define Module_Date                     "25 Feb 2012"
d16 1
a16 1
#define Module_ApplicationDate          "25-Feb-12"
d21 3
a23 3
#define Module_FullVersion              "0.39"
#define Module_HelpVersion              "0.39 (25 Feb 2012)"
#define Module_LibraryVersionInfo       "0:39"
@


4.32
log
@Exports added.
SWI numbers and some bit fields for both C and assembler use.

Version 0.38. Tagged as 'NetTime-0_38'
@
text
@d1 1
a1 1
/* (0.38)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.38
d9 1
a9 1
#define Module_Date_CMHG                12 Feb 2012
d11 2
a12 2
#define Module_MajorVersion             "0.38"
#define Module_Version                  38
d14 1
a14 1
#define Module_Date                     "12 Feb 2012"
d16 1
a16 1
#define Module_ApplicationDate          "12-Feb-12"
d21 3
a23 3
#define Module_FullVersion              "0.38"
#define Module_HelpVersion              "0.38 (12 Feb 2012)"
#define Module_LibraryVersionInfo       "0:38"
@


4.31
log
@Add SWI NetTime_States.
Makefile changed to use "CModule" fragment.
Soak up some compiler warnings.
Extralong functions removed.
Use central header files in preference to local defines.
A failure to register resources no longer leaves EventV and WordV claimed.

Version 0.37. Tagged as 'NetTime-0_37'
@
text
@d1 1
a1 1
/* (0.37)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.37
d9 1
a9 1
#define Module_Date_CMHG                04 Feb 2012
d11 2
a12 2
#define Module_MajorVersion             "0.37"
#define Module_Version                  37
d14 1
a14 1
#define Module_Date                     "04 Feb 2012"
d16 1
a16 1
#define Module_ApplicationDate          "04-Feb-12"
d21 3
a23 3
#define Module_FullVersion              "0.37"
#define Module_HelpVersion              "0.37 (04 Feb 2012)"
#define Module_LibraryVersionInfo       "0:37"
@


4.30
log
@        added compile in of messages file for StandAlone build
Detail:
Admin:  no other changes



Version 0.36. Tagged as 'NetTime-0_36'
@
text
@d1 1
a1 1
/* (0.36)
d4 1
a4 1
 * Last processed by srccommit version: 1.2.
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.36
d9 1
a9 1
#define Module_Date_CMHG                17 Jan 2005
d11 2
a12 2
#define Module_MajorVersion             "0.36"
#define Module_Version                  36
d14 1
a14 1
#define Module_Date                     "17 Jan 2005"
d16 1
a16 1
#define Module_ApplicationDate          "17-Jan-05"
d19 1
a19 1
#define Module_ComponentPath            "RiscOS/Sources/Networking/NetTime"
d21 3
a23 3
#define Module_FullVersion              "0.36"
#define Module_HelpVersion              "0.36 (17 Jan 2005)"
#define Module_LibraryVersionInfo       "0:36"
@


4.29
log
@  Different change to the problems with servers without primary sync.
Detail:
  We now simply keep a flag indicating if we have ever seen the configured
  NTP server with primary sync. While the flag is FALSE, we will accept NTP
  responses more flexibly. For example, we ignore leap indicator of 3 or
  stratum of zero or greater than 14.
Admin:
  Works as hoped with the servers at Customer A.

Version 0.35. Tagged as 'NetTime-0_35'
@
text
@d1 1
a1 1
/* (0.35)
d4 1
a4 1
 * Last processed by srccommit version: 1.68.
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.35
d9 1
a9 1
#define Module_Date_CMHG                17 Oct 2004
d11 2
a12 2
#define Module_MajorVersion             "0.35"
#define Module_Version                  35
d14 1
a14 1
#define Module_Date                     "17 Oct 2004"
d16 1
a16 1
#define Module_ApplicationDate          "17-Oct-04"
d21 3
a23 3
#define Module_FullVersion              "0.35"
#define Module_HelpVersion              "0.35 (17 Oct 2004)"
#define Module_LibraryVersionInfo       "0:35"
@


4.28
log
@  Slight change to NTP behaviour.
Detail:
  NetTime will accept NTP responses from servers which do not have
  primary sync until and after they gain it. It will not accept the
  response from a server whos stratum increases, for example when
  it loses primary sync.
Admin:
  Tested on Iyonix and works as desired without breaking existing
  behaviour.

Version 0.34. Tagged as 'NetTime-0_34'
@
text
@d1 1
a1 1
/* (0.34)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.34
d9 1
a9 1
#define Module_Date_CMHG                14 Oct 2004
d11 2
a12 2
#define Module_MajorVersion             "0.34"
#define Module_Version                  34
d14 1
a14 1
#define Module_Date                     "14 Oct 2004"
d16 1
a16 1
#define Module_ApplicationDate          "14-Oct-04"
d21 3
a23 3
#define Module_FullVersion              "0.34"
#define Module_HelpVersion              "0.34 (14 Oct 2004)"
#define Module_LibraryVersionInfo       "0:34"
@


4.27
log
@Negative timezone offsets received from DHCP were incorrectly rounded,
resulting in -5:45 being set instead of -6:00.

Version 0.33. Tagged as 'NetTime-0_33'
@
text
@d1 1
a1 1
/* (0.33)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.33
d9 1
a9 1
#define Module_Date_CMHG                14 Jun 2004
d11 2
a12 2
#define Module_MajorVersion             "0.33"
#define Module_Version                  33
d14 1
a14 1
#define Module_Date                     "14 Jun 2004"
d16 1
a16 1
#define Module_ApplicationDate          "14-Jun-04"
d21 3
a23 3
#define Module_FullVersion              "0.33"
#define Module_HelpVersion              "0.33 (14 Jun 2004)"
#define Module_LibraryVersionInfo       "0:33"
@


4.26
log
@* Added support for non-IOMD, HAL-based platforms.
* Improved *NetTime_PollInterval to make sure next poll happens at
  the expected time.
* On module init, no longer sets the time from the NVRAM if the current
  time seems sensible (ie >= 2003ish).
* Sets the time NVRAM on shutdown (was only on packet reception).

Version 0.32. Tagged as 'NetTime-0_32'
@
text
@d1 1
a1 1
/* (0.32)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.32
d9 1
a9 1
#define Module_Date_CMHG                19 May 2004
d11 2
a12 2
#define Module_MajorVersion             "0.32"
#define Module_Version                  32
d14 1
a14 1
#define Module_Date                     "19 May 2004"
d16 1
a16 1
#define Module_ApplicationDate          "19-May-04"
d21 3
a23 3
#define Module_FullVersion              "0.32"
#define Module_HelpVersion              "0.32 (19 May 2004)"
#define Module_LibraryVersionInfo       "0:32"
@


4.25
log
@  Fixed to build with the latest cc (5.54) compiler.
Detail:
  This version now builds with cc-5_45. Note: it has not been verified as
  actually functioning correctly.
Admin:
  Tested in DSL Baseline build.

Version 0.31. Tagged as 'NetTime-0_31'
@
text
@d1 1
a1 1
/* (0.31)
d4 1
a4 1
 * Last processed by srccommit version: 1.64.
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.31
d9 1
a9 1
#define Module_Date_CMHG                23 Jul 2002
d11 2
a12 2
#define Module_MajorVersion             "0.31"
#define Module_Version                  31
d14 1
a14 1
#define Module_Date                     "23 Jul 2002"
d16 1
a16 2
#define Module_ApplicationDate2         "23-Jul-02"
#define Module_ApplicationDate4         "23-Jul-2002"
d21 3
a23 3
#define Module_FullVersion              "0.31"
#define Module_HelpVersion              "0.31 (23 Jul 2002)"
#define Module_LibraryVersionInfo       "0:31"
@


4.24
log
@  * Fixed all of the !Mk... files.
  * Now builds with the latest TCPIPLibs.
Detail:
  * All of the !Mk... files are required to pass TARGET into the makefile.
  * The new TCPIPLibs use the standard types.h from RISC_OSLib if it is
    available. This defines u_int32 types using int rather than long, which
    TCPIPLibs uses. Thus, NetTime needed a little tweaking to adjust for
    this change.
Admin:
  Builds.
  Requires TCPIPLibs-5_42 or later.

Version 0.30. Tagged as 'NetTime-0_30'
@
text
@d1 1
a1 1
/* (0.30)
d4 1
a4 1
 * Last processed by srccommit version: 1.63.
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.30
d9 1
a9 1
#define Module_Date_CMHG                25 Apr 2002
d11 2
a12 2
#define Module_MajorVersion             "0.30"
#define Module_Version                  30
d14 1
a14 1
#define Module_Date                     "25 Apr 2002"
d16 2
a17 2
#define Module_ApplicationDate2         "25-Apr-02"
#define Module_ApplicationDate4         "25-Apr-2002"
d22 3
a24 3
#define Module_FullVersion              "0.30"
#define Module_HelpVersion              "0.30 (25 Apr 2002)"
#define Module_LibraryVersionInfo       "0:30"
@


4.23
log
@  Fixed CMHG header to contain correct SWI chunk information.
Detail:
  A non-existent header file was being included to define the SWI chunk
    information.  This is no longer done.
  Build tidied up a bit.
Admin:
  Built a ROM module and tested fake linking it.
  Built a RAM module (it'll fail due to lack of Messages file though)

Version 0.29. Tagged as 'NetTime-0_29'
@
text
@d1 1
a1 1
/* (0.29)
d4 1
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.29
d9 1
a9 1
#define Module_Date_CMHG                06 Oct 2000
d11 2
a12 2
#define Module_MajorVersion             "0.29"
#define Module_Version                  29
d14 1
a14 1
#define Module_Date                     "06 Oct 2000"
d16 2
a17 2
#define Module_ApplicationDate2         "06-Oct-00"
#define Module_ApplicationDate4         "06-Oct-2000"
d19 6
a24 2
#define Module_FullVersion              "0.29"
#define Module_HelpVersion              "0.29 (06 Oct 2000)"
@


4.22
log
@Added NetTime_Status SWI

Version 0.28. Tagged as 'NetTime-0_28'
@
text
@d1 1
a1 1
/* (0.28)
d6 1
a6 1
#define Module_MajorVersion_CMHG        0.28
d8 1
a8 1
#define Module_Date_CMHG                08 Sep 2000
d10 2
a11 2
#define Module_MajorVersion             "0.28"
#define Module_Version                  28
d13 1
a13 1
#define Module_Date                     "08 Sep 2000"
d15 2
a16 2
#define Module_ApplicationDate2         "08-Sep-00"
#define Module_ApplicationDate4         "08-Sep-2000"
d18 2
a19 1
#define Module_FullVersion              "0.28"
@


4.21
log
@	Now builds. Updated documentation.
Detail:
	Last checkin did not include the file adst.o in the makefile, meaning
that a routine was not being linked against.
	Updated the Functional Specification with the latest changes.
	c.module now uses the global countries header file to get Australia#s
territory number, rather than using the hard-coded value of 29.
Admin:
	Tested.

Version 0.26. Tagged as 'NetTime-0_26'
@
text
@d1 1
a1 1
/* (0.26)
d6 1
a6 1
#define Module_MajorVersion_CMHG        0.26
d8 1
a8 1
#define Module_Date_CMHG                06 Sep 2000
d10 2
a11 2
#define Module_MajorVersion             "0.26"
#define Module_Version                  26
d13 1
a13 1
#define Module_Date                     "06 Sep 2000"
d15 2
a16 2
#define Module_ApplicationDate2         "06-Sep-00"
#define Module_ApplicationDate4         "06-Sep-2000"
d18 1
a18 1
#define Module_FullVersion              "0.26"
@


4.20
log
@  Added Australian Rules DST.
Detail:
  * If NetTime$DST is set to Australian, instead of European, the
    Australian rules for daylight saving time are applied.
Admin:
  * Tested, and appears to work as expected.
  * Included documentation from Australian legislature detailing the
    changes for DST, and the special case for 2000. Not really required
    for projects at present, but useful to be correct nonetheless.

Version 0.25. Tagged as 'NetTime-0_25'
@
text
@d1 1
a1 1
/* (0.25)
d6 1
a6 1
#define Module_MajorVersion_CMHG        0.25
d8 1
a8 1
#define Module_Date_CMHG                01 Aug 2000
d10 2
a11 2
#define Module_MajorVersion             "0.25"
#define Module_Version                  25
d13 1
a13 1
#define Module_Date                     "01 Aug 2000"
d15 2
a16 2
#define Module_ApplicationDate2         "01-Aug-00"
#define Module_ApplicationDate4         "01-Aug-2000"
d18 1
a18 1
#define Module_FullVersion              "0.25"
@


4.19
log
@  Bug fix for time server off smartcard
Detail:
  Protocol auto determination when using a time server specified off
   a smart card was only being done if the time server on the
   smart card was a packed IP address.  If the time server was a
   string, auto determination wasn't being done.  Behaviour changed
   so that auto determination will be done for any smart card format.

Admin:
  Tested on Customer F5 softload.
  Fixes Pace 1618


Version 0.24. Tagged as 'NetTime-0_24'
@
text
@d1 1
a1 1
/* (0.24)
d6 1
a6 1
#define Module_MajorVersion_CMHG        0.24
d8 1
a8 1
#define Module_Date_CMHG                21 Jul 2000
d10 2
a11 2
#define Module_MajorVersion             "0.24"
#define Module_Version                  24
d13 1
a13 1
#define Module_Date                     "21 Jul 2000"
d15 2
a16 2
#define Module_ApplicationDate2         "21-Jul-00"
#define Module_ApplicationDate4         "21-Jul-2000"
d18 1
a18 1
#define Module_FullVersion              "0.24"
@


4.18
log
@A couple of warnings removed.
Now uses "low delay" type of service for outgoing datagrams.

Version 0.23. Tagged as 'NetTime-0_23'
@
text
@d1 1
a1 1
/* (0.23)
d6 1
a6 1
#define Module_MajorVersion_CMHG        0.23
d8 1
a8 1
#define Module_Date_CMHG                20 Mar 2000
d10 2
a11 2
#define Module_MajorVersion             "0.23"
#define Module_Version                  23
d13 1
a13 1
#define Module_Date                     "20 Mar 2000"
d15 4
a18 1
#define Module_FullVersion              "0.23"
@


4.17
log
@Precision of internal arithmetic and clock reading improved. Now possible
to maintain time to within a couple of milliseconds (given frequent enough
polling).

Version 0.22. Tagged as 'NetTime-0_22'
@
text
@d1 1
a1 1
/* (0.22)
d6 1
a6 1
#define Module_MajorVersion_CMHG        0.22
d8 1
a8 1
#define Module_Date_CMHG                16 Mar 2000
d10 2
a11 2
#define Module_MajorVersion             "0.22"
#define Module_Version                  22
d13 1
a13 1
#define Module_Date                     "16 Mar 2000"
d15 1
a15 1
#define Module_FullVersion              "0.22"
@


4.16
log
@Can now change the poll interval via a *Command.
If the time server came from NetTime$Server or NCMA, both NTP and Time/UDP
will be tried.
Maximum adjustment rate limited to +/-1%, rather than 10%.

Version 0.21. Tagged as 'NetTime-0_21'
@
text
@d1 1
a1 1
/* (0.21)
d6 1
a6 1
#define Module_MajorVersion_CMHG        0.21
d8 1
a8 1
#define Module_Date_CMHG                15 Mar 2000
d10 2
a11 2
#define Module_MajorVersion             "0.21"
#define Module_Version                  21
d13 1
a13 1
#define Module_Date                     "15 Mar 2000"
d15 1
a15 1
#define Module_FullVersion              "0.21"
@


4.15
log
@  Added support for NTP, gradual time adjustment, configurable DST,
  and DHCP timezone.

Detail:
  If Inet$NTPServer is set, NetTime will use NTP (unicast SNTP, as per RFC2030).
  Otherwise it will use the UDP time protocol (it used to use TCP).

  NetTime will use the RTCAdjust algorithms to adjust the centisecond clock
  rate by +/-10% to get in step with the time server. By polling every 30
  minutes on a LAN, time will not deviate by more than 0.1 seconds once
  synchronised. It interoperates with RTCAdjust and the hardware RTC to ensure
  correct operation on a machine with RTC.

  NetTime has returned to polling every 30 minutes. This may defeat PPP
  timeouts - a suggested fix is to change PPP to only have TCP traffic keep the
  link up, or to have a separate user inactivity timeout (like Lazarus).

  The system variable NetTime$DST controls DST behaviour. Set to "European"
  (the default) to use European rules. Set it to something like
  "03-May-2000.01:00:00; 14-Sep-2000.01:00:00" to specify this year's start
  and end dates (in UTC). Set to "No" to make it leave DST alone.

  If a DHCP reply arrives while NetTime is loaded, it will check for the time
  offset option - if present, the timezone will be configured.

  New command *NetTime_Status gives information about the clock adjustments.

  NetTime attempts to start operation immediately on a non-dialup machine -
  removes the need for a *NetTime_Kick after softloading. *NetTime_Kick will
  still be required after, say, setting Inet$NTPServer manually.

Admin:
  Tested on desktop systems and STBs. NTP operation on an NC will require a
  way of finding out an NTP server - possibly redefining TIME_SERVER smartcard
  tag to be NTP? Anycast operation may also be worth adding.

Version 0.20. Tagged as 'NetTime-0_20'
@
text
@d1 1
a1 1
/* (0.20)
d6 1
a6 1
#define Module_MajorVersion_CMHG        0.20
d8 1
a8 1
#define Module_Date_CMHG                07 Mar 2000
d10 2
a11 2
#define Module_MajorVersion             "0.20"
#define Module_Version                  20
d13 1
a13 1
#define Module_Date                     "07 Mar 2000"
d15 1
a15 1
#define Module_FullVersion              "0.20"
@


4.14
log
@ 	NetTime now looks at the Inet$TimeServer system variable before
looking at the NetTime$Server variable or the smartcard.
 	This fixes a bug where the server was not getting set if there was
not a time server on the smartcard (or it was present but was not a valid
DNS) as the Inet$TimeServer was not being looked at.

Detail:
 	When attempting to locate a server to gain the time from, it now does
it on the following order:
 	* Checks the Inet$TimeServer system variable first;
 	* If not present, checks the NetTime$Server system variable;
 	* If not present, finally attmepts to get the server off the
smartcard.

Admin:
 	Tested as a softload on an ethernet Customer M box.

Version 0.16. Tagged as 'NetTime-0_16'
@
text
@d1 1
a1 1
/* (0.16)
d6 3
a8 3
#define Module_MajorVersion_CMHG     	0.16
#define Module_MinorVersion_CMHG	
#define Module_Date_CMHG      		05 Jul 1999
d10 4
a13 4
#define Module_MajorVersion     	"0.16"
#define Module_Version                  16
#define Module_MinorVersion		""
#define Module_Date      		"05 Jul 1999"
d15 1
a15 1
#define Module_FullVersion              "0.16"
@


4.13
log
@Minor tweaks that I was going to make anyway before Kevin beat me
to the check-in...

	* Added StripDepnd support to makefile

	* Date-stamped the CMHG header file to ensure that the new
	  version of the module contains the correct date in the version
	  string

Version 0.15. Tagged as 'NetTime-0_15'
@
text
@d1 1
a1 1
/* (0.15)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	0.15
d8 1
a8 1
#define Module_Date_CMHG      		09 Jun 1999
d10 2
a11 2
#define Module_MajorVersion     	"0.15"
#define Module_Version                  15
d13 1
a13 1
#define Module_Date      		"09 Jun 1999"
d15 1
a15 1
#define Module_FullVersion              "0.15"
@


4.12
log
@Prevented from doing half-hour time changes, unless PERIODICAL_TIME_CHECKS
is defined. If you must keep adjusting the time, it would be a good idea
to make sure it changes gradually, like RTCAdjust does it. These checks were
preventing PPP from timing out.

Version 0.14. Tagged as 'NetTime-0_14'
@
text
@d1 1
a1 1
/* (0.14)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	0.14
d10 2
a11 2
#define Module_MajorVersion     	"0.14"
#define Module_Version                  14
d15 1
a15 1
#define Module_FullVersion              "0.14"
@


4.11
log
@Added a header file, debug.h, that is used to redefine some debuglib macros
if a non-debug build is being built. This is to allow the module to be built
on machines where debuglib is not present.

Validated by building both the old (v0.12) and new versions and ensuring that
the non-debug versions were identical. Also checked that the debug version
still built.

Version 0.13. Tagged as 'NetTime-0_13'
@
text
@d1 1
a1 1
/* (0.13)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	0.13
d8 1
a8 1
#define Module_Date_CMHG      		08 Apr 1999
d10 2
a11 2
#define Module_MajorVersion     	"0.13"
#define Module_Version                  13
d13 1
a13 1
#define Module_Date      		"08 Apr 1999"
d15 1
a15 1
#define Module_FullVersion              "0.13"
@


4.10
log
@Check for errors from the NVRAM call, and don't set the time if it fails.

Version 0.12. Tagged as 'NetTime-0_12'
@
text
@d1 1
a1 1
/* (0.12)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	0.12
d8 1
a8 1
#define Module_Date_CMHG      		04 Mar 1999
d10 2
a11 2
#define Module_MajorVersion     	"0.12"
#define Module_Version                  12
d13 1
a13 1
#define Module_Date      		"04 Mar 1999"
d15 1
@


4.9
log
@Automatically switch into and out of Daylight Savings for Europe in
1998-2001, if EUROPEAN_DST_BODGE is defined.

Version 0.11. Tagged as 'NetTime-0_11'
@
text
@d1 1
a1 1
/* (0.11)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	0.11
d8 1
a8 1
#define Module_Date_CMHG      		13 Jan 1999
d10 2
a11 2
#define Module_MajorVersion     	"0.11"
#define Module_Version                  11
d13 1
a13 1
#define Module_Date      		"13 Jan 1999"
@


4.8
log
@If STB22 is defined, no attempts to use NVRAM are made. !MkSTB22
builds such a variant.

Version 0.10. Tagged as 'NetTime-0_10'
@
text
@d1 1
a1 1
/* (0.10)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	0.10
d8 1
a8 1
#define Module_Date_CMHG      		14 Dec 1998
d10 2
a11 2
#define Module_MajorVersion     	"0.10"
#define Module_Version                  10
d13 1
a13 1
#define Module_Date      		"14 Dec 1998"
@


4.7
log
@Make DNS lookup non-blocking:
  New state (DNSWait) and internal transition (DoDNS) added.
  Machine now support internal transitions, and DoDNS is injected by
  transitions that previously called tryconnect() to start lookup.
  State DNSWait polls resolver every second while it returns EINPROGRESS.
  Resolver interface (dns.c) taken from Acorn FTP fetcher.

Version 0.09. Tagged as 'NetTime-0_09'
@
text
@d1 1
a1 1
/* (0.09)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	0.09
d8 1
a8 1
#define Module_Date_CMHG      		01 Dec 1998
d10 2
a11 2
#define Module_MajorVersion     	"0.09"
#define Module_Version                  9
d13 1
a13 1
#define Module_Date      		"01 Dec 1998"
@


4.6
log
@Fixed typo in my enthusiastic code clean-up.

Version 0.08. Tagged as 'NetTime-0_08'
@
text
@d1 1
a1 1
/* (0.08)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	0.08
d8 1
a8 1
#define Module_Date_CMHG      		24 Nov 1998
d10 2
a11 2
#define Module_MajorVersion     	"0.08"
#define Module_Version                  8
d13 1
a13 1
#define Module_Date      		"24 Nov 1998"
@


4.5
log
@Convert to using DebugLib for debug output.

Version 0.07. Tagged as 'NetTime-0_07'
@
text
@d1 1
a1 1
/* (0.07)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	0.07
d10 2
a11 2
#define Module_MajorVersion     	"0.07"
#define Module_Version                  7
@


4.4
log
@Changed to use Link 5.08. Internationalised help.

Version 0.06. Tagged as 'NetTime-0_06'
@
text
@d1 1
a1 1
/* (0.06)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	0.06
d10 2
a11 2
#define Module_MajorVersion     	"0.06"
#define Module_Version                  6
@


4.3
log
@Code clean-up.

Version 0.05. Tagged as 'NetTime-0_05'
@
text
@d1 1
a1 1
/* (0.05)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	0.05
d10 2
a11 2
#define Module_MajorVersion     	"0.05"
#define Module_Version                  5
@


4.2
log
@Moved module to trunk and srccommitted. No code changes other
than removing some warnings.

Version 0.04. Tagged as 'NetTime-0_04'
@
text
@d1 1
a1 1
/* (0.04)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	0.04
d8 1
a8 1
#define Module_Date_CMHG      		23 Nov 1998
d10 2
a11 2
#define Module_MajorVersion     	"0.04"
#define Module_Version                  4
d13 1
a13 1
#define Module_Date      		"23 Nov 1998"
@


4.1
log
@created by srccommit.
@
text
@d1 1
a1 1
/* (0.03)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	0.03
d10 2
a11 2
#define Module_MajorVersion     	"0.03"
#define Module_Version                  3
@
