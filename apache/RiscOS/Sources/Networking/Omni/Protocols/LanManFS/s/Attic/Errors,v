head	1.6;
access;
symbols
	LanManFS-2_39:1.5
	LanManFS-2_38:1.5
	LanManFS-2_37:1.5
	LanManFS-2_36:1.5
	LanManFS-2_35:1.5
	LanManFS-2_34:1.5
	LanManFS-2_33:1.5
	LanManFS-2_32:1.4
	LanManFS-2_31:1.4
	RO_5_07:1.4
	LanManFS-2_30:1.4
	LanManFS-2_29:1.4
	LanManFS-2_28:1.4
	LanManFS-2_27:1.4
	LanManFS-2_26:1.4
	LanManFS-2_25:1.4
	LanManFS-2_24:1.3
	LanManFS-2_23:1.3
	LanManFS-2_22:1.3
	LanManFS-2_21:1.3
	LanManFS-2_20:1.3
	LanManFS-2_19:1.3
	LanManFS-2_18:1.3
	LanManFS-2_17:1.3
	LanManFS-2_16:1.3
	LanManFS-2_15:1.3
	LanManFS-2_14:1.3
	LanManFS-2_13:1.3
	LanManFS-2_12:1.3
	LanManFS-2_11:1.3
	LanManFS-2_10:1.3
	LanManFS-2_09:1.3
	kbracey_32bit:1.3.0.2
	LanManFS-2_08:1.3
	LanManFS-2_07:1.3
	LanManFS-2_06:1.3
	LanManFS-2_05:1.3
	LanManFS-2_04:1.2
	LanManFS-2_03:1.1.1.1
	LanManFS-2_02:1.1.1.1
	LanManFS-2_01:1.1.1.1
	LanManFS-2_00:1.1.1.1
	LanManFS-1_87-1_1_1_1_2_13:1.1.1.1
	LanManFS-1_87-1_1_1_1_2_12:1.1.1.1
	LanManFS-1_87-1_1_1_1_2_11:1.1.1.1
	LanManFS-1_87-1_1_1_1_2_10:1.1.1.1
	LanManFS-1_87-1_1_1_1_2_9:1.1.1.1
	LanManFS-1_87-1_1_1_1_2_8:1.1.1.1
	LanManFS-1_87-1_1_1_1_2_7:1.1.1.1
	LanManFS-1_87-1_1_1_1_2_6:1.1.1.1
	LanManFS-1_87-1_1_1_1_2_5:1.1.1.1
	LanManFS-1_87-1_1_1_1_2_4:1.1.1.1
	LanManFS-1_87-1_1_1_1_2_3:1.1.1.1
	LanManFS-1_87-1_1_1_1_2_2:1.1.1.1
	LanManFS-1_87-1_1_1_1_2_1:1.1.1.1
	sbrodie_LanManFS_dev:1.1.1.1.0.2
	sbrodie_LanManFS_dev_bp:1.1.1.1
	LanManFS-1_87:1.1.1.1
	initial:1.1.1.1
	TRUNK:1.1.1;
locks; strict;
comment	@# @;


1.6
date	2013.10.03.07.27.15;	author rsprowson;	state dead;
branches;
next	1.5;
commitid	iTaBDwF1woaPMO7x;

1.5
date	2009.07.19.22.25.13;	author rsprowson;	state Exp;
branches;
next	1.4;

1.4
date	2003.01.16.18.14.19;	author rsprowson;	state Exp;
branches;
next	1.3;

1.3
date	99.03.16.14.49.52;	author sbrodie;	state Exp;
branches;
next	1.2;

1.2
date	99.03.09.15.07.42;	author sbrodie;	state Exp;
branches;
next	1.1;

1.1
date	98.12.03.13.54.48;	author sbrodie;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	98.12.03.13.54.48;	author sbrodie;	state Exp;
branches;
next	;


desc
@@


1.6
log
@Internationalised
Unused LMFiler put in the attic.
As LanMan has historically put its resources into ThirdPart/OmniClient this component has no ROM resources phase - it still registers the resources at run time.

Version 2.40. Tagged as 'LanManFS-2_40'
@
text
@; Copyright 1998 Acorn Computers Ltd
;
; Licensed under the Apache License, Version 2.0 (the "License");
; you may not use this file except in compliance with the License.
; You may obtain a copy of the License at
;
;     http://www.apache.org/licenses/LICENSE-2.0
;
; Unless required by applicable law or agreed to in writing, software
; distributed under the License is distributed on an "AS IS" BASIS,
; WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
; See the License for the specific language governing permissions and
; limitations under the License.
;
;
; S.ERRORS - Lan Manager client errors file.
; Keep in step with H.Stdtypes

        AREA   |C$$data|

        EXPORT Err_XltTable

Err_Base     EQU    &16600   ; Errors from filing system #66

Err_XltTable DCD Err0
             DCD Err1
             DCD Err2
             DCD Err3
             DCD Err4
             DCD Err5
             DCD Err6
             DCD Err7
             DCD Err8
             DCD Err9
             DCD Err10
             DCD Err11
             DCD Err12
             DCD Err13
             DCD Err14
             DCD Err15
             DCD Err16
             DCD Err17
             DCD Err18
             DCD Err19
             DCD Err20
             DCD Err21
             DCD Err22
             DCD Err23
             DCD Err24
             DCD Err25
             DCD Err26
             DCD Err27
             DCD Err28
             DCD Err29
             DCD Err30
             DCD Err31
             DCD Err32
             DCD Err33
             DCD Err34
             DCD Err35
             DCD Err36
             DCD Err37
             DCD Err38
             DCD Err39
             DCD Err40
             DCD Err41
             DCD Err42
             DCD Err43
             DCD Err44
             DCD Err45
             DCD Err46
             DCD Err47
             DCD Err48
             DCD Err49
             DCD Err50
             DCD Err51
             DCD Err52
             DCD Err53
             DCD Err54
             DCD Err55
             DCD Err56
             DCD Err57
             DCD Err58
             DCD Err59
             DCD Err60
             DCD Err61
             DCD Err62


        ALIGN
Err0    DCD Err_Base+0
        DCB "LanManFS internal error", 0
        
        ALIGN
Err1    DCD Err_Base+1
        DCB "Bad parameters", 0
        
        ALIGN
Err2    DCD Err_Base+2
        DCB "No connection to server", 0
        
        ALIGN
Err3    DCD Err_Base+3
        DCB "Out of buffers", 0

        ALIGN
Err4    DCD Err_Base+4
        DCB "Connection to server failed", 0
        
        ALIGN
Err5    DCD Err_Base+5
        DCB "Out of handles", 0
        
        ALIGN
Err6    DCD Err_Base+6
        DCB "Receive not ready", 0
        
        ALIGN
Err7    DCD Err_Base+7
        DCB "Connection already exists", 0
        
        ALIGN
Err8    DCD Err_Base+8
        DCB "Timeout error", 0
        
        ALIGN
Err9    DCD Err_Base+9
        DCB "This workstation name already exists", 0
        
        ALIGN
Err10   DCD Err_Base+10
        DCB "Cannot find given server", 0
        
        ALIGN
Err11   DCD Err_Base+11
        DCB "Data length error", 0
        
        ALIGN            ; ERRSRV error
Err12   DCD Err_Base+12
        DCB "Error from server", 0
        
        ALIGN            ; ERRDOS error
Err13   DCD Err_Base+13
        DCB "Unable to perform operation", 0
        
        ALIGN
Err14   DCD Err_Base+14
        DCB "Hardware error on server", 0
        
        ALIGN
Err15   DCD Err_Base+15
        DCB "Network protocol error", 0
        
        ALIGN
Err16   DCD Err_Base+16
        DCB "No more files", 0
        
        ALIGN
Err17   DCD Err_Base+17
        DCB "File not found", 0
        
        ALIGN
Err18   DCD Err_Base+18
        DCB "Directory not found", 0
        
        ALIGN
Err19   DCD Err_Base+19
        DCB "Server out of file handles", 0
        
; 28/Jan/97 NAS horrible fudge because some LanMan servers don't return a specific
; "directory not empty" code, but use this instead, and Filer_Action checks on
; exact error return code. [Fault NET-01359]
        
        ALIGN
Err20   DCD Err_Base+&B4
        DCB "Access denied", 0
        
        ALIGN
Err21   DCD Err_Base+21
        DCB "File already exists", 0
        
        ALIGN
Err22   DCD Err_Base+22
        DCB "Incorrect password", 0
        
        ALIGN
Err23   DCD Err_Base+23
        DCB "Illegal name", 0
        
        ALIGN
Err24   DCD Err_Base+24
        DCB "No such connection", 0
        
        ALIGN
Err25   DCD Err_Base+25
        DCB "RISCOS 2 directory functions not supported", 0
        
        ALIGN
Err26   DCD Err_Base+26
        DCB "OS_GBPB not supported", 0
        
        ALIGN
Err27   DCD Err_Base+27
        DCB "Unbuffered file functions not supported", 0
        
        ALIGN
Err28   DCD Err_Base+28
        DCB "LanManFS has not been loaded", 0
        
        ALIGN
Err29   DCD Err_Base+29
        DCB "Function not implemented", 0
        
        ALIGN
Err30   DCD Err_Base+30
        DCB "Wildcards not allowed", 0
        
        ALIGN
Err31   DCD Err_Base+31
        DCB "File attributes could not be read", 0
        
        ALIGN
Err32   DCD Err_Base+32
        DCB "File attributes could not be written", 0
        
        ALIGN
Err33   DCD Err_Base+33
        DCB "File sharing violation", 0
        
        ALIGN
Err34   DCD Err_Base+34
        DCB "Connection limit has been reached", 0
        
        ALIGN
Err35   DCD Err_Base+35
        DCB "Share name does not exist", 0
        
        ALIGN
Err36   DCD Err_Base+36
        DCB "Bad LanManFS command line", 0
        
        ALIGN
Err37   DCD Err_Base+37
        DCB "LanManFS requires RISC OS 3.00 or later", 0
        
        ALIGN
Err38   DCD Err_Base+38
        DCB "Initialisation failed", 0
        
        ALIGN
Err39   DCD Err_Base+39
        DCB "Network driver not found", 0
        
        ALIGN
Err40   DCD Err_Base+40
        DCB "Network interface is of incorrect type", 0
        
        ALIGN
Err41   DCD Err_Base+41
        DCB "Network driver is not DCI-4 compatible", 0
        
        ALIGN
Err42   DCD Err_Base+42
        DCB "Already connected to this drive on this server", 0
        
        ALIGN
Err43   DCD Err_Base+43
        DCB "IEEE802.3 frames are already being used by another protocol", 0
        
        ALIGN
Err44   DCD Err_Base+44
        DCB "Buffer manager module is not installed", 0
        
        ALIGN
Err45   DCD Err_Base+45
        DCB "RPC call returned error", 0
        
        ALIGN
Err46   DCD Err_Base+46
        DCB "Disc full", 0
        
; Err47 moved to ErrB4 28/Jan/97 NAS because Filer_Action checks on
; exact error return code. [Fault NET-01359]
        
        ALIGN
Err47   DCD Err_Base+&B4
        DCB "Directory not empty", 0
        
        ALIGN
Err48   DCD Err_Base+48
        DCB "Can't rename across shares", 0
        
        ALIGN
Err49   DCD Err_Base+49
        DCB "Bad file handle", 0
        
        ALIGN
Err50   DCD Err_Base+50
        DCB "Cannot create TCP/IP socket", 0
        
        ALIGN
Err51   DCD Err_Base+51
        DCB "Cannot make TCP/IP connection", 0
        
        ALIGN
Err52   DCD Err_Base+52
        DCB "Connection rejected by server", 0
        
        ALIGN
Err53   DCD Err_Base+53
        DCB "Too many re-target requests", 0
        
        ALIGN
Err54   DCD Err_Base+54
        DCB "Unable to determine this machine's IP address", 0
        
        ALIGN
Err55   DCD Err_Base+55
        DCB "Internet module is not present or not working", 0
        
        ALIGN
Err56   DCD Err_Base+56
        DCB "!ArmBoot files are nested too deep", 0
        
        ALIGN
Err57   DCD Err_Base+57
        DCB "Error while running !ArmBoot file", 0
        
        ALIGN
Err58   DCD Err_Base+58
        DCB "Home directory name not valid", 0
        
        ALIGN
Err59   DCD Err_Base+59
        DCB "Could not connect to home directory", 0
        
        ALIGN
Err60   DCD Err_Base+60
        DCB "User name not recognised", 0
        
        ALIGN
Err61   DCD Err_Base+61
        DCB "User account has been disabled", 0
        
        ALIGN
Err62   DCD Err_Base+62
        DCB "LanManFS in use", 0

        END
@


1.5
log
@Workaround for NTFS returning resume keys of zero.
Detail:
  When the underlying FS is NTFS, eg. WinXP Pro, the requested
  resume keys for a directory search are always zero - this is passed
  back via OSGBPB and on the next call it triggers a new search. So
  we get stuck in an infinite loop.
  Now checks for a resume key stuck at zero, and makes a fake one static
  to the search context then sets the continuation bit in the SMB_FIND_NEXT
  call because the server returning the duff key remembers the position.
  Dir_CallbackFn could return with "taken" undefined. Move a few lines
  higher.
  Missing "#else" added to CHECK_ARMBOOT_EXISTS so if this is disabled
  no further attempt is made to find !ArmBoot.
  Couple of typos corrected.
  Spelling of "disk" changed to "disc" in an error message.
Admin:
  Tested with XP Pro SP3 with NTFS, directories which previously hung
  the filer now open correctly. Checked with XP Home SP3 with FAT32 to
  verify behaviour unchanged from 2.32.
  Note, with large directories the initial path translation triggers a
  dir search too which takes ages compared with the actual number of
  entries returned. This could be cached to make counting far faster.

Version 2.33. Tagged as 'LanManFS-2_33'
@
text
@@


1.4
log
@Directory rename fixed - the mask being passed by the rename routine didn't
have the ATTR_DIR bit set.Discovered this after reading lots of the spec
which is also now included here in /doc.
Copying files out of LanManFS filer "forgot" their filetype even though
they appeared right in the filer,fixed.
A stray debugging printf removed,along with one compiler warning.
New sprites (yuck) to match !Omni.
Reordered the shutdown in two places,first Omni_Shutdown bins the mounts
lists which SMB_Shutdown uses.Second in NetBEUI mode the announcement that
a protocol has terminated goes *after* the shutdown - otherwise you sit
around for about 20s wondering where the link has gone.

Version 2.25. Tagged as 'LanManFS-2_25'
@
text
@d19 1
a19 1
        AREA    |C$$data|
d23 1
a23 1
Err_Base     EQU   &16600   ; Errors from filing system #66
d90 80
a169 80
       ALIGN
Err0   DCD Err_Base+0
       DCB "LanManFS internal error", 0

       ALIGN
Err1   DCD Err_Base+1
       DCB "Bad parameters", 0

       ALIGN
Err2   DCD Err_Base+2
       DCB "No connection to server", 0

       ALIGN
Err3   DCD Err_Base+3
       DCB "Out of buffers", 0

       ALIGN
Err4   DCD Err_Base+4
       DCB "Connection to server failed", 0

       ALIGN
Err5   DCD Err_Base+5
       DCB "Out of handles", 0

       ALIGN
Err6   DCD Err_Base+6
       DCB "Receive not ready", 0

       ALIGN
Err7   DCD Err_Base+7
       DCB "Connection already exists", 0

       ALIGN
Err8   DCD Err_Base+8
       DCB "Timeout error", 0

       ALIGN
Err9   DCD Err_Base+9
       DCB "This workstation name already exists", 0

       ALIGN
Err10  DCD Err_Base+10
       DCB "Cannot find given server", 0

       ALIGN
Err11  DCD Err_Base+11
       DCB "Data length error", 0

       ALIGN            ; ERRSRV error
Err12  DCD Err_Base+12
       DCB "Error from server", 0

       ALIGN            ; ERRDOS error
Err13  DCD Err_Base+13
       DCB "Unable to perform operation", 0

       ALIGN
Err14  DCD Err_Base+14
       DCB "Hardware error on server", 0

       ALIGN
Err15  DCD Err_Base+15
       DCB "Network protocol error", 0

       ALIGN
Err16  DCD Err_Base+16
       DCB "No more files", 0

       ALIGN
Err17  DCD Err_Base+17
       DCB "File not found", 0

       ALIGN
Err18  DCD Err_Base+18
       DCB "Directory not found", 0

       ALIGN
Err19  DCD Err_Base+19
       DCB "Server out of file handles", 0

d173 109
a281 109

       ALIGN
Err20  DCD Err_Base+&B4
       DCB "Access denied", 0

       ALIGN
Err21  DCD Err_Base+21
       DCB "File already exists", 0

       ALIGN
Err22  DCD Err_Base+22
       DCB "Incorrect password", 0

       ALIGN
Err23  DCD Err_Base+23
       DCB "Illegal name", 0

       ALIGN
Err24  DCD Err_Base+24
       DCB "No such connection", 0

       ALIGN
Err25  DCD Err_Base+25
       DCB "RISCOS 2 directory functions not supported", 0

       ALIGN
Err26  DCD Err_Base+26
       DCB "OS_GBPB not supported", 0

       ALIGN
Err27  DCD Err_Base+27
       DCB "Unbuffered file functions not supported", 0

       ALIGN
Err28  DCD Err_Base+28
       DCB "LanManFS has not been loaded", 0

       ALIGN
Err29  DCD Err_Base+29
       DCB "Function not implemented", 0

       ALIGN
Err30  DCD Err_Base+30
       DCB "Wildcards not allowed", 0

       ALIGN
Err31  DCD Err_Base+31
       DCB "File attributes could not be read", 0

       ALIGN
Err32  DCD Err_Base+32
       DCB "File attributes could not be written", 0

       ALIGN
Err33  DCD Err_Base+33
       DCB "File sharing violation", 0

       ALIGN
Err34  DCD Err_Base+34
       DCB "Connection limit has been reached", 0

       ALIGN
Err35  DCD Err_Base+35
       DCB "Share name does not exist", 0

       ALIGN
Err36  DCD Err_Base+36
       DCB "Bad LanManFS command line", 0

       ALIGN
Err37  DCD Err_Base+37
       DCB "LanManFS requires RISC OS 3.00 or later", 0

       ALIGN
Err38  DCD Err_Base+38
       DCB "Initialisation failed", 0

       ALIGN
Err39  DCD Err_Base+39
       DCB "Network driver not found", 0

       ALIGN
Err40  DCD Err_Base+40
       DCB "Network interface is of incorrect type", 0

       ALIGN
Err41  DCD Err_Base+41
       DCB "Network driver is not DCI-4 compatible", 0

       ALIGN
Err42  DCD Err_Base+42
       DCB "Already connected to this drive on this server", 0

       ALIGN
Err43  DCD Err_Base+43
       DCB "IEEE802.3 frames are already being used by another protocol", 0

       ALIGN
Err44  DCD Err_Base+44
       DCB "Buffer manager module is not installed", 0

       ALIGN
Err45  DCD Err_Base+45
       DCB "RPC call returned error", 0

       ALIGN
Err46  DCD Err_Base+46
       DCB "Disk full", 0

d284 64
d349 1
a349 65
       ALIGN
Err47  DCD Err_Base+&B4
       DCB "Directory not empty", 0

       ALIGN
Err48  DCD Err_Base+48
       DCB "Can't rename across shares", 0

       ALIGN
Err49  DCD Err_Base+49
       DCB "Bad file handle", 0

       ALIGN
Err50  DCD Err_Base+50
       DCB "Cannot create TCP/IP socket", 0

       ALIGN
Err51  DCD Err_Base+51
       DCB "Cannot make TCP/IP connection", 0

       ALIGN
Err52  DCD Err_Base+52
       DCB "Connection rejected by server", 0

       ALIGN
Err53  DCD Err_Base+53
       DCB "Too many re-target requests", 0

       ALIGN
Err54  DCD Err_Base+54
       DCB "Unable to determine this machine's IP address", 0

       ALIGN
Err55  DCD Err_Base+55
       DCB "Internet module is not present or not working", 0

       ALIGN
Err56  DCD Err_Base+56
       DCB "!ArmBoot files are nested too deep", 0

       ALIGN
Err57  DCD Err_Base+57
       DCB "Error while running !ArmBoot file", 0
       ALIGN
Err58  DCD Err_Base+58
       DCB "Home directory name not valid", 0
       ALIGN
Err59  DCD Err_Base+59
       DCB "Could not connect to home directory", 0
       ALIGN
Err60  DCD Err_Base+60
       DCB "User name not recognised", 0
       ALIGN
Err61  DCD Err_Base+61
       DCB "User account has been disabled", 0
       ALIGN
Err62  DCD Err_Base+62
       DCB "LanManFS in use", 0
       ALIGN

     END




@


1.3
log
@  No longer assumes that it should attach itself to eh0 if it cannot
    find a driver.
Detail:
  The module used to have specific knowledge of the driver to which it
    was supposed to bind if it was unable to find any active drivers at
    the time that LanManFS was initialised.  This meant that if the
    LanManFS module was placed in ROM (eg. in STB3) and the drivers
    hadn't initialised by the time that LanManFS was initialised, it
    would sit and wait for EtherH to arrive - which doesn't happen
    for ATM solutions, and doesn't happen for Ethernet in STB3 because
    we no longer use EtherH!
Admin:
  Tested in STB22 expansion cards, and in STB3 ROM builds for both
    Ethernet and ATM solutions.

Version 2.05. Tagged as 'LanManFS-2_05'
@
text
@d176 1
a176 1
       DCB "Access not allowed", 0
@


1.2
log
@  Changed idle-out strategy.
  Introduced new error message for re-entrancy prevention trap to use.
Detail:
  When 'pinging' an SMB server, LanManFS does not wait for any response
    but the response reading routine knows to just throw away any old
    SMBchkpth responses that it gets and try reading again.
  Re-entrancy trap now has its own error "LanManFS in use" &1663E, which
    means you no longer see "!Armboot files nested too deeply" which is
    confusing.  The only way you can provoke this message is if you use
    Alt-Break whilst the NetBIOS/IP code is executing.  The error plays
    the same part as "FileCore in use" does for FileCore.
Admin:
  Verified module still works and the anti idle-out features still work.

Version 2.04. Tagged as 'LanManFS-2_04'
@
text
@d340 1
d343 1
a343 1

@


1.1
log
@Initial revision
@
text
@d87 1
d170 1
a170 1
; 28/Jan/97 NAS horrible fudge because some LanMan servers don't return a specific 
d340 2
@


1.1.1.1
log
@
LanManFS moved into Omni subdirectory.  Previous version in
RiscOS/Sources/Networking/LanManFS is now locked out.

The rest of Omni will be imported at a later date.

Version 1.87, tagged as LanManFS-1_87

@
text
@@
