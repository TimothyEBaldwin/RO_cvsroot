head	1.8;
access;
symbols
	LanManFS-2_62:1.8
	LanManFS-2_61:1.8
	LanManFS-2_60:1.8
	LanManFS-2_59:1.8
	LanManFS-2_58:1.8
	LanManFS-2_57:1.8
	LanManFS-2_56:1.8
	LanManFS-2_55:1.8
	LanManFS-2_54:1.8
	LanManFS-2_53:1.8
	LanManFS-2_52:1.8
	LanManFS-2_51:1.8
	LanManFS-2_50:1.8
	LanManFS-2_49:1.8
	LanManFS-2_48:1.8
	LanManFS-2_47:1.8
	LanManFS-2_46:1.8
	LanManFS-2_45:1.8
	LanManFS-2_44:1.8
	LanManFS-2_43:1.8
	LanManFS-2_42:1.8
	LanManFS-2_41:1.8
	LanManFS-2_40:1.8
	LanManFS-2_39:1.7
	LanManFS-2_38:1.7
	LanManFS-2_37:1.7
	LanManFS-2_36:1.7
	LanManFS-2_35:1.7
	LanManFS-2_34:1.7
	LanManFS-2_33:1.7
	LanManFS-2_32:1.7
	LanManFS-2_31:1.6
	RO_5_07:1.6
	LanManFS-2_30:1.6
	LanManFS-2_29:1.6
	LanManFS-2_28:1.6
	LanManFS-2_27:1.6
	LanManFS-2_26:1.6
	LanManFS-2_25:1.6
	LanManFS-2_24:1.5
	LanManFS-2_23:1.5
	LanManFS-2_22:1.4
	LanManFS-2_21:1.4
	LanManFS-2_20:1.4
	LanManFS-2_19:1.4
	LanManFS-2_18:1.4
	LanManFS-2_17:1.4
	LanManFS-2_16:1.4
	LanManFS-2_15:1.4
	LanManFS-2_14:1.4
	LanManFS-2_13:1.3
	LanManFS-2_12:1.3
	LanManFS-2_11:1.3
	LanManFS-2_10:1.3
	LanManFS-2_09:1.3
	LanManFS-2_08:1.3
	LanManFS-2_07:1.3
	LanManFS-2_06:1.3
	LanManFS-2_05:1.3
	LanManFS-2_04:1.3
	LanManFS-2_03:1.3
	LanManFS-2_02:1.2
	LanManFS-2_01:1.2
	LanManFS-2_00:1.2
	LanManFS-1_87-1_1_1_1_2_13:1.1.1.1.2.4
	LanManFS-1_87-1_1_1_1_2_12:1.1.1.1.2.4
	LanManFS-1_87-1_1_1_1_2_11:1.1.1.1.2.3
	LanManFS-1_87-1_1_1_1_2_10:1.1.1.1.2.2
	LanManFS-1_87-1_1_1_1_2_9:1.1.1.1.2.2
	LanManFS-1_87-1_1_1_1_2_8:1.1.1.1.2.1
	LanManFS-1_87-1_1_1_1_2_7:1.1.1.1.2.1
	LanManFS-1_87-1_1_1_1_2_6:1.1.1.1
	LanManFS-1_87-1_1_1_1_2_5:1.1.1.1
	LanManFS-1_87-1_1_1_1_2_4:1.1.1.1
	LanManFS-1_87-1_1_1_1_2_3:1.1.1.1
	LanManFS-1_87-1_1_1_1_2_2:1.1.1.1
	LanManFS-1_87-1_1_1_1_2_1:1.1.1.1
	sbrodie_LanManFS_dev:1.1.1.1.0.2
	sbrodie_LanManFS_dev_bp:1.1.1.1
	LanManFS-1_87:1.1.1.1
	initial:1.1.1.1
	TRUNK:1.1.1;
locks; strict;
comment	@# @;


1.8
date	2013.10.03.07.27.11;	author rsprowson;	state Exp;
branches;
next	1.7;
commitid	iTaBDwF1woaPMO7x;

1.7
date	2009.04.15.16.00.08;	author bavison;	state Exp;
branches;
next	1.6;
commitid	GhZBwZ2GN8lg58Kt;

1.6
date	2003.01.16.18.14.17;	author rsprowson;	state Exp;
branches;
next	1.5;

1.5
date	2002.12.14.13.51.17;	author rsprowson;	state Exp;
branches;
next	1.4;

1.4
date	2000.08.11.15.55.01;	author sbrodie;	state Exp;
branches;
next	1.3;

1.3
date	99.03.01.16.58.29;	author sbrodie;	state Exp;
branches;
next	1.2;

1.2
date	99.02.16.12.52.20;	author sbrodie;	state Exp;
branches;
next	1.1;

1.1
date	98.12.03.13.54.46;	author sbrodie;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	98.12.03.13.54.46;	author sbrodie;	state Exp;
branches
	1.1.1.1.2.1;
next	;

1.1.1.1.2.1
date	99.01.19.14.24.48;	author sbrodie;	state Exp;
branches;
next	1.1.1.1.2.2;

1.1.1.1.2.2
date	99.02.03.12.51.42;	author sbrodie;	state Exp;
branches;
next	1.1.1.1.2.3;

1.1.1.1.2.3
date	99.02.10.14.55.54;	author sbrodie;	state Exp;
branches;
next	1.1.1.1.2.4;

1.1.1.1.2.4
date	99.02.12.17.18.24;	author sbrodie;	state Exp;
branches;
next	;


desc
@@


1.8
log
@Internationalised
Unused LMFiler put in the attic.
As LanMan has historically put its resources into ThirdPart/OmniClient this component has no ROM resources phase - it still registers the resources at run time.

Version 2.40. Tagged as 'LanManFS-2_40'
@
text
@; Copyright 1998 Acorn Computers Ltd
;
; Licensed under the Apache License, Version 2.0 (the "License");
; you may not use this file except in compliance with the License.
; You may obtain a copy of the License at
;
;     http://www.apache.org/licenses/LICENSE-2.0
;
; Unless required by applicable law or agreed to in writing, software
; distributed under the License is distributed on an "AS IS" BASIS,
; WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
; See the License for the specific language governing permissions and
; limitations under the License.
;
; cmhg control file for Lan Man filing system
;
; <module-is-runnable:> - NO

#include "VersionNum"
#include "Global/Services.h"

; Title string
title-string: LanManFS

; Version information
help-string: LanManFS Module_MajorVersion_CMHG Module_MinorVersion_CMHG

; Build date information
date-string: Module_Date_CMHG

initialisation-code: LM_Initialise

finalisation-code: LM_Finalise

; Service calls: FSRedeclare; ResourceFSStarting; DCIDriverStatus; OmniAction
; InternetStatus
service-call-handler: LM_Service Service_OmniAction Service_ResourceFSStarting,
  Service_FSRedeclare,
  Service_DCIDriverStatus Service_InternetStatus Service_DCIProtocolStatus

swi-handler-code:      LM_Swi

swi-chunk-base-number: 0x49240

swi-decoding-table:    LanMan,
   OmniOp, FreeOp, NameOp, Transact, LogonOp


generic-veneers: callback_entry/callback_handler,	; for anti-idleout callback
                 callevery_entry/callevery_handler

vector-handlers: NBIP_CallbackFn/NBIP_CallbackFn_handler_ctrl,
#ifndef NO_NETBEUI
                 ReceiveFn TickerFn LLC_CallbackFn,
#endif
                 EventFn

#ifdef NO_INTERNATIONAL_HELP

command-keyword-table: LM_Command

    LanMan(min-args:0, max-args:0, add-syntax:,
           help-text: "*LanMan selects LanManFS as the current filing system\n",
           invalid-syntax: "Syntax:\t*LanMan" ),

    LMConnect(min-args:3, max-args:5, add-syntax:, fs-command:,
           help-text: "*LMConnect sets up a connection to a file server\n",
           invalid-syntax: "Syntax:\t*LMConnect <name> <server> <dir-name> [<user> <password>]", ),

    LMDisconnect(min-args:1, max-args:1, add-syntax:, fs-command:,
           help-text: "*LMDisconnect disconnects from a file server\n",
           invalid-syntax: "Syntax:\t*LMDisconnect <name>", ),

    LMLogon(min-args:2, max-args:3, add-syntax:, fs-command:,
           help-text: "*LMLogon sets default information about the network\n",
           invalid-syntax: "Syntax:\t*LMLogon <workgroup> <username> <password>", ),

    LMInfo(min-args:0, max-args:0, add-syntax:, fs-command:,
           help-text: "*LMInfo displays debugging information\n",
           invalid-syntax: "Syntax:\t*LMInfo", ),

    LMNameMode(min-args:1, max-args:1, add-syntax:, fs-command:,
           help-text: "*LMNameMode sets the way LanManFS capitalises names on DOS shares, "
                      "it does not affect long filename shares\n",
           invalid-syntax: "Syntax:\t*LMNameMode  0 | 1 | 2", ),

    LMLogoff(min-args:0, max-args:0, add-syntax:, fs-command:,
           help-text: "*LMLogoff clears the workgroup and default user settings "
                      "and disables network browsing\n",
           invalid-syntax: "Syntax:\t*LMLogoff" ),

    LMServer(min-args:1, max-args:17, add-syntax:, fs-command:,
           help-text: "*LMServer adds a server name and list of shared drives\n",
           invalid-syntax: "Syntax:\t*LMServer server [sharename] [sharename] ...", ),

    LMPrinters(min-args:1, max-args:17, add-syntax:, fs-command:,
           help-text: "*LMPrinters adds a server name and list of printers\n",
           invalid-syntax: "Syntax:\t*LMPrinters server [printername] [printername] ...", ),

    Free(min-args:0, max-args:1, add-syntax:, fs-command:,
           help-text: "*Free displays the total free space on a LanManFS share",
           invalid-syntax: "Syntax:\t*Free [<disc spec.>]", ),

    ListFS(min-args:0, max-args:1, add-syntax:, fs-command:,
           help-text: "*ListFS displays the servers in the current LAN workgroup or "
                      "the shares on the given server\n",
           invalid-syntax: "Syntax:\t*ListFS [server]", ),

    FS(min-args:0, max-args:1, add-syntax:, configure:, status:,
           help-text: "*Configure FS sets the file server or domain name from "
                      "which LanManFS will attempt to boot\n",
           invalid-syntax: "Syntax:\t*Configure FS file-server-name", ),

    LMTransport(min-args:0, max-args:1, add-syntax:, configure:, status:,
           help-text: "*Configure LMTransport sets whether LanManFS should use "
                      "NetBEUI or TCP/IP as transport protocol\n",
           invalid-syntax: "Syntax:\t*Configure LMTransport IP | NetBEUI", ),

    LMNameServer(min-args:0, max-args:1, add-syntax:, configure:, status:,
           help-text: "*Configure LMNameServer sets the address of a "
                      "NetBIOS over IP nameserver for LanManFS to use\n",
           invalid-syntax: "Syntax:\t*Configure LMNameServer <IP address>", )

#else

international-help-file:"Resources:$.ThirdParty.OmniClient.LanManFS.Messages"
command-keyword-table: LM_Command

    LanMan(min-args:0, max-args:0, international:,
           help-text: "HLANM",
           invalid-syntax: "SLMAN" ),

    LMConnect(min-args:3, max-args:5, international:, fs-command:,
           help-text: "HCONN",
           invalid-syntax: "SCONN", ),

    LMDisconnect(min-args:1, max-args:1, international:, fs-command:,
           help-text: "HDISC",
           invalid-syntax: "SDISC", ),

    LMLogon(min-args:2, max-args:3, international:, fs-command:,
           help-text: "HLOGN",
           invalid-syntax: "SLOGN", ),

    LMInfo(min-args:0, max-args:0, international:, fs-command:,
           help-text: "HINFO",
           invalid-syntax: "SINFO", ),

    LMNameMode(min-args:1, max-args:1, international:, fs-command:,
           help-text: "HNMOD",
           invalid-syntax: "SNMOD", ),

    LMLogoff(min-args:0, max-args:0, international:, fs-command:,
           help-text: "HLOGO",
           invalid-syntax: "SLOGO" ),

    LMServer(min-args:1, max-args:17, international:, fs-command:,
           help-text: "HSERV",
           invalid-syntax: "SSERV", ),

    LMPrinters(min-args:1, max-args:17, international:, fs-command:,
           help-text: "HPRNT",
           invalid-syntax: "SPRNT", ),

    Free(min-args:0, max-args:1, international:, fs-command:,
           help-text: "HFREE",
           invalid-syntax: "SFREE", ),

    ListFS(min-args:0, max-args:1, international:, fs-command:,
           help-text: "HLSFS",
           invalid-syntax: "SLSFS", ),

    FS(min-args:0, max-args:1, international:, configure:, status:,
           help-text: "HCFFS",
           invalid-syntax: "SCFFS", ),

    LMTransport(min-args:0, max-args:1, international:, configure:, status:,
           help-text: "HCTRN",
           invalid-syntax: "SCTRN", ),

    LMNameServer(min-args:0, max-args:1, international:, configure:, status:,
           help-text: "HCNMS",
           invalid-syntax: "SCNMS", )

#endif
@


1.7
log
@  Multiple fixes.
Detail:
  Too many to list here: see doc/RPSChanges.
Admin:
  Received from Rob Sprowson approx 2009-02-08. Builds, but not tested by ROOL.

Version 2.32. Tagged as 'LanManFS-2_32'
@
text
@d58 1
d62 61
a122 92
        LanMan(min-args:0, max-args:0,
    help-text: "*LanMan selects Lan Manager as the current filing system\r"
               "Syntax:\t*LanMan",
                invalid-syntax: "Syntax:\t*LanMan\r" ),

        LMConnect(min-args:3, max-args:5,
    help-text: "*LMConnect sets up a connection to a file server\r"
      "Syntax:\t*LMConnect <name> <server> <dir-name> [<user-name> <password>]",
    fs-command:,
    invalid-syntax: "Syntax:\t*LMConnect <name> <server> <dir-name> <user>"
                                " <password>\r", ),

        LMDisconnect(min-args:1, max-args:1,
    help-text: "*LMDisconnect disconnects from a file server\r"
               "Syntax:\t*LMDisconnect <name>",
    fs-command:,
    invalid-syntax: "Syntax:\t*LMDisconnect <name>\r", ),

        LMLogon(min-args:2, max-args:3,
    help-text: "*LMLogon sets default information about the network\r"
               "Syntax:\t*LMLogon <workgroup> <username> <password>",
    fs-command:,
    invalid-syntax: "Syntax:\t*LMLogon <workgroup> <username> <password>\r", ),

        LMInfo(min-args:0, max-args:0,
    help-text: "*LMInfo displays debugging information\r"
               "Syntax:\t*LMInfo",
    fs-command:,
    invalid-syntax: "Syntax:\t*LMInfo\r", ),

        LMNameMode(min-args:1, max-args:1,
    help-text: "*LMNameMode sets the way LanManFS capitalises names on DOS shares\r"
               "It does not affect long filename shares\r"
               "Syntax:\t*LMNameMode  0 | 1 | 2",
    fs-command:,
    invalid-syntax: "Syntax:\t*LMNameMode  0 | 1 | 2\r", ),

        LMLogoff(min-args:0, max-args:0,
    help-text: "*LMLogoff clears the workgroup and default user settings "
               "and disables network browsing\rSyntax:\t*LMLogoff",
    fs-command:,
    invalid-syntax: "Syntax:\t*LMLogoff\r" ),

        LMServer(min-args:1, max-args:17,
    help-text: "*LMServer adds a server name and list of shared drives\r"
               "Syntax:\t*LMServer server [sharename] [sharename] ...",
    fs-command:,
    invalid-syntax: "Syntax:\t*LMServer server [sharename] [sharename] ...\r", ),

        LMPrinters(min-args:1, max-args:17,
    help-text: "*LMPrinters adds a server name and list of printers\r"
               "Syntax:\t*LMPrinters server [printername] [printername] ...",
    fs-command:,
    invalid-syntax: "Syntax:\t*LMPrinters server [printername] [printername] ...\r",
                 ),

        FS(min-args:0, max-args:1,
    help-text: "*Configure FS <name> sets the file server or domain name from "
               "which LanManFS will attempt to boot\rSyntax:\t*Configure FS file-server-name",
    invalid-syntax: "Syntax:\t*Configure FS file-server-name\r",
    configure:,
    status:,
                 ),

        LMTransport(min-args:0, max-args:1,
    help-text: "*Configure LMTransport sets whether LanManFS should use "
               "NetBEUI or TCP/IP as transport protocol\rSyntax:\t*Configure LMTransport IP | NetBEUI",
    invalid-syntax: "Syntax:\t*Configure LMTransport IP | NetBEUI\r",
    configure:,
    status:,
                 ),

        LMNameServer(min-args:0, max-args:1,
    help-text: "*Configure LMNameServer <IP address> sets the address of a "
               "NetBIOS over IP nameserver for LanManFS to use\rSyntax:\t*Configure LMNameServer <IP address>",
    invalid-syntax: "Syntax:\t*Configure LMNameServer <IP address>\r",
    configure:,
    status:,
                 ),

        Free(min-args:0, max-args:1,
    help-text: "*Free displays the total free space on a LanManFS share",
    invalid-syntax: "Syntax:\t*Free [<disc spec.>]\r",
    fs-command:,
                 ),

        ListFS(min-args:0, max-args:1,
    help-text: "*ListFS displays the servers in the current LAN workgroup or\r"
               "the shares on the given server\rSyntax:\t*ListFS [server]",
    fs-command:,
    invalid-syntax: "Syntax:\t*ListFS [server]\r",
                 )
d124 1
d126 58
d185 1
@


1.6
log
@Directory rename fixed - the mask being passed by the rename routine didn't
have the ATTR_DIR bit set.Discovered this after reading lots of the spec
which is also now included here in /doc.
Copying files out of LanManFS filer "forgot" their filetype even though
they appeared right in the filer,fixed.
A stray debugging printf removed,along with one compiler warning.
New sprites (yuck) to match !Omni.
Reordered the shutdown in two places,first Omni_Shutdown bins the mounts
lists which SMB_Shutdown uses.Second in NetBEUI mode the announcement that
a protocol has terminated goes *after* the shutdown - otherwise you sit
around for about 20s wondering where the link has gone.

Version 2.25. Tagged as 'LanManFS-2_25'
@
text
@d105 1
a105 1
    help-text: "*LMserver adds a server name and list of shared drives\r"
a116 7
        LMStats(min-args:0, max-args:0,
    help-text: "*LMStats shows network statistics\r"
               "Syntax:\t*LMStats",
    fs-command:,
    invalid-syntax: "Syntax:\t*LMStats",
                 ),

d149 1
a149 1
               "the shares on the given server",
@


1.5
log
@LanmanFS help syntax corrected and tidied
Change lmls command to ListFS in line with NFS
Supress LF when ListFS is issued but there are no servers present.
Cast a few things to shut some compiler warnings up.
Addition of MimeMap lookups where the file has no ",ttt" style type
appended.Previously any such files were all reported as text files so
viewing a machine would typically show whole directories full of
identical filetypes.

Version 2.23. Tagged as 'LanManFS-2_23'
@
text
@d94 1
a94 1
               "Syntax:\t*LMNameMode  [0|1|2]",
d96 1
a96 1
    invalid-syntax: "Syntax:\t*LMNameMode  [0|1|2]\r", ),
d134 2
a135 2
               "NetBEUI or TCP/IP as transport protocol\rSyntax:\t*Configure LMTransport [IP|NetBEUI]",
    invalid-syntax: "Syntax:\t*Configure LMTransport [IP|NetBEUI]\r",
d142 2
a143 2
               "NetBIOS over IP nameserver for LanManFS to use\rSyntax:\t*Configure LMNameServer [IP address]",
    invalid-syntax: "Syntax:\t*Configure LMNameServer [IP address]\r",
@


1.4
log
@  New build option to exclude NetBEUI support.
Detail:
  Pass OPTIONS=-DNO_NETBEUI from the Components file if you do not need
    NetBEUI support, and LanManFS will be 12K smaller.
  In NetBEUI mode, LanManFS sends Service_DCIProtocolStatus as required.
  In IP mode, LanManFS notices Service_DCIProtocolStatus from the Internet
    module when it dies and marks all its sockets as needing reconnection.
  Booting behaviour changed to look for !ArmBoot again and not attempt
    the boot if it is missing.  Removed lots of grotty backdoor hacks
    that used to be used to determine this.
Admin:
  Not tested at all.  This will need very thorough testing before it can
    be considered for release.

Version 2.14. Tagged as 'LanManFS-2_14'
@
text
@d63 1
a63 1
               "Syntax:\t*LanMan\r",
d68 1
a68 1
      "Syntax:\t*LMConnect <name> <server> <dir-name> [<user-name> <password>]\r",
d75 1
a75 1
               "Syntax:\t*LMDisconnect <name>\r",
d81 1
a81 1
               "Syntax:\t*LMLogon <workgroup> <username> <password>\r",
d87 1
a87 1
               "Syntax:\t*LMInfo\r",
d94 1
a94 1
               "Syntax:\t*LMNameMode  [0|1|2]\r",
d100 1
a100 1
               "and disables network browsing\rSyntax:\t*LMLogoff\r",
d106 1
a106 1
               "Syntax:\t*LMServer server [sharename] [sharename] ...\r",
d112 1
a112 1
               "Syntax:\t*LMPrinters server [printername] [printername] ...\r",
d119 1
a119 1
               "Syntax:\t*LMStats\r",
d126 1
a126 1
               "which LanManFS will attempt to boot\r",
d134 1
a134 1
               "NetBEUI or TCP/IP as transport protocol\r",
d141 2
a142 2
    help-text: "*Configure LMNameServer <IP address> sets the address of a"
               "NetBIOS over IP nameserver for LanManFS to use\r",
a147 1

d154 2
a155 2
        LMls(min-args:0, max-args:1,
    help-text: "*LMls displays the servers in the current workgroup or\r"
a156 1
    invalid-syntax: "Syntax:\t*LMls [server]\r",
d158 4
a161 1
                  )
@


1.3
log
@  New *LMLS command.
  Fix for ./.. files in short filename shares.
  Long multiply now provided in assembler.
Detail:
  *LMLS is a new filesystem-specific command which performs the same
    task as "smbclient -L" does under UNIX - ie. listing all the shares
    available on the specified host.
  When enumerating the shares on a remote server, LanManFS now remembers
    all the printers, IPC, device and disc shares (for *LMLS to output).
  The 32x32->64 multiply routine is now provided in assembler instead of
    the previous huge amount of obscure C taken from NSPRLib.  This is
    more understandable (and almost certainly far smaller and quicker
    and doesn't need a hack to stop the compiler mis-optimising it!)
  Old short filename shares still had problems with the . and .. file
    filtering.  Programmer fault there - should've let the compiler do
    the optimisations :-)
  Server info string fixed to byte-reverse the port numbers when printing
    the string into the info buffer.  Now claims to be talking to port 139
    as it should.
Admin:
  Tested in general desktop use for several days, plus experimental versions
    tested in other boot ROMs.

Version 2.03. Tagged as 'LanManFS-2_03'
@
text
@d20 1
d37 3
a39 1
service-call-handler: LM_Service &40 &60 &9D &A0 &B0
d52 5
a56 3
vector-handlers: ReceiveFn TickerFn LLC_CallbackFn,
	NBIP_CallbackFn/NBIP_CallbackFn_handler_ctrl,
 	EventFn
@


1.2
log
@  Support for long filename.
  Support for spaces in machine names.
  Merge of sbrodie_LanManFS_dev branch to trunk.
Detail:
  LanManFS 2.00 supports the "NT LM 0.12" protocol, enabling it to
    use long filenames on mounted shares.
Admin:
  Supporting documentation:
    1215,256/FS: LanManFS Software Functional Specification.
  Same as LanManFS-1_87_1_1_1_1_2_13.

Version 2.00. Tagged as 'LanManFS-2_00'
@
text
@d148 7
@


1.1
log
@Initial revision
@
text
@d35 2
a36 1
service-call-handler: LM_Service &40 &60 &9D &A0
d46 6
a51 1
vector-handlers: ReceiveFn TickerFn LLC_CallbackFn NBIP_CallbackFn EventFn
d61 5
a65 4
        Connect(min-args:3, max-args:5,
    help-text: "*Connect sets up a connection to a file server\r"
      "Syntax:\t*Connect <name> <server> <dir-name> [<user-name> <password>]\r",
    invalid-syntax: "Syntax:\t*Connect <name> <server> <dir-name> <user>"
d68 5
a72 5

        Disconnect(min-args:1, max-args:1,
    help-text: "*Disconnect disconnects from a file server\r"
               "Syntax:\t*Disconnect <name>\r",
    invalid-syntax: "Syntax:\t*Disconnect <name>\r", ),
d77 1
d83 1
d87 2
a88 1
    help-text: "*LMNameMode sets the way LanManFS capitalises names\r"
d90 1
d96 1
d102 1
d108 1
d115 1
d141 8
a148 1
                 )
@


1.1.1.1
log
@
LanManFS moved into Omni subdirectory.  Previous version in
RiscOS/Sources/Networking/LanManFS is now locked out.

The rest of Omni will be imported at a later date.

Version 1.87, tagged as LanManFS-1_87

@
text
@@


1.1.1.1.2.1
log
@  Check-in of all files comprising this development build of LanManFS
  Spaces in NetBIOS names are now allowed.
Detail:
  Now supports NetBIOS hostnames which contain spaces.  Use hardspaces
    in the Omni frontend or at the command-line (unless you can get
    away with a normal space without confusing the CLI parser)
Admin:
  Tested by attempting to connect to machines with spaces in their
    names.  Got the expected response from the target machine, so
    this aspect is working.
  It appears that several files did not get checked in due to datestamp
    problems when LanManFS's location in CVS was changed.  This is now
    fixed.

Version 1.87, 1.1.1.1.2.7. Tagged as 'LanManFS-1_87-1_1_1_1_2_7'
@
text
@d35 1
a35 2
; InternetStatus
service-call-handler: LM_Service &40 &60 &9D &A0 &B0
d45 1
a45 3
vector-handlers: ReceiveFn TickerFn LLC_CallbackFn,
	NBIP_CallbackFn/NBIP_CallbackFn_handler_ctrl,
 	EventFn
@


1.1.1.1.2.2
log
@  Fixed most dodgy pathname problems.
  All *LM... commands are now filing system commands.
  *Connect and *Disconnect renamed to *LMConnect and *LMDisconnect.
Detail:
  When translating RISC OS to DOS filenames, a loop could develop if
    any path component contained a dodgy character.  This is now fixed
    with the exception of problems when both < and > characters appear
    in pathnames since that confuses FileSwitch.  New mappings will be
    need to be agreed for these characters (and remappings for $ and %
    which overload < and > respectively)
  All *LM... commands are now filing system commands, which means that
    you need to prefix them with LanMan: unless LanManFS is the current
    filesystem (following spec review).
  *Connect and *Disconnect renamed to *LMConnect and *LMDisconnect
    (following spec review).
  Trace builds allow "*LanMan:LMNameMode 4" to enable display of system
    and hidden files on the remote filesystem.
Admin:
  Tested briefly against Windows 98 and Windows NT 4 SP3.
  If a directory name contains a dodgy character, repeated searches will
    be made on the remote filesystem.  This is inefficient and a name
    cache would alleviate this.  There is no name cacheing in the current
    version.

Version 1.87, 1.1.1.1.2.9. Tagged as 'LanManFS-1_87-1_1_1_1_2_9'
@
text
@d58 4
a61 5
        LMConnect(min-args:3, max-args:5,
    help-text: "*LMConnect sets up a connection to a file server\r"
      "Syntax:\t*LMConnect <name> <server> <dir-name> [<user-name> <password>]\r",
    fs-command:,
    invalid-syntax: "Syntax:\t*LMConnect <name> <server> <dir-name> <user>"
d64 5
a68 5
        LMDisconnect(min-args:1, max-args:1,
    help-text: "*LMDisconnect disconnects from a file server\r"
               "Syntax:\t*LMDisconnect <name>\r",
    fs-command:,
    invalid-syntax: "Syntax:\t*LMDisconnect <name>\r", ),
a72 1
    fs-command:,
a77 1
    fs-command:,
d81 1
a81 2
    help-text: "*LMNameMode sets the way LanManFS capitalises names on DOS shares\r"
               "It does not affect long filename shares\r"
a82 1
    fs-command:,
a87 1
    fs-command:,
a92 1
    fs-command:,
a97 1
    fs-command:,
a103 1
    fs-command:,
@


1.1.1.1.2.3
log
@  Boot behaviour fixes.
  More debug added.
Detail:
  Trapped Service_InternetStatus reason code 0 as a tipoff to try
    to continue a pending boot operation.  Internet module is not
    sending the expected reason code 2 to indicate that the interface
    has come up when it is also having its address changed.
  Holding down SHIFT when a new connection is made prevents execution
    of !ArmBoot on the newly connected share.
  Several more debug statements added to track progress through the
    booting.
  IPConfig's internal logging system imported.  *LanMan:Free shows
    the contents of the log.
  Free space information still seems to be broken against Windows 95/98.
    Works against NT4SP4 though.
  *Free filesystem-specific command added.
Admin:
  This version managed to boot an STB22 from our NT4 server which
    was supplying it with baseline 303.
  *LanMan:Free is not yet implemented and in debug builds, shows
     the debug log instead.
  Anti-idleout work still pending.

Version 1.87, 1.1.1.1.2.11. Tagged as 'LanManFS-1_87-1_1_1_1_2_11'
@
text
@d138 1
a138 8
                 ),


        Free(min-args:0, max-args:1,
    help-text: "*Free displays the total free space on a LanManFS share",
    invalid-syntax: "Syntax:\t*Free [<disc spec.>]\r",
    fs-command:,
                  )
@


1.1.1.1.2.4
log
@  Free space now 64-bit aware plus *-command implemented.
  Anti-idleout measures implemented.
  Boot behaviour sanitised.
Detail:
  Free space code now knows about 64-bit versions of the various
    calls that can be made to it (OS_FSControl and Free module's i/f)
  *Free implemented.
  CallEvery set up to periodically ping each share to stop buggy
    Microsoft servers going to sleep on it.
  The filesystem does not get deregistered from FileSwitch whenever
    any interface on the machine changes(!)   More subtle changes
    are still required to finalise things in this area though.
Admin:
  Requires TCPIPLibs 5.06 or later
    (CVS: RiscOS/Sources/Libs/TCPIPLibs  tag: TCPIPLibs-5_06)
  Tested by booting an STB22 against an NT4SP4 machine.

Version 1.87, 1.1.1.1.2.12. Tagged as 'LanManFS-1_87-1_1_1_1_2_12'
@
text
@a45 3
generic-veneers: callback_entry/callback_handler,	; for anti-idleout callback
                 callevery_entry/callevery_handler

@
