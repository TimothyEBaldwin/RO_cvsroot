head	1.2;
access;
symbols
	TTXTViewer-0_11:1.1.1.1
	TTXTViewer-0_10:1.1.1.1
	TTXTViewer-0_09:1.1.1.1
	TTXTViewer-0_08:1.1.1.1
	TTXTViewer-0_07:1.1.1.1
	TTXTViewer-0_06:1.1.1.1
	TTXTViewer-0_05:1.1.1.1
	TTXTViewer-0_04:1.1.1.1
	TTXTViewer-0_03:1.1.1.1
	TTXTViewer-0_02:1.1.1.1
	initial:1.1.1.1
	TRUNK:1.1.1;
locks; strict;
comment	@# @;


1.2
date	2002.06.24.14.00.04;	author srevill;	state dead;
branches;
next	1.1;

1.1
date	2001.11.14.15.19.28;	author mboura;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2001.11.14.15.19.28;	author mboura;	state Exp;
branches;
next	;


desc
@@


1.2
log
@  Updated support for setting the default language.
Detail:
  The URL scheme has been updated to be the 'correct' solution rather
  than a short-term bodge. The new language parameter now takes a
  hexadecimal charset value as per the ETS 300 706 specification.
  Charsets specified in the stream will still override this.

  E.g. HREF="teletext:?language=5" will launch the Teletext viewer
  with a Default Charset 0 and Spanish National Subset.
Admin:
  I deleted the s.teletext file as it isn't used anywhere.

Version 0.12. Tagged as 'TTXTViewer-0_12'
@
text
@; Copyright 2001 Pace Micro Technology plc
;
; Licensed under the Apache License, Version 2.0 (the "License");
; you may not use this file except in compliance with the License.
; You may obtain a copy of the License at
;
;     http://www.apache.org/licenses/LICENSE-2.0
;
; Unless required by applicable law or agreed to in writing, software
; distributed under the License is distributed on an "AS IS" BASIS,
; WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
; See the License for the specific language governing permissions and
; limitations under the License.
;
; generated by Norcroft RISC OS ARM C vsn 5.18 (Pace Micro Technology plc.)  [Apr 18 2000]

        AREA |C$$code|, CODE, READONLY
|x$codeseg|

        DCB     &73,&63,&72,&65
        DCB     &65,&6e,&6d,&6f
        DCB     &64,&65,&5f,&73
        DCB     &61,&76,&65,&00
        DCD     &ff000010

        IMPORT  __rt_stkovf_split_small
        IMPORT  _swix
screenmode_save
        MOV      ip,sp
        STMDB    sp!,{fp,ip,lr,pc}
        SUB      fp,ip,#4
        CMP      sp,sl
        BLLT     __rt_stkovf_split_small
        MOV      a4,#&23
        MOV      a3,#7
        MOV      a2,#0
        LDR      a1,[pc, #L00007c-.-8]
        STMDB    sp!,{a1-a4}
        MOV      a4,#&10000000
        ADD      a4,a4,#&100
        MOV      a3,#0
        MOV      a2,#&1f
        ADD      a2,a2,#&200
        MOV      a1,#&34
        BL       _swix
        ADD      sp,sp,#&10
        TEQ      a1,#0
        LDMNEDB  fp,{fp,sp,pc}^
        LDR      a4,[pc, #L000080-.-8]
        MOV      a3,#1
        MOV      a2,#&40000001
        MOV      a1,#&65
        LDMDB    fp,{fp,sp,lr}
        B        _swix
L00007c
        ;MPORT  SavedPalette
        DCD     SavedPalette
L000080
        DCD     |x$dataseg|

        DCB     &73,&63,&72,&65
        DCB     &65,&6e,&6d,&6f
        DCB     &64,&65,&5f,&72
        DCB     &65,&73,&74,&6f
        DCB     &72,&65,&00,&00
        DCD     &ff000014

screenmode_restore
        MOV      ip,sp
        STMDB    sp!,{v1,fp,ip,lr,pc}
        SUB      fp,ip,#4
        CMP      sp,sl
        BLLT     __rt_stkovf_split_small
        MOV      a1,#0
        LDR      v1,[pc, #L000080-.-8]
        LDR      a2,[v1,#0]
        CMN      a2,#1
        LDMEQDB  fp,{v1,fp,sp,pc}^
        MOV      a2,#0
        MOV      a1,#&37
        BL       _swix
        MOV      a2,#1
        MOV      a1,#&e3
        ADD      a1,a1,#&40000
        LDR      a3,[v1,#0]
        BL       _swix
        TEQ      a1,#0
        BNE      |L00011c.J6.screenmode_restore|
        MOV      a4,#&23
        MOV      a3,#8
        LDR      a2,[pc, #L00007c-.-8]
        STMDB    sp!,{a2-a4}
        MOV      a4,#&10000000
        ADD      a4,a4,#&100
        MOV      a3,#0
        MOV      a2,#&17
        ADD      a2,a2,#&200
        MOV      a1,#&34
        BL       _swix
        ADD      sp,sp,#&c
|L00011c.J6.screenmode_restore|
        MVN      a2,#0
        STR      a2,[v1,#0]
        LDMDB    fp,{v1,fp,sp,pc}^

        DCB     &73,&63,&72,&65
        DCB     &65,&6e,&6d,&6f
        DCB     &64,&65,&5f,&74
        DCB     &65,&6c,&65,&74
        DCB     &65,&78,&74,&00
        DCD     &ff000014

screenmode_teletext
        MOV      ip,sp
        STMDB    sp!,{fp,ip,lr,pc}
        SUB      fp,ip,#4
        CMP      sp,sl
        BLLT     __rt_stkovf_split_small
        MOV      a4,#7
        MOV      a3,#0
        MOV      a2,#3
        MOV      a1,#&65
        BL       _swix
        TEQ      a1,#0
        MOVEQ    a2,#0
        MOVEQ    a1,#&36
        LDMEQDB  fp,{fp,sp,lr}
        BEQ      _swix
        LDMDB    fp,{fp,sp,pc}^

get_action
        MVN      a4,#0
        MOV      a3,#0
|L000188.J4.get_action|
        ADD      ip,a2,a3,LSL #2
        LDR      ip,[ip,#0]
        TEQ      ip,a1
        MOVEQ    a4,a3
        BEQ      |L0001a8.J7.get_action|
        ADD      a3,a3,#1
        CMP      a3,#&1b
        BLT      |L000188.J4.get_action|
|L0001a8.J7.get_action|
        MOV      a1,a4
        MOVS     pc,lr

disable_update
        LDR      a3,[pc, #L0001c4-.-8]
        MOV      a4,#&a
        MOV      a2,#3
        MOV      a1,#&46
        B        _swix
L0001c4
        DCD     |x$dataseg|+&4

enable_update
        LDR      a3,[pc, #L0001dc-.-8]
        MOV      a4,#&a
        MOV      a2,#3
        MOV      a1,#&46
        B        _swix
L0001dc
        DCD     |x$dataseg|+&10

set_reveal
        TEQ      a1,#0
        MOVNE    a1,#1
        LDR      a3,[pc, #L000200-.-8]
        STRB     a1,[a3,#3]
        MOV      a4,#&a
        MOV      a2,#3
        MOV      a1,#&46
        B        _swix
L000200
        DCD     |x$dataseg|+&1c

set_national_option_charset
        LDR      a3,[pc, #L00021c-.-8]
        STRB     a1,[a3,#3]
        MOV      a4,#&a
        MOV      a2,#3
        MOV      a1,#&46
        B        _swix
L00021c
        DCD     |x$dataseg|+&28

set_display_mode
        LDR      a3,[pc, #L000238-.-8]
        STRB     a1,[a3,#3]
        MOV      a4,#&a
        MOV      a2,#3
        MOV      a1,#&46
        B        _swix
L000238
        DCD     |x$dataseg|+&34

writec
        AND      a3,a1,#&ff
        MOV      a2,#1
        MOV      a1,#0
        B        _swix

        DCB     &75,&70,&64,&61
        DCB     &74,&65,&5f,&73
        DCB     &74,&61,&74,&75
        DCB     &73,&00,&00,&00
        DCD     &ff000010

update_status
        MOV      ip,sp
        STMDB    sp!,{a1,v1,v2,fp,ip,lr,pc}
        SUB      fp,ip,#4
        CMP      sp,sl
        BLLT     __rt_stkovf_split_small
        MOV      v1,a1
        BL       disable_update
        MOV      a1,#&1e
        BL       writec
        MOV      v2,#0
|L000288.J4.update_status|
        LDRB     a1,[v1,v2]
        ORR      a1,a1,#&80
        BL       writec
        ADD      v2,v2,#1
        CMP      v2,#8
        BLT      |L000288.J4.update_status|
        LDMDB    fp,{v1,v2,fp,sp,lr}
        B        enable_update

        DCB     &75,&70,&64,&61
        DCB     &74,&65,&5f,&73
        DCB     &74,&61,&74,&75
        DCB     &73,&5f,&6c,&69
        DCB     &6e,&65,&00,&00
        DCD     &ff000014

update_status_line
        MOV      ip,sp
        STMDB    sp!,{a1,v1,v2,fp,ip,lr,pc}
        SUB      fp,ip,#4
        CMP      sp,sl
        BLLT     __rt_stkovf_split_small
        MOV      v1,a1
        BL       disable_update
        MOV      a1,#&1f
        BL       writec
        MOV      a1,#8
        BL       writec
        MOV      a1,#0
        BL       writec
        MOV      v2,#0
|L0002f8.J4.update_status_line|
        LDRB     a1,[v1,v2]
        ORR      a1,a1,#&80
        BL       writec
        ADD      v2,v2,#1
        CMP      v2,#&20
        BLT      |L0002f8.J4.update_status_line|
        LDMDB    fp,{v1,v2,fp,sp,lr}
        B        enable_update

        DCB     &75,&70,&64,&61
        DCB     &74,&65,&5f,&73
        DCB     &74,&61,&74,&75
        DCB     &73,&5f,&74,&69
        DCB     &6d,&65,&00,&00
        DCD     &ff000014

update_status_time
        MOV      ip,sp
        STMDB    sp!,{a1,v1,v2,fp,ip,lr,pc}
        SUB      fp,ip,#4
        CMP      sp,sl
        BLLT     __rt_stkovf_split_small
        MOV      v1,a1
        BL       disable_update
        MOV      a1,#&1f
        BL       writec
        MOV      a1,#&20
        BL       writec
        MOV      a1,#0
        BL       writec
        MOV      v2,#&18
|L000368.J4.update_status_time|
        LDRB     a1,[v1,v2]
        ORR      a1,a1,#&80
        BL       writec
        ADD      v2,v2,#1
        CMP      v2,#&20
        BLT      |L000368.J4.update_status_time|
        LDMDB    fp,{v1,v2,fp,sp,lr}
        B        enable_update

        DCB     &64,&69,&73,&70
        DCB     &6c,&61,&79,&5f
        DCB     &65,&72,&72,&6f
        DCB     &72,&00,&00,&00
        DCD     &ff000010

display_error
        MOV      ip,sp
        STMDB    sp!,{a1,v1,v2,fp,ip,lr,pc}
        SUB      fp,ip,#4
        CMP      sp,sl
        BLLT     __rt_stkovf_split_small
        MOV      v1,a1
        BL       disable_update
        MOV      a1,#&1f
        BL       writec
        MOV      a1,#0
        BL       writec
        MOV      a1,#1
        BL       writec
        MOV      v2,#0
|L0003d4.J4.display_error|
        MOV      a1,#&a0
        BL       writec
        ADD      v2,v2,#1
        CMP      v2,#&398
        BLT      |L0003d4.J4.display_error|
        MOV      a1,#&81
        BL       writec
        MOV      a1,#&9d
        BL       writec
        MOV      a1,#&87
        BL       writec
        MOV      a1,#&8b
        BL       writec
        MOV      v2,#4
        B        |L000424.J9.display_error|
|L000410.J6.display_error|
        ORR      a1,a1,#&80
        BL       writec
        ADD      v2,v2,#1
        CMP      v2,#&28
        BGE      |L000434.J15.display_error|
|L000424.J9.display_error|
        ADD      a1,v1,v2
        LDRB     a1,[a1,#-4]
        CMP      a1,#&20
        BGE      |L000410.J6.display_error|
|L000434.J15.display_error|
        CMP      v2,#&28
        BGE      |L000450.J12.display_error|
|L00043c.J11.display_error|
        MOV      a1,#&a0
        BL       writec
        ADD      v2,v2,#1
        CMP      v2,#&28
        BLT      |L00043c.J11.display_error|
|L000450.J12.display_error|
        LDMDB    fp,{v1,v2,fp,sp,lr}
        B        enable_update

        DCB     &63,&6c,&65,&61
        DCB     &72,&5f,&65,&72
        DCB     &72,&6f,&72,&00
        DCD     &ff00000c

clear_error
        MOV      ip,sp
        STMDB    sp!,{v1,fp,ip,lr,pc}
        SUB      fp,ip,#4
        CMP      sp,sl
        BLLT     __rt_stkovf_split_small
        BL       disable_update
        MOV      a1,#&1f
        BL       writec
        MOV      a1,#0
        BL       writec
        MOV      a1,#&18
        BL       writec
        MOV      v1,#0
|L00049c.J4.clear_error|
        MOV      a1,#&a0
        BL       writec
        ADD      v1,v1,#1
        CMP      v1,#&28
        BLT      |L00049c.J4.clear_error|
        LDMDB    fp,{v1,fp,sp,lr}
        B        enable_update

        DCB     &64,&69,&73,&70
        DCB     &6c,&61,&79,&5f
        DCB     &70,&61,&67,&65
        DCB     &00,&00,&00,&00
        DCD     &ff000010

display_page
        MOV      ip,sp
        STMDB    sp!,{a1-a3,v1-v5,fp,ip,lr,pc}
        SUB      fp,ip,#4
        CMP      sp,sl
        BLLT     __rt_stkovf_split_small
        MOV      v3,a1
        MOV      v2,a2
        MOV      v1,a3
        MOV      v5,#0
        BL       disable_update
        MOV      a1,#&c
        BL       writec
        MOV      v4,#0
|L000500.J4.display_page|
        LDRB     a1,[v3,v4]
        ORR      a1,a1,#&80
        BL       writec
        ADD      v4,v4,#1
        CMP      v4,#8
        BLT      |L000500.J4.display_page|
        MOV      v4,#0
|L00051c.J6.display_page|
        LDRB     a1,[v2,v4]
        ORR      a1,a1,#&80
        BL       writec
        ADD      v4,v4,#1
        CMP      v4,#&20
        BLT      |L00051c.J6.display_page|
        MOV      v2,#0
|L000538.J8.display_page|
        TEQ      v5,#0
        BEQ      |L000570.J9.display_page|
        MOV      v5,#0
        MOV      v4,#0
        ADD      v3,v2,v2,LSL #2
|L00054c.J11.display_page|
        ADD      a1,v4,v3,LSL #3
        ADD      a1,a1,v1
        LDRB     a1,[a1,#-&28]
        ORR      a1,a1,#&80
        BL       writec
        ADD      v4,v4,#1
        CMP      v4,#&28
        BLT      |L00054c.J11.display_page|
        B        |L00059c.J13.display_page|
|L000570.J9.display_page|
        MOV      v4,#0
        ADD      v3,v2,v2,LSL #2
|L000578.J14.display_page|
        ADD      a1,v4,v3,LSL #3
        LDRB     a1,[v1,a1]
        TEQ      a1,#&d
        MOVEQ    v5,#1
        ORR      a1,a1,#&80
        BL       writec
        ADD      v4,v4,#1
        CMP      v4,#&28
        BLT      |L000578.J14.display_page|
|L00059c.J13.display_page|
        ADD      v2,v2,#1
        CMP      v2,#&18
        BLT      |L000538.J8.display_page|
        LDMDB    fp,{v1-v5,fp,sp,lr}
        B        enable_update

        DCB     &70,&61,&67,&65
        DCB     &5f,&61,&64,&64
        DCB     &00,&00,&00,&00
        DCD     &ff00000c

        IMPORT  __rt_sdiv
        IMPORT  __rt_sdiv10
page_add
        MOV      ip,sp
        STMDB    sp!,{a1,a2,v1,v2,fp,ip,lr,pc}
        SUB      fp,ip,#4
        CMP      sp,sl
        BLLT     __rt_stkovf_split_small
        AND      a3,a1,#&f00
        MOV      a4,a3,LSR #8
        AND      a3,a1,#&f0
        MOV      lr,a3,LSR #4
        AND      a3,a1,#&f
        MOV      ip,#9
        CMP      lr,#9
        MOVLE    a1,lr
        MOVGT    a1,ip
        CMP      a3,#9
        MOVGT    a3,ip
        ADD      ip,a4,a4,LSL #3
        ADD      a4,ip,a4,LSL #4
        MOV      a4,a4,LSL #2
        ADD      a1,a1,a1,LSL #2
        ADD      a1,a4,a1,LSL #1
        ADD      a1,a1,a3
        ADD      a1,a1,a2
        MOV      a2,#&83
        ADD      a2,a2,#&300
        CMP      a1,a2
        MOVGT    a2,#&64
        BGT      |L000638.J10.page_add|
        CMP      a1,#&64
        MOVGE    a2,a1
|L000638.J10.page_add|
        MOV      v1,a2
        MOV      a1,#&64
        BL       __rt_sdiv
        MOV      v2,a1
        MOV      a1,v1
        BL       __rt_sdiv10
        MOV      v1,a2
        BL       __rt_sdiv10
        MOV      a1,a2
        MOV      a3,v2,LSL #8
        ADD      a1,a3,a1,LSL #4
        ADD      a1,a1,v1
        LDMDB    fp,{v1,v2,fp,sp,pc}^

        DCB     &70,&61,&67,&65
        DCB     &5f,&64,&6f,&77
        DCB     &6e,&00,&00,&00
        DCD     &ff00000c

page_down
        MOV      ip,sp
        STMDB    sp!,{a1,a2,v1,fp,ip,lr,pc}
        SUB      fp,ip,#4
        CMP      sp,sl
        BLLT     __rt_stkovf_split_small
        MOV      v1,a2
        STR      v1,[sp,#-4]!
        MOV      a4,sp
        MOV      a3,a2
        STMDB    sp!,{a3,a4}
        MOV      a3,a1
        MOV      a4,#1
        MOV      a2,#&20000007
        LDR      a1,[pc, #L0006e8-.-8]
        BL       _swix
        ADD      sp,sp,#8
        TEQ      a1,#0
        BNE      |L0006d0.J5.page_down|
        LDR      a1,[sp,#0]
        CMN      a1,#1
        BNE      |L0006e0.J4.page_down|
|L0006d0.J5.page_down|
        MOV      a1,v1
        MVN      a2,#0
        BL       page_add
        STR      a1,[sp,#0]
|L0006e0.J4.page_down|
        LDR      a1,[sp],#4
        LDMDB    fp,{v1,fp,sp,pc}^
L0006e8
        DCD     &00055a05

        DCB     &70,&61,&67,&65
        DCB     &5f,&75,&70,&00
        DCD     &ff000008

page_up
        MOV      ip,sp
        STMDB    sp!,{a1,a2,v1,fp,ip,lr,pc}
        SUB      fp,ip,#4
        CMP      sp,sl
        BLLT     __rt_stkovf_split_small
        MOV      v1,a2
        STR      v1,[sp,#-4]!
        MOV      a4,sp
        MOV      a3,a2
        STMDB    sp!,{a3,a4}
        MOV      a3,a1
        MOV      a4,#2
        MOV      a2,#&20000007
        LDR      a1,[pc, #L0006e8-.-8]
        BL       _swix
        ADD      sp,sp,#8
        TEQ      a1,#0
        BNE      |L00074c.J5.page_up|
        LDR      a1,[sp,#0]
        CMN      a1,#1
        BNE      |L00075c.J4.page_up|
|L00074c.J5.page_up|
        MOV      a1,v1
        MOV      a2,#1
        BL       page_add
        STR      a1,[sp,#0]
|L00075c.J4.page_up|
        LDR      a1,[sp],#4
        LDMDB    fp,{v1,fp,sp,pc}^

        DCB     &70,&72,&69,&6d
        DCB     &61,&72,&79,&5f
        DCB     &70,&61,&67,&65
        DCB     &5f,&72,&65,&71
        DCB     &75,&65,&73,&74
        DCB     &00,&00,&00,&00
        DCD     &ff000018

primary_page_request
        MOV      ip,sp
        STMDB    sp!,{a1-a3,v1-v4,fp,ip,lr,pc}
        SUB      fp,ip,#4
        CMP      sp,sl
        BLLT     __rt_stkovf_split_small
        MOV      v1,a1
        MOV      v2,a2
        MOV      v3,a3
        SUB      sp,sp,#&34
        MOV      a4,a2
        STMDB    sp!,{a4}
        MOV      a3,a1
        MOV      a4,#0
        MOV      a2,#7
        LDR      a1,[pc, #L0008a8-.-8]
        BL       _swix
        ADD      sp,sp,#4
        TEQ      a1,#0
        BNE      |L0008a4.J15.primary_page_request|
        MOV      v4,#8
        MOV      a2,v2
        MOV      a1,v1
        BL       page_down
        STR      a1,[sp,#0]
        MOV      a2,a1
        MOV      a1,v1
        BL       page_down
        STR      a1,[sp,#4]
        MOV      a2,a1
        MOV      a1,v1
        BL       page_down
        STR      a1,[sp,#8]
        MOV      a2,a1
        MOV      a1,v1
        BL       page_down
        MOV      a2,v2
        STR      a1,[sp,#&c]
        MOV      a1,v1
        BL       page_up
        STR      a1,[sp,#&10]
        MOV      a2,a1
        MOV      a1,v1
        BL       page_up
        STR      a1,[sp,#&14]
        MOV      a2,a1
        MOV      a1,v1
        BL       page_up
        STR      a1,[sp,#&18]
        MOV      a2,a1
        MOV      a1,v1
        BL       page_up
        TEQ      v3,#0
        STR      a1,[sp,#&1c]
        BEQ      |L000880.J6.primary_page_request|
        MOV      a1,#0
|L00085c.J8.primary_page_request|
        LDR      a3,[v3,a1,LSL #2]
        CMN      a3,#1
        BEQ      |L000874.J9.primary_page_request|
        MOV      a2,v4
        ADD      v4,v4,#1
        STR      a3,[sp,a2,LSL #2]
|L000874.J9.primary_page_request|
        ADD      a1,a1,#1
        CMP      a1,#5
        BLT      |L00085c.J8.primary_page_request|
|L000880.J6.primary_page_request|
        MOV      a4,v4
        MOV      a3,sp
        STMDB    sp!,{a3,a4}
        MOV      a3,v1
        MOV      a4,#1
        MOV      a2,#&f
        LDR      a1,[pc, #L0008a8-.-8]
        BL       _swix
        ADD      sp,sp,#8
|L0008a4.J15.primary_page_request|
        LDMDB    fp,{v1-v4,fp,sp,pc}^
L0008a8
        DCD     &00055a02

        DCB     &6d,&61,&69,&6e
        DCB     &6c,&6f,&6f,&70
        DCB     &5f,&74,&65,&6c
        DCB     &65,&74,&65,&78
        DCB     &74,&00,&00,&00
        DCD     &ff000014

        IMPORT  messages_error_lookup
        IMPORT  messages_simple_lookup
        IMPORT  _sprintf
        IMPORT  malloc
        IMPORT  free
        IMPORT  memcpy
        IMPORT  _fprintf
        IMPORT  keyboard_get_key
mainloop_teletext
        MOV      ip,sp
        STMDB    sp!,{a1-a3,v1-v6,fp,ip,lr,pc}
        SUB      fp,ip,#4
        CMP      sp,sl
        BLLT     __rt_stkovf_split_small
        MOV      v6,a2
        SUB      sp,sp,#&64
        MOV      a1,#0
        STR      a1,[sp,#&5c]
        MOV      v5,#0
        STR      a1,[sp,#&58]
        MOV      v3,#0
        STR      a1,[sp,#&54]
        STR      a1,[sp,#&50]
        STR      a1,[sp,#&4c]
        MOV      v4,#0
        STR      a1,[sp,#&48]
        ADD      a2,sp,#&28
        LDR      a1,[pc, #L000970-.-8]
        LDMIA    a1,{a1,a4,ip}
        STMIA    a2,{a1,a4,ip}
        MOV      a1,#0
        STR      a1,[sp,#4]
        MOV      v1,#&100
        STR      a1,[sp,#0]
        LDR      a1,[pc, #L000080-.-8]
        LDR      a1,[a1,#&44]
        TEQ      a1,#0
        BNE      |L000978.J4.mainloop_teletext|
        LDR      a4,[pc, #L000974-.-8]
        STMDB    sp!,{a4}
        MOV      a4,#0
        MOV      a3,#0
        MOV      a2,#&80000003
        MOV      a1,#&5a00
        ADD      a1,a1,#&50000
        BL       _swix
        ADD      sp,sp,#4
        MOV      v2,a1
        MVN      a1,#0
        LDR      a2,[pc, #L000080-.-8]
        STR      a1,[a2,#&40]!
        B        |L000a1c.J6.mainloop_teletext|
L000970
        DCD     |x$dataseg|+&48
L000974
        DCD     |x$dataseg|+&44
|L000978.J4.mainloop_teletext|
        MOV      a2,#0
        STR      a2,[sp,#-4]!
        MOV      a4,sp
        ADD      a3,sp,#&c
        STMDB    sp!,{a3,a4}
        MOV      a3,a1
        MOV      a4,#0
        MOV      a2,#&40000007
        LDR      a1,[pc, #L0009ec-.-8]
        BL       _swix
        ADD      sp,sp,#8
        MOVS     v2,a1
        BNE      |L000a18.J7.mainloop_teletext|
        LDR      a1,[sp,#0]
        TEQ      a1,#5
        BNE      |L0009f0.J9.mainloop_teletext|
        MOV      a1,#0
        LDR      a2,[pc, #L000080-.-8]
        STR      a1,[a2,#&44]
        MVN      a1,#0
        STR      a1,[a2,#&40]!
        LDR      a4,[pc, #L000974-.-8]
        STMDB    sp!,{a4}
        MOV      a4,#0
        MOV      a3,#0
        MOV      a2,#&80000003
        MOV      a1,#&5a00
        ADD      a1,a1,#&50000
        B        |L000a0c.J279.mainloop_teletext|
L0009ec
        DCD     &00055a03
|L0009f0.J9.mainloop_teletext|
        MVN      a4,#0
        STMDB    sp!,{a4}
        LDR      a1,[pc, #L000080-.-8]
        MOV      a4,#0
        MOV      a2,#7
        LDR      a3,[a1,#&44]!
        LDR      a1,[pc, #L0008a8-.-8]
|L000a0c.J279.mainloop_teletext|
        BL       _swix
        ADD      sp,sp,#4
        MOV      v2,a1
|L000a18.J7.mainloop_teletext|
        ADD      sp,sp,#4
|L000a1c.J6.mainloop_teletext|
        TEQ      v2,#0
        BNE      |L000b04.J12.mainloop_teletext|
        SUB      sp,sp,#8
        MOV      a1,#0
        STR      a1,[sp,#4]
        STR      a1,[sp,#0]
        MOV      a4,sp
        STMDB    sp!,{a4}
        ADD      a4,sp,#8
        LDR      a1,[pc, #L000080-.-8]
        MOV      a2,#&60000001
        LDR      a3,[a1,#&44]!
        LDR      a1,[pc, #L000aa0-.-8]
        BL       _swix
        ADD      sp,sp,#4
        MOVS     v2,a1
        BNE      |L000a7c.J14.mainloop_teletext|
        LDR      a1,[sp,#4]
        TST      a1,#1
        BNE      |L000a84.J18.mainloop_teletext|
        ADD      a2,pc,#L000aa4-.-8
        MOV      a1,#0
        BL       messages_error_lookup
        MOV      v2,a1
|L000a7c.J14.mainloop_teletext|
        TEQ      v2,#0
        BNE      |L000b00.J17.mainloop_teletext|
|L000a84.J18.mainloop_teletext|
        TEQ      v6,#0
        BEQ      |L000ab4.J22.mainloop_teletext|
        TEQ      v6,#1
        BEQ      |L000ac8.J21.mainloop_teletext|
        TEQ      v6,#2
        LDREQ    v1,[fp,#-&28]
        B        |L000adc.J19.mainloop_teletext|
L000aa0
        DCD     &00055a06
L000aa4
        DCB     &4e,&6f,&56,&69
        DCB     &64,&65,&6f,&50
        DCB     &6c,&61,&79,&69
        DCB     &6e,&67,&00,&00
|L000ab4.J22.mainloop_teletext|
        LDR      a1,[pc, #L000080-.-8]
        LDR      a1,[a1,#&40]
        CMN      a1,#1
        MOVNE    v1,a1
        BNE      |L000adc.J19.mainloop_teletext|
|L000ac8.J21.mainloop_teletext|
        LDR      a1,[sp,#4]
        TST      a1,#4
        MOVEQ    a1,#1
        STREQ    a1,[sp,#&54]
        LDRNE    v1,[sp,#0]
|L000adc.J19.mainloop_teletext|
        LDR      a1,[sp,#4]
        TST      a1,#2
        MOVNE    a1,#0
        MOVEQ    a1,#1
        STR      a1,[sp,#&50]
        TEQ      a1,#0
        ADDNE    a1,pc,#L000b18-.-8
        BLNE     messages_simple_lookup
        BLNE     display_error
|L000b00.J17.mainloop_teletext|
        ADD      sp,sp,#8
|L000b04.J12.mainloop_teletext|
        TEQ      v2,#0
        BEQ      |L000b24.J37.mainloop_teletext|
|L000b0c.J276.mainloop_teletext|
        LDR      a1,[pc, #L000b20-.-8]
        STR      a1,[sp,#&60]
        B        |L00149c.J42.mainloop_teletext|
L000b18
        DCB     &4e,&6f,&54,&65
        DCB     &78,&74,&00,&00
L000b20
        IMPORT  __iob
        DCD     __iob+&50
|L000b24.J37.mainloop_teletext|
        MOV      a3,v1
        ADD      a1,sp,#&28
        ADD      a2,pc,#L000b58-.-8
        BL       _sprintf
        ADD      a1,sp,#&28
        BL       update_status
        MOV      a3,#0
        MOV      a2,v1
        LDR      a1,[pc, #L000080-.-8]
        LDR      a1,[a1,#&44]
        BL       primary_page_request
        MOV      v2,a1
        B        |L000b0c.J276.mainloop_teletext|
L000b58
        DCB     &20,&20,&20,&25
        DCB     &33,&2e,&33,&58
        DCB     &20,&20,&00,&00
|L000b64.J41.mainloop_teletext|
        MOV      a1,#0
        STR      a1,[sp,#-4]!
        LDR      a1,[sp,#&4c]
        TEQ      a1,#0
        BEQ      |L000bc0.J43.mainloop_teletext|
        MOV      a1,#0
        STR      a1,[sp,#-4]!
        MOV      a4,sp
        LDR      a1,[pc, #L000080-.-8]
        MOV      a2,#&40000001
        LDR      a3,[a1,#&44]!
        LDR      a1,[pc, #L000aa0-.-8]
        BL       _swix
        MOVS     v2,a1
        BNE      |L000bbc.J45.mainloop_teletext|
        LDR      a1,[sp,#0]
        TST      a1,#2
        MOVNE    a1,#0
        MOVEQ    a1,#1
        STR      a1,[sp,#&50]
        TEQ      a1,#0
        BLEQ     clear_error
|L000bbc.J45.mainloop_teletext|
        ADD      sp,sp,#4
|L000bc0.J43.mainloop_teletext|
        LDR      a1,[sp,#&50]
        TEQ      a1,#0
        BEQ      |L000c4c.J52.mainloop_teletext|
        SUB      sp,sp,#8
        MOV      a1,#0
        STR      a1,[sp,#4]
        STR      a1,[sp,#0]
        MOV      a4,sp
        STMDB    sp!,{a4}
        ADD      a4,sp,#8
        LDR      v6,[pc, #L000080-.-8]
        MOV      a2,#&60000001
        LDR      a3,[v6,#&44]
        LDR      a1,[pc, #L000aa0-.-8]
        BL       _swix
        ADD      sp,sp,#4
        MOVS     v2,a1
        BNE      |L000c48.J54.mainloop_teletext|
        LDR      a1,[sp,#4]
        TST      a1,#4
        BEQ      |L000c38.J56.mainloop_teletext|
        TEQ      v4,#0
        LDR      v1,[sp,#0]
        MOVEQ    a3,#0
        ADDNE    a3,sp,#&40
        MOV      a2,v1
        LDR      a1,[v6,#&44]!
        BL       primary_page_request
        MOV      v2,a1
        B        |L000c40.J63.mainloop_teletext|
|L000c38.J56.mainloop_teletext|
        TST      a1,#&10
        BEQ      |L000c48.J54.mainloop_teletext|
|L000c40.J63.mainloop_teletext|
        MOV      a1,#0
        STR      a1,[sp,#&58]
|L000c48.J54.mainloop_teletext|
        ADD      sp,sp,#8
|L000c4c.J52.mainloop_teletext|
        TEQ      v2,#0
        BNE      |L000c80.J64.mainloop_teletext|
        MOV      a4,sp
        ADD      a3,sp,#&c
        STMDB    sp!,{a3,a4}
        LDR      a1,[pc, #L000080-.-8]
        MOV      a4,#0
        MOV      a2,#&40000007
        LDR      a3,[a1,#&44]!
        LDR      a1,[pc, #L0009ec-.-8]
        BL       _swix
        ADD      sp,sp,#8
        MOV      v2,a1
|L000c80.J64.mainloop_teletext|
        TEQ      v2,#0
        BNE      |L000ef0.J66.mainloop_teletext|
        LDR      a1,[sp,#0]
        TEQ      a1,#0
        BEQ      |L000ef0.J66.mainloop_teletext|
        SUB      a1,a1,#1
        CMP      a1,#4
        ADDLS    pc,pc,a1,LSL #2
        B        |L000ef0.J66.mainloop_teletext|
        B        |L000cc4.J74.mainloop_teletext|
        B        |L000cd0.J73.mainloop_teletext|
        B        |L000cdc.J72.mainloop_teletext|
        B        |L000ecc.J71.mainloop_teletext|
        MOV      a2,#0
        LDR      a1,[pc, #L000080-.-8]
        STR      a2,[a1,#&44]!
        B        |L001170.J173.mainloop_teletext|
|L000cc4.J74.mainloop_teletext|
        ADD      a1,sp,#&c
        BL       update_status_line
        B        |L000ef0.J66.mainloop_teletext|
|L000cd0.J73.mainloop_teletext|
        ADD      a1,sp,#&c
        BL       update_status_time
        B        |L000ef0.J66.mainloop_teletext|
|L000cdc.J72.mainloop_teletext|
        SUB      sp,sp,#8
        MOV      a1,#0
        STR      a1,[sp,#4]
        STR      a1,[sp,#0]
        LDR      v6,[pc, #L000080-.-8]
        MOV      a4,sp
        STR      v1,[v6,#&40]
        STMDB    sp!,{a4}
        MOV      a4,#0
        MOV      a2,#&40000003
        LDR      a3,[v6,#&44]
        LDR      a1,[pc, #L000e34-.-8]
        BL       _swix
        ADD      sp,sp,#4
        MOVS     v2,a1
        BNE      |L000d40.J75.mainloop_teletext|
        LDR      a1,[sp,#0]
        BL       malloc
        STR      a1,[sp,#4]
        TEQ      a1,#0
        BNE      |L000d48.J80.mainloop_teletext|
        ADD      a2,pc,#L000e38-.-8
        MOV      a1,#0
        BL       messages_error_lookup
        MOV      v2,a1
|L000d40.J75.mainloop_teletext|
        TEQ      v2,#0
        BNE      |L000d60.J79.mainloop_teletext|
|L000d48.J80.mainloop_teletext|
        LDR      a4,[sp,#4]
        MOV      a2,#3
        LDR      a3,[v6,#&44]!
        LDR      a1,[pc, #L000e34-.-8]
        BL       _swix
        MOV      v2,a1
|L000d60.J79.mainloop_teletext|
        TEQ      v2,#0
        BNE      |L000e24.J81.mainloop_teletext|
        TEQ      v5,#0
        BNE      |L000e24.J81.mainloop_teletext|
        SUB      sp,sp,#8
        ADD      v6,sp,#8
        LDMIA    v6,{a1,v6}
        MOV      a1,a1,LSR #2
        ADD      a1,v6,a1,LSL #2
        STR      a1,[sp,#4]
        MOV      a1,#0
        MOV      v4,#0
        STR      a1,[sp,#0]
        LDR      a1,[sp,#4]
        CMP      v6,a1
        BCS      |L000e20.J106.mainloop_teletext|
|L000da0.J84.mainloop_teletext|
        LDR      a1,[v6,#0]
        TEQ      a1,#0
        BEQ      |L000e44.J90.mainloop_teletext|
        TEQ      a1,#1
        LDREQ    a1,[v6,#8]
        BLEQ     set_national_option_charset
        BEQ      |L000de0.J87.mainloop_teletext|
        TEQ      a1,#2
        BNE      |L000de0.J87.mainloop_teletext|
        MOV      v4,#1
        ADD      a1,sp,#&48
        ADD      a2,v6,#8
        LDMIA    a2!,{a4,ip}
        STMIA    a1!,{a4,ip}
        LDMIA    a2,{a2,a4,ip}
        STMIA    a1,{a2,a4,ip}
|L000de0.J87.mainloop_teletext|
        LDR      a1,[v6,#4]
        MOV      a1,a1,LSR #2
        ADD      a1,v6,a1,LSL #2
        ADD      v6,a1,#8
        LDR      a1,[sp,#4]
        CMP      v6,a1
        BCC      |L000da0.J84.mainloop_teletext|
        LDR      a1,[sp,#0]
        TEQ      a1,#0
        BEQ      |L000e20.J106.mainloop_teletext|
        MOV      a1,#&20
        STRB     a1,[sp,#&3c]
        LDR      a3,[sp,#0]
        ADD      a2,sp,#&1c
        ADD      a1,sp,#&3c
        BL       display_page
|L000e20.J106.mainloop_teletext|
        ADD      sp,sp,#8
|L000e24.J81.mainloop_teletext|
        LDR      a1,[sp,#4]
        BL       free
        ADD      sp,sp,#8
        B        |L000ef0.J66.mainloop_teletext|
L000e34
        DCD     &00055a04
L000e38
        DCB     &4e,&6f,&4d,&65
        DCB     &6d,&6f,&72,&79
        DCB     &00,&00,&00,&00
|L000e44.J90.mainloop_teletext|
        ADD      a1,v6,#&24
        ADD      a2,v6,#&c
        STR      a1,[sp,#0]
        ADD      a1,sp,#&1c
        MOV      a3,#&18
        BL       memcpy
        LDR      a1,[v6,#8]
        TST      a1,#3
        MOVEQ    v3,#0
        MOVNE    v3,#1
        CMP      v3,#0
        ADDEQ    a4,pc,#L000ea4-.-8
        ADDNE    a4,pc,#L000eac-.-8
        MOV      a3,v1
        LDR      a1,[sp,#&74]
        ADD      a2,pc,#L000eb4-.-8
        BL       _fprintf
        MOVNE    a1,#2
        BNE      |L000e9c.J100.mainloop_teletext|
        LDR      a1,[sp,#&6c]
        TEQ      a1,#0
        MOVNE    a1,#1
|L000e9c.J100.mainloop_teletext|
        BL       set_display_mode
        B        |L000de0.J87.mainloop_teletext|
L000ea4
        DCB     &66,&61,&6c,&73
        DCB     &65,&00,&00,&00
L000eac
        DCB     &74,&72,&75,&65
        DCB     &00,&00,&00,&00
L000eb4
        DCB     &50,&61,&67,&65
        DCB     &20,&25,&33,&2e
        DCB     &33,&58,&3a,&20
        DCB     &62,&6f,&78,&20
        DCB     &3d,&20,&25,&73
        DCB     &0a,&00,&00,&00
|L000ecc.J71.mainloop_teletext|
        LDR      a1,[sp,#&5c]
        TEQ      a1,#0
        MOVNE    a1,#1
        BL       set_display_mode
        ADD      a1,pc,#L000fc8-.-8
        BL       messages_simple_lookup
        BL       display_error
        MOV      a1,#1
        STR      a1,[sp,#&54]
|L000ef0.J66.mainloop_teletext|
        LDR      a1,[sp,#&60]
        TEQ      a1,#0
        BNE      |L001498.J111.mainloop_teletext|
        TEQ      v2,#0
        BNE      |L001498.J111.mainloop_teletext|
        BL       keyboard_get_key
        CMN      a1,#1
        BEQ      |L001498.J111.mainloop_teletext|
        LDR      a2,[fp,#-&30]
        BL       get_action
        MOV      v6,a1
        CMP      a1,#&1a
        ADDLS    pc,pc,a1,LSL #2
        B        |L001498.J111.mainloop_teletext|
        B        |L000fe4.J134.mainloop_teletext|
        B        |L000fe4.J134.mainloop_teletext|
        B        |L000fe4.J134.mainloop_teletext|
        B        |L000fe4.J134.mainloop_teletext|
        B        |L000fe4.J134.mainloop_teletext|
        B        |L000fe4.J134.mainloop_teletext|
        B        |L000fe4.J134.mainloop_teletext|
        B        |L000fe4.J134.mainloop_teletext|
        B        |L000fe4.J134.mainloop_teletext|
        B        |L000fe4.J134.mainloop_teletext|
        B        |L00114c.J133.mainloop_teletext|
        B        |L001170.J173.mainloop_teletext|
        B        |L001164.J131.mainloop_teletext|
        B        |L001190.J130.mainloop_teletext|
        B        |L0011c4.J129.mainloop_teletext|
        B        |L00123c.J128.mainloop_teletext|
        B        |L0012b4.J127.mainloop_teletext|
        B        |L0012e0.J126.mainloop_teletext|
        B        |L001334.J125.mainloop_teletext|
        B        |L001388.J124.mainloop_teletext|
        B        |L0013c0.J123.mainloop_teletext|
        B        |L0013fc.J122.mainloop_teletext|
        B        |L001434.J121.mainloop_teletext|
        B        |L001478.J120.mainloop_teletext|
        B        |L001478.J120.mainloop_teletext|
        B        |L001480.J118.mainloop_teletext|
        TEQ      v5,#0
        BNE      |L001498.J111.mainloop_teletext|
        TEQ      v4,#0
        LDRNE    a1,[sp,#&48]
        CMNNE    a1,#1
        BEQ      |L001498.J111.mainloop_teletext|
        TEQ      v3,#0
        LDR      v1,[sp,#&48]
        MOVEQ    a3,#&20
        MOVNE    a3,#&b
        MOV      a4,v1
        ADD      a1,sp,#&2c
        ADD      a2,pc,#L000fd8-.-8
        B        |L001468.J282.mainloop_teletext|
L000fc8
        DCB     &50,&61,&67,&65
        DCB     &55,&6e,&61,&76
        DCB     &61,&69,&6c,&61
        DCB     &62,&6c,&65,&00
L000fd8
        DCB     &25,&63,&20,&20
        DCB     &25,&33,&2e,&33
        DCB     &58,&20,&20,&00
|L000fe4.J134.mainloop_teletext|
        TEQ      v5,#0
        BNE      |L001498.J111.mainloop_teletext|
        LDR      a1,[sp,#&54]
        TEQ      a1,#0
        MOVNE    a1,#0
        STRNE    a1,[sp,#&54]
        BLNE     clear_error
        MVN      a4,#0
        STMDB    sp!,{a4}
        LDR      a1,[pc, #L000080-.-8]
        MOV      a4,#0
        MOV      a2,#7
        LDR      a3,[a1,#&44]!
        LDR      a1,[pc, #L0008a8-.-8]
        BL       _swix
        ADD      sp,sp,#4
        MOV      v2,a1
        LDR      a1,[sp,#8]
        TEQ      a1,#0
        BEQ      |L0010ac.J151.mainloop_teletext|
        TEQ      a1,#1
        BEQ      |L001108.J150.mainloop_teletext|
        TEQ      a1,#2
        BNE      |L00109c.J148.mainloop_teletext|
        LDR      a1,[sp,#4]
        ADD      a1,v6,a1,LSL #4
        TEQ      v3,#0
        STR      a1,[sp,#4]
        MOVEQ    a3,#&20
        MOVNE    a3,#&b
        LDR      a4,[sp,#4]
        ADD      a1,sp,#&2c
        SUB      a2,pc,#.+8-L000fd8
        BL       _sprintf
        MOV      a1,#0
        STR      a1,[sp,#8]
        STR      a1,[sp,#&58]
        TEQ      v4,#0
        LDR      v1,[sp,#4]
        MOVEQ    a3,#0
        ADDNE    a3,sp,#&38
        MOV      a2,v1
        LDR      a1,[pc, #L0010a8-.-8]
        LDR      a1,[a1,#&44]
        BL       primary_page_request
        MOV      v2,a1
|L00109c.J148.mainloop_teletext|
        ADD      a1,sp,#&2c
        BL       update_status
        B        |L001498.J111.mainloop_teletext|
L0010a8
        DCD     |x$dataseg|
|L0010ac.J151.mainloop_teletext|
        CMP      v6,#0
        BLE      |L00109c.J148.mainloop_teletext|
        CMP      v6,#9
        BGE      |L00109c.J148.mainloop_teletext|
        TEQ      v3,#0
        STR      v6,[sp,#4]
        MOVEQ    a3,#&20
        MOVNE    a3,#&b
        LDR      a4,[sp,#4]
        ADD      a1,sp,#&2c
        ADD      a2,pc,#L0010f4-.-8
        BL       _sprintf
        LDR      a1,[sp,#&64]
        ADD      a3,sp,#&2c
        ADD      a2,pc,#L001104-.-8
        BL       _fprintf
        MOV      a1,#1
        B        |L001134.J280.mainloop_teletext|
L0010f4
        DCB     &25,&63,&20,&25
        DCB     &31,&2e,&31,&58
        DCB     &2d,&2d,&20,&20
        DCB     &00,&00,&00,&00
L001104
        DCB     &25,&73,&0a,&00
|L001108.J150.mainloop_teletext|
        LDR      a1,[sp,#4]
        ADD      a1,v6,a1,LSL #4
        TEQ      v3,#0
        STR      a1,[sp,#4]
        MOVEQ    a3,#&20
        MOVNE    a3,#&b
        LDR      a4,[sp,#4]
        ADD      a1,sp,#&2c
        ADD      a2,pc,#L00113c-.-8
        BL       _sprintf
        MOV      a1,#2
|L001134.J280.mainloop_teletext|
        STR      a1,[sp,#8]
        B        |L00109c.J148.mainloop_teletext|
L00113c
        DCB     &25,&63,&20,&20
        DCB     &25,&32,&2e,&32
        DCB     &58,&2d,&20,&20
        DCB     &00,&00,&00,&00
|L00114c.J133.mainloop_teletext|
        MOV      a1,#1
        TEQ      v3,#0
        STR      a1,[sp,#&5c]
        BNE      |L001498.J111.mainloop_teletext|
|L00115c.J171.mainloop_teletext|
        MOV      a1,#1
        B        |L0011bc.J182.mainloop_teletext|
|L001164.J131.mainloop_teletext|
        LDR      a1,[sp,#&5c]
        TEQ      a1,#0
        BEQ      |L00117c.J172.mainloop_teletext|
|L001170.J173.mainloop_teletext|
        MOV      a1,#1
        STR      a1,[sp,#&60]
        B        |L001498.J111.mainloop_teletext|
|L00117c.J172.mainloop_teletext|
        MOV      a1,#1
        TEQ      v3,#0
        STR      a1,[sp,#&5c]
        BEQ      |L00115c.J171.mainloop_teletext|
        B        |L001498.J111.mainloop_teletext|
|L001190.J130.mainloop_teletext|
        LDR      a1,[sp,#&5c]
        TEQ      a1,#0
        MOVNE    a1,#0
        MOVEQ    a1,#1
        TEQ      v3,#0
        STR      a1,[sp,#&5c]
        BNE      |L001498.J111.mainloop_teletext|
        LDR      a1,[sp,#&5c]
        TEQ      a1,#0
        BNE      |L00115c.J171.mainloop_teletext|
        MOV      a1,#0
|L0011bc.J182.mainloop_teletext|
        BL       set_display_mode
        B        |L001498.J111.mainloop_teletext|
|L0011c4.J129.mainloop_teletext|
        TEQ      v5,#0
        BNE      |L001498.J111.mainloop_teletext|
        LDR      a1,[sp,#&54]
        TEQ      a1,#0
        MOVNE    a1,#0
        STRNE    a1,[sp,#&54]
        BLNE     clear_error
        MOV      a1,#0
        STR      a1,[sp,#8]
        MOV      a2,v1
        STR      a1,[sp,#&58]
        LDR      v2,[pc, #L0010a8-.-8]
        LDR      a1,[v2,#&44]
        BL       page_up
        MOV      v1,a1
        TEQ      v3,#0
        MOVEQ    a3,#&20
        MOVNE    a3,#&b
        MOV      a4,v1
        ADD      a1,sp,#&2c
        SUB      a2,pc,#.+8-L000fd8
        BL       _sprintf
        ADD      a1,sp,#&2c
        BL       update_status
        TEQ      v4,#0
        BEQ      |L0012ac.J203.mainloop_teletext|
        B        |L0012a4.J204.mainloop_teletext|
|L001230.J192.mainloop_teletext|
        MOV      a2,v1
        LDR      a1,[v2,#&44]!
        B        |L001328.J281.mainloop_teletext|
|L00123c.J128.mainloop_teletext|
        TEQ      v5,#0
        BNE      |L001498.J111.mainloop_teletext|
        LDR      a1,[sp,#&54]
        TEQ      a1,#0
        MOVNE    a1,#0
        STRNE    a1,[sp,#&54]
        BLNE     clear_error
        MOV      a1,#0
        STR      a1,[sp,#8]
        MOV      a2,v1
        STR      a1,[sp,#&58]
        LDR      v2,[pc, #L0010a8-.-8]
        LDR      a1,[v2,#&44]
        BL       page_down
        MOV      v1,a1
        TEQ      v3,#0
        MOVEQ    a3,#&20
        MOVNE    a3,#&b
        MOV      a4,v1
        ADD      a1,sp,#&2c
        SUB      a2,pc,#.+8-L000fd8
        BL       _sprintf
        ADD      a1,sp,#&2c
        BL       update_status
        TEQ      v4,#0
        BEQ      |L0012ac.J203.mainloop_teletext|
|L0012a4.J204.mainloop_teletext|
        ADD      a3,sp,#&38
        B        |L001230.J192.mainloop_teletext|
|L0012ac.J203.mainloop_teletext|
        MOV      a3,#0
        B        |L001230.J192.mainloop_teletext|
|L0012b4.J127.mainloop_teletext|
        MOV      a1,#0
        MOV      v5,#1
        STR      a1,[sp,#8]
        ADD      a2,sp,#&2c
        ADD      a1,pc,#L0012d4-.-8
        LDMIA    a1,{a1,a4,ip}
        STMIA    a2,{a1,a4,ip}
        B        |L00109c.J148.mainloop_teletext|
L0012d4
        DCB     &20,&20,&48,&4f
        DCB     &4c,&44,&20,&20
        DCB     &00,&00,&00,&00
|L0012e0.J126.mainloop_teletext|
        MOV      a1,#0
        MOV      v5,#1
        MOV      a3,v1
        STR      a1,[sp,#8]
        ADD      a1,sp,#&2c
        LDR      a2,[pc, #L001314-.-8]
        BL       _sprintf
        ADD      a1,sp,#&2c
        BL       update_status
        TEQ      v4,#0
        BEQ      |L001318.J206.mainloop_teletext|
|L00130c.J207.mainloop_teletext|
        ADD      a3,sp,#&38
        B        |L00131c.J266.mainloop_teletext|
L001314
        DCD     |x$codeseg|+&b58
|L001318.J206.mainloop_teletext|
        MOV      a3,#0
|L00131c.J266.mainloop_teletext|
        MOV      a2,v1
        LDR      a1,[pc, #L0010a8-.-8]
        LDR      a1,[a1,#&44]
|L001328.J281.mainloop_teletext|
        BL       primary_page_request
        MOV      v2,a1
        B        |L001498.J111.mainloop_teletext|
|L001334.J125.mainloop_teletext|
        MOV      a1,#0
        TEQ      v5,#0
        STR      a1,[sp,#8]
        MOVNE    v5,#0
        MOVEQ    v5,#1
        CMP      v5,#0
        ADDNE    a2,sp,#&2c
        SUBNE    a1,pc,#.+8-L0012d4
        LDMNEIA  a1,{a1,a4,ip}
        STMNEIA  a2,{a1,a4,ip}
        BNE      |L001370.J213.mainloop_teletext|
        MOV      a3,v1
        ADD      a1,sp,#&2c
        LDR      a2,[pc, #L001314-.-8]
        BL       _sprintf
|L001370.J213.mainloop_teletext|
        ADD      a1,sp,#&2c
        BL       update_status
        BNE      |L001498.J111.mainloop_teletext|
        TEQ      v4,#0
        BEQ      |L001318.J206.mainloop_teletext|
        B        |L00130c.J207.mainloop_teletext|
|L001388.J124.mainloop_teletext|
        TEQ      v5,#0
        BNE      |L001498.J111.mainloop_teletext|
        TEQ      v4,#0
        LDRNE    a1,[sp,#&38]
        CMNNE    a1,#1
        BEQ      |L001498.J111.mainloop_teletext|
        TEQ      v3,#0
        LDR      v1,[sp,#&38]
        MOVEQ    a3,#&20
        MOVNE    a3,#&b
        MOV      a4,v1
        ADD      a1,sp,#&2c
        SUB      a2,pc,#.+8-L000fd8
        B        |L001468.J282.mainloop_teletext|
|L0013c0.J123.mainloop_teletext|
        TEQ      v5,#0
        BNE      |L001498.J111.mainloop_teletext|
        TEQ      v4,#0
        LDRNE    a1,[sp,#&3c]
        CMNNE    a1,#1
        BEQ      |L001498.J111.mainloop_teletext|
        TEQ      v3,#0
        LDR      v1,[sp,#&3c]
        MOVEQ    a3,#&20
        MOVNE    a3,#&b
        MOV      a4,v1
        ADD      a1,sp,#&2c
        LDR      a2,[pc, #L0013f8-.-8]
        B        |L001468.J282.mainloop_teletext|
L0013f8
        DCD     |x$codeseg|+&fd8
|L0013fc.J122.mainloop_teletext|
        TEQ      v5,#0
        BNE      |L001498.J111.mainloop_teletext|
        TEQ      v4,#0
        LDRNE    a1,[sp,#&40]
        CMNNE    a1,#1
        BEQ      |L001498.J111.mainloop_teletext|
        TEQ      v3,#0
        LDR      v1,[sp,#&40]
        MOVEQ    a3,#&20
        MOVNE    a3,#&b
        MOV      a4,v1
        ADD      a1,sp,#&2c
        LDR      a2,[pc, #L0013f8-.-8]
        B        |L001468.J282.mainloop_teletext|
|L001434.J121.mainloop_teletext|
        TEQ      v5,#0
        BNE      |L001498.J111.mainloop_teletext|
        TEQ      v4,#0
        LDRNE    a1,[sp,#&44]
        CMNNE    a1,#1
        BEQ      |L001498.J111.mainloop_teletext|
        TEQ      v3,#0
        LDR      v1,[sp,#&44]
        MOVEQ    a3,#&20
        MOVNE    a3,#&b
        MOV      a4,v1
        ADD      a1,sp,#&2c
        LDR      a2,[pc, #L0013f8-.-8]
|L001468.J282.mainloop_teletext|
        BL       _sprintf
        ADD      a1,sp,#&2c
        BL       update_status
        B        |L00130c.J207.mainloop_teletext|
|L001478.J120.mainloop_teletext|
        MOV      a1,#1
        B        |L001490.J269.mainloop_teletext|
|L001480.J118.mainloop_teletext|
        LDR      a1,[sp,#&58]
        TEQ      a1,#0
        BEQ      |L001478.J120.mainloop_teletext|
        MOV      a1,#0
|L001490.J269.mainloop_teletext|
        STR      a1,[sp,#&58]
        BL       set_reveal
|L001498.J111.mainloop_teletext|
        ADD      sp,sp,#4
|L00149c.J42.mainloop_teletext|
        TEQ      v2,#0
        BNE      |L0014b0.J272.mainloop_teletext|
        LDR      a1,[sp,#&5c]
        TEQ      a1,#0
        BEQ      |L000b64.J41.mainloop_teletext|
|L0014b0.J272.mainloop_teletext|
        MOV      a1,v2
        LDMDB    fp,{v1-v6,fp,sp,pc}^

        DCB     &74,&65,&6c,&65
        DCB     &74,&65,&78,&74
        DCB     &5f,&6f,&6e,&00
        DCD     &ff00000c

        IMPORT  keyboard_init
        IMPORT  keyboard_restore
        EXPORT  teletext_on
teletext_on
        MOV      ip,sp
        STMDB    sp!,{a1-a4}
        STMDB    sp!,{v1-v5,fp,ip,lr,pc}
        SUB      fp,ip,#&14
        CMP      sp,sl
        BLLT     __rt_stkovf_split_small
        MOV      v3,a2
        MOV      v2,a3
        MOV      v1,a4
        LDR      v5,[fp,#&14]
        BL       screenmode_save
        MOVS     v4,a1
        BLEQ     screenmode_teletext
        MOVEQ    v4,a1
        TEQ      v4,#0
        BLEQ     keyboard_init
        MOVEQ    v4,a1
        TEQ      v4,#0
        BNE      |L001530.J8.teletext_on|
        TEQ      v3,#0
        BNE      |L001530.J8.teletext_on|
        MOV      a3,v1
        MOV      a2,v2
        MOV      a1,v5
        BL       mainloop_teletext
        MOV      v4,a1
|L001530.J8.teletext_on|
        BL       keyboard_restore
        BL       screenmode_restore
        MOV      a1,v4
        LDMDB    fp,{v1-v5,fp,sp,pc}^

        AREA |C$$data|,DATA

|x$dataseg|

SavedMode
        DCD     &ffffffff
        DCD     &01011217
        DCD     &00000000
        DCD     &00000000
        DCD     &00011217
        DCD     &00000000
        DCD     &00000000
        DCD     &00021217
        DCD     &00000000
        DCD     &00000000
        DCD     &00041217
        DCD     &00000000
        DCD     &00000000
        DCD     &00001217
        DCD     &00000000
        DCD     &00000000

LastDisplayedPage
        DCD     &ffffffff
        DCD     &00000000
        DCD     &20202020
        DCD     &20202020
        DCD     &00000000

        AREA |C$$zidata|,NOINIT
SavedPalette
        % 2048

        END
@


1.1
log
@Initial revision
@
text
@@


1.1.1.1
log
@Initial import of IPTeletext module
Detail:
Takes teletext data from an MPEG stream and processes it for use be !TTXTView
Admin:
Brief testing OK
@
text
@@
