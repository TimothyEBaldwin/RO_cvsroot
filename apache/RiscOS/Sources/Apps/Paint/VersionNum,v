head	4.32;
access;
symbols
	Paint-2_23-1:4.32
	Paint-2_23:4.32
	Paint-2_22:4.31
	Paint-2_21:4.30
	Paint-2_20:4.29
	Paint-2_19:4.28
	Paint-2_18:4.27
	Paint-2_17:4.26
	Paint-2_16:4.25
	Paint-2_15:4.24
	Paint-2_14:4.23
	Paint-2_13:4.22
	Paint-2_12:4.21
	Paint-2_11:4.20
	Paint-2_10:4.19
	Paint-2_09:4.18
	Paint-2_08:4.17
	Paint-2_07:4.16
	Paint-2_06:4.15
	Paint-2_05:4.14
	Paint-2_04:4.13
	Paint-2_03:4.12
	Paint-2_02:4.11
	Paint-2_01:4.10
	Paint-2_00:4.7
	Paint-1_99:4.6
	Paint-1_98:4.5
	Paint-1_97:4.4
	RO_5_07:4.3
	Paint-1_96:4.3
	Paint-1_95:4.2;
locks; strict;
comment	@# @;


4.32
date	2017.11.11.12.32.32;	author rool;	state Exp;
branches;
next	4.31;
commitid	7xcfho84RnWggCeA;

4.31
date	2017.09.23.08.29.16;	author rool;	state Exp;
branches;
next	4.30;
commitid	XrFzjjyu6MCtui8A;

4.30
date	2017.05.20.09.03.16;	author rool;	state Exp;
branches;
next	4.29;
commitid	GzVnMq2x9MpfJ6Sz;

4.29
date	2015.10.14.20.42.25;	author jlee;	state Exp;
branches;
next	4.28;
commitid	zi4LAThs0ylWm7Fy;

4.28
date	2015.09.26.14.41.15;	author jlee;	state Exp;
branches;
next	4.27;
commitid	jFGXEicrSRIUWLCy;

4.27
date	2015.06.01.17.17.00;	author rsprowson;	state Exp;
branches;
next	4.26;
commitid	mA6qui1JkvewzKny;

4.26
date	2014.07.31.08.30.35;	author rsprowson;	state Exp;
branches;
next	4.25;
commitid	A6qHr8I1nEMGsvKx;

4.25
date	2014.03.27.23.18.28;	author jlee;	state Exp;
branches;
next	4.24;
commitid	zsqBYJ6Lrncsqoux;

4.24
date	2013.08.06.23.22.59;	author jlee;	state Exp;
branches;
next	4.23;
commitid	8Tn6wOJxX7xmWr0x;

4.23
date	2013.07.13.17.42.23;	author rsprowson;	state Exp;
branches;
next	4.22;
commitid	KU75iaLuw8AlPkXw;

4.22
date	2012.09.05.21.36.08;	author rsprowson;	state Exp;
branches;
next	4.21;
commitid	s6gxm2ebrTlk7ojw;

4.21
date	2012.08.22.07.18.07;	author rsprowson;	state Exp;
branches;
next	4.20;
commitid	jkPgRNvjP7QROvhw;

4.20
date	2012.08.11.20.23.20;	author rsprowson;	state Exp;
branches;
next	4.19;
commitid	fwRfIgb2Udhbwagw;

4.19
date	2012.01.14.22.51.42;	author srevill;	state Exp;
branches;
next	4.18;
commitid	YGB7SMu3mLiA5cPv;

4.18
date	2011.09.24.22.15.43;	author rsprowson;	state Exp;
branches;
next	4.17;
commitid	uTEZt2Z5jTCruNAv;

4.17
date	2011.07.24.21.26.21;	author jlee;	state Exp;
branches;
next	4.16;
commitid	Qtqrsf5FpJ54dPsv;

4.16
date	2010.12.12.21.12.51;	author rsprowson;	state Exp;
branches;
next	4.15;

4.15
date	2010.12.07.21.57.03;	author rsprowson;	state Exp;
branches;
next	4.14;

4.14
date	2010.12.07.21.29.31;	author rsprowson;	state Exp;
branches;
next	4.13;

4.13
date	2010.12.07.21.11.54;	author rsprowson;	state Exp;
branches;
next	4.12;

4.12
date	2010.12.05.19.04.53;	author rsprowson;	state Exp;
branches;
next	4.11;

4.11
date	2010.11.29.20.55.08;	author rsprowson;	state Exp;
branches;
next	4.10;

4.10
date	2009.10.01.01.24.21;	author srevill;	state Exp;
branches;
next	4.9;

4.9
date	2009.05.31.19.07.49;	author pnaulls;	state Exp;
branches;
next	4.8;

4.8
date	2009.05.29.02.09.24;	author pnaulls;	state Exp;
branches;
next	4.7;

4.7
date	2007.11.13.01.39.44;	author srevill;	state Exp;
branches;
next	4.6;

4.6
date	2007.09.18.13.14.19;	author srevill;	state Exp;
branches;
next	4.5;

4.5
date	2007.07.27.21.23.27;	author srevill;	state Exp;
branches;
next	4.4;

4.4
date	2007.01.22.17.03.38;	author srevill;	state Exp;
branches;
next	4.3;

4.3
date	2003.02.21.11.58.22;	author rsprowson;	state Exp;
branches;
next	4.2;

4.2
date	2003.01.13.11.15.31;	author rsprowson;	state Exp;
branches;
next	4.1;

4.1
date	2003.01.13.11.06.53;	author rsprowson;	state Exp;
branches;
next	;


desc
@@


4.32
log
@Add mousewheel zoom/scroll and auto scrolling of selected tools
Detail:
  The mouse wheel can now be used to
  * scroll up/down
  * +shift to scroll left/right
  * +control to zoom in/out
  on an open sprite editing window.
  The sprite editing window will auto scroll when the mouse approaches the border with
  * the move whole sprite "hand" tool
  * the copy block "camera" tool
  * the move block "scissors" tool
Admin:
  Submission for the Paint bounty.

Version 2.23. Tagged as 'Paint-2_23'
@
text
@/* (2.23)
 *
 * This file is automatically maintained by srccommit, do not edit manually.
 * Last processed by srccommit version: 1.1.
 *
 */
#define Module_MajorVersion_CMHG        2.23
#define Module_MinorVersion_CMHG        
#define Module_Date_CMHG                11 Nov 2017

#define Module_MajorVersion             "2.23"
#define Module_Version                  223
#define Module_MinorVersion             ""
#define Module_Date                     "11 Nov 2017"

#define Module_ApplicationDate          "11-Nov-17"

#define Module_ComponentName            "Paint"
#define Module_ComponentPath            "castle/RiscOS/Sources/Apps/Paint"

#define Module_FullVersion              "2.23"
#define Module_HelpVersion              "2.23 (11 Nov 2017)"
#define Module_LibraryVersionInfo       "2:23"
@


4.31
log
@Add 4k and 64k new sprite selector
Detail:
  Put in minimal support to create 4k and 64k sprites (currently, TBGR only) so that the User Guide chapter makes sense.
  Previously it was only possible to create such sprites by switching to that mode and doing a screen capture.
Admin:
  Tested on RISC OS 4.02 (ie. without 4k & 64k support) and RISC OS 5.23 (ie. with).

Version 2.22. Tagged as 'Paint-2_22'
@
text
@d1 1
a1 1
/* (2.22)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.22
d9 1
a9 1
#define Module_Date_CMHG                23 Sep 2017
d11 2
a12 2
#define Module_MajorVersion             "2.22"
#define Module_Version                  222
d14 1
a14 1
#define Module_Date                     "23 Sep 2017"
d16 1
a16 1
#define Module_ApplicationDate          "23-Sep-17"
d21 3
a23 3
#define Module_FullVersion              "2.22"
#define Module_HelpVersion              "2.22 (23 Sep 2017)"
#define Module_LibraryVersionInfo       "2:22"
@


4.30
log
@Moderate spray can density based on time not CPU speed
Detail:
  The spray tool rate was ultimately determined by the number of wimp polls per second, which on a fast CPU can be 10,000's making the spray can more of a circle drawing tool.
  Use OS_ReadMonotonicTime to moderate the spray rate, so the speed of the CPU doesn't matter.
  Default density increased to 100 to achieve roughly the same density as a StrongARM Risc PC would previously.
Admin:
  Submission for the Paint bounty.

Version 2.21. Tagged as 'Paint-2_21'
@
text
@d1 1
a1 1
/* (2.21)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.21
d9 1
a9 1
#define Module_Date_CMHG                20 May 2017
d11 2
a12 2
#define Module_MajorVersion             "2.21"
#define Module_Version                  221
d14 1
a14 1
#define Module_Date                     "20 May 2017"
d16 1
a16 1
#define Module_ApplicationDate          "20-May-17"
d21 3
a23 3
#define Module_FullVersion              "2.21"
#define Module_HelpVersion              "2.21 (20 May 2017)"
#define Module_LibraryVersionInfo       "2:21"
@


4.29
log
@Fix unreliable sorting of sprites
Detail:
  c/Menus - Fix sprite sort code to take into account the fact that variable-length array allocations may cause flex blocks to be moved (due to CLib allocating the array from the heap)
Admin:
  Tested on Raspberry Pi
  Appears to fix 'sort by name' sometimes resulting in a random sort order being used
  Will hopefully fix 'out of memory' error reported on forums (unable to reproduce here, but this is a likely cause)
  https://www.riscosopen.org/forum/forums/4/topics/3657


Version 2.20. Tagged as 'Paint-2_20'
@
text
@d1 1
a1 1
/* (2.20)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.20
d9 1
a9 1
#define Module_Date_CMHG                14 Oct 2015
d11 2
a12 2
#define Module_MajorVersion             "2.20"
#define Module_Version                  220
d14 1
a14 1
#define Module_Date                     "14 Oct 2015"
d16 1
a16 1
#define Module_ApplicationDate          "14-Oct-15"
d21 3
a23 3
#define Module_FullVersion              "2.20"
#define Module_HelpVersion              "2.20 (14 Oct 2015)"
#define Module_LibraryVersionInfo       "2:20"
@


4.28
log
@Fix incorrect calculation of memory requirements for alpha-masked sprites
Detail:
  c/PSprite - Fix psprite_size to correctly calculate the memory required by alpha masks
Admin:
  Tested on Raspberry Pi
  Fixes issue reported on forums with 'Not enough memory' errors from SpriteExtend when resizing or adding rows/columns to alpha-masked sprites: https://www.riscosopen.org/forum/forums/4/topics/3610


Version 2.19. Tagged as 'Paint-2_19'
@
text
@d1 1
a1 1
/* (2.19)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.19
d9 1
a9 1
#define Module_Date_CMHG                26 Sep 2015
d11 2
a12 2
#define Module_MajorVersion             "2.19"
#define Module_Version                  219
d14 1
a14 1
#define Module_Date                     "26 Sep 2015"
d16 1
a16 1
#define Module_ApplicationDate          "26-Sep-15"
d21 3
a23 3
#define Module_FullVersion              "2.19"
#define Module_HelpVersion              "2.19 (26 Sep 2015)"
#define Module_LibraryVersionInfo       "2:19"
@


4.27
log
@Turn off close icon on transitory dbox
The 'shapshot' window shouldn't have a close icon, otherwise it automatically gets an iconise icon, and you can't sensibly iconise or uniconise it as it's transitory.

Version 2.18. Tagged as 'Paint-2_18'
@
text
@d1 1
a1 1
/* (2.18)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.18
d9 1
a9 1
#define Module_Date_CMHG                01 Jun 2015
d11 2
a12 2
#define Module_MajorVersion             "2.18"
#define Module_Version                  218
d14 1
a14 1
#define Module_Date                     "01 Jun 2015"
d16 1
a16 1
#define Module_ApplicationDate          "01-Jun-15"
d21 3
a23 3
#define Module_FullVersion              "2.18"
#define Module_HelpVersion              "2.18 (01 Jun 2015)"
#define Module_LibraryVersionInfo       "2:18"
@


4.26
log
@Build fix
Message_SetPrinter renamed.

Version 2.17. Tagged as 'Paint-2_17'
@
text
@d1 1
a1 1
/* (2.17)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.17
d9 1
a9 1
#define Module_Date_CMHG                31 Jul 2014
d11 2
a12 2
#define Module_MajorVersion             "2.17"
#define Module_Version                  217
d14 1
a14 1
#define Module_Date                     "31 Jul 2014"
d16 1
a16 1
#define Module_ApplicationDate          "31-Jul-14"
d21 3
a23 3
#define Module_FullVersion              "2.17"
#define Module_HelpVersion              "2.17 (31 Jul 2014)"
#define Module_LibraryVersionInfo       "2:17"
@


4.25
log
@Various bugfixes. Improve sprite info dialog.
Detail:
  - Handling of currently selected foreground & background colour rewritten; colour is now stored as a 'main_colour' struct, in order to allow representation of alpha level, pixel colour/palette index (which must be 4 bytes for things like CMYK) and ECF index (previously encoded as negative colour values). Fixes crashes when editing RISC OS 5 32bpp ARGB sprites. Note that although the alpha level is now stored internally, and tools should mostly respect it, palette/colour picker limitations mean that only 0/255 is available when selecting colours.
  - "Select colour" code rewritten to decode all the new pixel formats correctly; colours_entry() now accepts a sprite mode word instead of a number-of-colours value
  - "Full info" display tweaked to give more information about the mask (now displays no mask, normal mask, alpha mask, alpha channel)
  - Sprite info dialog extended to display lots more information, including OS version compatibility
  - Fix sprite menu to disallow add/remove mask option if the sprite has a RISC OS 5 alpha channel
  - Fix ECF pattern that's used for the background of masked sprites to get black/white colour values from ColourTrans when in >8bpp modes, to ensure correct colours in new RISC OS 5 modes
  - Fix palette window to render ECF patterns correctly - when creating the sprite that shows the ECF pattern in the palette, psprite_setup_ecf() was failing to set its palette due to passing a sprite pointer to ColourTrans but setting the flags as if it was a sprite name
  - Fix sprwindow_redisplay() and sprwindow_invalidate() to refresh the display correctly when in full info mode; was previously assuming only one column of sprites visible
  - Fix sprites with alpha channels to have the mask ECF pattern plotted in the background
  Files changed:
  - Resources/UK/Messages, Resources/UK/Templates,fec, c/Colours, c/Main, c/Menus, c/PSprite, c/SprWindow, c/Tools, h/Colours, h/MenuD, h/PSprite, h/main
Admin:
  Tested on BB-xM
  Amongst others, fixes issue reported on forums with spritefile window not refreshing correctly when in full info display with multiple columns:
  http://www.riscosopen.org/forum/forums/8/topics/2146?page=5#posts-31272


Version 2.16. Tagged as 'Paint-2_16'
@
text
@d1 1
a1 1
/* (2.16)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.16
d9 1
a9 1
#define Module_Date_CMHG                27 Mar 2014
d11 2
a12 2
#define Module_MajorVersion             "2.16"
#define Module_Version                  216
d14 1
a14 1
#define Module_Date                     "27 Mar 2014"
d16 1
a16 1
#define Module_ApplicationDate          "27-Mar-14"
d21 3
a23 3
#define Module_FullVersion              "2.16"
#define Module_HelpVersion              "2.16 (27 Mar 2014)"
#define Module_LibraryVersionInfo       "2:16"
@


4.24
log
@Fix rendering issues in new screen modes. Add basic support for new sprite types.
Detail:
  c/Main, c/PSprite, h/main - Update window background rendering & sprite translation table caching to work properly with new screen modes.
  c/Main, c/Menus, c/PSprite, h/PSprite, h/main - Code to generate description text for sprite colour count now uses new shared function, psprite_get_colours(), which understands the new sprite formats and won't crash horribly if given something unknown.
Admin:
  Tested on BB-xM with new format sprites and new screen modes
  Needs extending to report more info about new format sprites (RGB order, alpha channel, wide mask, etc.) along with relevant editing facilities.
  Part of an implementation of the Extended Framebuffer Format spec:
  http://www.riscosopen.org/wiki/documentation/show/Extended%20Framebuffer%20Format%20Specification


Version 2.15. Tagged as 'Paint-2_15'
@
text
@d1 1
a1 1
/* (2.15)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.15
d9 1
a9 1
#define Module_Date_CMHG                07 Aug 2013
d11 2
a12 2
#define Module_MajorVersion             "2.15"
#define Module_Version                  215
d14 1
a14 1
#define Module_Date                     "07 Aug 2013"
d16 1
a16 1
#define Module_ApplicationDate          "07-Aug-13"
d21 3
a23 3
#define Module_FullVersion              "2.15"
#define Module_HelpVersion              "2.15 (07 Aug 2013)"
#define Module_LibraryVersionInfo       "2:15"
@


4.23
log
@Don't silently do nothing when trying to rename to a duplicate name
Paint, when renaming a sprite via alt-clicking on the name, would silently do nothing if the target name already exists. This was different behaviour to renaming via the menu (which gives "Sprite name already exists") and the Filer (which gives "Filename already exists". Now, alt-click-rename also gives a suitable error.

Version 2.14. Tagged as 'Paint-2_14'
@
text
@d1 1
a1 1
/* (2.14)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.14
d9 1
a9 1
#define Module_Date_CMHG                13 Jul 2013
d11 2
a12 2
#define Module_MajorVersion             "2.14"
#define Module_Version                  214
d14 1
a14 1
#define Module_Date                     "13 Jul 2013"
d16 1
a16 1
#define Module_ApplicationDate          "13-Jul-13"
d21 3
a23 3
#define Module_FullVersion              "2.14"
#define Module_HelpVersion              "2.14 (13 Jul 2013)"
#define Module_LibraryVersionInfo       "2:14"
@


4.22
log
@Fix data abort when adjust clicking on one sprite immediately after loading
Uninitialised 'transprite' member now set to NULL.

Version 2.13. Tagged as 'Paint-2_13'
@
text
@d1 1
a1 1
/* (2.13)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.13
d9 1
a9 1
#define Module_Date_CMHG                05 Sep 2012
d11 2
a12 2
#define Module_MajorVersion             "2.13"
#define Module_Version                  213
d14 1
a14 1
#define Module_Date                     "05 Sep 2012"
d16 1
a16 1
#define Module_ApplicationDate          "05-Sep-12"
d21 3
a23 3
#define Module_FullVersion              "2.13"
#define Module_HelpVersion              "2.13 (05 Sep 2012)"
#define Module_LibraryVersionInfo       "2:13"
@


4.21
log
@Sprite filer selection logic made consistent with filer
Specifically, in the filer when you menu click on a file it is temporarily selected. Clicking on a different file loses the first temporary selection and moves the highlight to the new file. This behaviour is skipped if there are already files selected (using left or right click).
This change makes !Paint behave this way too, previously the menu click was a permanent selection, so menu clicking elsewhere on a different sprite would actually manipulate the sprite selected some time earlier - very confusing.
Tidy ups
 * Remove hardwired mouse button bitmask operations, now uses defines from <wimp.h>.
 * Use OS_Byte numbers from header

Version 2.12. Tagged as 'Paint-2_12'
@
text
@d1 1
a1 1
/* (2.12)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.12
d9 1
a9 1
#define Module_Date_CMHG                22 Aug 2012
d11 2
a12 2
#define Module_MajorVersion             "2.12"
#define Module_Version                  212
d14 1
a14 1
#define Module_Date                     "22 Aug 2012"
d16 1
a16 1
#define Module_ApplicationDate          "22-Aug-12"
d21 3
a23 3
#define Module_FullVersion              "2.12"
#define Module_HelpVersion              "2.12 (22 Aug 2012)"
#define Module_LibraryVersionInfo       "2:12"
@


4.20
log
@Add option to install disc sprites as a seperate target
Also make use of (some) shared makefiles.

Version 2.11. Tagged as 'Paint-2_11'
@
text
@d1 1
a1 1
/* (2.11)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.11
d9 1
a9 1
#define Module_Date_CMHG                11 Aug 2012
d11 2
a12 2
#define Module_MajorVersion             "2.11"
#define Module_Version                  211
d14 1
a14 1
#define Module_Date                     "11 Aug 2012"
d16 1
a16 1
#define Module_ApplicationDate          "11-Aug-12"
d21 3
a23 3
#define Module_FullVersion              "2.11"
#define Module_HelpVersion              "2.11 (11 Aug 2012)"
#define Module_LibraryVersionInfo       "2:11"
@


4.19
log
@/home/srevill-nfs/sandbox/rool/msg.txt

Version 2.10. Tagged as 'Paint-2_10'
@
text
@d1 1
a1 1
/* (2.10)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.10
d9 1
a9 1
#define Module_Date_CMHG                14 Jan 2012
d11 2
a12 2
#define Module_MajorVersion             "2.10"
#define Module_Version                  210
d14 1
a14 1
#define Module_Date                     "14 Jan 2012"
d16 1
a16 1
#define Module_ApplicationDate          "14-Jan-12"
d21 3
a23 3
#define Module_FullVersion              "2.10"
#define Module_HelpVersion              "2.10 (14 Jan 2012)"
#define Module_LibraryVersionInfo       "2:10"
@


4.18
log
@Failure to plot JPEG would not switch output back.
Always switches back now before reporting the error.

Version 2.09. Tagged as 'Paint-2_09'
@
text
@d1 1
a1 1
/* (2.09)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.09
d9 1
a9 1
#define Module_Date_CMHG                24 Sep 2011
d11 2
a12 2
#define Module_MajorVersion             "2.09"
#define Module_Version                  209
d14 1
a14 1
#define Module_Date                     "24 Sep 2011"
d16 1
a16 1
#define Module_ApplicationDate          "24-Sep-11"
d21 3
a23 3
#define Module_FullVersion              "2.09"
#define Module_HelpVersion              "2.09 (24 Sep 2011)"
#define Module_LibraryVersionInfo       "2:9"
@


4.17
log
@Fix CATCH_SIGNALS code to report the right error if WIMP$ScrapDir is undefined
Detail:
  c/Main - Previously the signal handling code was using a pointer to the original error block when reporting the error to the user. This could cause the wrong error to be reported in some situations (e.g. if WIMP$ScrapDir is undefined). Instead, the code now stores a copy of the error block on the stack.
Admin:
  Tested on rev A2 BB-xM


Version 2.08. Tagged as 'Paint-2_08'
@
text
@d1 1
a1 1
/* (2.08)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.08
d9 1
a9 1
#define Module_Date_CMHG                24 Jul 2011
d11 2
a12 2
#define Module_MajorVersion             "2.08"
#define Module_Version                  208
d14 1
a14 1
#define Module_Date                     "24 Jul 2011"
d16 1
a16 1
#define Module_ApplicationDate          "24-Jul-11"
d21 3
a23 3
#define Module_FullVersion              "2.08"
#define Module_HelpVersion              "2.08 (24 Jul 2011)"
#define Module_LibraryVersionInfo       "2:8"
@


4.16
log
@Colour picker help made more helpful.
Previously, the help requests would end up in the background event handler which didn't look at the window handle and would just return "This is paint" even if the handle was that of the colour picker dialogue.
Also now passes documented 0x80000000 and 0x7FFFFFFF on opening rather than zero.

Version 2.07. Tagged as 'Paint-2_07'
@
text
@d1 1
a1 1
/* (2.07)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.07
d9 1
a9 1
#define Module_Date_CMHG                12 Dec 2010
d11 2
a12 2
#define Module_MajorVersion             "2.07"
#define Module_Version                  207
d14 1
a14 1
#define Module_Date                     "12 Dec 2010"
d16 1
a16 1
#define Module_ApplicationDate          "12-Dec-10"
d21 3
a23 3
#define Module_FullVersion              "2.07"
#define Module_HelpVersion              "2.07 (12 Dec 2010)"
#define Module_LibraryVersionInfo       "2:7"
@


4.15
log
@Fix crashes when dragging from the sprite filer to the filer to save sprite(s).
The use of DragASprite tended to cause an abort somewhere in the kernel's sprite handling code for some reason, changed this to instead create a temporary WIMP icon on the sprite filer in question which can than be referred to in a normal call to xfersend(). The rest of the save is then handled by the normal xfersend() handlers and the temporary icon destroyed since the WIMP takes a copy anyway.
Has the extra benefits
 * Dragging from the sprite filer now obeys the 'solid drag' flags.
 * Dragging from the sprite filer no longer crashes if dropping back on the originating filer window itself.
When dragging a selection from the filer the selection is cleared at the end of the drag, to match the behaviour of the desktop filer. When saving a selection from the 'Selection' menu, they are not deselected.
Changed to use the 'package' icon when dragging multiple sprites, or file_ff9 for singles.

Version 2.06. Tagged as 'Paint-2_06'
@
text
@d1 1
a1 1
/* (2.06)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.06
d9 1
a9 1
#define Module_Date_CMHG                07 Dec 2010
d11 2
a12 2
#define Module_MajorVersion             "2.06"
#define Module_Version                  206
d14 1
a14 1
#define Module_Date                     "07 Dec 2010"
d16 1
a16 1
#define Module_ApplicationDate          "07-Dec-10"
d21 3
a23 3
#define Module_FullVersion              "2.06"
#define Module_HelpVersion              "2.06 (07 Dec 2010)"
#define Module_LibraryVersionInfo       "2:6"
@


4.14
log
@Switch to using common JPEG code in RISC_OSLib.
Allows better sharing when !Draw is also in ROM.
Fix long (long) standing bug of not being able to drag JPEGs into !Paint using the RAM transfer protocol - some dubious pointer arithmetic meant the wrong address of JPEG data was used and so gave an error.
The 3 paths that result in a JPEG->Sprite conversion now share code too.
Remove local definition of FileType_JPEG, use that in the exports.

Version 2.05. Tagged as 'Paint-2_05'
@
text
@d1 1
a1 1
/* (2.05)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.05
d11 2
a12 2
#define Module_MajorVersion             "2.05"
#define Module_Version                  205
d21 3
a23 3
#define Module_FullVersion              "2.05"
#define Module_HelpVersion              "2.05 (07 Dec 2010)"
#define Module_LibraryVersionInfo       "2:5"
@


4.13
log
@Simplify _swix to os_swix.
Function main_icon_bboxes() reordered to only call the SWIs it needs to fulfil the requested information.

Version 2.04. Tagged as 'Paint-2_04'
@
text
@d1 1
a1 1
/* (2.04)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.04
d11 2
a12 2
#define Module_MajorVersion             "2.04"
#define Module_Version                  204
d21 3
a23 3
#define Module_FullVersion              "2.04"
#define Module_HelpVersion              "2.04 (07 Dec 2010)"
#define Module_LibraryVersionInfo       "2:4"
@


4.12
log
@Prune the plethora of targets a bit.
Spurious ';' after an if at line 2386 of c.Main deleted, something to do with scroll wheel support. Untested.
Refer to FileType_ using the filetypes header file.
Internationalised "Selection" when saving a sprite selection.
main_save_selection wasn't checking if fwrite() worked so never reported 'disc full'.
Turn on egg timer during main_save_selection().
Fix (de)selection bug when in full sprite info view, the 'spritesperrow' was being rounded down to zero, and unlike everywhere else it wasn't being adjusted back to a minimum of 1.

Version 2.03. Tagged as 'Paint-2_03'
@
text
@d1 1
a1 1
/* (2.03)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.03
d9 1
a9 1
#define Module_Date_CMHG                05 Dec 2010
d11 2
a12 2
#define Module_MajorVersion             "2.03"
#define Module_Version                  203
d14 1
a14 1
#define Module_Date                     "05 Dec 2010"
d16 1
a16 1
#define Module_ApplicationDate          "05-Dec-10"
d21 3
a23 3
#define Module_FullVersion              "2.03"
#define Module_HelpVersion              "2.03 (05 Dec 2010)"
#define Module_LibraryVersionInfo       "2:3"
@


4.11
log
@Fix abort when sorting the sprites by name and one or more sprite viewers
are open, also massively simplified it since the copying around of
main_sprite blocks was pointless - much simpler to just rejoin the linked
list leaving the data in place.
*Tidy up
 Delete awk.*, change to use central 'AwkVers' script.
 Delete h.types.
 Delete h.Paint, it's a duplicate of h.main.
 Delete writepixel, swap to using the one in RISCOS_Lib
 Retire 'h.fixes', switches collapsed, bugfixes proven after 18 years use.
 Cast away some warnings.
 Sprinkled in some consts, moved pointer qualifiers to get syntax colouring
 right.
 Remove local SWI defines, read from <swis.h> now.
 !MkInstall now installs into <Install$Dir>.Apps
*Little UI changes
 Make the colour number in the colour picker be in the right place vertically
 and correct horizontal position of 'T' and 'E' for ECFs.
 In the create new sprite dialogue box the 32k and 16M options are shaded
 when a palette is requested, this avoids the problem of selecting a deep
 colour mode (which trapped the radio icon in a shaded paletted selection).
 The 'Selection' menu is now shaded when there are zero sprites in the
 file
*Sprite filer
 Fix tiled main window fill to work in EX0 modes and not overwrite in EX2
 modes (was using the sprite's mode word not the current mode to deduce eigen
 factors), leading to odd chequer board areas not being redrawn.
 Refactored main_clear_background() to use stronger typing of RISC_OSLib
 rather than _swix where possible.
 A failure to get the Wimp pixel translation table now falls back to solid
 fill
 Double clicking on a sprite in the sprite file window no longer leaves it
 selected, to mimic the filer.
 Set DISPLAY_MARGIN to 0 to counter for the recent increase from 32 to 40
 of main_FILER_TextHeight
 Added 'Sort by size' after 'Sort by name'

Version 2.02. Tagged as 'Paint-2_02'
@
text
@d1 1
a1 1
/* (2.02)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.02
d9 1
a9 1
#define Module_Date_CMHG                29 Nov 2010
d11 2
a12 2
#define Module_MajorVersion             "2.02"
#define Module_Version                  202
d14 1
a14 1
#define Module_Date                     "29 Nov 2010"
d16 1
a16 1
#define Module_ApplicationDate          "29-Nov-10"
d21 3
a23 3
#define Module_FullVersion              "2.02"
#define Module_HelpVersion              "2.02 (29 Nov 2010)"
#define Module_LibraryVersionInfo       "2:2"
@


4.10
log
@Added the disc-based sprite resources for RISC OS 5.

Admin:
  Also a small tidy-up of the clean-all phase.

Version 2.01. Tagged as 'Paint-2_01'
@
text
@d1 1
a1 1
/* (2.01)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.01
d9 1
a9 1
#define Module_Date_CMHG                01 Oct 2009
d11 2
a12 2
#define Module_MajorVersion             "2.01"
#define Module_Version                  201
d14 1
a14 1
#define Module_Date                     "01 Oct 2009"
d16 1
a16 1
#define Module_ApplicationDate          "01-Oct-09"
d21 3
a23 3
#define Module_FullVersion              "2.01"
#define Module_HelpVersion              "2.01 (01 Oct 2009)"
#define Module_LibraryVersionInfo       "2:1"
@


4.9
log
@Normalise include paths
Detail:
 Use Unix style paths for includes
Admin:
 Part of path changes in all C modules in Apps

Version 2.00. Not tagged
@
text
@d1 1
a1 1
/* (2.00)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.00
d9 1
a9 1
#define Module_Date_CMHG                31 May 2009
d11 2
a12 2
#define Module_MajorVersion             "2.00"
#define Module_Version                  200
d14 1
a14 1
#define Module_Date                     "31 May 2009"
d16 1
a16 1
#define Module_ApplicationDate          "31-May-09"
d21 3
a23 3
#define Module_FullVersion              "2.00"
#define Module_HelpVersion              "2.00 (31 May 2009)"
#define Module_LibraryVersionInfo       "2:0"
@


4.8
log
@Filename fixes for case-sensitive environments.  No functional changes.  First commit to ROOL CVS, hooray.

Version 2.00. Not tagged
@
text
@d9 1
a9 1
#define Module_Date_CMHG                28 May 2009
d14 1
a14 1
#define Module_Date                     "28 May 2009"
d16 1
a16 1
#define Module_ApplicationDate          "28-May-09"
d22 1
a22 1
#define Module_HelpVersion              "2.00 (28 May 2009)"
@


4.7
log
@Fixes background display in sprite file window
Detail:
  Change made to main_clear_background to cope with background sprites which
  are the wrong colour depth.
 
  The background sprite is no longer used if the 'Textured window
  backgrounds' CMOS bit is not set.
Admin:
  Tested on Iyonix RO v5.11
Changed by:
  Colin Granville.

Version 2.00. Tagged as 'Paint-2_00'
@
text
@d4 1
a4 1
 * Last processed by srccommit version: 1.2.
d9 1
a9 1
#define Module_Date_CMHG                13 Nov 2007
d14 1
a14 1
#define Module_Date                     "13 Nov 2007"
d16 1
a16 1
#define Module_ApplicationDate          "13-Nov-07"
d22 1
a22 1
#define Module_HelpVersion              "2.00 (13 Nov 2007)"
@


4.6
log
@  Bugfix of version 1.98
Detail:
  * Show error message when dragging selection fails.
  * Sprite target area in spritefile window set to a minimum height
    of 64 units and minimum width of 64 units.
  * Moving brush now redrawn in the same place that it is updated.
  * Changed moving brush plotting from EOR to NOT to stop
    black in brushes not appearing.
  * Fixed situation where the moving text y position is different
    to plotted text y position at 1:1 scale.
  * Stopped text redrawing repeatedly at the same place. This makes
    single clicks when using EOR plotting always work as expected.
    (old bug)
  * fixed width of insert/delete display at 1:1 scale.
  * fixed ftrace calls left in from changes that cause the !Debug
    compilation to fail.
  * makefile: changed OBJSZ o.Paintlib and o.AltRename. Changed o. to  oz.
  * makefile: changed OBJSD o.Paintlib and o.AltRename. Changed o. to  od.
Admin:
 Tested on Iyonix RO5.10
 Programmer tested only.
Notes:
  Changed by Colin Granville

Version 1.99. Tagged as 'Paint-1_99'
@
text
@d1 1
a1 1
/* (1.99)
d7 1
a7 1
#define Module_MajorVersion_CMHG        1.99
d9 1
a9 1
#define Module_Date_CMHG                18 Sep 2007
d11 2
a12 2
#define Module_MajorVersion             "1.99"
#define Module_Version                  199
d14 1
a14 1
#define Module_Date                     "18 Sep 2007"
d16 1
a16 1
#define Module_ApplicationDate          "18-Sep-07"
d21 3
a23 3
#define Module_FullVersion              "1.99"
#define Module_HelpVersion              "1.99 (18 Sep 2007)"
#define Module_LibraryVersionInfo       "1:99"
@


4.5
log
@  Changes to SpriteFile window to allow selections and
  sprite edit window changed to improve positioning accuracy.
Detail:
  * Wimp_EScroll event added to make wheelmouse work.
  * Tool rubber banding now snaps to pixel centres making location easier.
  * flickering of box stopped in move (hand) tool.
  * Bottom left of sprites used in painting aligned with grid and sprite plotted
    directly under moving version.
  * Text painting now plots under the moving version of the text.
  * copy, move and hand tools cancel dragging with Adjust.
  * SpriteFile window changed to allow selections using Select,Adjust or Drag.
  * Alt-Select/Adjust on name allows renaming of sprite.
  * TAB moves rename icon to next sprite.
  * Shift TAB moves rename icon to previous sprite
  * Ctrl-Return renames sprite and moves the rename icon to the
    next sprite.
 V2 changes
  * Rubber band rectangular boxes with 0 width or height drawn as a
   line so they don't disappear.
  * Parallelogram rubber band where all the points are in line drawn
    as a line so they don't disappear.
Admin:
  Tested on Iyonix RO5.10
  Programmer tested only.
Changed by:
  Colin Granville

Version 1.98. Tagged as 'Paint-1_98'
@
text
@d1 1
a1 1
/* (1.98)
d7 1
a7 1
#define Module_MajorVersion_CMHG        1.98
d9 1
a9 1
#define Module_Date_CMHG                27 Jul 2007
d11 2
a12 2
#define Module_MajorVersion             "1.98"
#define Module_Version                  198
d14 1
a14 1
#define Module_Date                     "27 Jul 2007"
d16 1
a16 1
#define Module_ApplicationDate          "27-Jul-07"
d21 3
a23 3
#define Module_FullVersion              "1.98"
#define Module_HelpVersion              "1.98 (27 Jul 2007)"
#define Module_LibraryVersionInfo       "1:98"
@


4.4
log
@  Minor tweaks to build and install correctly.
Detail:
  Some changes were required in order for this component to build and install
  correctly. These changes are required for the ROOL 'Disc' build.
Admin:
  Tested in Iyonix 'Disc' build using ROOL 'BuildEnv' build environment

Version 1.97. Tagged as 'Paint-1_97'
@
text
@d1 1
a1 1
/* (1.97)
d7 1
a7 1
#define Module_MajorVersion_CMHG        1.97
d9 1
a9 1
#define Module_Date_CMHG                22 Jan 2007
d11 2
a12 2
#define Module_MajorVersion             "1.97"
#define Module_Version                  197
d14 1
a14 1
#define Module_Date                     "22 Jan 2007"
d16 1
a16 1
#define Module_ApplicationDate          "22-Jan-07"
d19 1
a19 1
#define Module_ComponentPath            "RiscOS/Sources/Apps/Paint"
d21 3
a23 3
#define Module_FullVersion              "1.97"
#define Module_HelpVersion              "1.97 (22 Jan 2007)"
#define Module_LibraryVersionInfo       "1:97"
@


4.3
log
@Deleted some junk from CVS.
On creating a new sprite (which is white) an attempt is made to select the
furthest colour from white in the palette.
Corrected icon shading in create dialogue,redid create template.
On closing a file the sprites are freed in reverse order in an attempt to
make it faster (as the blocks are flex'd in the other order) - will speed
up some situations.
When there are 0 sprites in a file the "Save" entry is greyed,this was
causing a internal error nasty looking error box before.
Tweak to allow the debug to be compiled again.
Filesize info box now used OS_ConvertFileSize as the display field
overflowed for files > 1M ish.
File info box made longer than 50 characters,that was a bit stingy.
Local flood fill with transparent mask added.
Reworded some of the messages.
Added "sort by name" to misc menu - sorts the sprites by name oddly enough.
The delete rows/columns now rounds up the grid coordinates,before there
were cases where you could never quite select the edge column/row,for
example a 79*98 sprites zoomed to x8 versus x7.

Version 1.96. Tagged as 'Paint-1_96'
@
text
@d1 1
a1 1
/* (1.96)
d4 1
a4 1
 * Last processed by srccommit version: 1.68.
d7 1
a7 1
#define Module_MajorVersion_CMHG        1.96
d9 1
a9 1
#define Module_Date_CMHG                21 Feb 2003
d11 2
a12 2
#define Module_MajorVersion             "1.96"
#define Module_Version                  196
d14 1
a14 1
#define Module_Date                     "21 Feb 2003"
d16 1
a16 1
#define Module_ApplicationDate          "21-Feb-03"
d21 3
a23 3
#define Module_FullVersion              "1.96"
#define Module_HelpVersion              "1.96 (21 Feb 2003)"
#define Module_LibraryVersionInfo       "1:96"
@


4.2
log
@Version number now extracted from the VersionNum file and inserted into
messages at build time.
Saving palette files now preserve the attributes if a file of the same name
already existed in the target directory.
New tool sprites (and corresponding changed Templates)
Now strips dependencies when cleaned.

Version 1.95. Tagged as 'Paint-1_95'
@
text
@d1 1
a1 1
/* (1.95)
d7 1
a7 1
#define Module_MajorVersion_CMHG        1.95
d9 1
a9 1
#define Module_Date_CMHG                13 Jan 2003
d11 2
a12 2
#define Module_MajorVersion             "1.95"
#define Module_Version                  195
d14 1
a14 1
#define Module_Date                     "13 Jan 2003"
d16 1
a16 1
#define Module_ApplicationDate          "13-Jan-03"
d21 3
a23 3
#define Module_FullVersion              "1.95"
#define Module_HelpVersion              "1.95 (13 Jan 2003)"
#define Module_LibraryVersionInfo       "1:95"
@


4.1
log
@Addition of VersionNum file
@
text
@d1 1
a1 1
/* (1.94)
d4 1
a4 1
 * Last processed by srccommit version: 1.62.
d7 1
a7 1
#define Module_MajorVersion_CMHG        1.94
d9 1
a9 1
#define Module_Date_CMHG                20 Apr 2000
d11 2
a12 2
#define Module_MajorVersion             "1.94"
#define Module_Version                  194
d14 1
a14 1
#define Module_Date                     "20 Apr 2000"
d16 1
a16 1
#define Module_ApplicationDate          "20-Apr-00"
d21 3
a23 3
#define Module_FullVersion              "1.94"
#define Module_HelpVersion              "1.94 (20 Apr 2000)"
#define Module_LibraryVersionInfo       "1:94"
@

