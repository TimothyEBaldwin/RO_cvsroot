head	1.16;
access;
symbols
	DebugLib-0_72:1.16
	DebugLib-0_71:1.16
	DebugLib-0_70:1.16
	DebugLib-0_69:1.16
	DebugLib-0_68:1.16
	DebugLib-0_67:1.16
	DebugLib-0_66:1.16
	DebugLib-0_65:1.16
	DebugLib-0_64:1.16
	RO_5_07:1.16
	DebugLib-0_63:1.16
	DebugLib-0_62:1.16
	DebugLib-0_61:1.16
	DebugLib-0_60:1.15
	DebugLib-0_59:1.15
	DebugLib-0_58:1.15
	DebugLib-0_57:1.15
	dellis_autobuild_BaseSW:1.15
	DebugLib-0_56:1.15
	DebugLib-0_55:1.15
	DebugLib-0_54:1.15
	DebugLib-0_53:1.14
	DebugLib-0_52:1.14
	DebugLib-0_51:1.14
	DebugLib-0_50:1.14
	DebugLib-0_49:1.14
	sbrodie_sedwards_16Mar2000:1.14
	DebugLib-0_48:1.14
	DebugLib-0_47:1.14
	DebugLib-0_46:1.13
	dcotton_autobuild_BaseSW:1.16
	DebugLib-0_45:1.13
	DebugLib-0_44:1.13
	DebugLib-0_43:1.13
	DebugLib-0_42:1.12
	DebugLib-0_41:1.12
	DebugLib-0_40:1.12
	DebugLib-0_39:1.12
	DebugLib-0_38:1.11
	DebugLib-0_33-1_28_2_1:1.9
	DebugLib-0_37:1.10
	DebugLib-0_36:1.10
	DebugLib-0_35:1.10
	DebugLib-0_34:1.10
	nturton_DebugLib-0_24:1.6
	DebugLib-0_33:1.9
	DebugLib-0_32:1.8
	DebugLib-0_31:1.8
	DebugLib-0_30:1.8
	DebugLib-0_29:1.8
	DebugLib-0_28:1.8
	DebugLib-0_27:1.8
	DebugLib-0_26:1.8
	DebugLib-0_25:1.7
	DebugLib-0_24:1.6
	DebugLib-0_23:1.6
	DebugLib-0_22:1.6
	DebugLib-0_21:1.5
	DebugLib-0_20:1.5
	DebugLib-0_19:1.5
	DebugLib-0_18:1.5
	sforrest_daytona_appflash-0_31:1.1
	DebugLib-0_17:1.5
	DebugLib-0_16:1.4
	DebugLib-0_15:1.4
	DebugLib-0_14:1.4
	DebugLib-0_13:1.3
	DebugLib-0_12:1.3
	DebugLib-0_11:1.2
	DebugLib-0_10:1.2
	blaughto_daytona_appflash-0_30:1.1
	blaughto_daytona_appflash-0_29:1.1
	blaughto_daytona_appflash-0_28:1.1
	jberanek_debuglib-0_09:1.1
	blaughto_daytona_appflash-0_27:1.1
	blaughto_daytona_appflash-0_26:1.1
	blaughto_daytona_appflash-0_25:1.1
	blaughto_daytona_appflash-0_24:1.1
	blaughto_daytona_appflash-0_23:1.1
	jberanek_debuglib-0_08:1.1
	blaughto_daytona_appflash-0_21:1.1
	blaughto_daytona_appflash-0_20:1.1
	rwarren_debuglib-0_07:1.1
	blaughto_daytona_appflash-0_19:1.1
	jberanek_debuglib-0_06:1.1
	blaughto_daytona_appflash-0_18:1.1
	jberanek_debuglib-0_05:1.1
	Daytona_bp:1.1
	Daytona:1.1.0.2;
locks; strict;
comment	@# @;


1.16
date	2001.09.17.10.53.32;	author jberanek;	state Exp;
branches;
next	1.15;

1.15
date	2000.05.17.09.56.24;	author jberanek;	state Exp;
branches;
next	1.14;

1.14
date	2000.01.21.10.56.45;	author jberanek;	state Exp;
branches;
next	1.13;

1.13
date	99.09.13.14.20.23;	author jberanek;	state Exp;
branches;
next	1.12;

1.12
date	99.05.26.17.47.34;	author jberanek;	state Exp;
branches;
next	1.11;

1.11
date	99.05.26.13.19.49;	author jberanek;	state Exp;
branches;
next	1.10;

1.10
date	99.05.19.15.20.17;	author sbrodie;	state Exp;
branches;
next	1.9;

1.9
date	99.05.10.15.48.54;	author jberanek;	state Exp;
branches;
next	1.8;

1.8
date	99.01.14.17.43.53;	author jberanek;	state Exp;
branches;
next	1.7;

1.7
date	99.01.11.16.03.52;	author nbingham;	state Exp;
branches;
next	1.6;

1.6
date	98.11.11.17.18.28;	author jberanek;	state Exp;
branches;
next	1.5;

1.5
date	98.10.22.16.32.28;	author jberanek;	state Exp;
branches;
next	1.4;

1.4
date	98.09.17.12.48.22;	author jberanek;	state Exp;
branches;
next	1.3;

1.3
date	98.09.15.15.27.13;	author ahodgkin;	state Exp;
branches;
next	1.2;

1.2
date	98.09.04.17.19.05;	author jberanek;	state Exp;
branches;
next	1.1;

1.1
date	98.02.16.14.18.32;	author jberanek;	state Exp;
branches;
next	;


desc
@@


1.16
log
@  Updated Copyrights, tidied comment header blocks
Detail:
  Updated Copyright messages to show range of years, up to 2001...a bit
 late in the year for that...

  Tidied a few file header comment blocks.

Admin:
  Built on RiscPC.


Version 0.61. Tagged as 'DebugLib-0_61'
@
text
@/* Copyright 1998 Acorn Computers Ltd
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**************************************************************************/
/* File:    include.h                                                     */
/* Purpose: General header file for DebugLib.                             */
/*                                                                        */
/* Copyright [1999-2001] Pace Micro Technology PLC.  All rights reserved. */
/*                                                                        */
/* The copyright in this material is owned by Pace Micro Technology PLC   */
/* ("Pace").  This material is regarded as a highly confidential trade    */
/* secret of Pace.  It may not be reproduced, used, sold or in any        */
/* other way exploited or transferred to any third party without the      */
/* prior written permission of Pace.                                      */
/**************************************************************************/

#ifndef __include_h
#define __include_h

/* -------------------------------------- LIBRARY IMPORTS --------------------------------------- */
/* ANSI Libraries */
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

/* CLib 5 Libraries */
#include "kernel.h"
#include "swis.h"

/* Turn on the PDebug code */
#ifndef PDebug_DEBUG
#define PDebug_DEBUG 1
#endif

/* Turn on the RemoteDB code */
#ifndef REMOTE_DEBUG
#define REMOTE_DEBUG 1
#endif

/* Turn on the trace code */
#ifndef Trace_TRACE
#define Trace_TRACE  1
#endif

#include <stdbool.h>

/* Include the exported header */
#define DEBUGLIB
#include "DebugLib.h"

/* "Unused" macro */
#define IGNORE(a) a=a

/* DebugLib debugging macro */
#ifdef DEBUG
  #define internal_dprintf(a) _dprintf a
#else
  #define internal_dprintf(a)
#endif

#endif

/* -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ END +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ */
@


1.15
log
@  More boolean type changes.
Detail:
  More drastic changes to try and fix all the wonderful variants of
   the boolean type.

  DebugLib now uses <stdbool.h>, "bool", "false" and "true"
   internally.

  DebugLib.h now prototypes its functions with the type DebugLib_BOOL,
   and does preprocessor jiggery-pokery to try and ensure that
   it, plus TRUE, FALSE and BOOL get defined as something appropriate.
Admin:
  Tested by changing some of the test harnesses to include OSLib,
   stdbool and tboxlib headers.
  Fixed test harness module Makefile to include zm versions of
   libraries in all cases.


Version 0.54. Tagged as 'DebugLib-0_54'
@
text
@d15 12
a26 12
/************************************************************************/
/* File:    include.h                                                   */
/* Purpose: General header file for DebugLib.                           */
/*                                                                      */
/* Copyright [1999] Pace Micro Technology PLC.  All rights reserved.    */
/*                                                                      */
/* The copyright in this material is owned by Pace Micro Technology PLC */
/* ("Pace").  This material is regarded as a highly confidential trade  */
/* secret of Pace.  It may not be reproduced, used, sold or in any      */
/* other way exploited or transferred to any third party without the    */
/* prior written permission of Pace.                                    */
/************************************************************************/
@


1.14
log
@  Tidy-up
Detail:
  Stewart's checkin about LibVersion reminded me I'd done some tidying
  (including the LibVersion thing) and not checked it in.  So here it is.

  Tidied Makefile, added standard headers to all the c and h files,
  including the regulation copyright message.

  Changed options.c so that it fits the coding style of the rest of
  DebugLib (naughty Stewart).

  Improved "strdup" routine.

  Moved stripdepend call into Makefile.

Admin:
  Built and tested.


Version 0.47. Tagged as 'DebugLib-0_47'
@
text
@a40 9
#ifndef BOOL_DEFINED
#define BOOL_DEFINED
#ifndef BOOL
#define BOOL int
#define TRUE 1
#define FALSE 0
#endif
#endif

d55 2
@


1.13
log
@ * Forgot to copy h directory back to NFS before previous check-in.  This
   is now rectified, which should allow DebugLib to build correctly.


Version 0.43. Tagged as 'DebugLib-0_43'
@
text
@d15 12
a26 4
/*************************************************************/
/* File:    include.h                                        */
/* Purpose: General header file for DebugLib.                */
/*************************************************************/
@


1.12
log
@ * Tidied "include.h":

 * Moved non-general definitions into appropriate
   header files.  e.g. Default serial options into serial.h etc.
 * Removed DEBUGLIB_UNUSED() macro, as there was already a similar macro
   IGNORE()

 * "globals.h" now includes "options.h" to get the definition of the
   options structure.


Version 0.38. Not tagged
@
text
@a32 4
/* Include the exported header */
#define DEBUGLIB
#include "DebugLib.h"

d56 4
@


1.11
log
@ * Continued tidy-up of DebugLib:

 * All DebugLib functions now namespaced, they all start debug_<filename>_
  (except the functions in debug.c which are debug_).

 * Device specific #defines etc moved into device specific header files,
   e.g. debugit.h

 * Moved taskname prefixing to a central location, moved timestamping here
   also, added area/level prefixing, and tidied up this prefixing to make
   sure it looks good on all the possible debug devices.

 * Can now do any debuglib function to any debug device, including trace
   output, this hasn't been the case for a while.

 * Added new option, to set whether you want to prefix all debug lines
   with the area/level pair specified in dprintf, dfprintf etc.  Added
   new function to set this option.  debug_set_area_level_prefix ()

 * remotedb output now uses new "raw" output mode added to remotedb in
   version 0.06.  _DebugLib now requires remotedb version >= 0.06_

 * Added new test cases into CLI_App test harness, and changed a few things
   in TestMod.

 * Added Memcheck misc block registration into buffering code, which allows
   buffering to be used on the DebugLib Memcheck build.

 * Added lots of new function names into the always_ignore field which is
   used to tell trace which functions to ignore.  It seems that some the
   internet libraries have function names emebedded, which causes horrible
   loops when using DebugLib to output trace info to remotedb.  Also added
   debug_* and remote_debug_*

 * Added StrongHelp topics for ddumpbuf, debug_output_buffer_* and
   debug_set_area_level_prefix.  Updated the "Setting up the library"
   section.

 * Checked with all the debug devices except TML and serial.


Version 0.38. Tagged as 'DebugLib-0_38'
@
text
@d15 4
a18 5

/************************************************************************/
/* File:    include.h                                                   */
/* Purpose: Gneral header file for DebugLib. Holds type definitions etc.*/
/************************************************************************/
d61 1
a61 19
/* Types */

typedef struct debug_options
{
  char *taskname;
  char *filename;
  debug_device device;
  debug_device trace_device;
  BOOL taskname_prefix;
  BOOL area_level_prefix;
  BOOL stamp_debug;
  BOOL screen_cornering;
  BOOL unbuffered_files;
  BOOL serial_lf;
  int serial_port_speed;
  int serial_port_number;
  size_t dump_width;
}debug_options;

d64 1
a69 13

/* size of internal debug buffer */
#define Debug_Buffer_Size 1024

/* Default Serial Port Behaviour */
#define SerialPort_DefaultPort	1
#define SerialPort_DefaultSpeed	57600

/* Default ddumpbuf width */
#define DumpWidth_DefaultWidth 16u

/* UNUSED Macro */
#define DEBUGLIB_UNUSED(x)	(void) (x)
@


1.10
log
@  Buffer dumper added.
  A handful of miscellaneous header file fixes.
Detail:
  ddumpbuf(area, buffer pointer, size of buffer, offset) added to enable
    binary data to be dumped out to debug.
  debug_set_dump_width(width) sets the number of bytes of data per line
    of debug output.  This must be a positive integer greater than zero
    and less than 64.
  Macro out of serial port function fixed.
  Pragma declarations fixed.
Admin:
  Modified CLI test program to dump buffers out and verified the widthing
    and offset work.

Version 0.34. Tagged as 'DebugLib-0_34'
@
text
@a61 6
/* Other Debug Devices */
#include "PDebug/PDebug.h"              /* PDebug by JSmith */
#include "Trace.h"                      /* Trace by JSmith */
#include "debug/remote.h"               /* Remote DB code by Rich Buckley */
#include "serial_lib.h"                 /* Local Dual Serial library */

d71 1
a80 12

typedef struct
{
  int	debugit;
  int	tml;
  int	remotedb;
  int	tracker;
  int	pdebug;
  int	file;
  int	serial;
} SessionsAvailable;

a82 1

a87 9

/* Tracker SWIs */
#define Tracker_Open   0xcf000
#define Tracker_Close  0xcf001
#define Tracker_WriteS 0xcf003
#define Tracker_Simple 0xcf005

/* DebugIt SWIs */
#define DebugIt_WriteC 0x4ba82
@


1.9
log
@ * Overhauled how DebugLib options are handled.  Options are now held in
   an options structure internal to DebugLib.  Options are set one at a
   time by function calls, this makes it much easier to add new options
   over time.  debug_set_options and debug_output_device now deprecated,
   but still provided.  Updated StrongHelp manual to document this
   new behaviour.

 * Fixed trace output somewhat...should now look better on remotedb
   output (no extraneous CRs), and you can now set the trace device to
   be the same as the main debug device.  Setting trace device to "printf"
   now also works (file still to do, as you still can't "dfprintf" to file)

 * Added one of the new options function calls to the CLI_App test harness,
   to test functionality.

 * Improved the !MkCleans for the test harnesses.


Version 0.33. Tagged as 'DebugLib-0_33'
@
text
@d83 1
d122 3
@


1.8
log
@ * DebugLib now uses PDebug object and header from inside build tree
   Export.Lib directory.  Removed header and objects from DebugLib itself

 * Added stripdepend call to Makefile, requires new Library.

 * DebugLib.h now include "kernel.h", to stop complaints about
   _kernel_oserror


Version 0.26. Tagged as 'DebugLib-0_26'
@
text
@d34 4
d68 17
a84 1
/* --------------------------------------- DEBUG DEVICES ---------------------------------------- */
a98 3
/* Include the exported header */
#define DEBUGLIB
#include "DebugLib.h"
@


1.7
log
@--------
  * Added buffering support.
Detail:
-------
  * DebugLib output can now be buffered and then output.  This is primarily
    for debugging ROM modules that would be active before the parallel
    port is alive during boot up.  Two new functions have been added to
    support this; debug_output_buffer_on() and debug_output_buffer_off().
    Updated documentation to follow.
Admin:
------
  * Tested on RiscPC/NC with Parallel, DebugIt and System variable
    override of output settings.

Version 0.25. Tagged as 'DebugLib-0_25'
@
text
@d59 1
a59 1
#include "PDebug.h"                     /* PDebug by JSmith */
@


1.6
log
@ * Fixed bug in area debugging.  This bug meant that if you specified the
   levels to output as e.g. "Main,Error", dprintfs with "Error" as the level
   would not be output.  Tracked it down to a misbracketed expression.

 * Made it possible to debug debuglib by adding another macro
   "internal_dprintf".  To turn on internal debugging you must define
   "DEBUG" in the make system.


Version 0.22. Tagged as 'DebugLib-0_22'
@
text
@d105 3
@


1.5
log
@ * You can now specify the debug device that DebugLib uses for trace
   output with a system variable (DebugLib$TraceDevice_<taskname>).
   The corresponding behaviour for normal debug statements is now
   more appropriate. (i.e. The debug device specified in the variable is
   only initialised at the first call of debug_out_device())

 * Increased vsprintf buffer size to 1Kbyte (Previous buffer was overrun
   by some applications).  Could put in a hack to fprintf to Null: to
   discover the size, then create a big enough buffer to do the vsprintf...


Version 0.17. Tagged as 'DebugLib-0_17'
@
text
@d83 6
@


1.4
log
@  Updated Documentation for debug_initialise, to clarify some of the
parameters.
  Fixed a few cases where NULLs could be passed to strcpy etc. in
debug_initialise.
  VersionNum file now gets exported to the DebugLib's Export directory, so
you always know what version you've got compiled.
  Tidied some header files a bit.

Version 0.14. Tagged as 'DebugLib-0_14'
@
text
@d93 1
a93 1
#define Debug_Buffer_Size 256
@


1.3
log
@PDebug_DEBUG defined as '1' in include.h to avoid differing redefinition
error on compiling caused by PDebug.h. Both headers now only try to define
symbols if they're not already defined in an effort to avoid similar errors
in future.

No functional change - version number not updated.
@
text
@d79 3
a81 12
#define NULL_OUTPUT		0	/* No valid debugging mechanisms found */
#define TRACKER_OUTPUT		1	/* !Tracker by Andy Armstrong Debugging Output Window. */
#define PRINTF_OUTPUT		2	/* Standard printf statements with  a black background. */
#define NOTUSED_OUTPUT    	3	/* Not used. */
#define PDEBUG_OUTPUT		4	/* Parallel Port Debugging (JSmith). */
#define SOCKET_OUTPUT		5	/* Debug to Network Socket (RBuckley). */
#define DEBUGIT_OUTPUT		6	/* !List-Debug - Wimp based debug system (MChallis) */
#define TML_OUTPUT		7	/* TML Debugging Podule. */
#define FILE_OUTPUT		8	/* FILE output mode */
#define SERIAL_OUTPUT		9	/* Serial Port output - dual serial interface only */

#define no_devices		9	/* Number of debug devices available */
@


1.2
log
@Added Serial Output device.
Added CLI, Module and Toolbox test applications
Tidied various sections
Tidied StrongHelp manual
Removed remotedb from Libs folder, now fetched from build structure
Removed svcprint from Libs folder, wasn't being used
Added srccommit support

Version 0.10. Tagged as 'DebugLib-0_10'
@
text
@d44 3
a46 1
#define PDebug_DEBUG
d49 1
d51 1
d54 1
d56 1
@


1.1
log
@Debug Library used in Daytona project.  First CVS checkin
@
text
@d17 2
a18 5
/* File:    main.h                                                      */
/* Purpose: Header file for all things to do with Debugging.            */
/*                                                                      */
/* Author:  Neil Bingham (mailto:NBingham@@art.acorn.co.uk)              */
/* History: Tue 18th February 1997  ver 0.01 - Created.                 */
d21 3
d29 1
a29 4
/* Toolbox Libraries */
#include "toolbox.h"
#include "wimp.h"
#include "wimplib.h"
d34 8
a41 1
//#include "DebugLib.h"
d43 2
a44 5
/* Other Debug Devices */
#include "svcprint.h"			/* TML Podule */
#include "PDebug.h"			/* PDebug by JSmith */
#define Trace_TRACE  1
#include "Trace.h"			/* Trace by JSmith */
d46 1
d49 8
a56 1
#include "remote.h"			/* Remote DB code by Rich Buckley */
d68 1
d76 1
a76 1
#define WIMP_OUTPUT		3	/* Use wimp message boxes to output data (last resort). */
d82 1
d84 1
a84 1
#define no_devices		8	/* Number of debug devices available */
d87 3
d91 1
d98 3
a100 1
/* -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ END +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ */
d102 1
d104 1
@
