head	1.8;
access;
symbols
	ScrSaver-0_14-1_9_2_4:1.2.2.6
	ScrSaver-0_14-1_9_2_3:1.2.2.5
	ScrSaver-0_22:1.8
	RO_5_07:1.2.2.4
	bavison_ScrSaver-0_14:1.2.2.4
	ScrSaver-0_21:1.7
	ScrSaver-0_20:1.6
	dellis_autobuild_BaseSW:1.5
	ScrSaver-0_19:1.5
	sbrodie_sedwards_16Mar2000:1.4
	dcotton_autobuild_BaseSW:1.7
	ScrSaver-0_18:1.4
	ScrSaver-0_17:1.4
	ScrSaver-0_16:1.4
	ScrSaver-0_15:1.3
	mstphens_UrsulaRiscPCBuild_20Nov98:1.2.2.3
	Ursula_RiscPC:1.2.2.3.0.2
	rthornb_UrsulaBuild-19Aug1998:1.2.2.3
	UrsulaBuild_FinalSoftload:1.2.2.3
	rthornb_UrsulaBuild-12Aug1998:1.2.2.3
	aglover_UrsulaBuild-05Aug1998:1.2.2.3
	rthornb_UrsulaBuild-29Jul1998:1.2.2.3
	rthornb_UrsulaBuild-22Jul1998:1.2.2.3
	rthornb_UrsulaBuild-15Jul1998:1.2.2.3
	rthornb_UrsulaBuild-07Jul1998:1.2.2.3
	rthornb_UrsulaBuild-17Jun1998:1.2.2.3
	rthornb_UrsulaBuild-03Jun1998:1.2.2.3
	rthornb_UrsulaBuild-27May1998:1.2.2.3
	rleggett_ScrSaver-0_14:1.2.2.3
	rthornb_UrsulaBuild-21May1998:1.2.2.3
	rthornb_UrsulaBuild_01May1998:1.2.2.2
	afrost_NC2_Generic:1.1.1.7
	Spinner_B20_2:1.1.1.4
	Spinner_19_3:1.1.1.4
	Spinner_B18:1.1.1.4
	Spinner_B17:1.1.1.4
	Spinner_B15:1.1.1.4
	Ursula:1.2.0.2
	Ursula_bp:1.2
	Spin_merge:1.1.1.8
	Spinner_B14:1.1.1.4
	Spinner_B13:1.1.1.4
	Spinner_B12:1.1.1.4
	Spinner_B10:1.1.1.4
	Daytona:1.1.0.6
	Daytona_bp:1.1
	Spinner_B7:1.1.1.4
	ARTtmp_merge:1.1.1.1
	Spin_3Apr97:1.1.1.1
	ARTtmp:1.1.1.1.0.2
	initial:1.1.1.1
	Spinner:1.1.1;
locks; strict;
comment	@# @;


1.8
date	2012.01.14.23.04.54;	author srevill;	state Exp;
branches;
next	1.7;
commitid	JU2PiEXw1vP6acPv;

1.7
date	2000.12.15.16.14.58;	author nbingham;	state Exp;
branches;
next	1.6;

1.6
date	2000.12.14.18.22.38;	author nbingham;	state Exp;
branches;
next	1.5;

1.5
date	2000.08.17.13.54.46;	author dcotton;	state Exp;
branches;
next	1.4;

1.4
date	99.04.28.09.23.08;	author kbracey;	state Exp;
branches;
next	1.3;

1.3
date	99.04.28.09.07.48;	author kbracey;	state Exp;
branches;
next	1.2;

1.2
date	97.06.30.15.02.26;	author kbracey;	state Exp;
branches
	1.2.2.1;
next	1.1;

1.1
date	97.03.19.14.25.47;	author scormie;	state Exp;
branches
	1.1.1.1;
next	;

1.2.2.1
date	97.11.21.11.34.00;	author rleggett;	state Exp;
branches;
next	1.2.2.2;

1.2.2.2
date	98.03.26.14.47.15;	author rthornb;	state Exp;
branches;
next	1.2.2.3;

1.2.2.3
date	98.05.08.15.12.05;	author rleggett;	state Exp;
branches;
next	1.2.2.4;

1.2.2.4
date	2003.12.03.18.12.14;	author bavison;	state Exp;
branches;
next	1.2.2.5;

1.2.2.5
date	2012.05.08.21.38.17;	author rsprowson;	state Exp;
branches;
next	1.2.2.6;
commitid	vh8V3LWmZ9IdZX3w;

1.2.2.6
date	2015.08.01.09.06.36;	author rsprowson;	state Exp;
branches;
next	;
commitid	vprkYBnBr8wITxvy;

1.1.1.1
date	97.03.19.14.25.47;	author scormie;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	97.04.16.14.17.47;	author olove;	state Exp;
branches;
next	1.1.1.3;

1.1.1.3
date	97.04.22.13.03.03;	author olove;	state Exp;
branches;
next	1.1.1.4;

1.1.1.4
date	97.04.28.14.37.23;	author nturton;	state Exp;
branches;
next	1.1.1.5;

1.1.1.5
date	97.08.08.13.06.20;	author nturton;	state Exp;
branches;
next	1.1.1.6;

1.1.1.6
date	97.08.19.11.06.15;	author olove;	state Exp;
branches;
next	1.1.1.7;

1.1.1.7
date	97.08.19.13.51.44;	author nturton;	state Exp;
branches;
next	1.1.1.8;

1.1.1.8
date	98.09.21.15.28.23;	author kbracey;	state Exp;
branches;
next	;


desc
@@


1.8
log
@Replace "-wipe" with "x wipe" in makefiles to remove annoying errors.

Version 0.22. Tagged as 'ScrSaver-0_22'
@
text
@# Makefile for ScrSaver
#

#
# Paths
#
EXP_HDR = <export$dir>

#
# Generic options:
#
MKDIR   = cdir
AS      = objasm
CC      = cc
CMHG    = cmhg
CP      = copy
LD      = link
RM      = remove
WIPE    = x wipe
SHRINK  = ShrinkWrapZipCompress

AFLAGS = -depend !Depend -Stamp -quit
CFLAGS  = -c -depend !Depend -zM -zps1 -ff ${INCLUDES} ${DFLAGS}
CPFLAGS = ~cfr~v
WFLAGS  = ~c~v

#
# Libraries
#
CLIB      = CLIB:o.stubs
RLIB      = RISCOSLIB:o.risc_oslib
RSTUBS    = RISCOSLIB:o.rstubs
ROMSTUBS  = RISCOSLIB:o.romstubs
ROMCSTUBS = RISCOSLIB:o.romcstubs
ABSSYM    = RISC_OSLib:o.AbsSym

#
# Include files
#
INCLUDES = -IC:

LIBS     =

DFLAGS   =

#
# Program specific options:
#
COMPONENT = ScrSaver
TARGET    = aof.${COMPONENT}
APPTARGET = abs.!RunImage
RAMTARGET = rm.${COMPONENT}
OBJS      = o.header o.module
APPOBJS   = o.app
EXPORTS   = 

#
# Rule patterns
#
.c.o:;      ${CC} ${CFLAGS} -o $@@ $<
.cmhg.o:;   ${CMHG} -p -o $@@ $<
.s.o:;      ${AS} ${AFLAGS} $< $@@

#
# build a relocatable module:
#
all: ${RAMTARGET} ${APPTARGET}

# Binary Build Environment augmenting rules
BBETYPE   = local
bbe-local: bbe-generic-resources-get-alias
  ${MKDIR} ${BBEDIR}.Resources
  BBE_Export_Dir abs
  BBE_Export_File Resources.!Run
  BBE_Export_File Resources.Templates
  BBE_Export_Dir  Resources.${LOCALE}.${USERIF}.${UI_VARIANT}
  BBE_Export_Dir  Resources.UK.${USERIF}

#
# RISC OS ROM build rules:
#
rom: ${TARGET} ${APPTARGET}
        @@echo ${COMPONENT}: rom module built

export: ${EXPORTS}
        @@echo ${COMPONENT}: export complete

install_rom: ${TARGET}
        ${CP} ${TARGET} ${INSTDIR}.${COMPONENT} ${CPFLAGS}
        @@echo ${COMPONENT}: rom module installed

clean:
        ${WIPE} o.* ${WFLAGS}
        ${WIPE} linked.* ${WFLAGS}
        ${RM} ${TARGET}
        ${RM} ${RAMTARGET}
        ${RM} ${APPTARGET}
        @@echo ${COMPONENT}: cleaned

resources: ${APPTARGET}
        Set ScrSaverRes$Path Resources.${Locale}.${UserIF}.${UI_VARIANT}.,Resources.{Locale}.{UserIF}.,Resources.UK.{UserIF}.${UI_VARIANT}.,Resources.UK.{UserIF}.
        ${MKDIR} ${RESDIR}.ScrSaver
        ${CP} ${APPTARGET}                    ${RESDIR}.ScrSaver.!RunImage  ${CPFLAGS}
        ${CP} Resources.!Run                  ${RESDIR}.ScrSaver.!Run       ${CPFLAGS}
        ${CP} ScrSaverRes:Messages            ${RESDIR}.ScrSaver.Messages   ${CPFLAGS}
        ${CP} ScrSaverRes:Sprites             ${RESDIR}.ScrSaver.Sprites    ${CPFLAGS}
        ${CP} Resources.Templates             ${RESDIR}.ScrSaver.Templates  ${CPFLAGS}
        UnSet ScrSaverRes$Path
        @@echo ${COMPONENT}: resource files copied

#
# ROM target (re-linked at ROM Image build time)
#
${TARGET}: ${OBJS} ${ROMCSTUBS}
        ${LD} -o $@@ -aof ${OBJS} ${LIBS} ${ROMCSTUBS}

${APPTARGET}: ${APPOBJS}
	${MKDIR} abs
        ${LD} -aif -o $@@ ${APPOBJS} ${CLIB} ${RLIB}

#
# Final link for the ROM Image (using given base address)
#
rom_link:
        ${MKDIR} linked
        ${LD} -o linked.${COMPONENT} -rmf -base ${ADDRESS} ${TARGET} ${ABSSYM}
        ${CP} linked.${COMPONENT} ${LINKDIR}.${COMPONENT} ${CPFLAGS}
        @@echo ${COMPONENT}: rom_link complete

${RAMTARGET}: ${OBJS} ${CLIB}
        ${LD} -o $@@ -module ${OBJS} ${LIBS} ${CLIB}

${EXP_HDR}.${COMPONENT}: hdr.${COMPONENT}
#       ${CP} hdr.${COMPONENT} $@@ ${CPFLAGS}

# Dynamic dependencies:
@


1.7
log
@  Another BBE tweak.
Detail:
  Added another dependency on the rom rule to stop it cleaning away the
  resourcefs component and breaking the bbe.
Admin:
  Tested very briefly on Fun8JP Source & BBE builds.

Version 0.21. Tagged as 'ScrSaver-0_21'
@
text
@d19 1
a19 1
WIPE    = -wipe
@


1.6
log
@  BBE support
Detail:
  Private bbe rule added to cope with Resources in non-standard locations
  and the UI_VARIANT macro.
Admin:
  Tested on Fun8JP Source & BBE builds.  No code change.

Version 0.20. Tagged as 'ScrSaver-0_20'
@
text
@d82 1
a82 1
rom: ${TARGET}
@


1.5
log
@	Imported new resources for the Customer F 8 project.
Detail:
	The new resources are in the Reesources.Japan.NC2.Fun8JP directory.
Correspondingly the makefile has been made to look for the Sprites and
Messages file on the following paths in the order that they are shown:
        Resources.${Locale}.${UserIF}.${UI_VARIANT}.
        Resources.{Locale}.{UserIF}.
        Resources.UK.{UserIF}.${UI_VARIANT}.
        Resources.UK.{UserIF}.
        Where UI_VARIANT is a flag that can be passed in on the command line.
Admin:
	Some testing performed in a Customer F 8 build, but not extensively
tested.

Version 0.19. Tagged as 'ScrSaver-0_19'
@
text
@d69 10
@


1.4
log
@Moved !Run and Templates files out of language and user interface-specific
directories. Added Customer M screensaver.

Version 0.16. Tagged as 'ScrSaver-0_16'
@
text
@d91 1
d93 1
a93 1
        ${CP} ${APPTARGET}                               ${RESDIR}.ScrSaver.!RunImage  ${CPFLAGS}
d95 2
a96 1
        ${CP} LocalRes:${UserIF}.Messages     ${RESDIR}.ScrSaver.Messages   ${CPFLAGS}
d98 1
a98 1
        ${SHRINK} LocalRes:${UserIF}.Sprites  ${RESDIR}.ScrSaver.Sprites
@


1.3
log
@Spinner branch merged.
Modified to use srccommit.

Version 0.15. Tagged as 'ScrSaver-0_15'
@
text
@d93 1
a93 1
        ${CP} LocalRes:${UserIF}.!Run         ${RESDIR}.ScrSaver.!Run       ${CPFLAGS}
d95 1
a95 1
        ${CP} LocalRes:${UserIF}.Templates    ${RESDIR}.ScrSaver.Templates  ${CPFLAGS}
@


1.2
log
@Spinner branch merged
@
text
@d61 1
a61 1
.cmhg.o:;   ${CMHG} -o $@@ $<
a84 1
        ${WIPE} map.* ${WFLAGS}
d92 5
a96 4
        ${CP} ${APPTARGET}                     ${RESDIR}.ScrSaver.!RunImage  ${CPFLAGS}
        ${CP} Resources.${LOCALE}.!Run         ${RESDIR}.ScrSaver.!Run       ${CPFLAGS}
        ${CP} Resources.${LOCALE}.Templates    ${RESDIR}.ScrSaver.Templates  ${CPFLAGS}
        ${SHRINK} Resources.${LOCALE}.Sprites  ${RESDIR}.ScrSaver.Sprites
d114 1
a114 3
        ${MKDIR} map
        ${LD} -o linked.${COMPONENT} -map -bin -base ${ADDRESS} ${TARGET} ${ABSSYM} > map.${COMPONENT}
        truncate map.${COMPONENT} linked.${COMPONENT}
a124 23
o.app:	c.app
o.app:	C:h.swis
o.app:	C:h.kernel
o.app:	C:h.time
o.app:	C:h.math
o.app:	C:h.float
o.app:	C:h.os
o.app:	C:h.wimp
o.app:	C:h.sprite
o.app:	C:h.wimpt
o.app:	C:h.win
o.app:	C:h.res
o.app:	C:h.template
o.app:	C:h.event
o.app:	C:h.menu
o.app:	C:h.sprite
o.app:	C:h.bbc
o.app:	C:h.colourtran
o.app:	C:h.font
o.app:	C:h.drawmod
o.module:	c.module
o.module:	C:h.kernel
o.module:	h.module
@


1.2.2.1
log
@Service_ScreenBlanking only claimed if ScrSaver$Path is set.
@
text
@a146 1
o.app:	C:h.werr
@


1.2.2.2
log
@Removed dynamic dependancies from Makefiles and removed all reference to Prefix
@
text
@d127 24
@


1.2.2.3
log
@Removed resources rule from Makefile.
@
text
@d91 7
a97 7
#resources: ${APPTARGET}
#        ${MKDIR} ${RESDIR}.ScrSaver
#        ${CP} ${APPTARGET}                     ${RESDIR}.ScrSaver.!RunImage  ${CPFLAGS}
#        ${CP} Resources.${LOCALE}.!Run         ${RESDIR}.ScrSaver.!Run       ${CPFLAGS}
#        ${CP} Resources.${LOCALE}.Templates    ${RESDIR}.ScrSaver.Templates  ${CPFLAGS}
#        ${SHRINK} Resources.${LOCALE}.Sprites  ${RESDIR}.ScrSaver.Sprites
#        @@echo ${COMPONENT}: resource files copied
@


1.2.2.4
log
@  Build-related changes.
Detail:
  * Deletes the linked and map directories on clean
  * Links using -rmf -base instead of -bin -base, since the latter requires
    the 26-bit-only truncate tool
  * Added stripdepnd
Admin:
  Tested in a Tungsten build.
  Tagged as 'bavison_ScrSaver-0_14'
@
text
@d84 2
a85 2
        ${WIPE} linked ${WFLAGS}
        ${WIPE} map ${WFLAGS}
d115 2
a116 1
        ${LD} -o linked.${COMPONENT} -map -rmf -base ${ADDRESS} ${TARGET} ${ABSSYM} > map.${COMPONENT}
@


1.2.2.5
log
@Makefile recreated.
Warnings squashed.
Changed to use VersionNum.
Explicit rule for target 'app' written, so it at least compiles, but probably not relevant on this branch.
Participated in ROM build but not functionally tested.

Version 0.14, 1.9.2.3. Tagged as 'ScrSaver-0_14-1_9_2_3'
@
text
@a0 14
# Copyright 1997 Acorn Computers Ltd
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
d4 120
a123 24
COMPONENT   = ScrSaver
OBJS        = module
CINCLUDES   = -IC:
CMHGFILE    = header
CMHGDEPENDS = module
RES_OBJ     =
CUSTOMEXP   = custom
CUSTOMRES   = custom

include CModule

resources:
        @@${ECHO} ${COMPONENT}: no resources

clean::
        ${XWIPE} !SaverAni ${WFLAGS}

app:
        ${MKDIR} o
        ${MKDIR} !SaverAni
        ${CC} -c -IRISC_OSLib: app.c
        ${LD} -o !SaverAni.!RunImage -aif app.o ${RLIB} ${CLIB}
        ${CP} LocalRes:!Run !SaverAni.!Run ${CPFLAGS}
        ${CP} LocalRes:Templates !SaverAni.Templates ${CPFLAGS}
@


1.2.2.6
log
@Makefile amendment
Use CUSTOMRES=no to denote no resources.

Version 0.14, 1.9.2.4. Tagged as 'ScrSaver-0_14-1_9_2_4'
@
text
@d23 3
a25 2
HDRS        =
CUSTOMRES   = no
d29 3
@


1.1
log
@Initial revision
@
text
@d20 1
d50 3
a52 1
TARGET    = aof.ScrSaver
d54 1
d67 1
a67 1
all: rm.ScrSaver
a83 1
        ${WIPE} rm.* ${WFLAGS}
d87 2
d91 1
a91 1
resources:
d93 4
a96 2
        ${CP} Resources.${LOCALE}.!Run  ${RESDIR}.ScrSaver.!Run  ${CPFLAGS}
        ${CP} Resources.${LOCALE}.!RunImage  ${RESDIR}.ScrSaver.!RunImage  ${CPFLAGS}
d105 4
d120 1
a120 1
rm.ScrSaver: ${OBJS} ${CLIB}
d127 20
@


1.1.1.1
log
@Initial version.

@
text
@@


1.1.1.2
log
@Added reference to sprite file in the MakeFile
@
text
@a89 1
        ${CP} Resources.${LOCALE}.Sprites  ${RESDIR}.ScrSaver.Sprites  ${CPFLAGS}        
@


1.1.1.3
log
@Altered Makefile to build application from C and Shrinkwrapped sprites
@
text
@a19 1
SHRINK  = ShrinkWrapZipCompress
d49 1
a49 3
TARGET    = aof.${COMPONENT}
APPTARGET = abs.!RunImage
RAMTARGET = rm.${COMPONENT}
a50 1
APPOBJS   = o.app
d63 1
a63 1
all: ${RAMTARGET} ${APPTARGET}
d80 1
a83 2
        ${RM} ${RAMTARGET}
        ${RM} ${APPTARGET}
d86 1
a86 1
resources: ${APPTARGET}
d88 3
a90 4
        ${CP} ${APPTARGET}                     ${RESDIR}.ScrSaver.!RunImage  ${CPFLAGS}
        ${CP} Resources.${LOCALE}.!Run         ${RESDIR}.ScrSaver.!Run       ${CPFLAGS}
        ${CP} Resources.${LOCALE}.Templates    ${RESDIR}.ScrSaver.Templates  ${CPFLAGS}
        ${SHRINK} Resources.${LOCALE}.Sprites  ${RESDIR}.ScrSaver.Sprites
a98 3
${APPTARGET}: ${APPOBJS}
        ${LD} -aif -o $@@ ${APPOBJS} ${CLIB} ${RLIB}

d110 1
a110 1
${RAMTARGET}: ${OBJS} ${CLIB}
a119 20
o.app:	c.app
o.app:	C:h.swis
o.app:	C:h.kernel
o.app:	C:h.time
o.app:	C:h.math
o.app:	C:h.float
o.app:	C:h.os
o.app:	C:h.wimp
o.app:	C:h.sprite
o.app:	C:h.wimpt
o.app:	C:h.win
o.app:	C:h.res
o.app:	C:h.template
o.app:	C:h.event
o.app:	C:h.menu
o.app:	C:h.sprite
o.app:	C:h.bbc
o.app:	C:h.colourtran
o.app:	C:h.font
o.app:	C:h.drawmod
@


1.1.1.4
log
@Create abs directory as required
@
text
@a105 1
	${MKDIR} abs
d126 3
a148 3
o.module:	c.module
o.module:	C:h.kernel
o.module:	h.module
@


1.1.1.5
log
@Added Zenith resources
@
text
@d96 1
a96 3
        Set SpriteFile Resources.${LOCALE}.Sprites
        IfThere Resources.${LOCALE}.${SYSTEM}.Sprites Then Set SpriteFile Resources.${LOCALE}.${SYSTEM}.Sprites
        ${SHRINK} <SpriteFile>  ${RESDIR}.ScrSaver.Sprites
a126 3
o.module:	c.module
o.module:	C:h.kernel
o.module:	h.module
d147 3
a149 1
o.app:	C:h.werr
@


1.1.1.6
log
@Updated Makefile to use separate resources for Customer R / Acorn NC
@
text
@d93 6
a98 5
        ${CP} ${APPTARGET}                               ${RESDIR}.ScrSaver.!RunImage  ${CPFLAGS}
        ${CP} Resources.${LOCALE}.${SYSTEM}.!Run         ${RESDIR}.ScrSaver.!Run       ${CPFLAGS}
        ${CP} Resources.${LOCALE}.${SYSTEM}.Messages     ${RESDIR}.ScrSaver.Messages   ${CPFLAGS}
        ${CP} Resources.${LOCALE}.${SYSTEM}.Templates    ${RESDIR}.ScrSaver.Templates  ${CPFLAGS}
        ${SHRINK} Resources.${LOCALE}.${SYSTEM}.Sprites  ${RESDIR}.ScrSaver.Sprites
@


1.1.1.7
log
@Changed to switch on UserIF instead of System
@
text
@d94 4
a97 4
        ${CP} Resources.${LOCALE}.${UserIF}.!Run         ${RESDIR}.ScrSaver.!Run       ${CPFLAGS}
        ${CP} Resources.${LOCALE}.${UserIF}.Messages     ${RESDIR}.ScrSaver.Messages   ${CPFLAGS}
        ${CP} Resources.${LOCALE}.${UserIF}.Templates    ${RESDIR}.ScrSaver.Templates  ${CPFLAGS}
        ${SHRINK} Resources.${LOCALE}.${UserIF}.Sprites  ${RESDIR}.ScrSaver.Sprites
@


1.1.1.8
log
@Makefile modified to use LocalRes$Path and Link 5.08.
@
text
@d85 1
d94 4
a97 4
        ${CP} LocalRes:${UserIF}.!Run         ${RESDIR}.ScrSaver.!Run       ${CPFLAGS}
        ${CP} LocalRes:${UserIF}.Messages     ${RESDIR}.ScrSaver.Messages   ${CPFLAGS}
        ${CP} LocalRes:${UserIF}.Templates    ${RESDIR}.ScrSaver.Templates  ${CPFLAGS}
        ${SHRINK} LocalRes:${UserIF}.Sprites  ${RESDIR}.ScrSaver.Sprites
d115 3
a117 1
        ${LD} -o linked.${COMPONENT} -rmf -base ${ADDRESS} ${TARGET} ${ABSSYM}
d128 24
@
