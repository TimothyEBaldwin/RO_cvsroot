head	1.36;
access;
symbols
	ScrnSetup-0_43:1.36
	ScrnSetup-0_42:1.35
	ScrnSetup-0_41:1.34
	ScrnSetup-0_40:1.33
	ScrnSetup-0_39:1.32
	ScrnSetup-0_38:1.31
	ScrnSetup-0_37:1.30
	ScrnSetup-0_36:1.29
	ScrnSetup-0_35:1.28
	ScrnSetup-0_34:1.27
	ScrnSetup-0_33:1.26
	ScrnSetup-0_32:1.25
	ScrnSetup-0_31:1.24
	ScrnSetup-0_30:1.23
	ScrnSetup-0_29:1.22
	ScrnSetup-0_28:1.21
	ScrnSetup-0_27:1.20
	ScrnSetup-0_26:1.19
	ScrnSetup-0_25:1.18
	ScrnSetup-0_24:1.17
	ScrnSetup-0_23:1.16
	ScrnSetup-0_22:1.15
	ScrnSetup-0_21:1.14
	ScrnSetup-0_20:1.13
	ScrnSetup-0_19:1.12
	ScrnSetup-0_18:1.11
	ScrnSetup-0_17:1.10
	ScrnSetup-0_16:1.9
	ScrnSetup-0_15:1.8
	ScrnSetup-0_14:1.7
	ScrnSetup-0_13:1.6
	ScrnSetup-0_12:1.5
	ScrnSetup-0_11:1.4
	ScrnSetup-0_10:1.3
	ScrnSetup-0_09:1.2;
locks; strict;
comment	@# @;


1.36
date	2018.08.26.17.32.37;	author rsprowson;	state Exp;
branches;
next	1.35;
commitid	q20Wi4Z6RRohFEPA;

1.35
date	2018.04.14.17.52.47;	author rsprowson;	state Exp;
branches;
next	1.34;
commitid	4WDNwmdnQD6f5ryA;

1.34
date	2017.04.08.20.14.34;	author rool;	state Exp;
branches;
next	1.33;
commitid	dMN8yIo9bZlfNLMz;

1.33
date	2017.03.05.15.35.46;	author rool;	state Exp;
branches;
next	1.32;
commitid	pXgDBRq60MdmlnIz;

1.32
date	2016.08.04.08.05.57;	author rsprowson;	state Exp;
branches;
next	1.31;
commitid	Vu6lBW12jz6xHXgz;

1.31
date	2016.08.02.17.54.22;	author rsprowson;	state Exp;
branches;
next	1.30;
commitid	O1Nr1KXUCG5o1Lgz;

1.30
date	2016.05.19.19.59.37;	author rsprowson;	state Exp;
branches;
next	1.29;
commitid	2IeQPndzgzxO787z;

1.29
date	2016.05.18.21.26.35;	author rsprowson;	state Exp;
branches;
next	1.28;
commitid	ZXaRZP5oar7ED07z;

1.28
date	2016.05.18.21.19.14;	author rsprowson;	state Exp;
branches;
next	1.27;
commitid	HMZqYtNJWkx7B07z;

1.27
date	2016.02.01.20.33.58;	author jlee;	state Exp;
branches;
next	1.26;
commitid	crlomV5WYUgPMfTy;

1.26
date	2015.05.11.07.25.46;	author rsprowson;	state Exp;
branches;
next	1.25;
commitid	P3vMabTzcbhyYZky;

1.25
date	2014.10.15.08.08.53;	author rsprowson;	state Exp;
branches;
next	1.24;
commitid	Sqz3279VmgsRTgUx;

1.24
date	2014.09.15.08.53.58;	author rsprowson;	state Exp;
branches;
next	1.23;
commitid	pg8BBGtIW1t77qQx;

1.23
date	2014.02.09.13.02.05;	author rsprowson;	state Exp;
branches;
next	1.22;
commitid	ureZvxROBfkGuqox;

1.22
date	2013.12.18.13.22.15;	author jlee;	state Exp;
branches;
next	1.21;
commitid	MJRQNzj7JbmejChx;

1.21
date	2013.12.15.22.12.00;	author jlee;	state Exp;
branches;
next	1.20;
commitid	KqO0dfOA3DjWkhhx;

1.20
date	2013.07.31.07.13.02;	author rsprowson;	state Exp;
branches;
next	1.19;
commitid	JnHIm805T7MzLAZw;

1.19
date	2013.07.17.19.50.15;	author rsprowson;	state Exp;
branches;
next	1.18;
commitid	BZtxXveSUP5fpRXw;

1.18
date	2013.01.17.21.24.00;	author rsprowson;	state Exp;
branches;
next	1.17;
commitid	oUFvl5G78V97KBAw;

1.17
date	2012.10.06.00.08.28;	author jlee;	state Exp;
branches;
next	1.16;
commitid	PDyBVCjLEG5OZfnw;

1.16
date	2012.08.28.20.57.40;	author jlee;	state Exp;
branches;
next	1.15;
commitid	4NuHSXS9qPu4amiw;

1.15
date	2012.08.22.16.58.24;	author rsprowson;	state Exp;
branches;
next	1.14;
commitid	jOeRqWIJpSkX1zhw;

1.14
date	2012.07.22.09.46.30;	author rsprowson;	state Exp;
branches;
next	1.13;
commitid	h015P4FWeP2zDxdw;

1.13
date	2012.06.26.23.40.30;	author jlee;	state Exp;
branches;
next	1.12;
commitid	qPBJ2veAN8Fu5haw;

1.12
date	2012.02.12.15.46.21;	author rsprowson;	state Exp;
branches;
next	1.11;
commitid	AITMkVfdGV9SNSSv;

1.11
date	2012.02.11.18.26.17;	author rsprowson;	state Exp;
branches;
next	1.10;
commitid	Tn70qsPfKA3JILSv;

1.10
date	2012.01.14.23.02.20;	author srevill;	state Exp;
branches;
next	1.9;
commitid	JuiqyFeJQeBe9cPv;

1.9
date	2011.04.13.22.44.55;	author jlee;	state Exp;
branches;
next	1.8;
commitid	usaqYFvcXuqiVIfv;

1.8
date	2010.01.27.19.31.37;	author srevill;	state Exp;
branches;
next	1.7;

1.7
date	2009.10.25.15.53.00;	author jlee;	state Exp;
branches;
next	1.6;

1.6
date	2009.10.24.23.03.10;	author jlee;	state Exp;
branches;
next	1.5;

1.5
date	2003.06.18.15.40.00;	author rsprowson;	state Exp;
branches;
next	1.4;

1.4
date	2003.02.02.23.00.28;	author rsprowson;	state Exp;
branches;
next	1.3;

1.3
date	2002.12.19.22.50.47;	author srevill;	state Exp;
branches;
next	1.2;

1.2
date	2002.12.14.13.27.37;	author srevill;	state Exp;
branches;
next	1.1;

1.1
date	2002.12.14.12.43.36;	author rsprowson;	state Exp;
branches;
next	;


desc
@@


1.36
log
@Fix handle and memory leaks on error
screen.c: if the destination file couldn't be opened, don't leak the source file; and when there are no disc based screen savers don't leak menustring (since the built in DPMS saver name doesn't need allocating - it can go straight into the stringset gadget).
Found by cppcheck static analysis.

Version 0.43. Tagged as 'ScrnSetup-0_43'
@
text
@/* (0.43)
 *
 * This file is automatically maintained by srccommit, do not edit manually.
 * Last processed by srccommit version: 1.1.
 *
 */
#define Module_MajorVersion_CMHG        0.43
#define Module_MinorVersion_CMHG        
#define Module_Date_CMHG                26 Aug 2018

#define Module_MajorVersion             "0.43"
#define Module_Version                  43
#define Module_MinorVersion             ""
#define Module_Date                     "26 Aug 2018"

#define Module_ApplicationDate          "26-Aug-18"

#define Module_ComponentName            "ScrnSetup"
#define Module_ComponentPath            "castle/RiscOS/Sources/SystemRes/Configure2/PlugIns/ScrnSetup"

#define Module_FullVersion              "0.43"
#define Module_HelpVersion              "0.43 (26 Aug 2018)"
#define Module_LibraryVersionInfo       "0:43"
@


1.35
log
@Improve fading logic when unselecting Native
When the previously configured mode was Native, in order to avoid accessing the colour flags array with a -ve index, the depth was arbitrarily set to 1bpp.
However, if the graphics controller doesn't support 1bpp the search would exit with no matches the the colour/frame rate popups remained greyed and unselectable.
Instead let the loop run up to the highest colour depth (16M), the best match logic will pick the best colour/frame rate combination, but more importantly the GUI controls will be activated.

Version 0.42. Tagged as 'ScrnSetup-0_42'
@
text
@d1 1
a1 1
/* (0.42)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.42
d9 1
a9 1
#define Module_Date_CMHG                14 Apr 2018
d11 2
a12 2
#define Module_MajorVersion             "0.42"
#define Module_Version                  42
d14 1
a14 1
#define Module_Date                     "14 Apr 2018"
d16 1
a16 1
#define Module_ApplicationDate          "14-Apr-18"
d21 3
a23 3
#define Module_FullVersion              "0.42"
#define Module_HelpVersion              "0.42 (14 Apr 2018)"
#define Module_LibraryVersionInfo       "0:42"
@


1.34
log
@Minor UI improvements
Detail:
  Move the resolution picker menu after the monitor type picker menu, so the logical order flows better.
  Fix for failure to unshade menus after cancelling a 'Try' operation with the Auto monitor type.
  Improve the clarity of the magic EDID entry by using the text 'Auto (BrandX 123GTI)' in the menu so it stands out from other non-Auto detected types.
Admin:
  Submission for the EDID bounty.

Version 0.41. Tagged as 'ScrnSetup-0_41'
@
text
@d1 1
a1 1
/* (0.41)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.41
d9 1
a9 1
#define Module_Date_CMHG                08 Apr 2017
d11 2
a12 2
#define Module_MajorVersion             "0.41"
#define Module_Version                  41
d14 1
a14 1
#define Module_Date                     "08 Apr 2017"
d16 1
a16 1
#define Module_ApplicationDate          "08-Apr-17"
d21 3
a23 3
#define Module_FullVersion              "0.41"
#define Module_HelpVersion              "0.41 (08 Apr 2017)"
#define Module_LibraryVersionInfo       "0:41"
@


1.33
log
@Add support for EDID monitors in the system
Detail:
  Upgrade the MDF directory enumeration to minimally parse EDID data blobs. Add these to the list of known monitors. This allows a disc based MDF to override faulty data in the monitor, or on systems such as IOMD that don't support EDID, for them to benefit from a library of blobs rather than needing a parallel set of MDFs creating.
  Add the path of EDID blobs exported by ScrModes to those scanned for monitor definitions. EDID data is always placed in the top level manufacturer menu below 'Auto'.
  Add interactive help to clarify what 'Auto' means and how it differs from the EDID data.

  common.c: Relocate [un]grey_gadget() from screen.c.
  main.c: Simplify unnecessary memset(). Create a flag based on ScreenModes_Features whether the host OS supports EDID or not.
  monitor.c: Extra scanning. Conflict resolution if duplicate monitor definitions exist from differing sources. Simple EDID parser to get the monitor name (else default string) and DPMS flags.
Admin:
  Submission for the EDID bounty.
  Tested with ScrModes-0_61, and also on earlier versions, on RISC OS 5.23.
  Briefly tested on RISC OS 3.70 with !Boot.Resources.Configure.Monitors containing EDID data (should be ignored).

Version 0.40. Tagged as 'ScrnSetup-0_40'
@
text
@d1 1
a1 1
/* (0.40)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.40
d9 1
a9 1
#define Module_Date_CMHG                05 Mar 2017
d11 2
a12 2
#define Module_MajorVersion             "0.40"
#define Module_Version                  40
d14 1
a14 1
#define Module_Date                     "05 Mar 2017"
d16 1
a16 1
#define Module_ApplicationDate          "05-Mar-17"
d21 3
a23 3
#define Module_FullVersion              "0.40"
#define Module_HelpVersion              "0.40 (05 Mar 2017)"
#define Module_LibraryVersionInfo       "0:40"
@


1.32
log
@Fix for Auto setting not being stored
3rd time's a charm: in changing from a stringset changed to a menu selection event, nothing was updating the globals holding the monitor details for the Auto case calling switch_monitor(). Move that call so it is.
Change menus_are_grey to a boolean.

Version 0.39. Tagged as 'ScrnSetup-0_39'
@
text
@d1 1
a1 1
/* (0.39)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.39
d9 1
a9 1
#define Module_Date_CMHG                04 Aug 2016
d11 2
a12 2
#define Module_MajorVersion             "0.39"
#define Module_Version                  39
d14 1
a14 1
#define Module_Date                     "04 Aug 2016"
d16 1
a16 1
#define Module_ApplicationDate          "04-Aug-16"
d21 3
a23 3
#define Module_FullVersion              "0.39"
#define Module_HelpVersion              "0.39 (04 Aug 2016)"
#define Module_LibraryVersionInfo       "0:39"
@


1.31
log
@Fix for thinking 0th model is Auto type
The current_montype variable now holds the entry number within the menu for the selected manufacturer, whereas it used to be the current entry for the 1 (and only) models menu.
So, when selecting any 0th model from a submenu this would be mistaken as the former 'Auto' entry, and the PreDesk$Configure file wiped out.

Rescope current_montype to be static so it can only be used for its intended purpose, and derive 'Auto' or not in set_monitor_choices() by whether the filename is NULL like elsewhere.
Use defines when calling OS_ScreenMode rather than magic numbers.
Should fix issue described in https://www.riscosopen.org/forum/forums/11/topics/6370 introduced in ScrnSetup-0_36.

Version 0.38. Tagged as 'ScrnSetup-0_38'
@
text
@d1 1
a1 1
/* (0.38)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.38
d9 1
a9 1
#define Module_Date_CMHG                02 Aug 2016
d11 2
a12 2
#define Module_MajorVersion             "0.38"
#define Module_Version                  38
d14 1
a14 1
#define Module_Date                     "02 Aug 2016"
d16 1
a16 1
#define Module_ApplicationDate          "02-Aug-16"
d21 3
a23 3
#define Module_FullVersion              "0.38"
#define Module_HelpVersion              "0.38 (02 Aug 2016)"
#define Module_LibraryVersionInfo       "0:38"
@


1.30
log
@Make the previous selection more obvious
Having chosen a monitor type from within a group, it wasn't very obvious from which group it came.
Follow the same behaviour as a font menu: tick the parent when an exclusive selection is made from its child.

Version 0.37. Tagged as 'ScrnSetup-0_37'
@
text
@d1 1
a1 1
/* (0.37)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.37
d9 1
a9 1
#define Module_Date_CMHG                19 May 2016
d11 2
a12 2
#define Module_MajorVersion             "0.37"
#define Module_Version                  37
d14 1
a14 1
#define Module_Date                     "19 May 2016"
d16 1
a16 1
#define Module_ApplicationDate          "19-May-16"
d21 3
a23 3
#define Module_FullVersion              "0.37"
#define Module_HelpVersion              "0.37 (19 May 2016)"
#define Module_LibraryVersionInfo       "0:37"
@


1.29
log
@Group manufacturers together in the type menu
The plugin scans all the subdirectories of BootResources:Configure.Monitors but then presents the findings unsorted in a huge menu. Now there are lots of MDFs the menu is so big it has a scrollbox too.
To simplify this, and make finding the right one easier, collect up the monitors by manufacturer (inferred from name of the topmost directory) into submenus.
Tested on a Risc PC with a mix of complexities of subdirectories from a default !Boot.

Version 0.36. Tagged as 'ScrnSetup-0_36'
@
text
@d1 1
a1 1
/* (0.36)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.36
d9 1
a9 1
#define Module_Date_CMHG                18 May 2016
d11 2
a12 2
#define Module_MajorVersion             "0.36"
#define Module_Version                  36
d14 1
a14 1
#define Module_Date                     "18 May 2016"
d16 1
a16 1
#define Module_ApplicationDate          "18-May-16"
d21 3
a23 3
#define Module_FullVersion              "0.36"
#define Module_HelpVersion              "0.36 (18 May 2016)"
#define Module_LibraryVersionInfo       "0:36"
@


1.28
log
@Make monitor type into a display field + popup menu
Was previously a StringSet, but these are limited to only one level of menu tree.
Turned off "Deliver event before showing" for the popups in the main window, since nothing registered events against them.
No longer spends an eternity rebuilding the monitors menu when adjust clicking on 'Cancel', because the read_choices() function also used to scan the MDFs to make the menu. Now it really does just read the choices back in.
Correction to interactive help for the "Resolution" menu - the guidance about square and rectangular pixels was back to front.

Version 0.35. Tagged as 'ScrnSetup-0_35'
@
text
@d1 1
a1 1
/* (0.35)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.35
d11 2
a12 2
#define Module_MajorVersion             "0.35"
#define Module_Version                  35
d21 3
a23 3
#define Module_FullVersion              "0.35"
#define Module_HelpVersion              "0.35 (18 May 2016)"
#define Module_LibraryVersionInfo       "0:35"
@


1.27
log
@Increase screen mode "try" timeout from 5 to 10 seconds
Detail:
  h/defines - Increase DisplayTestDuration to 10 seconds
  Resources/UK/Messsages - Update warning message to say 'ten'
Admin:
  Tested on Iyonix
  Should fix problem reported on forums where 5 second timeout wasn't long enough to be any use when using an HDMI splitter:
  https://www.riscosopen.org/forum/forums/5/topics/3867


Version 0.34. Tagged as 'ScrnSetup-0_34'
@
text
@d1 1
a1 1
/* (0.34)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.34
d9 1
a9 1
#define Module_Date_CMHG                01 Feb 2016
d11 2
a12 2
#define Module_MajorVersion             "0.34"
#define Module_Version                  34
d14 1
a14 1
#define Module_Date                     "01 Feb 2016"
d16 1
a16 1
#define Module_ApplicationDate          "01-Feb-16"
d21 3
a23 3
#define Module_FullVersion              "0.34"
#define Module_HelpVersion              "0.34 (01 Feb 2016)"
#define Module_LibraryVersionInfo       "0:34"
@


1.26
log
@Enlarge text clipping boxes
In system font, some text got clipped.

Version 0.33. Tagged as 'ScrnSetup-0_33'
@
text
@d1 1
a1 1
/* (0.33)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.33
d9 1
a9 1
#define Module_Date_CMHG                11 May 2015
d11 2
a12 2
#define Module_MajorVersion             "0.33"
#define Module_Version                  33
d14 1
a14 1
#define Module_Date                     "11 May 2015"
d16 1
a16 1
#define Module_ApplicationDate          "11-May-15"
d21 3
a23 3
#define Module_FullVersion              "0.33"
#define Module_HelpVersion              "0.33 (11 May 2015)"
#define Module_LibraryVersionInfo       "0:33"
@


1.25
log
@Look for territory specific messages before falling back to en-gb
To build the screen saver 'Info' menu this plugin reaches into the screensaver to get the purpose/author/version fields from its messages, however was not respecting any territory selection.
This change emulates how Toolbox_Initialise would look and is essentially a repeat of ticket #367.
Also - the return registers for MessageTrans_FileInfo were wrong, R0 and R2 (not R1 and R2) but since the flags were never used, this is easier to delete.

Version 0.32. Tagged as 'ScrnSetup-0_32'
@
text
@d1 1
a1 1
/* (0.32)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.32
d9 1
a9 1
#define Module_Date_CMHG                15 Oct 2014
d11 2
a12 2
#define Module_MajorVersion             "0.32"
#define Module_Version                  32
d14 1
a14 1
#define Module_Date                     "15 Oct 2014"
d16 1
a16 1
#define Module_ApplicationDate          "15-Oct-14"
d21 3
a23 3
#define Module_FullVersion              "0.32"
#define Module_HelpVersion              "0.32 (15 Oct 2014)"
#define Module_LibraryVersionInfo       "0:32"
@


1.24
log
@Display field resized
Monitor display field was 56 tall, when Style Guide says 52 (as the others are).

Version 0.31. Tagged as 'ScrnSetup-0_31'
@
text
@d1 1
a1 1
/* (0.31)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.31
d9 1
a9 1
#define Module_Date_CMHG                15 Sep 2014
d11 2
a12 2
#define Module_MajorVersion             "0.31"
#define Module_Version                  31
d14 1
a14 1
#define Module_Date                     "15 Sep 2014"
d16 1
a16 1
#define Module_ApplicationDate          "15-Sep-14"
d21 3
a23 3
#define Module_FullVersion              "0.31"
#define Module_HelpVersion              "0.31 (15 Sep 2014)"
#define Module_LibraryVersionInfo       "0:31"
@


1.23
log
@Leave the selected monitor type correct after hitting 'Set'
When the monitor type is Auto at startup (type=3) and the user selects a monitor from an MDF (type=7) when pressing 'Set' the temporary instance of the ScreenModes module is killed off (in program_exit()) which restores the monitor type back to what it was when starting (type=3). That leaves DisplayManager thinking there's an MDF loaded, but the base instance of ScreenModes thinking not.
main.c/defines.h:
Minor unrelated clean ups.
monitor.c:
When saving the settings, kill off the temporary instance, apply the setting, then create a new one - this is much like adjust clicking on cancel does.
Complete a TODO with an error message if the settings file wont open.
Messages;
New error token for the TODO.

Fixes ticket #372.

Version 0.30. Tagged as 'ScrnSetup-0_30'
@
text
@d1 1
a1 1
/* (0.30)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.30
d9 1
a9 1
#define Module_Date_CMHG                09 Feb 2014
d11 2
a12 2
#define Module_MajorVersion             "0.30"
#define Module_Version                  30
d14 1
a14 1
#define Module_Date                     "09 Feb 2014"
d16 1
a16 1
#define Module_ApplicationDate          "09-Feb-14"
d21 3
a23 3
#define Module_FullVersion              "0.30"
#define Module_HelpVersion              "0.30 (09 Feb 2014)"
#define Module_LibraryVersionInfo       "0:30"
@


1.22
log
@Fix a couple of issues
Detail:
  Resources/UK/Res,fae - Change the default Colours box text to "4096 colours", as it's now the longest string the box needs to display. Fixes "buffer too short" error when trying to select a 4K colour mode.
  c/monitor - Adjust switch_colour() so that it checks both the X and Y dimensions when finding the new mode instead of just the X dimension. Avoids the selection unintentionally switching to the tallest available mode with the matching width when all you want to do is change the number of colours.
  c/monitor - Adjust update_monitor_displayfields() so that the monitor text box is only reset to "Auto" if it failed to find a monitor. Fixes a visible flicker on some machines due to the display temporarily switching to "Auto" when changing settings.
Admin:
  Tested on RiscPC with latest ROM softload


Version 0.29. Tagged as 'ScrnSetup-0_29'
@
text
@d1 1
a1 1
/* (0.29)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.29
d9 1
a9 1
#define Module_Date_CMHG                18 Dec 2013
d11 2
a12 2
#define Module_MajorVersion             "0.29"
#define Module_Version                  29
d14 1
a14 1
#define Module_Date                     "18 Dec 2013"
d16 1
a16 1
#define Module_ApplicationDate          "18-Dec-13"
d21 3
a23 3
#define Module_FullVersion              "0.29"
#define Module_HelpVersion              "0.29 (18 Dec 2013)"
#define Module_LibraryVersionInfo       "0:29"
@


1.21
log
@Update to add support for new screen modes
Detail:
  Resources/UK/Res,fae - Add new 4K and 64K entries to colours menu
  c/monitor - Generalise mode provider block parsing to deal with the fact we might encounter both new and old format blocks. Rework handling of colour menu entries and colour selection to deal with 4K & 64K modes and the possibility of RGB/alpha variants. Update PreDesk configuration file parsing to prefer to use OS_ScreenMode 13 where possible.
Admin:
  Tested on Iyonix & BB with new and old ROMs
  Requires Kernel-5_35-4_79_2_203 to build


Version 0.28. Tagged as 'ScrnSetup-0_28'
@
text
@d1 1
a1 1
/* (0.28)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.28
d9 1
a9 1
#define Module_Date_CMHG                15 Dec 2013
d11 2
a12 2
#define Module_MajorVersion             "0.28"
#define Module_Version                  28
d14 1
a14 1
#define Module_Date                     "15 Dec 2013"
d16 1
a16 1
#define Module_ApplicationDate          "15-Dec-13"
d21 3
a23 3
#define Module_FullVersion              "0.28"
#define Module_HelpVersion              "0.28 (15 Dec 2013)"
#define Module_LibraryVersionInfo       "0:28"
@


1.20
log
@Correction to system variable name
Allocated application name and system variable name sync'd

Version 0.27. Tagged as 'ScrnSetup-0_27'
@
text
@d1 1
a1 1
/* (0.27)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.27
d9 1
a9 1
#define Module_Date_CMHG                31 Jul 2013
d11 2
a12 2
#define Module_MajorVersion             "0.27"
#define Module_Version                  27
d14 1
a14 1
#define Module_Date                     "31 Jul 2013"
d16 1
a16 1
#define Module_ApplicationDate          "31-Jul-13"
d21 3
a23 3
#define Module_FullVersion              "0.27"
#define Module_HelpVersion              "0.27 (31 Jul 2013)"
#define Module_LibraryVersionInfo       "0:27"
@


1.19
log
@Makefile updated for BuildSys-6_20

Version 0.26. Tagged as 'ScrnSetup-0_26'
@
text
@d1 1
a1 1
/* (0.26)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.26
d9 1
a9 1
#define Module_Date_CMHG                17 Jul 2013
d11 2
a12 2
#define Module_MajorVersion             "0.26"
#define Module_Version                  26
d14 1
a14 1
#define Module_Date                     "17 Jul 2013"
d16 1
a16 1
#define Module_ApplicationDate          "17-Jul-13"
d21 3
a23 3
#define Module_FullVersion              "0.26"
#define Module_HelpVersion              "0.26 (17 Jul 2013)"
#define Module_LibraryVersionInfo       "0:26"
@


1.18
log
@Minor ScrnSetup improvements
* Get OS_Byte/OS_File/filetypes/CMOS/OS_Module defs from header files.
* Fix ticket #312 (misuse of OS_GBPB means enumerating dirs on a non FileCore filing system could get stuck).
* Simplify the steps in the mode 'Try' sequence, now the mouse is bounded in the 'Keep/Cancel' message box (with the same 5s timeout) so that you can't click elsewhere on the main window. Previously, you could click 'Set', then the 5s would elapse and the mode revert to not the one you set.
* Window size is now compared with screensize on startup and the V scroll bar turned on/off as needed.

Note that in reviewing the plugins the minimum resolution considered to fit without scroll bars is 640x480, a special case is made of the screen setup plugin in case it starts in some mode less than that and you can't reach the 'OK' button to set it to anything else.

Version 0.25. Tagged as 'ScrnSetup-0_25'
@
text
@d1 1
a1 1
/* (0.25)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.25
d9 1
a9 1
#define Module_Date_CMHG                17 Jan 2013
d11 2
a12 2
#define Module_MajorVersion             "0.25"
#define Module_Version                  25
d14 1
a14 1
#define Module_Date                     "17 Jan 2013"
d16 1
a16 1
#define Module_ApplicationDate          "17-Jan-13"
d21 3
a23 3
#define Module_FullVersion              "0.25"
#define Module_HelpVersion              "0.25 (17 Jan 2013)"
#define Module_LibraryVersionInfo       "0:25"
@


1.17
log
@Add vertical scrollbar
Detail:
  Resources/UK/Res,fae - Vertical scroll bar added, to avoid window being cut off in low res modes
Admin:
  Tested in 640x480 screen mode


Version 0.24. Tagged as 'ScrnSetup-0_24'
@
text
@d1 1
a1 1
/* (0.24)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.24
d9 1
a9 1
#define Module_Date_CMHG                06 Oct 2012
d11 2
a12 2
#define Module_MajorVersion             "0.24"
#define Module_Version                  24
d14 1
a14 1
#define Module_Date                     "06 Oct 2012"
d16 1
a16 1
#define Module_ApplicationDate          "06-Oct-12"
d21 3
a23 3
#define Module_FullVersion              "0.24"
#define Module_HelpVersion              "0.24 (06 Oct 2012)"
#define Module_LibraryVersionInfo       "0:24"
@


1.16
log
@Fix null pointer dereference when monitor is unknown. Be more sensible when setting/testing mode.
Detail:
  c/monitor - Added a few checks to make sure current_monitor_file isn't null before we try accessing it. Make sure monitor is reset to "Auto" if switching to a set of settings where no MDF is loaded.
  c/monitor, h/monitor - Updated set_monitor_choices to only complain about unspecified mode settings if an MDF is in use. Return true/false for whether the settings were applied or not.
  c/main - Make use of set_monitor_choices return code to decide whether the 5 second "try" timeout is needed or not. Make sure selected monitor gets reset when switching between different settings during the various "try" stages.
Admin:
  Tested on Raspberry Pi with high processor vectors


Version 0.23. Tagged as 'ScrnSetup-0_23'
@
text
@d1 1
a1 1
/* (0.23)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.23
d9 1
a9 1
#define Module_Date_CMHG                28 Aug 2012
d11 2
a12 2
#define Module_MajorVersion             "0.23"
#define Module_Version                  23
d14 1
a14 1
#define Module_Date                     "28 Aug 2012"
d16 1
a16 1
#define Module_ApplicationDate          "28-Aug-12"
d21 3
a23 3
#define Module_FullVersion              "0.23"
#define Module_HelpVersion              "0.23 (28 Aug 2012)"
#define Module_LibraryVersionInfo       "0:23"
@


1.15
log
@Only create ScrSavers in choices when the plugin needs it
Really, the screen saver setup apps should do this themselves, but this plugin can at least defer the create until it's reasonably sure it's needed.

Version 0.22. Tagged as 'ScrnSetup-0_22'
@
text
@d1 1
a1 1
/* (0.22)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.22
d9 1
a9 1
#define Module_Date_CMHG                22 Aug 2012
d11 2
a12 2
#define Module_MajorVersion             "0.22"
#define Module_Version                  22
d14 1
a14 1
#define Module_Date                     "22 Aug 2012"
d16 1
a16 1
#define Module_ApplicationDate          "22-Aug-12"
d21 3
a23 3
#define Module_FullVersion              "0.22"
#define Module_HelpVersion              "0.22 (22 Aug 2012)"
#define Module_LibraryVersionInfo       "0:22"
@


1.14
log
@Enable hourglass while scanning monitor directories.
Check return result from malloc() and don't dereference NULL on failure.
Pointers initialised to NULL not 0.

Version 0.21. Tagged as 'ScrnSetup-0_21'
@
text
@d1 1
a1 1
/* (0.21)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.21
d9 1
a9 1
#define Module_Date_CMHG                22 Jul 2012
d11 2
a12 2
#define Module_MajorVersion             "0.21"
#define Module_Version                  21
d14 1
a14 1
#define Module_Date                     "22 Jul 2012"
d16 1
a16 1
#define Module_ApplicationDate          "22-Jul-12"
d21 3
a23 3
#define Module_FullVersion              "0.21"
#define Module_HelpVersion              "0.21 (22 Jul 2012)"
#define Module_LibraryVersionInfo       "0:21"
@


1.13
log
@Fix null pointer dereference on startup
Detail:
  c/main - Command line parsing now checks if enough arguments exist before attempting to look for an -openat option
Admin:
  Tested on Raspberry Pi with high processor vectors


Version 0.20. Tagged as 'ScrnSetup-0_20'
@
text
@d1 1
a1 1
/* (0.20)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.20
d9 1
a9 1
#define Module_Date_CMHG                27 Jun 2012
d11 2
a12 2
#define Module_MajorVersion             "0.20"
#define Module_Version                  20
d14 1
a14 1
#define Module_Date                     "27 Jun 2012"
d16 1
a16 1
#define Module_ApplicationDate          "27-Jun-12"
d21 3
a23 3
#define Module_FullVersion              "0.20"
#define Module_HelpVersion              "0.20 (27 Jun 2012)"
#define Module_LibraryVersionInfo       "0:20"
@


1.12
log
@Internationalised the screensaver blank times.
When reading choices, read from Choices:.
If no screensaver is set then adjustclicking on 'Cancel' now correctly restores the DPMS saver as the default.
Use OS_FSControl instead of OS_CLI(*COPY).
'Auto' and 'Unknown' put in messages file.

Version 0.19. Tagged as 'ScrnSetup-0_19'
@
text
@d1 1
a1 1
/* (0.19)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.19
d9 1
a9 1
#define Module_Date_CMHG                12 Feb 2012
d11 2
a12 2
#define Module_MajorVersion             "0.19"
#define Module_Version                  19
d14 1
a14 1
#define Module_Date                     "12 Feb 2012"
d16 1
a16 1
#define Module_ApplicationDate          "12-Feb-12"
d21 3
a23 3
#define Module_FullVersion              "0.19"
#define Module_HelpVersion              "0.19 (12 Feb 2012)"
#define Module_LibraryVersionInfo       "0:19"
@


1.11
log
@Get error box title from "_TaskName" token in messages file.
Use Mask_NoNullEvents/Gadget_Faded flag from toolbox headers.
Use OSFile 8 to create directories not OS_CLI.
Code in 'common.[c|h]' made more common.

Version 0.18. Tagged as 'ScrnSetup-0_18'
@
text
@d1 1
a1 1
/* (0.18)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.18
d9 1
a9 1
#define Module_Date_CMHG                11 Feb 2012
d11 2
a12 2
#define Module_MajorVersion             "0.18"
#define Module_Version                  18
d14 1
a14 1
#define Module_Date                     "11 Feb 2012"
d16 1
a16 1
#define Module_ApplicationDate          "11-Feb-12"
d21 3
a23 3
#define Module_FullVersion              "0.18"
#define Module_HelpVersion              "0.18 (11 Feb 2012)"
#define Module_LibraryVersionInfo       "0:18"
@


1.10
log
@Replace "-wipe" with "x wipe" in makefiles to remove annoying errors.

Version 0.17. Tagged as 'ScrnSetup-0_17'
@
text
@d1 1
a1 1
/* (0.17)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.17
d9 1
a9 1
#define Module_Date_CMHG                14 Jan 2012
d11 2
a12 2
#define Module_MajorVersion             "0.17"
#define Module_Version                  17
d14 1
a14 1
#define Module_Date                     "14 Jan 2012"
d16 1
a16 1
#define Module_ApplicationDate          "14-Jan-12"
d21 3
a23 3
#define Module_FullVersion              "0.17"
#define Module_HelpVersion              "0.17 (14 Jan 2012)"
#define Module_LibraryVersionInfo       "0:17"
@


1.9
log
@Add framerate selection to ScrnSetup plugin. Update to take version number from VersionNum file.
Detail:
  c/main, c/monitor, h/defines, h/monitor, Resources/UK/Res,fae - Added an extra box to the display settings are to allow selection of screen refresh rate.
  Makefile, Resources/UK/Messages - Updated so that version number is taken from the VersionNum file instead of being hard-coded in the messages file.
Admin:
  Tested on Iyonix. New plugin seems to work OK with parsing both the old and new WimpMode lines, as well as when the PreDesk.Configure.Monitor file is missing altogether.


Version 0.16. Tagged as 'ScrnSetup-0_16'
@
text
@d1 1
a1 1
/* (0.16)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.16
d9 1
a9 1
#define Module_Date_CMHG                13 Apr 2011
d11 2
a12 2
#define Module_MajorVersion             "0.16"
#define Module_Version                  16
d14 1
a14 1
#define Module_Date                     "13 Apr 2011"
d16 1
a16 1
#define Module_ApplicationDate          "13-Apr-11"
d21 3
a23 3
#define Module_FullVersion              "0.16"
#define Module_HelpVersion              "0.16 (13 Apr 2011)"
#define Module_LibraryVersionInfo       "0:16"
@


1.8
log
@Fix bug in "Try" button for screensavers.

If you select a screensaver from the menu and 'try' it, then decide to
cancel the plug-in, the last selected screensaver is left as the current
saver, rather than restoring what you had configured originally. A reboot
would sort it out, but that's a little OTT. Fixed.

Version 0.15. Tagged as 'ScrnSetup-0_15'
@
text
@d1 1
a1 1
/* (0.15)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.15
d9 1
a9 1
#define Module_Date_CMHG                27 Jan 2010
d11 2
a12 2
#define Module_MajorVersion             "0.15"
#define Module_Version                  15
d14 1
a14 1
#define Module_Date                     "27 Jan 2010"
d16 1
a16 1
#define Module_ApplicationDate          "27-Jan-10"
d21 3
a23 3
#define Module_FullVersion              "0.15"
#define Module_HelpVersion              "0.15 (27 Jan 2010)"
#define Module_LibraryVersionInfo       "0:15"
@


1.7
log
@Fix broken ScrnSetup Configure plugin
Detail:
  read_current_mode_settings() in monitor.c now correctly parses the default Choices:Boot.PreDesk.Configure.Monitor file (The addition of the Castle license text was causing the original code to fail)
  update_monitor_displayfields() in monitor.c now behaves correctly if the current colour depth is unknown
  trap_error() in common.c/.h has been updated to allow the reporting of the file & line that caused the error, to allow errors to be tracked down more easily in the future.
Admin:
  Tested on rev C2 beagleboard.


Version 0.14. Tagged as 'ScrnSetup-0_14'
@
text
@d1 1
a1 1
/* (0.14)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.14
d9 1
a9 1
#define Module_Date_CMHG                25 Oct 2009
d11 2
a12 2
#define Module_MajorVersion             "0.14"
#define Module_Version                  14
d14 1
a14 1
#define Module_Date                     "25 Oct 2009"
d16 1
a16 1
#define Module_ApplicationDate          "25-Oct-09"
d21 3
a23 3
#define Module_FullVersion              "0.14"
#define Module_HelpVersion              "0.14 (25 Oct 2009)"
#define Module_LibraryVersionInfo       "0:14"
@


1.6
log
@Bulk import of missing !Sprites11 files

Version 0.13. Tagged as 'ScrnSetup-0_13'
@
text
@d1 1
a1 1
/* (0.13)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.13
d11 2
a12 2
#define Module_MajorVersion             "0.13"
#define Module_Version                  13
d21 3
a23 3
#define Module_FullVersion              "0.13"
#define Module_HelpVersion              "0.13 (25 Oct 2009)"
#define Module_LibraryVersionInfo       "0:13"
@


1.5
log
@Renamed title of DPMS settings window to be consistent with all the others.

Version 0.12. Tagged as 'ScrnSetup-0_12'
@
text
@d1 1
a1 1
/* (0.12)
d4 1
a4 1
 * Last processed by srccommit version: 1.68.
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.12
d9 1
a9 1
#define Module_Date_CMHG                18 Jun 2003
d11 2
a12 2
#define Module_MajorVersion             "0.12"
#define Module_Version                  12
d14 1
a14 1
#define Module_Date                     "18 Jun 2003"
d16 1
a16 1
#define Module_ApplicationDate          "18-Jun-03"
d19 1
a19 1
#define Module_ComponentPath            "RiscOS/Sources/SystemRes/Configure2/PlugIns/ScrnSetup"
d21 3
a23 3
#define Module_FullVersion              "0.12"
#define Module_HelpVersion              "0.12 (18 Jun 2003)"
#define Module_LibraryVersionInfo       "0:12"
@


1.4
log
@Added low res sprites.
Changed RMEnsure level to UtilityModule 3.50 as this relies on OS_ScreenMode
The colour depth menu will now have entries greyed out when the
list of mode descriptions given to it indicates there are some colour
depths unachieveable on this hardware.

Version 0.11. Tagged as 'ScrnSetup-0_11'
@
text
@d1 1
a1 1
/* (0.11)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.11
d9 1
a9 1
#define Module_Date_CMHG                02 Feb 2003
d11 2
a12 2
#define Module_MajorVersion             "0.11"
#define Module_Version                  11
d14 1
a14 1
#define Module_Date                     "02 Feb 2003"
d16 1
a16 1
#define Module_ApplicationDate          "02-Feb-03"
d21 3
a23 3
#define Module_FullVersion              "0.11"
#define Module_HelpVersion              "0.11 (02 Feb 2003)"
#define Module_LibraryVersionInfo       "0:11"
@


1.3
log
@Addition of "Try" button to the mode settings frame,similar in principal
to the "Try" button for the screen saver.
Associated Res file change.

Version 0.10. Tagged as 'ScrnSetup-0_10'
@
text
@d1 1
a1 1
/* (0.10)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.10
d9 1
a9 1
#define Module_Date_CMHG                19 Dec 2002
d11 2
a12 2
#define Module_MajorVersion             "0.10"
#define Module_Version                  10
d14 1
a14 1
#define Module_Date                     "19 Dec 2002"
d16 1
a16 1
#define Module_ApplicationDate          "19-Dec-02"
d21 3
a23 3
#define Module_FullVersion              "0.10"
#define Module_HelpVersion              "0.10 (19 Dec 2002)"
#define Module_LibraryVersionInfo       "0:10"
@


1.2
log
@Makefile tweaks
New sprites
As featured in disc image accompanying RISC OS 5.00

Version 0.09. Tagged as 'ScrnSetup-0_09'
@
text
@d1 1
a1 1
/* (0.09)
d7 1
a7 1
#define Module_MajorVersion_CMHG        0.09
d9 1
a9 1
#define Module_Date_CMHG                14 Dec 2002
d11 2
a12 2
#define Module_MajorVersion             "0.09"
#define Module_Version                  9
d14 1
a14 1
#define Module_Date                     "14 Dec 2002"
d16 1
a16 1
#define Module_ApplicationDate          "14-Dec-02"
d21 3
a23 3
#define Module_FullVersion              "0.09"
#define Module_HelpVersion              "0.09 (14 Dec 2002)"
#define Module_LibraryVersionInfo       "0:9"
@


1.1
log
@Addition of VersionNum
@
text
@d1 1
a1 1
/* (0.08)
d4 1
d7 17
a23 1
#define Module_ApplicationDate          "21-Jul-98"
@

