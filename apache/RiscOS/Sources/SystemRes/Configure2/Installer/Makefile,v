head	1.8;
access;
symbols
	Installer-0_15:1.8
	Installer-0_14:1.8
	Installer-0_13:1.7
	Installer-0_12:1.6
	Installer-0_11:1.6
	Installer-0_10:1.5
	Installer-0_09:1.4
	Installer-0_08:1.3
	Installer-0_07:1.2
	rthornb_UrsulaBuild-29Jul1998:1.1.1.1
	rthornb_UrsulaBuild-22Jul1998:1.1.1.1
	rthornb_UrsulaBuild-15Jul1998:1.1.1.1
	rthornb_UrsulaBuild-07Jul1998:1.1.1.1
	bavison_Installer-0_06:1.1.1.1
	rthornb_UrsulaBuild-17Jun1998:1.1.1.1
	bavison_Installer-0_05:1.1.1.1
	rthornb_UrsulaBuild-03Jun1998:1.1.1.1
	rthornb_UrsulaBuild-27May1998:1.1.1.1
	rthornb_UrsulaBuild-21May1998:1.1.1.1
	rthornb_UrsulaBuild_01May1998:1.1.1.1
	bavison_Installer_004:1.1.1.1
	bavison_Installer_003:1.1.1.1
	initial:1.1.1.1
	Ursula:1.1.1;
locks; strict;
comment	@# @;


1.8
date	2016.04.29.20.00.25;	author rsprowson;	state Exp;
branches;
next	1.7;
commitid	WVduFvofJJZWLy4z;

1.7
date	2012.07.19.20.12.55;	author rsprowson;	state Exp;
branches;
next	1.6;
commitid	2rhgQnyjgL3rcddw;

1.6
date	2012.01.07.10.50.25;	author rsprowson;	state Exp;
branches;
next	1.5;
commitid	Q2FqZVr9VQU5keOv;

1.5
date	2007.05.24.01.45.14;	author srevill;	state Exp;
branches;
next	1.4;

1.4
date	2001.10.26.13.07.05;	author bavison;	state Exp;
branches;
next	1.3;

1.3
date	2001.08.31.13.47.50;	author bavison;	state Exp;
branches;
next	1.2;

1.2
date	2000.06.29.11.28.09;	author jfletche;	state Exp;
branches;
next	1.1;

1.1
date	98.04.07.18.12.51;	author bavison;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	98.04.07.18.12.51;	author bavison;	state Exp;
branches;
next	;


desc
@@


1.8
log
@Makefile recreated from fragments
Get OS_ReadVarVal assistance from AsmUtils, remove local OSVar.s.
Rename CMHG file to follow the autogenerated name, and resource area to Resources() similarly.

Version 0.14. Tagged as 'Installer-0_14'
@
text
@# Copyright 1998 Acorn Computers Ltd
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
# Makefile for Configure Installer module
#

COMPONENT    = Installer
CINCLUDES    = -IC:,C:ConfigLib.
OBJS         = CheckSys Dispatch File FileOp Housekeep\
               Log Merge Mess Modver
CMHGDEPENDS  = Dispatch Housekeep
LIBS        += ${CONLIB} ${ASMUTILS}
ifeq ("${CMDHELP}","None")
CMHGDEFINES += -DNO_INTERNATIONAL_HELP
endif

include CModule

# Dynamic dependencies:
@


1.7
log
@Makefile adapted to accept CMDHELP=None

Version 0.13. Tagged as 'Installer-0_13'
@
text
@a16 22
# ***********************************
# ***    C h a n g e   L i s t    ***
# ***********************************
# Date           Name   Description
# ----           ----   -----------
# 15-Dec-97      BJGA   Created
# 17-Dec-97      BJGA   Tidied up
# 20-Jan-98      BJGA   Added objasm support
# 06-Apr-98      BJGA   Replaced Common directory with ConfigLib
# 29-Jun-20      JRF    Updated to use srccommit.
# See CVS for future logs

include StdTools
include StdRules

#
# Program specific options:
#
COMPONENT  = Installer
RDIR       = Resources
LDIR       = ${RDIR}.${LOCALE}
RAM_MODULE = rm.${COMPONENT}
d18 6
d28 1
a28 47
#
# Generic options:
#
CFLAGS   += -c -depend !Depend -ffah -gflv ${CINCLUDES} -throwback -zM
CINCLUDES = -IC:,<Lib$Dir>.ConfigLib.

#
# Libraries
#
CLIB   = CLIB:o.stubs
CONLIB = <Lib$Dir>.ConfigLib.o.ConfigLib
OBJS = CheckSys.o Dispatch.o File.o FileOp.o Housekeep.o Log.o Merge.o Mess.o Modver.o OSVar.o   ResMess.o ModHdr.o

#
# Main rules
#
all: ${RAM_MODULE}
        @@echo ${COMPONENT}: Module built (RAM)

install: ${RAM_MODULE}
        ${MKDIR} ${INSTDIR}
        |
        ${CP} ${RAM_MODULE} ${INSTDIR}.${COMPONENT} ${CPFLAGS}
        |
        ${CHMOD} -R a+rx ${INSTDIR}.${COMPONENT}
        |
        @@echo ${COMPONENT}: All installed (Disc)

clean:
        ${WIPE} o.* ${WFLAGS}
        ${WIPE} rm ${WFLAGS}
        ${RM} h.ModHdr
        @@echo ${COMPONENT}: cleaned

${RAM_MODULE}: ${OBJS} ${CONLIB} ${CLIB}
        ${MKDIR} rm
        ${LD} -o $@@ -module ${OBJS} ${CONLIB} ${CLIB}
        ${CHMOD} -R a+rx $@@

ModHdr.h: cmhg.ModHdr
        ${CMHG} -p ${CMHGDEFINES} -o o.ModHdr cmhg.ModHdr h.ModHdr

ModHdr.o: cmhg.ModHdr
        ${CMHG} -p ${CMHGDEFINES} -o o.ModHdr cmhg.ModHdr h.ModHdr

ResMess.o: ${LDIR}.Messages
        ResGen resourcesfiles o.ResMess ${LDIR}.Messages Resources.Installer.Messages
a29 1
#---------------------------------------------------------------------------
@


1.6
log
@Allow CFLAGS to be prefixed by the thing invoking the makefile.
Permits 26 bit target even when the C compiler defaults to 32 bit output.
Swapped to use StdTools and StdRules also.

Version 0.11. Tagged as 'Installer-0_11'
@
text
@d40 4
d47 2
a48 4
CMHGFLAGS = ${OPTIONS}
CFLAGS   += -c -depend !Depend -ffah -gflv ${INCLUDES} -throwback -zM
INCLUDES  = -IC:,<Lib$Dir>.ConfigLib.
OFLAGS    = -depend !Depend -throwback
d84 1
a84 1
        ${CMHG} -p ${CMHGFLAGS} -o o.ModHdr cmhg.ModHdr h.ModHdr
d87 1
a87 1
        ${CMHG} -p ${CMHGFLAGS} -o o.ModHdr cmhg.ModHdr h.ModHdr
@


1.5
log
@  Makefile fixes.
Detail:
  Addressed some issues which stopped ROOL Batch One source release from
  working correctly.
Admin:
  Tested in patched Batch One BBE.

Version 0.10. Tagged as 'Installer-0_10'
@
text
@d29 3
a42 12
MKDIR   = do mkdir -p
CC      = cc
ATTR    = -attr
OBJASM  = objasm
CMHG    = cmhg
CP      = copy
LD      = link
RM      = remove
WIPE    = x wipe

CPFLAGS = ~cfr~v
WFLAGS  = ~c~v
d44 3
a46 4

CFLAGS   = -c -depend !Depend -ffah -gflv ${INCLUDES} -throwback -zM
INCLUDES = -IC:,<Lib$Dir>.ConfigLib.
OFLAGS   = -depend !Depend -throwback
a52 1

d56 1
a56 8
# Rule patterns
#
.c.o:;    ${CC} ${CFLAGS} -o $@@ $<
.s.o:;    ${OBJASM} ${OFLAGS} -o $@@ $<

#
# Main rules:
#
d66 1
a66 1
        ${ATTR} -files +or +ow +wr -ww ${INSTDIR}.${COMPONENT}
d77 1
a77 1
	${MKDIR} rm
d79 1
a79 1
        access $@@ RW/R
d82 1
a82 1
	${CMHG} -p ${CMHGFLAGS} -o o.ModHdr cmhg.ModHdr h.ModHdr
d85 1
a85 1
	${CMHG} -p ${CMHGFLAGS} -o o.ModHdr cmhg.ModHdr h.ModHdr
d88 1
a88 1
	ResGen resourcesfiles o.ResMess ${LDIR}.Messages Resources.Installer.Messages
@


1.4
log
@Added option to build non-international help variant. Necessary because
RISC OS 3.10 won't allow star commands with the international flag bit set!
(Should also be used for RISC OS 3.50, because although it will work, it is
suspected that the implementation of international help is buggy.)

Version 0.09. Tagged as 'Installer-0_09'
@
text
@d40 1
a40 1
MKDIR   = cdir
d48 1
a48 1
WIPE    = -wipe
@


1.3
log
@32-bit compatible.

Version 0.08. Tagged as 'Installer-0_08'
@
text
@d52 1
d100 1
a100 1
	${CMHG} -p -o o.ModHdr cmhg.ModHdr h.ModHdr
d103 1
a103 1
	${CMHG} -p -o o.ModHdr cmhg.ModHdr h.ModHdr
@


1.2
log
@  Corrected date comparissons, moved to using srccommit.
Detail:
  * Some date comparissons were using ints, rather than unsigned ints.
    Consequently, 50% of the time updates using the Installer module are
    not performed because they are deemed to be in the past. This fault
    is present in release versions of RISC OS 4 from ROL. It is not in any
    patch release.
  * Moved to using srccommit. I doubt this component will be used in
    future, but it's worth doing anyhow.
Admin:
  Tested with internal ROL builds.

Version 0.07. Tagged as 'Installer-0_07'
@
text
@a35 1
INSTDIR    = ${INSTDIR}
@


1.1
log
@Initial revision
@
text
@d26 2
a27 1
#
d100 1
a100 1
	${CMHG} -o o.ModHdr cmhg.ModHdr h.ModHdr
d103 1
a103 1
	${CMHG} -o o.ModHdr cmhg.ModHdr h.ModHdr
@


1.1.1.1
log
@Initial commit of Configure's shared Installer module to CVS.
@
text
@@
