head	1.3;
access;
symbols
	Installer-0_13:1.2
	Installer-0_12:1.2
	Installer-0_11:1.2
	Installer-0_10:1.2
	Installer-0_09:1.2
	Installer-0_08:1.2
	Installer-0_07:1.1.1.1
	rthornb_UrsulaBuild-29Jul1998:1.1.1.1
	rthornb_UrsulaBuild-22Jul1998:1.1.1.1
	rthornb_UrsulaBuild-15Jul1998:1.1.1.1
	rthornb_UrsulaBuild-07Jul1998:1.1.1.1
	bavison_Installer-0_06:1.1.1.1
	rthornb_UrsulaBuild-17Jun1998:1.1.1.1
	bavison_Installer-0_05:1.1.1.1
	rthornb_UrsulaBuild-03Jun1998:1.1.1.1
	rthornb_UrsulaBuild-27May1998:1.1.1.1
	rthornb_UrsulaBuild-21May1998:1.1.1.1
	rthornb_UrsulaBuild_01May1998:1.1.1.1
	bavison_Installer_004:1.1.1.1
	bavison_Installer_003:1.1.1.1
	initial:1.1.1.1
	Ursula:1.1.1;
locks; strict;
comment	@# @;


1.3
date	2016.04.29.20.00.34;	author rsprowson;	state dead;
branches;
next	1.2;
commitid	WVduFvofJJZWLy4z;

1.2
date	2001.08.31.13.47.53;	author bavison;	state Exp;
branches;
next	1.1;

1.1
date	98.04.07.18.12.54;	author bavison;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	98.04.07.18.12.54;	author bavison;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Makefile recreated from fragments
Get OS_ReadVarVal assistance from AsmUtils, remove local OSVar.s.
Rename CMHG file to follow the autogenerated name, and resource area to Resources() similarly.

Version 0.14. Tagged as 'Installer-0_14'
@
text
@; Copyright 1998 Acorn Computers Ltd
;
; Licensed under the Apache License, Version 2.0 (the "License");
; you may not use this file except in compliance with the License.
; You may obtain a copy of the License at
;
;     http://www.apache.org/licenses/LICENSE-2.0
;
; Unless required by applicable law or agreed to in writing, software
; distributed under the License is distributed on an "AS IS" BASIS,
; WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
; See the License for the specific language governing permissions and
; limitations under the License.
;
; /****** OSVar.s ***********************************************************\ 
; 
; Project:	Ursula (RISC OS for Risc PC II)
; Component:	Configure Installer module (for SysMerge/FontMerge/BootMerge)
; This file:	OS variable handling
; 
; History:
; Date		Who	Change
; ----------------------------------------------------------------------------
; 20/01/1998	BJGA	Created
; 
; \**************************************************************************/

; This stuff is necessary because the standard C wrappers can't cope with the
; concept of a SWI which returns an error, where a register other than R0
; contains pertinent information...
	
	GET     Hdr:ListOpts
	GET     Hdr:Macros
	GET     Hdr:APCS.<APCS>
	
XOS_ReadVarVal	*	&20023
	
	AREA |OSVar|, CODE, READONLY
	
; BOOL OSVar_Exists (const char *var)
; In:	Pointer to OS variable name
; Out:	TRUE/FALSE depending on whether the variable exists or not
	
	EXPORT OSVar_Exists
OSVar_Exists
        FunctionEntry "v1"
	MOV	r1, #0
	MOV	r2, #-1
	MOV	r3, #0
	MOV	r4, #0
	SWI	XOS_ReadVarVal
	CMP	r2, #0
	MOVGE	r0, #0 ; variable doesn't exist
	MOVLT	r0, #1 ; variable does exist
	Return  "v1"
	
; int OSVar_Length (const char *var);
; In:	Pointer to OS variable name
; Out:	Length of OS variable, not including a terminator
	
	EXPORT OSVar_Length
OSVar_Length
        FunctionEntry "v1"
	MOV	r1, #0
	MOV	r2, #-1
	MOV	r3, #0
	MOV	r4, #0
	SWI	XOS_ReadVarVal
	MVN	r0, r2
	Return  "v1"
	
	END
@


1.2
log
@32-bit compatible.

Version 0.08. Tagged as 'Installer-0_08'
@
text
@@


1.1
log
@Initial revision
@
text
@d32 4
d46 1
a46 1
	STMFD	sp!, {v1, lr}
d55 1
a55 1
	LDMFD	sp!, {v1, pc}^
d63 1
a63 1
	STMFD	sp!, {v1, lr}
d70 1
a70 1
	LDMFD	sp!, {v1, pc}^
@


1.1.1.1
log
@Initial commit of Configure's shared Installer module to CVS.
@
text
@@
