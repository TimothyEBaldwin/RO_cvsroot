head	4.27;
access;
symbols
	Boot-1_26:4.27
	Boot-1_25:4.27
	Boot-1_24:4.27
	Boot-1_23:4.27
	Boot-1_22:4.27
	Boot-1_21:4.27
	Boot-1_20:4.27
	Boot-1_19:4.27
	Boot-1_18:4.27
	Boot-1_17:4.26
	Boot-1_16:4.26
	Boot-1_15:4.26
	Boot-1_14:4.26
	Boot-1_13:4.25
	Boot-1_12:4.24
	Boot-1_11:4.23
	Boot-1_10:4.23
	Boot-1_09:4.23
	Boot-1_08:4.22
	Boot-1_07:4.21
	Boot-1_06:4.21
	Boot-1_05:4.21
	Boot-1_04:4.21
	Boot-1_03:4.21
	Boot-1_02:4.21
	Boot-1_01:4.20
	Boot-1_00:4.20
	Boot-0_99:4.19
	Boot-0_98:4.19
	Boot-0_97:4.19
	Boot-0_96:4.19
	Boot-0_95:4.19
	Boot-0_94:4.18
	Boot-0_93:4.17
	Boot-0_92:4.16
	Boot-0_91:4.15
	Boot-0_90:4.13
	Boot-0_89:4.12
	Boot-0_88:4.12
	Boot-0_87:4.11
	Boot-0_86:4.11
	Boot-0_85:4.11
	Boot-0_84:4.11
	Boot-0_83:4.11
	Boot-0_82:4.10
	Boot-0_81:4.10
	Boot-0_80:4.9
	Boot-0_79:4.8
	Boot-0_78:4.8
	Boot-0_77:4.7
	Boot-0_76:4.6
	Boot-0_75:4.5
	Boot-0_74:4.5
	Boot-0_73:4.5
	Boot-0_72:4.5
	Boot-0_71:4.4
	Boot-0_70:4.4
	Boot-0_69:4.3
	Boot-0_68:4.3
	Boot-0_67:4.3
	nbingham_boot_991007:4.2;
locks; strict;
comment	@# @;


4.27
date	2013.05.27.20.37.37;	author rsprowson;	state Exp;
branches;
next	4.26;
commitid	vUwSuxHXx7U7jjRw;

4.26
date	2013.03.29.11.43.37;	author rsprowson;	state Exp;
branches;
next	4.25;
commitid	jEmpqbH2KnKvfGJw;

4.25
date	2013.03.24.19.06.04;	author rsprowson;	state Exp;
branches;
next	4.24;
commitid	Ioma95nmsRFgR4Jw;

4.24
date	2013.03.23.22.33.18;	author rsprowson;	state Exp;
branches;
next	4.23;
commitid	aggR80xzVr5m2YIw;

4.23
date	2012.09.19.11.24.30;	author rsprowson;	state Exp;
branches;
next	4.22;
commitid	avaKXEYX1XhBh8lw;

4.22
date	2012.09.19.07.37.58;	author rsprowson;	state Exp;
branches;
next	4.21;
commitid	1wieIxlXTrSS17lw;

4.21
date	2012.09.01.23.12.26;	author rsprowson;	state Exp;
branches;
next	4.20;
commitid	mVd4G1gchQYhMSiw;

4.20
date	2012.08.26.17.17.36;	author rsprowson;	state Exp;
branches;
next	4.19;
commitid	7LosJbi66iQy05iw;

4.19
date	2012.07.26.07.30.48;	author rsprowson;	state Exp;
branches;
next	4.18;
commitid	OlF6qJCeal42L2ew;

4.18
date	2012.07.22.19.01.44;	author rsprowson;	state Exp;
branches;
next	4.17;
commitid	iqJeZKPz9sb2IAdw;

4.17
date	2012.07.21.09.48.04;	author rsprowson;	state Exp;
branches;
next	4.16;
commitid	lQfK10iay896Gpdw;

4.16
date	2012.07.19.18.45.31;	author rsprowson;	state Exp;
branches;
next	4.15;
commitid	GvaPeCASWarsIcdw;

4.15
date	2012.07.19.11.34.00;	author rsprowson;	state Exp;
branches;
next	4.14;
commitid	yvfUBHvL8y1pkadw;

4.14
date	2012.07.15.17.57.26;	author rsprowson;	state Exp;
branches;
next	4.13;
commitid	VcJxNS1QFB6WzGcw;

4.13
date	2012.07.15.16.56.15;	author rsprowson;	state Exp;
branches;
next	4.12;
commitid	kBacYOBPRVrWeGcw;

4.12
date	2012.01.14.23.00.35;	author srevill;	state Exp;
branches;
next	4.11;
commitid	ySaw8XpElA1D8cPv;

4.11
date	2011.03.17.16.12.23;	author srevill;	state Exp;
branches;
next	4.10;
commitid	evqh4NfTdnIrCdcv;

4.10
date	2009.10.28.20.40.04;	author jlee;	state Exp;
branches;
next	4.9;

4.9
date	2009.10.25.16.34.26;	author jlee;	state Exp;
branches;
next	4.8;

4.8
date	2009.10.24.22.49.21;	author jlee;	state Exp;
branches;
next	4.7;

4.7
date	2009.09.30.20.22.04;	author jlee;	state Exp;
branches;
next	4.6;

4.6
date	2007.01.22.17.03.46;	author srevill;	state Exp;
branches;
next	4.5;

4.5
date	2003.02.13.17.22.15;	author rsprowson;	state Exp;
branches;
next	4.4;

4.4
date	2002.12.14.12.18.48;	author rsprowson;	state Exp;
branches;
next	4.3;

4.3
date	2001.10.05.16.07.53;	author srevill;	state Exp;
branches;
next	4.2;

4.2
date	99.10.07.10.06.28;	author nbingham;	state Exp;
branches;
next	4.1;

4.1
date	99.10.05.16.23.51;	author sbrodie;	state Exp;
branches;
next	;


desc
@@


4.27
log
@Update ROM patcher to understand Ursula kernels
The ROM patcher relied on lots of grubby internal knowledge of kernel addresses, some of which moved for Ursula
* L1PT now discovered with OS_ReadSysInfo 6
* CAM now discovered with OS_ReadSysInfo 6
* The StrongARM cleaner flipflop now discovered with OS_ReadSysInfo 6
* Option to ignore the ROM checksum where it is known to be duff (eg. personalised copies of RISC OS 4)

Also
* Remove RO430Hook from the output pending more testing
* Readd SoundDMA for RISC OS 3.60


Version 1.18. Tagged as 'Boot-1_18'
@
text
@# Copyright 1999 Pace Micro Technology plc
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
# Makefile for Boot
#

#---------------------------------------------------------------------------
# COMPONENT = ...
#   This must be set on the command line to one of Boot, ShareBoot,
#   ArmBoot, ResetBoot. Case is important. INSTDIR must also set, as usual.
APP        = !${COMPONENT}
RDIR       = ${COMPONENT}
LDIR       = ${RDIR}.${LOCALE}
INSTAPP    = ${INSTDIR}.${APP}

include StdTools
include StdRules
include AppLibs

CDEFINES  += -DCOMPAT_INET4
CINCLUDES += -ITCPIPLibs:,C:,OSLib:
CFLAGS    += -Wp 

#---------------------------------------------------------------------------
# File selections

# Files which are part of the Universal boot sequence
FILESUNIVERSAL = \
   Utils.BootVars \
   Library.PowerOff \
   Configure.ClrMonitor \
   ${FILES310} \
   ${FILES350} \
   ${FILES360} \
   ${FILES370} \
   ${FILES400} \
   ${FILES430} \
   ${FILES500} \
   ${FILES510} \
   ${FILES520} \

# Files required by a 3.1x machine
FILES310 = \
   RO310Hook \

# Files required by a 3.5x machine
FILES350 = \
   RO350Hook \
   RO350Hook.Boot.PreDesk.MemFix \
   RO350Hook.Boot.PreDesk.DPMSUtils \
   RO350Hook.Boot.PreDesk.WimpUtils \
   RO350Hook.Boot.PreDesk.ROMPatch \

# Files required by a 3.6x machine
FILES360 = \
   RO360Hook \
   RO360Hook.Boot.Tasks.~CDReinit \
   RO360Hook.Boot.PreDesk.ROMPatch \

# Files required by a 3.7x machine
FILES370 = \
   RO370Hook \
   RO370Hook.Boot.PreDesk.Configure.BandLimit \
   RO370Hook.Boot.Tasks.~CDReinit \
   RO370Hook.Boot.PreDesk.ROMPatch \

# Files required by a 4.0x machine
FILES400 = \
   RO400Hook \
   RO400Hook.Boot.PreDesk.Configure.BandLimit \
   RO400Hook.Boot.Tasks.~CDReinit \
   RO400Hook.Boot.PreDesk.ROMPatch \

# Files required by a 4.3x machine
FILES430 = \
   RO430Hook \
   RO430Hook.Boot.PreDesk.Configure.BandLimit \
   RO430Hook.Boot.Tasks.~CDReinit \

# Files required by a 5.0x machine
FILES500 = \
   RO500Hook \

# Files required by a 5.1x machine
FILES510 = \
   RO510Hook \

# Files required by a 5.2x machine
FILES520 = \
   RO520Hook \

#---------------------------------------------------------------------------
# Main rules:
install: install_${COMPONENT}${TARGET}
   @@echo ${COMPONENT}: installed (Disc)

# Files which hang together at the top of !Boot (the sprites are picked on a UserIF basis)
install_AppFiles: ${COMPONENT}.TmpRun
   ${MKDIR}                                     ${INSTAPP}
   ${CP} ${LDIR}.!Boot                          ${INSTAPP}.!Boot ${CPFLAGS}
   ${CP} ${LDIR}.!Help                          ${INSTAPP}.!Help ${CPFLAGS}
   ${CP} ${COMPONENT}.TmpRun                    ${INSTAPP}.!Run  ${CPFLAGS}
   ${MKDIR}                                     ${INSTAPP}.Themes
   ${CP} ${RDIR}.Iyonix.!Sprites                ${INSTAPP}.Themes.!Sprites   ${CPFLAGS}
   ${CP} ${RDIR}.Iyonix.!Sprites22              ${INSTAPP}.Themes.!Sprites22 ${CPFLAGS}
   ${CP} ${RDIR}.Iyonix.!Sprites11              ${INSTAPP}.Themes.!Sprites11 ${CPFLAGS}
   ${CP} ${RDIR}.Morris4                        ${INSTAPP}.Themes.Morris4    ${CPFLAGS}
   ${CP} ${RDIR}.Ursula                         ${INSTAPP}.Themes.Ursula     ${CPFLAGS}
   ${CHMOD} 444 ${INSTAPP}.*

# Files residing in !Boot.Resources.Configure
install_Configure:
   ${MKDIR}                                     ${INSTAPP}.Resources.Configure
   ${CP} Configure.ClrMonitor                   ${INSTAPP}.Resources.Configure.ClrMonitor ${CPFLAGS}
   ${CP} Configure.FontChange                   ${INSTAPP}.Resources.Configure.FontChange ${CPFLAGS}
   ${CP} Configure.IconChange                   ${INSTAPP}.Resources.Configure.IconChange ${CPFLAGS}
   ${CP} Configure.Monitors                     ${INSTAPP}.Resources.Configure.Monitors   ${CPFLAGS}
   ${CP} Configure.Textures.Universal           ${INSTAPP}.Resources.Configure.Textures   ${CPFLAGS}
   ${CP} Configure.Extras.Universal.2DTools     ${INSTAPP}.Resources.Configure.2DTools    ${CPFLAGS}
   ${CHMOD} -R 444 ${INSTAPP}.Resources.Configure

install_BootTEXTURES installShareBootTEXTURES installArmBootTEXTURES:
   ${MKDIR}                                     ${INSTAPP}.Resources.Configure.Textures.${USERIF}
   ${CP} Configure.Textures.${USERIF}           ${INSTAPP}.Resources.Configure.Textures.${USERIF} ${CPFLAGS}
   ${CHMOD} -R 444 ${INSTAPP}.Resources.Configure

# Make me a universal !Boot
install_BootUNIVERSAL: install_Configure ${FILESUNIVERSAL} install_AppFiles
   ${MKDIR}                                     ${INSTAPP}.Choices
   ${CP} Utils                                  ${INSTAPP}.Utils ${CPFLAGS}
   ${CP} Library                                ${INSTAPP}.Library ${CPFLAGS}
   ${CHMOD} -R 744 ${INSTAPP}.Choices
   ${CHMOD} -R 444 ${INSTAPP}.Utils
   ${CHMOD} -R 444 ${INSTAPP}.Library
   @@Echo Deleting superfluous files ...
   ${XWIPE}                                     ${INSTAPP}.RO350Hook.Boot.Tasks.!ROMPatch ${WFLAGS} # Now in PreDesk
   ${XWIPE}                                     ${INSTAPP}.RO430Hook ${WFLAGS} # Needs more testing really
   ${XWIPE}                                     ${INSTAPP}.Utils.NetBye ${WFLAGS} # Unreferenced
   ${XWIPE}                                     ${INSTAPP}.Library.Repeat ${WFLAGS} # Now in BootCommands

# Make me a network fileserver remote !Boot
install_ShareBootUNIVERSAL: install_Configure ${FILESUNIVERSAL} install_AppFiles
   ${MKDIR}                                     ${INSTAPP}.Choices
   ${MKDIR}                                     ${INSTAPP}.MchConfig
   ${MKDIR}                                     ${INSTAPP}.SiteHook
   ${CP} Utils                                  ${INSTAPP}.Utils ${CPFLAGS}
   ${CP} Library                                ${INSTAPP}.Library ${CPFLAGS}
   ${CHMOD} -R 744 ${INSTAPP}.Choices
   ${CHMOD} -R 444 ${INSTAPP}.Utils
   ${CHMOD} -R 444 ${INSTAPP}.Library
   @@Echo Deleting superfluous files ...
   ${XWIPE}                                     ${INSTAPP}.RO350Hook.Boot.Tasks.!ROMPatch ${WFLAGS} # Now in PreDesk
   ${XWIPE}                                     ${INSTAPP}.RO430Hook ${WFLAGS} # Needs more testing really
   ${XWIPE}                                     ${INSTAPP}.Utils.NetBye ${WFLAGS} # Unreferenced
   ${XWIPE}                                     ${INSTAPP}.Library.Repeat ${WFLAGS} # Now in BootCommands

# Make me a !ResetBoot app
install_ResetBoot:
   ${MKDIR}                                     ${INSTAPP}.Themes
   ${CP} ${LDIR}.Morris4                        ${INSTAPP}.Themes.Morris4    ${CPFLAGS}
   ${CP} ${LDIR}.Ursula                         ${INSTAPP}.Themes.Ursula     ${CPFLAGS}
   ${CP} ${LDIR}.!Sprites                       ${INSTAPP}.Themes.!Sprites   ${CPFLAGS}
   ${CP} ${LDIR}.!Sprites11                     ${INSTAPP}.Themes.!Sprites11 ${CPFLAGS}
   ${CP} ${LDIR}.!Sprites22                     ${INSTAPP}.Themes.!Sprites22 ${CPFLAGS}
   ${CP} ${LDIR}.!Help                          ${INSTAPP}.!Help ${CPFLAGS}
   ${CP} ${LDIR}.!Run                           ${INSTAPP}.!Run ${CPFLAGS}
   ${CP} ${RDIR}.!Boot                          ${INSTAPP}.!Boot ${CPFLAGS}
   ${CP} ${RDIR}.!RunImage                      ${INSTAPP}.!RunImage ${CPFLAGS}
   ${CP} ${LDIR}.Messages                       ${INSTAPP}.Messages ${CPFLAGS}
   ${MKDIR}                                     ${INSTAPP}.Choices
   ${CHMOD} -R 444 ${INSTAPP}.*
   ${CHMOD} -R 744 ${INSTAPP}.Choices

# Little tiddlers
install_FreePool: Utils.FreePool
   ${CP} Utils.FreePool ${INSTDIR}.FreePool ${CPFLAGS}

install_Do: Library.Do
   ${CP} Library.Do ${INSTDIR}.Do ${CPFLAGS}

install_IfThere: Library.IfThere
   ${CP} Library.IfThere ${INSTDIR}.IfThere ${CPFLAGS}

#---------------------------------------------------------------------------
# Manual cleanup:
clean:
   ${XWIPE} Boot.TmpRun ${WFLAGS}
   ${XWIPE} ArmBoot.TmpRun ${WFLAGS}
   ${XWIPE} ShareBoot.TmpRun ${WFLAGS}
   ${XWIPE} Utils.BootVars ${WFLAGS}
   ${XWIPE} Source.BootVars.o.main ${WFLAGS}
   ${XWIPE} Library.Do ${WFLAGS}
   ${XWIPE} Source.Do.o ${WFLAGS}
   ${XWIPE} Library.PowerOff ${WFLAGS}
   ${XWIPE} Source.PowerOff.o ${WFLAGS}
   ${XWIPE} Library.SafeLogon ${WFLAGS}
   ${XWIPE} Source.SafeLogon.o.main ${WFLAGS}
   ${XWIPE} Library.IfThere ${WFLAGS}
   ${XWIPE} Source.IfThere.o ${WFLAGS}
   ${XWIPE} Configure.ClrMonitor ${WFLAGS}
   ${XWIPE} Source.ClrMonitor.o.main ${WFLAGS}
   ${XWIPE} Utils.FreePool ${WFLAGS}
   ${XWIPE} Source.FreePool.o ${WFLAGS}
   ${XWIPE} RO350Hook.Boot.PreDesk.MemFix ${WFLAGS}
   ${XWIPE} Source.MemFix.o ${WFLAGS}
   ${XWIPE} RO350Hook.Boot.PreDesk.WimpUtils ${WFLAGS}
   ${XWIPE} Source.WimpUtils.o ${WFLAGS}
   ${XWIPE} RO350Hook.Boot.PreDesk.DPMSUtils ${WFLAGS}
   ${XWIPE} Source.DPMSUtils.o ${WFLAGS}
   ${XWIPE} RO360Hook.Boot.Tasks.~CDReinit ${WFLAGS}
   ${XWIPE} RO370Hook.Boot.Tasks.~CDReinit ${WFLAGS}
   ${XWIPE} RO400Hook.Boot.Tasks.~CDReinit ${WFLAGS}
   ${XWIPE} RO430Hook.Boot.Tasks.~CDReinit ${WFLAGS}
   ${XWIPE} Source.CDReinit.o ${WFLAGS}
   ${XWIPE} RO350Hook.Boot.PreDesk.*ROMPatch ${WFLAGS}
   ${XWIPE} RO360Hook.Boot.PreDesk.*ROMPatch ${WFLAGS}
   ${XWIPE} RO370Hook.Boot.PreDesk.*ROMPatch ${WFLAGS}
   ${XWIPE} RO400Hook.Boot.PreDesk.*ROMPatch ${WFLAGS}
   ${XWIPE} Source.ROMPatch.o ${WFLAGS}
   ${XWIPE} Source.ROMPatch.Install.ROMPatch.!RunImage ${WFLAGS}
   ${XWIPE} RO370Hook.Boot.PreDesk.Configure.BandLimit ${WFLAGS}
   ${XWIPE} RO400Hook.Boot.PreDesk.Configure.BandLimit ${WFLAGS}
   ${XWIPE} RO430Hook.Boot.PreDesk.Configure.BandLimit ${WFLAGS}
   ${XWIPE} Source.BandLimit.Source.o.BandLimit ${WFLAGS}
   @@echo ${COMPONENT}: cleaned

#---------------------------------------------------------------------------
# Static dependencies:
${COMPONENT}.TmpRun: ${LDIR}.!Run
   ${AWK} -f Build:AwkVers obeymode=1 < ${LDIR}.!Run > $@@
   ${SETTYPE} $@@ Obey

Utils.BootVars: Source.BootVars.c.main
   ${CC} ${CFLAGS} -o Source.BootVars.o.main Source.BootVars.c.main
   ${LD} ${LDFLAGS} -o $@@ Source.BootVars.o.main C:RMVersion.o.RMVersion ${SOCK4LIB} ${CLIB}
   ${SQZ} $@@

Library.Do: Source.Do.Source.Do
   ${MKDIR} Source.Do.o
   ${AS} ${ASFLAGS} -o Source.Do.o.Do Source.Do.Source.Do
   ${LD} ${LDFLAGS} -bin -o $@@ Source.Do.o.Do 
   ${SETTYPE} $@@ Utility

Library.PowerOff: Source.PowerOff.s.PowerOff
   ${MKDIR} Source.PowerOff.o
   ${AS} ${ASFLAGS} -o Source.PowerOff.o.PowerOff Source.PowerOff.s.PowerOff 
   ${LD} ${LDFLAGS} -bin -o $@@ Source.PowerOff.o.PowerOff
   ${SETTYPE} $@@ Utility

Library.SafeLogon: Source.SafeLogon.o.main
   ${CC} ${CFLAGS} -o Source.SafeLogon.o.main Source.SafeLogon.c.main
   ${LD} ${LDFLAGS} -o $@@ Source.SafeLogon.o.main ${OSLIB} ${CLIB}
   ${SQZ} $@@

Library.IfThere: Source.IfThere.Source.IfThere
   ${MKDIR} Source.IfThere.o
   ${AS} ${ASFLAGS} -o Source.IfThere.o.IfThere Source.IfThere.Source.IfThere
   ${LD} ${LDFLAGS} -bin -o $@@ Source.IfThere.o.IfThere
   ${SETTYPE} $@@ Utility

Configure.ClrMonitor: Source.ClrMonitor.o.main
   ${LD} ${LDFLAGS} -o $@@ Source.ClrMonitor.o.main ${OSLIB} ${CLIB}
   ${SQZ} $@@

Utils.FreePool: Source.FreePool.Source.FreePool
   ${MKDIR} Source.FreePool.o
   ${AS} ${ASFLAGS} -o Source.FreePool.o.FreePool Source.FreePool.Source.FreePool
   ${LD} ${LDFLAGS} -bin -o $@@ Source.FreePool.o.FreePool
   ${SETTYPE} $@@ Utility

RO310Hook RO350Hook RO360Hook RO370Hook RO400Hook RO430Hook RO500Hook RO510Hook RO520Hook:
   ${MKDIR} ${INSTAPP}.$@@.Apps
   ${MKDIR} ${INSTAPP}.$@@.Boot
   ${MKDIR} ${INSTAPP}.$@@.Res
   ${CP} $@@ ${INSTAPP}.$@@ ${CPFLAGS}
   ${CHMOD} -R 444 ${INSTAPP}.$@@.Apps
   ${CHMOD} -R 744 ${INSTAPP}.$@@.Boot
   ${CHMOD} -R 444 ${INSTAPP}.$@@.Res

RO350Hook.Boot.PreDesk.DPMSUtils: Source.DPMSUtils.Sources.DPMSUtils
   ${MKDIR} Source.DPMSUtils.o
   ${MKDIR} $@@
   ${AS} ${ASFLAGS} -o Source.DPMSUtils.o.DPMSUtils Source.DPMSUtils.Sources.DPMSUtils
   ${LD} ${LDFLAGS} -rmf -o $@@.DPMSUtils Source.DPMSUtils.o.DPMSUtils
   ${CP} Source.DPMSUtils.Sources.!Run $@@.!Run ${CPFLAGS}

RO350Hook.Boot.PreDesk.WimpUtils: Source.WimpUtils.s.WimpUtils3
   ${MKDIR} Source.WimpUtils.o
   ${MKDIR} $@@
   ${AS} ${ASFLAGS} -o Source.WimpUtils.o.WimpUtils Source.WimpUtils.s.WimpUtils3
   ${LD} ${LDFLAGS} -rmf -o $@@.WimpUtils Source.WimpUtils.o.WimpUtils
   ${CP} Source.WimpUtils.Sources.!Run $@@.!Run ${CPFLAGS}

RO350Hook.Boot.PreDesk.MemFix: Source.MemFix.Source.MemFix
   ${MKDIR} Source.MemFix.o
   ${AS} ${ASFLAGS} -o Source.MemFix.o.MemFix Source.MemFix.Source.MemFix
   ${LD} ${LDFLAGS} -bin -o $@@ Source.MemFix.o.MemFix
   ${SETTYPE} $@@ Utility

RO350Hook.Boot.PreDesk.ROMPatch RO360Hook.Boot.PreDesk.ROMPatch RO370Hook.Boot.PreDesk.ROMPatch RO400Hook.Boot.PreDesk.ROMPatch:
   ${MKDIR} Source.ROMPatch.o
   ${CC} ${CFLAGS} -ISource.ROMPatch -o Source.ROMPatch.o.rompatch Source.ROMPatch.c.rompatch
   ${AS} ${ASFLAGS} -o Source.ROMPatch.o.asmutils Source.ROMPatch.s.asmutils
   ${AS} ${ASFLAGS} -o Source.ROMPatch.o.module Source.ROMPatch.s.module
   ${LD} ${LDFLAGS} -aif -o Source.ROMPatch.Install.ROMPatch.!RunImage Source.ROMPatch.o.rompatch Source.ROMPatch.o.asmutils Source.ROMPatch.o.module ${CLIB}
   ${SQZ} Source.ROMPatch.Install.ROMPatch.!RunImage
   ${CP} Source.ROMPatch.Install $@@.^ ${CPFLAGS}

RO360Hook.Boot.Tasks.~CDReinit RO370Hook.Boot.Tasks.~CDReinit RO400Hook.Boot.Tasks.~CDReinit RO430Hook.Boot.Tasks.~CDReinit:
   ${MKDIR} Source.CDReinit.o
   ${AS} ${ASFLAGS} -o Source.CDReinit.o.CDReinit Source.CDReinit.s.CDReinit 
   ${LD} ${LDFLAGS} -bin -o $@@ Source.CDReinit.o.CDReinit
   ${SETTYPE} $@@ Utility

RO370Hook.Boot.PreDesk.Configure.BandLimit RO400Hook.Boot.PreDesk.Configure.BandLimit RO430Hook.Boot.PreDesk.Configure.BandLimit: Source.BandLimit.Source.c.BandLimit
   ${CC} ${CFLAGS} -o Source.BandLimit.Source.o.BandLimit Source.BandLimit.Source.c.BandLimit
   ${LD} ${LDFLAGS} -o $@@ Source.BandLimit.Source.o.BandLimit ${CLIB}
   ${SQZ} $@@

#---------------------------------------------------------------------------
# Dynamic dependencies:
@


4.26
log
@Updates to hooks
Makefile produces RO520Hook too, corrected rule for RO430Hook.
Removed unnecessary 'IfThere' from RO500/RO510, both of which are HAL based so have never provided BandLimit.

Version 1.14. Tagged as 'Boot-1_14'
@
text
@d83 1
d147 4
a150 4
   ${XWIPE}                                     ${INSTAPP}.RO350Hook.Boot.Tasks.!ROMPatch ${WFLAGS}
   ${XWIPE}                                     ${INSTAPP}.RO360Hook.Boot.PreDesk.SoundDMA ${WFLAGS}
   ${XWIPE}                                     ${INSTAPP}.Utils.NetBye ${WFLAGS}
   ${XWIPE}                                     ${INSTAPP}.Library.Repeat ${WFLAGS}
d163 4
a166 4
   ${XWIPE}                                     ${INSTAPP}.RO350Hook.Boot.Tasks.!ROMPatch ${WFLAGS}
   ${XWIPE}                                     ${INSTAPP}.RO360Hook.Boot.PreDesk.SoundDMA ${WFLAGS}
   ${XWIPE}                                     ${INSTAPP}.Utils.NetBye ${WFLAGS}
   ${XWIPE}                                     ${INSTAPP}.Library.Repeat ${WFLAGS}
d229 1
d311 1
a311 1
RO350Hook.Boot.PreDesk.ROMPatch RO360Hook.Boot.PreDesk.ROMPatch RO370Hook.Boot.PreDesk.ROMPatch:
@


4.25
log
@Add skeleton hook directory for RISC OS 4.39
Largely a clone of the RO400Hook.
Also
* Update RO400Hook/ResetCMOS to have the right OS version at the end
* In each 'Desktop' file only Filer_Boot the utilities of the same major version number
* BootRun accepts RISC OS Adjust's extra default library prefix, but outputs a corrected Run$Path (where the CSD is checked before the Lib)
* Makefile and docs updated

Tested on RISC OS 4.39, booting to the desktop with no errors.

Version 1.13. Tagged as 'Boot-1_13'
@
text
@d51 1
d85 1
a85 1
FILES400 = \
d98 4
d280 1
a280 1
RO310Hook RO350Hook RO360Hook RO370Hook RO400Hook RO430Hook RO500Hook RO510Hook:
@


4.24
log
@Reinstate RO310Hook
Clarify comment in 350 patches
Fix bug in SetChoices where it tried to create 2 levels of directory in one operation, leading to choices not getting copied over correctly

Version 1.12. Tagged as 'Boot-1_12'
@
text
@d48 1
d83 6
d218 1
d227 1
d275 1
a275 1
RO310Hook RO350Hook RO360Hook RO370Hook RO400Hook RO500Hook RO510Hook:
d313 1
a313 1
RO360Hook.Boot.Tasks.~CDReinit RO370Hook.Boot.Tasks.~CDReinit RO400Hook.Boot.Tasks.~CDReinit:
d319 1
a319 1
RO370Hook.Boot.PreDesk.Configure.BandLimit RO400Hook.Boot.PreDesk.Configure.BandLimit: Source.BandLimit.Source.c.BandLimit
@


4.23
log
@Install alternate !ResetBoot icons
To save a little disc space the default is the RISC OS 5 cream colour folder, hence only the deltas (Ursula and Morris4) are needed.

Version 1.09. Tagged as 'Boot-1_09'
@
text
@a133 1
   ${XWIPE}                                     ${INSTAPP}.RO310Hook.Boot ${WFLAGS} # <-- Nobble 3.10 until Hdr:Generic32 fixed
a149 1
   ${XWIPE}                                     ${INSTAPP}.RO310Hook.Boot ${WFLAGS} # <-- Nobble 3.10 until Hdr:Generic32 fixed
@


4.22
log
@Install alternate !Boot icons
To save a little disc space the default is the RISC OS 5 cream colour folder, hence only the deltas (Ursula and Morris4) are needed.

Version 1.08. Tagged as 'Boot-1_08'
@
text
@d159 6
a164 1
   ${MKDIR}                                     ${INSTAPP}
d167 1
a168 3
   ${CP} ${LDIR}.!Sprites                       ${INSTAPP}.!Sprites ${CPFLAGS}
   IfThere ${LDIR}.!Sprites11 Then ${CP} ${LDIR}.!Sprites11 ${INSTAPP}.!Sprites11 ${CPFLAGS}
   IfThere ${LDIR}.!Sprites22 Then ${CP} ${LDIR}.!Sprites22 ${INSTAPP}.!Sprites22 ${CPFLAGS}
@


4.21
log
@More boot reorganisation
* BootRun no longer bothers checking for CallASWI, since the SharedCLibrary (which is loaded prior to BootRun) does this anyway.
* Try loading the StrongARM app patcher. Note the check is conditioned on 500 since it is assumed any application which has been 32 bitted is now also StrongARM safe, the use of 'X RMLoad' uses cunning on the placement of the PatchApp module in System:Modules.370, thus skipping the load on versions prior to StrongARM too.
* Remove redundant sprite sets from Extras/500 which were no longer being used anyway.
* Import of UserIF specific backdrop textures (Morris4 ones clawed off an old CD, others courtesy of Richard Hallas).
* Makefile rejigged to allow a TARGET=TEXTURES to select which UserIFs to add.
* Updated 'RTexture' to scan the configured theme for its random backdrop in addition to the generics.

Version 1.02. Tagged as 'Boot-1_02'
@
text
@d101 6
a106 3
   ${CP} ${RDIR}.${USERIF}.!Sprites             ${INSTAPP}.!Sprites ${CPFLAGS}
   IfThere ${RDIR}.${USERIF}.!Sprites11 Then ${CP} ${RDIR}.${USERIF}.!Sprites11 ${INSTAPP}.!Sprites11 ${CPFLAGS}
   IfThere ${RDIR}.${USERIF}.!Sprites22 Then ${CP} ${RDIR}.${USERIF}.!Sprites22 ${INSTAPP}.!Sprites22 ${CPFLAGS}
@


4.20
log
@Add helper to recalc iconbar bounding boxes
When 'protect ROM sprites' is turned off, and a theme is being loaded (after the desktop has started in order to pick the right eigen factor sprites file), the various built in ROM applications have already installed their iconbar sprites.
Therefore, when new ones are loaded the bounding boxes are wrong (eg. drive icons the wrong width, switcher icon too tall) and need recalculating.
Derived from 'FontChange' new configure helper 'IconChange' does this.

Also removed unnecessary 500/Tools22.

Version 1.00. Tagged as 'Boot-1_00'
@
text
@a25 1
RESOURCES  = ${INSTAPP}.Resources
d106 16
a167 14
# Make me a !Boot.Resources.Configure
install_Configure:
   ${MKDIR}                               ${INSTAPP}
   ${MKDIR}                               ${RESOURCES}
   ${MKDIR}                               ${RESOURCES}.Configure
   ${CP} Configure.ClrMonitor             ${RESOURCES}.Configure.ClrMonitor ${CPFLAGS}
   ${CP} Configure.FontChange             ${RESOURCES}.Configure.FontChange ${CPFLAGS}
   ${CP} Configure.IconChange             ${RESOURCES}.Configure.IconChange ${CPFLAGS}
   ${CP} Configure.Monitors               ${RESOURCES}.Configure.Monitors ${CPFLAGS}
   ${CP} Configure.Textures.Universal     ${RESOURCES}.Configure.Textures ${CPFLAGS}
   IFThere Configure.Textures.${USERIF} then ${CP} Configure.Textures.${USERIF} ${RESOURCES}.Configure.Textures ${CPFLAGS}
   IFThere Configure.Extras.${TARGET}   then ${CP} Configure.Extras.${TARGET}   ${RESOURCES}.Configure          ${CPFLAGS}
   ${CHMOD} -R 444 ${RESOURCES}

@


4.19
log
@Generate ROM patches from source
It looks like the source to the ROM patches got lost in one of the numerous reorganisations, so while "ROMPatch2" was here "ROMPatch3" including the crucial > 2GB drive lockup fix were lost.
* Reverse engineered ROMPatch3, see userdocs/v204/!ReadMe
* Added support to the patch tool for 2MB ROMs as used in RISC OS 3.50
* Convert the BASIC patch for 3.50 (in Sources/ROMPatch4M) into patch tool format, unfortunately it's not clear what all the patches actually do so they're mostly grouped by module with little explanation
* Removed source attribution from obey files copied to the user
* Use Push/Pull macros
Tested by applying the original patch to a ROM, saving it, then applying this patch, and diffing the result.

Version 0.95. Tagged as 'Boot-0_95'
@
text
@d102 3
a104 3
   ${CP} ${RDIR}.<UserIF>.!Sprites              ${INSTAPP}.!Sprites ${CPFLAGS}
   IfThere ${RDIR}.<UserIF>.!Sprites11 Then ${CP} ${RDIR}.<UserIF>.!Sprites11 ${INSTAPP}.!Sprites11 ${CPFLAGS}
   IfThere ${RDIR}.<UserIF>.!Sprites22 Then ${CP} ${RDIR}.<UserIF>.!Sprites22 ${INSTAPP}.!Sprites22 ${CPFLAGS}
a157 2
   ${MKDIR}                               ${RESOURCES}.Configure.Monitors
   ${MKDIR}                               ${RESOURCES}.Configure.Monitors.Acorn
a158 3
   ${CP} Configure.Textures.Universal     ${RESOURCES}.Configure.Textures  ${CPFLAGS}
   IFThere Configure.Textures.<UserIF> then ${CP} Configure.Textures.<UserIF> ${RESOURCES}.Configure.Textures ${CPFLAGS}
   IFThere Configure.Extras.${TARGET} then  ${CP} Configure.Extras.${TARGET}  ${RESOURCES}.Configure ${CPFLAGS}
d160 1
d162 3
@


4.18
log
@Further convergence
* RO310Hook is now created, but Boot removed (to halt booting on 3.10 until the assembler macros support ARMv2)
* 310/350/360/370/400 predesktop now define Wimp$IconTheme after loading the nested window manager
* 360 now has a default backdrop tiled sprite on entering the desktop
* 400/500/510 now demark sections of 'Desktop' with RISCOS - note, all one word. The installer relies on the lines being of the form '|Start <company> <program> 1.23 <detail>" with a space it would be mis parsed
* Recovered more recent patch for 3.50 from the archives
* Reordered BootRun so the hourglass is on before the (potentially slow) choices directory is cloned
* Added sprites for UserIF=Sovereign

Version 0.94. Tagged as 'Boot-0_94'
@
text
@d62 1
d68 1
d75 1
a117 1
   ${XWIPE}                                     ${INSTAPP}.RO360Hook.Boot.PreDesk.ROMPatch ${WFLAGS}
a134 1
   ${XWIPE}                                     ${INSTAPP}.RO360Hook.Boot.PreDesk.ROMPatch ${WFLAGS}
d208 5
d291 10
a300 1
RO360Hook.Boot.Tasks.~CDReinit RO370Hook.Boot.Tasks.~CDReinit RO400Hook.Boot.Tasks.~CDReinit: Source.CDReinit.s.CDReinit
@


4.17
log
@Try creating Boot/Apps/Res explicitly
Some weird difference between the autobuilder and a manual run means that some of the (empty) hook directories are missing. Try working around this by creating a new hook rule which manually creates them then copies the template contents over the top.

Version 0.93. Tagged as 'Boot-0_93'
@
text
@d44 1
a44 1
   ${FILES310}  \
d54 1
a54 1
#   RO310Hook <-- skipping as Hdr:Generic32 macros output non ARMv2 at present
d113 1
d131 1
@


4.16
log
@/Repeat -> Repeat, /AddApp -> AddApp
No longer uses UnplugTBox

Version 0.92. Tagged as 'Boot-0_92'
@
text
@d29 1
d37 1
a37 3
# Program specific options:
.SUFFIXES: .oz .od .asm .o .Source .c
.c.o:;    ${CC} ${CFLAGS} -ff -o $@@ $<
d42 1
d44 1
a44 1
   ${FILES310} \
d54 1
d58 1
d65 1
d70 1
d76 1
d82 1
a82 1
   Library.PowerOff \
d86 1
a86 1
   Library.PowerOff \
d90 1
a90 1
install: set_access install_${COMPONENT}${TARGET}
d102 1
a102 2
   ${MKDIR}                                     ${INSTAPP}.Library
   ${MKDIR}                                     ${INSTAPP}.Choices
d106 1
a106 14
   ${MKDIR}                                     ${INSTAPP}.RO310Hook
   ${CP} RO310Hook                              ${INSTAPP}.RO310Hook ${CPFLAGS}
   ${MKDIR}                                     ${INSTAPP}.RO350Hook
   ${CP} RO350Hook                              ${INSTAPP}.RO350Hook ${CPFLAGS}
   ${MKDIR}                                     ${INSTAPP}.RO360Hook
   ${CP} RO360Hook                              ${INSTAPP}.RO360Hook ${CPFLAGS}
   ${MKDIR}                                     ${INSTAPP}.RO370Hook
   ${CP} RO370Hook                              ${INSTAPP}.RO370Hook ${CPFLAGS}
   ${MKDIR}                                     ${INSTAPP}.RO400Hook
   ${CP} RO400Hook                              ${INSTAPP}.RO400Hook ${CPFLAGS}
   ${MKDIR}                                     ${INSTAPP}.RO500Hook
   ${CP} RO500Hook                              ${INSTAPP}.RO500Hook ${CPFLAGS}
   ${MKDIR}                                     ${INSTAPP}.RO510Hook
   ${CP} RO510Hook                              ${INSTAPP}.RO510Hook ${CPFLAGS}
d109 3
d113 1
d121 1
a123 14
   ${MKDIR}                                     ${INSTAPP}.RO310Hook
   ${CP} RO310Hook                              ${INSTAPP}.RO310Hook ${CPFLAGS}
   ${MKDIR}                                     ${INSTAPP}.RO350Hook
   ${CP} RO350Hook                              ${INSTAPP}.RO350Hook ${CPFLAGS}
   ${MKDIR}                                     ${INSTAPP}.RO360Hook
   ${CP} RO360Hook                              ${INSTAPP}.RO360Hook ${CPFLAGS}
   ${MKDIR}                                     ${INSTAPP}.RO370Hook
   ${CP} RO370Hook                              ${INSTAPP}.RO370Hook ${CPFLAGS}
   ${MKDIR}                                     ${INSTAPP}.RO400Hook
   ${CP} RO400Hook                              ${INSTAPP}.RO400Hook ${CPFLAGS}
   ${MKDIR}                                     ${INSTAPP}.RO500Hook
   ${CP} RO500Hook                              ${INSTAPP}.RO500Hook ${CPFLAGS}
   ${MKDIR}                                     ${INSTAPP}.RO510Hook
   ${CP} RO510Hook                              ${INSTAPP}.RO510Hook ${CPFLAGS}
d126 3
d130 1
d136 1
a136 1
# The !ResetBoot app
d147 2
a152 1
   ${MKDIR}                               ${INSTAPP}.Choices
d163 1
a165 3
install_BootVars: Utils.BootVars
   ${CP} Utils.BootVars ${INSTDIR}.BootVars ${CPFLAGS}

d175 2
a176 12
# Extra faux targets
set_access:
   ${CHMOD} -R 555 ${INSTAPP}
   ${CHMOD} -R u+w ${INSTAPP}.Choices
   ${CHMOD} -R u+w ${INSTAPP}.RO310Hook.Boot
   ${CHMOD} -R u+w ${INSTAPP}.RO350Hook.Boot
   ${CHMOD} -R u+w ${INSTAPP}.RO360Hook.Boot
   ${CHMOD} -R u+w ${INSTAPP}.RO370Hook.Boot
   ${CHMOD} -R u+w ${INSTAPP}.RO400Hook.Boot
   ${CHMOD} -R u+w ${INSTAPP}.RO500Hook.Boot
   ${CHMOD} -R u+w ${INSTAPP}.RO510Hook.Boot

d254 9
@


4.15
log
@Clearout and universality improvements
Still a work in progress, but the number of changes were getting above my "due for a checkin" threshold.
Highlights
* Import of skeleton RO400Hook (derived from prototype RO380Hook recovered from the archives).
* Clear out !ArmBoot junk, the aim is to have either a disc based universal boot or fileserver based boot (1 of 2, not 1 of 3).
* Import of RO370Hook scripts (derived from Acorn's universal boot CD).
* Generate DPMSUtils, WimpUtils, BandLimit, CDReinit from sources. Binaries deleted.
* Import of Ursula style sprites
* Combined SetChoices and NetChoices into 1, now in BASIC, allows more rational RAM disc creation in the case of a readonly boot (using SWI to discover how much RAM there is to apportion its size).
* Empty SetTheme added.
* Removed use of aasm, now use objasm, at least for those things still used.
* Trimmed source attributions from those files which get copied to the end user's output.
* Removed SetupMimeMap hack - this was only needed because the dopey MimeMap module goes dormant if Inet$Mimemapping is not set when it starts (which it isn't when in ROM), now the BootRun obey file deals with that case.

Version 0.91. Tagged as 'Boot-0_91'
@
text
@d81 1
d122 1
d145 2
d148 1
@


4.14
log
@Makefile now cleans 'Do' and 'FreePool' properly
Make use of awk script to insert version numbers into obey files (requires Library-1_56.

Version 0.90. Not tagged
@
text
@a16 26
# ***********************************
# ***    C h a n g e   L i s t    ***
# ***********************************
# Date           Name   Description
# ----           ----   -----------
# 15th Nov 1994  JRC    Black Boot edifice created
# 21st Nov 1994  AMcC   Added ResetBoot
# 29th Nov 1994  AMcC   Made separate rule for installing Configure dir (Monitors etc)
#                       Now installs required Monitors by name
#  5th Jan 1995  AMcC   VProtect modsqz'd
#  9th Jan 1995  JRC    Squeeze LoadCMOS, SafeLogon, ClrMonitor
# 30th Jan 1995  AMcC   Corrected access permissions (files in Choices mustn't be locked)
#                       Extracted common bits into separate rules
# 30th Jan 1995  AMcC   ResetBoot - install phase depends on install_Configure
#                                 - install its own !Run file (not the common one)
# 13th Feb 1995  AMcC   ResetBoot - don't install_Configure
# 27th Mar 1995  AMcC   Removed AKF70 from install_configure rule
# 16th May 1995  JRC    No longer deletes ShareBoot SetupNet files: instead, there are separate
#                       ones for ShareBoot, ArmBoot and Boot. DOesn't remove ww access
#                       from everything.
# 14th Jun 1995  AMcC   Added lines to remove ~CDReinit from !ArmBoot and ShareBoot
#  4th Jul 1995  JRC    socket.h now in OSLib
#  7th Jul 1995  JRC    Changed INSTDIR to INSTAPP, except in 1 vital place
#  1st Aug 1995  JRC    Added BootVars target, for installation of BootVars in Scrap
#  4th Oct 1999  NB     Added FreePool, Do & IfThere targets for installation of tools into INSTDIR.
# 13th Feb 2003  RPS    Chopped about so you can produce an assortment of different !Boots, or a Universal one
d18 2
a19 2
#
#COMPONENT = ...
d40 2
a41 2
# Files which everybody always gets
COMMONFILES = \
a42 1
   Utils.VProtect \
a43 11

# Files which are part of the Universal boot sequence
FILESUNIVERSAL = \
   Library.AddApp \
   Library.AppSize \
   Library.Do \
   Library.IfThere \
   Library.LoadCMOS \
   Library.SafeLogon \
   Utils.FreePool \
   RO350Hook.Boot.PreDesk.MemFix \
d57 3
d63 1
d67 2
d72 2
d100 1
a100 1
install_BootUNIVERSAL: install_Configure install_AppFiles ${FILESUNIVERSAL} ${COMMONFILES} 
d118 3
a120 1
   ${XWIPE} ${INSTAPP}.Utils.NetBye ${WFLAGS}
d122 14
a135 2
# Make me a 5.00 only !Boot
install_Boot500: install_Configure ${FILES500} install_AppFiles ${COMMONFILES}
a142 54
   ${XWIPE} ${INSTAPP}.Utils.NetBye ${WFLAGS}
   ${XWIPE} ${INSTAPP}.Utils.HOn ${WFLAGS}
   ${XWIPE} ${INSTAPP}.Utils.UnplugTbox ${WFLAGS}
   ${XWIPE} ${INSTAPP}.Library.Repeat ${WFLAGS}

# Make me an STB !ARMBoot
install_ArmBootUNIVERSAL: install_Configure install_AppFiles ${FILESUNIVERSAL}
   ${MKDIR}                                     ${INSTAPP}.Choices
   ${MKDIR}                                     ${INSTAPP}.MchConfig
   ${CP} RO360Hook.Boot                         ${INSTAPP}.Choices.Boot ${CPFLAGS}
   ${CP} RO360Hook.DesktopBye                   ${INSTAPP}.Choices.Boot.Desktop ${CPFLAGS}
   ${CP} RO360Hook.PreDesktop                   ${INSTAPP}.Choices.Boot.PreDesktop ${CPFLAGS}
   ${MKDIR}                                     ${INSTAPP}.Choices.Boot.PreDesk.SetupNet
   ${CP} RO360Hook.ArmNet                       ${INSTAPP}.Choices.Boot.PreDesk.SetupNet.!Run ${CPFLAGS}
   ${CP} Library                                ${INSTAPP}.Library ${CPFLAGS}
   ${CP} Utils                                  ${INSTAPP}.Utils ${CPFLAGS}
   | RO2 machines need unmodsqz'd VProtect
   ${CP} rm.VProtect                            ${INSTAPP}.Utils.VProtect ${CPFLAGS}
   ${MKDIR}                                     ${INSTAPP}.Utils.RO200Hook
   ${CP} RO200Hook.Boot                         ${INSTAPP}.Utils.RO200Hook.Boot ${CPFLAGS}
   ${CP} RO200Hook.DesktopBye                   ${INSTAPP}.Utils.RO200Hook.Boot.Desktop ${CPFLAGS}
   ${CP} RO200Hook.PreDesktop                   ${INSTAPP}.Utils.RO200Hook.Boot.PreDesktop ${CPFLAGS}
   ${MKDIR}                                     ${INSTAPP}.Utils.RO310Hook
   ${CP} RO310Hook.Boot                         ${INSTAPP}.Utils.RO310Hook.Boot ${CPFLAGS}
   ${CP} RO310Hook.DesktopBye                   ${INSTAPP}.Utils.RO310Hook.Boot.Desktop ${CPFLAGS}
   ${CP} RO310Hook.PreDesktop                   ${INSTAPP}.Utils.RO310Hook.Boot.PreDesktop ${CPFLAGS}
   ${MKDIR}                                     ${INSTAPP}.Utils.RO350Hook
   ${CP} RO350Hook.Boot                         ${INSTAPP}.Utils.RO350Hook.Boot ${CPFLAGS}
   ${CP} RO350Hook.DesktopBye                   ${INSTAPP}.Utils.RO350Hook.Boot.Desktop ${CPFLAGS}
   ${CP} RO350Hook.PreDesktop                   ${INSTAPP}.Utils.RO350Hook.Boot.PreDesktop ${CPFLAGS}
   @@Echo Deleting superfluous files ...
   ${XWIPE}                                     ${INSTAPP}.Choices.Boot.Tasks.~CDReinit  ${WFLAGS}

# Make me a ShareFS remote !Boot
install_ShareBootUNIVERSAL: install_Configure install_AppFiles ${FILESUNIVERSAL}
   ${MKDIR}                                     ${INSTAPP}.Choices
   ${MKDIR}                                     ${INSTAPP}.MchConfig
   ${CP} RO360Hook.Boot                         ${INSTAPP}.Choices.Boot ${CPFLAGS}
   ${CP} RO360Hook.Desktop                      ${INSTAPP}.Choices.Boot.Desktop ${CPFLAGS}
   ${CP} RO360Hook.PreDesktop                   ${INSTAPP}.Choices.Boot.PreDesktop ${CPFLAGS}
   ${MKDIR}                                     ${INSTAPP}.Choices.Boot.PreDesk.SetupNet
   ${CP} RO360Hook.ShareNet                     ${INSTAPP}.Choices.Boot.PreDesk.SetupNet.!Run ${CPFLAGS}
   ${CP} Library                                ${INSTAPP}.Library ${CPFLAGS}
   ${CP} Utils                                  ${INSTAPP}.Utils ${CPFLAGS}
   ${MKDIR}                                     ${INSTAPP}.Utils.RO310Hook
   ${CP} RO310Hook.Boot                         ${INSTAPP}.Utils.RO310Hook.Boot ${CPFLAGS}
   ${CP} RO310Hook.Desktop                      ${INSTAPP}.Utils.RO310Hook.Boot.Desktop ${CPFLAGS}
   ${CP} RO310Hook.PreDesktop                   ${INSTAPP}.Utils.RO310Hook.Boot.PreDesktop ${CPFLAGS}
   ${MKDIR}                                     ${INSTAPP}.Utils.RO350Hook
   ${CP} RO350Hook.Boot                         ${INSTAPP}.Utils.RO350Hook.Boot ${CPFLAGS}
   ${CP} RO350Hook.Desktop                      ${INSTAPP}.Utils.RO350Hook.Boot.Desktop ${CPFLAGS}
   ${CP} RO350Hook.PreDesktop                   ${INSTAPP}.Utils.RO350Hook.Boot.PreDesktop ${CPFLAGS}
   @@Echo Deleting superfluous files ...
   ${XWIPE}                                     ${INSTAPP}.Choices.Boot.Tasks.~CDReinit  ${WFLAGS}
d179 1
a179 1
install_Do install_DoDo: Library.Do
d198 3
a200 5
   ${XWIPE} Library.AddApp ${WFLAGS}
   ${XWIPE} Library.AppSize ${WFLAGS}
   ${XWIPE} Source.BandLimit.Source.o.BandLimit ${WFLAGS}
   ${XWIPE} Source.BandLimit.Source.U.BandLimit ${WFLAGS}
   ${XWIPE} Source.BandLimit.BandLimit ${WFLAGS}
d205 2
a206 3
   ${XWIPE} Library.IfThere ${WFLAGS}
   ${XWIPE} Library.LoadCMOS ${WFLAGS}
   ${XWIPE} Source.LoadCMOS.o.main ${WFLAGS}
d209 2
d213 1
a214 4
   ${XWIPE} Utils.FreePool ${WFLAGS}
   ${XWIPE} Utils.VProtect ${WFLAGS}
   ${XWIPE} Source.PowerOff.o ${WFLAGS}
   ${XWIPE} Library.PowerOff ${WFLAGS}
d216 12
a227 3
   ${XWIPE} Boot.TmpRun ${WFLAGS}
   ${XWIPE} ArmBoot.TmpRun ${WFLAGS}
   ${XWIPE} ShareBoot.TmpRun ${WFLAGS}
d236 1
a236 1
Source.BootVars.o.main: Source.BootVars.c.main
d238 1
a238 3

Utils.BootVars: Source.BootVars.o.main
   ${LD} ${LDFLAGS} -o Utils.BootVars Source.BootVars.o.main C:RMVersion.o.RMVersion ${SOCK4LIB} ${CLIB}
d243 3
a245 3
   ${AS} Source.Do.Source.Do Source.Do.o.Do
   ${LD} -bin -o Library.Do Source.Do.o.Do 
   ${SETTYPE} Library.Do Utility
d247 1
a247 5
Library.LoadCMOS: Source.LoadCMOS.o.main
   ${LD} ${LDFLAGS} -o $@@ Source.LoadCMOS.o.main ${CLIB}
   ${SQZ} $@@

Library.PowerOff: Source.PowerOff.s.poweroff
d249 3
a251 3
   ${AS} Source.PowerOff.s.poweroff Source.PowerOff.o.poweroff
   ${LD} -bin -o Library.PowerOff Source.PowerOff.o.poweroff
   ${SETTYPE} Library.PowerOff Utility
d254 1
d258 6
d270 17
a286 21
   ${AS} ${OFLAGS} -o Source.FreePool.o.FreePool Source.FreePool.Source.FreePool
   ${LD} ${LDFLAGS} -o $@@ -bin Source.FreePool.o.FreePool
   ${SETTYPE} Utils.FreePool Utility

Utils.VProtect: rm.VProtect
   ${CP} rm.VProtect $@@ ${CPFLAGS}

#
# Aasm stuff (this is all obsolete)
#
Library.AddApp: Source.AddApp.Source.AddApp
   AAsm ${AFLAGS} Source.AddApp.Source.AddApp Library.AddApp -stamp -quit
   SetType Library.AddApp Utility

Library.AppSize: Source.AppSize.Source.AppSize
   AAsm ${AFLAGS} Source.AppSize.Source.AppSize Library.AppSize -stamp -quit
   SetType Library.AppSize Utility

Library.IfThere: Source.IfThere.Source.IfThere
   AAsm ${AFLAGS} Source.IfThere.Source.IfThere Library.IfThere -stamp -quit
   SetType Library.IfThere Utility
d289 15
a303 2
   AAsm ${AFLAGS} Source.MemFix.Source.MemFix RO350Hook.Boot.PreDesk.MemFix -stamp -quit
   SetType RO350Hook.Boot.PreDesk.MemFix Utility
@


4.13
log
@Restore a little universality
Makefile updated to use some shared bits.
New (empty) FILES510 definition.
Only !Sprites is mandatory for a given UserIF, !Sprites22 and !Sprites11 may be omitted.
Removed some heading blocks from files deposited on the user's disc.
Copied !Run into locale specific dir since it contains english translations.
Notes moved into Docs dir.

Version 0.90. Tagged as 'Boot-0_90'
@
text
@d118 1
a118 1
install_AppFiles:
d122 1
a122 1
   ${CP} ${LDIR}.!Run                           ${INSTAPP}.!Run ${CPFLAGS}
d276 1
d284 1
a284 1
   ${XWIPE} Source.FreePool.o.Freepool ${WFLAGS}
d290 3
d297 4
d302 1
a302 1
   cc ${CFLAGS} -o Source.BootVars.o.main Source.BootVars.c.main
d312 1
a312 1
   SetType Library.Do Utility
d322 1
a322 1
   SetType Library.PowerOff Utility
d336 1
a336 1
   SetType Utils.FreePool Utility
@


4.12
log
@Replace "-wipe" with "x wipe" in makefiles to remove annoying errors.

Version 0.88. Tagged as 'Boot-0_88'
@
text
@a44 2
# Program specific options:
#
d46 1
a46 1
#   This must be set on the command line to one of Boot, BootLib, ShareBoot,
d54 2
a55 21
#
# Generic options:
#
MKDIR   = do mkdir -p
AS      = objasm
ATTR    = -attr
CC      = cc
CMHG    = cmhg
CP      = copy
LD      = link
RM      = remove
SQUEEZE = squeeze
WIPE    = x wipe
XWIPE   = x wipe

AFLAGS  = ${THROWBACK} -depend !Depend -nocache -stamp -quit
CFLAGS  = ${THROWBACK} ${COMPAT} -c -depend !Depend -fafh ${INCLUDES} ${DFLAGS} -wp ${OPTIONS}
CPFLAGS = ~cfr~v
SQFLAGS = -f
WFLAGS  = ~c~vr
OFLAGS     = -depend !Depend ${THROWBACK}
d57 3
a59 9
#
# Libraries
#
CLIB      = CLib:o.Stubs
OSLIB     = OSLib:o.OSLib
SOCKLIB   = TCPIPLibs:o.socklib
ROMSTUBS  = RISC_OSLib:o.ROMStubs
ABSSYM    = RISC_OSLib:o.AbsSym
WRAPPER   = RISC_OSLib:s.ModuleWrap
d61 4
a64 8
LIBSD     = ${RLIB} ${CLIB}

COMPAT    = -DCOMPAT_INET4

#
# Include files
#
INCLUDES  = -ITCPIPLibs:,C:,OSLib:
d70 1
a70 1
   ClrMonitor \
d88 1
d90 1
a90 1
# Files required by a 3.10 machine
d93 1
a93 1
# Files required by a 3.50 machine
d96 1
a96 1
# Files required by a 3.60 machine
d99 1
a99 1
# Files required by a 3.70 machine
d102 1
a102 1
# Files required by a 4.00 machine
d105 1
a105 1
# Files required by a 5.00 machine
d109 2
a110 9
#
# Rule patterns
#
.SUFFIXES: .oz .od .asm .o .Source .c
.c.o:;    ${CC} ${CFLAGS} -ff -o $@@ $<
.c.oz:;   ${CC} ${CFLAGS} -ff -zM -zps1 -o $@@ $<
.c.od:;   ${CC} ${CFLAGS} -DTRACE=1 -g -o $@@ $<
.asm.o:;  ${AS} ${AFLAGS} $< $@@
.asm.od:; ${AS} ${AFLAGS} -g $< $@@
d112 1
a112 1
#
a113 4
#
all: ${FILES}
        @@echo ${COMPONENT}: Application built (Disc)

d118 1
a118 1
install_appfiles:
d122 1
a122 1
   ${CP} Source.!Run                            ${INSTAPP}.!Run ${CPFLAGS}
d124 2
a125 2
   ${CP} ${RDIR}.<UserIF>.!Sprites11            ${INSTAPP}.!Sprites11 ${CPFLAGS}
   ${CP} ${RDIR}.<UserIF>.!Sprites22            ${INSTAPP}.!Sprites22 ${CPFLAGS}
d130 1
a130 1
install_BootUNIVERSAL: install_Configure ${FILESUNIVERSAL} install_appfiles ${COMMONFILES} 
d141 4
d151 1
a151 1
install_Boot500: install_Configure ${FILES500} install_appfiles ${COMMONFILES}
d165 1
a165 1
install_ArmBoot: install_Configure install_appfiles ${FILES}
d167 1
d193 1
a193 1
install_ShareBoot: install_Configure install_appfiles ${FILES}
d195 1
d222 2
a223 2
   ${CP} ${LDIR}.!Sprites11                     ${INSTAPP}.!Sprites11 ${CPFLAGS}
   ${CP} ${LDIR}.!Sprites22                     ${INSTAPP}.!Sprites22 ${CPFLAGS}
a226 4
# Just the !Boot.Library directory
install_BootLib: ${FILES}
   ${CP} Library                                ${INSTDIR}.!Boot.Library ${CPFLAGS}

d235 1
a235 1
   ${CP} ClrMonitor                       ${RESOURCES}.Configure.ClrMonitor ${CPFLAGS}
d255 1
a255 1
# NB leave ww access as it was!!
d257 9
a265 10
   ${ATTR} -directories +wr ${INSTAPP}
   ${ATTR} -files +ol +or -ow +wr ${INSTAPP}
   ${ATTR} -files -ol +ow ${INSTAPP}.Choices
   ${ATTR} -files -ol +ow ${INSTAPP}.RO310Hook.Boot
   ${ATTR} -files -ol +ow ${INSTAPP}.RO350Hook.Boot
   ${ATTR} -files -ol +ow ${INSTAPP}.RO360Hook.Boot
   ${ATTR} -files -ol +ow ${INSTAPP}.RO370Hook.Boot
   ${ATTR} -files -ol +ow ${INSTAPP}.RO400Hook.Boot
   ${ATTR} -files -ol +ow ${INSTAPP}.RO500Hook.Boot
   ${ATTR} -files -ol +ow ${INSTAPP}.RO510Hook.Boot
d270 3
d281 1
a281 1
   ${XWIPE} ClrMonitor ${WFLAGS}
d291 1
a291 12
clean_all:
   -Destroy Library.AddApp Library.AppSize Utils.BootVars \
         Source.BootVars.o.main Library.Do \
         Library.IfThere Library.LoadCMOS Source.LoadCMOS.o.main \
         Library.SafeLogon Source.SafeLogon.o.main \
         ClrMonitor Source.ClrMonitor.o.main Source.Freepool.o.Freepool \
         Utils.FreePool Utils.VProtect \
         RO350Hook.Boot.PreDesk.MemFix Source.PowerOff.o Library.PowerOff
   ${ATTR} -ol ${INSTAPP}
   ${XWIPE} ${INSTAPP} ${WFLAGS}

#
a292 1
#
d294 1
a294 1
   cc ${CFLAGS} -ffah -o Source.BootVars.o.main Source.BootVars.c.main
d297 2
a298 2
   ${LD} ${LDFLAGS} -o Utils.BootVars Source.BootVars.o.main C:RMVersion.o.RMVersion ${SOCKLIB} ${CLIB}
   ${SQUEEZE} $@@
d308 1
a308 1
   ${SQUEEZE} $@@
d318 1
a318 1
   ${SQUEEZE} $@@
d320 1
a320 1
ClrMonitor: Source.ClrMonitor.o.main
d322 1
a322 1
   ${SQUEEZE} $@@
d324 1
a324 1
Source.FreePool.o.FreePool:
a326 3

Utils.FreePool: Source.FreePool.o.FreePool
   ${MKDIR} Source.FreePool.o
@


4.11
log
@Fix the 'Do' transient utility build process.
Tidy up the clean phase and a few other miscellaneous bits of makefile.

Version 0.83. Tagged as 'Boot-0_83'
@
text
@d68 1
a68 1
WIPE    = -wipe
@


4.10
log
@Import full set of MDFs from the offical Iyonix disc image
Detail:
  This change adds a load of MDFs to CVS that were in the Iyonix disc images but never in source control. The makefile has also been updated to simplify the MDF installation rules.
Admin:
  Tested on rev C2 beagleboard


Version 0.81. Tagged as 'Boot-0_81'
@
text
@d288 1
a288 1
install_Do: Library.Do
a344 8
Library.AddApp: Source.AddApp.Source.AddApp
   AAsm ${AFLAGS} Source.AddApp.Source.AddApp Library.AddApp -stamp -quit
   SetType Library.AddApp Utility

Library.AppSize: Source.AppSize.Source.AppSize
   AAsm ${AFLAGS} Source.AppSize.Source.AppSize Library.AppSize -stamp -quit
   SetType Library.AppSize Utility

d350 3
a352 1
   AAsm ${AFLAGS} Source.Do.Source.Do Library.Do -stamp -quit
a354 4
Library.IfThere: Source.IfThere.Source.IfThere
   AAsm ${AFLAGS} Source.IfThere.Source.IfThere Library.IfThere -stamp -quit
   SetType Library.IfThere Utility

d385 15
a404 1
# Library.AddApp: Hdr:ListOpts
@


4.9
log
@Ensure RO510Hook contains the new files that were added to RO500Hook, fix ResetBoot to not reset to RO500Hook
Detail:
  RO510Hook/* - These files were aded to RO500Hook yesterday, but needed adding to RO510Hook as well so that they actually get used on RISC OS 5.10+
  Makefile - Instead of containing a copy of RO500Hook, ResetBoot now has an empty Choices directory. This is the same as an ordinary (5.12) Iyonix, and will cause !Boot to reinstall the appropriate Hook folder on the next boot, ensuring the correct version is installed for the OS.
Admin:
  Tested on rev C2 beagleboard.


Version 0.80. Tagged as 'Boot-0_80'
@
text
@d279 1
a279 8
   ${CP} Configure.Monitors.Acorn.AKF50   ${RESOURCES}.Configure.Monitors.Acorn.AKF50 ${CPFLAGS}
   ${CP} Configure.Monitors.Acorn.AKF52   ${RESOURCES}.Configure.Monitors.Acorn.AKF52 ${CPFLAGS}
   ${CP} Configure.Monitors.Acorn.AKF53   ${RESOURCES}.Configure.Monitors.Acorn.AKF53 ${CPFLAGS}
   ${CP} Configure.Monitors.Acorn.AKF60   ${RESOURCES}.Configure.Monitors.Acorn.AKF60 ${CPFLAGS}
   ${CP} Configure.Monitors.Acorn.AKF65   ${RESOURCES}.Configure.Monitors.Acorn.AKF65 ${CPFLAGS}
   ${CP} Configure.Monitors.Acorn.AKF85   ${RESOURCES}.Configure.Monitors.Acorn.AKF85 ${CPFLAGS}
   ${CP} Configure.Monitors.Acorn.AKF91   ${RESOURCES}.Configure.Monitors.Acorn.AKF91 ${CPFLAGS}
   ${CP} Configure.Monitors.Acorn.AKF92   ${RESOURCES}.Configure.Monitors.Acorn.AKF92 ${CPFLAGS}
@


4.8
log
@Bulk import of missing !Sprites11 files

Version 0.78. Tagged as 'Boot-0_78'
@
text
@a260 2
   ${CP} RO500Hook.Boot                         ${INSTAPP}.Choices.Boot ${CPFLAGS}
   ${CP} ^.InetSetup.Resources.<Locale>.Blanks.SetUpNet  ${INSTAPP}.Choices.Boot.PreDesk.SetupNet ${CPFLAGS}
@


4.7
log
@Update BootVars to allow RISC OS 5.1x !Boot to be built from ROOL sources
Detail:
  Source/BootVars/c/main - Added kludge for missing service call definition in current ROOL sources
  Makefile - Updated to include RO510Hook directory. Fixed VProtect to use ${CPFLAGS} when copying.
  RO510Hook directory reconstructed by comparing RO500Hook directory against RISC OS 5 install CD.
Admin:
  Built on Iyonix, tested on beagleboard


Version 0.77. Tagged as 'Boot-0_77'
@
text
@d165 1
d257 1
@


4.6
log
@  Minor tweaks to build and install correctly.
Detail:
  Some changes were required in order for this component to build and install
  correctly. These changes are required for the ROOL 'Disc' build.
Admin:
  Tested in Iyonix 'Disc' build using ROOL 'BuildEnv' build environment

Version 0.76. Tagged as 'Boot-0_76'
@
text
@d190 2
d312 1
d400 1
a400 1
   ${CP} rm.VProtect $@@
@


4.5
log
@Finally got round to storing this stuff.
Many changes,highlights being:
 freepool now creates its 'o' directory in the top Makefile
 safelogin tweaked so it can find its header files again
 stopped EXITS macro moaning about no ENTRYS in Appsize and AddApp
 added 2DTools to universal boot sequence
 Added RO370/400/500Hook though the 370 and 400 are just empty at present
 newer vprotect added from Alan Glover
 add Utils.NetChoices
 delete ~CDReinit binary,shuffle sources a bit
 misc changes to obey files from Steve
The Makefile now expects a TARGET to be defined.Currently the 500 one is
the only one tested,though UNIVERSAL is also defined and outputs a boot
sequence like you would have got with !MkInstall in V0.71.
This picks up files which might differ between boots,and also adds
extra files which change when the UserIF changes.

Version 0.72. Tagged as 'Boot-0_72'
@
text
@d59 1
a59 1
MKDIR   = mkdir -p
d69 1
d184 1
a184 1
   ${WIPE} ${INSTAPP}.Utils.NetBye ${WFLAGS}
d193 4
a196 4
   ${WIPE} ${INSTAPP}.Utils.NetBye ${WFLAGS}
   ${WIPE} ${INSTAPP}.Utils.HOn ${WFLAGS}
   ${WIPE} ${INSTAPP}.Utils.UnplugTbox ${WFLAGS}
   ${WIPE} ${INSTAPP}.Library.Repeat ${WFLAGS}
d223 1
a223 1
   ${WIPE}                                      ${INSTAPP}.Choices.Boot.Tasks.~CDReinit  ${WFLAGS}
d244 2
a245 2
   ${WIPE}                                      ${INSTAPP}.Choices.Boot.Tasks.~CDReinit  ${WFLAGS}
   ${WIPE}                                      ${INSTAPP}.Utils.NetBye ${WFLAGS}
d312 18
a329 18
   ${WIPE} Library.AddApp ${WFLAGS}
   ${WIPE} Library.AppSize ${WFLAGS}
   ${WIPE} Utils.BootVars ${WFLAGS}
   ${WIPE} Source.BootVars.o.main ${WFLAGS}
   ${WIPE} Library.Do ${WFLAGS}
   ${WIPE} Library.IfThere ${WFLAGS}
   ${WIPE} Library.LoadCMOS ${WFLAGS}
   ${WIPE} Source.LoadCMOS.o.main ${WFLAGS}
   ${WIPE} Library.SafeLogon ${WFLAGS}
   ${WIPE} Source.SafeLogon.o.main ${WFLAGS}
   ${WIPE} ClrMonitor ${WFLAGS}
   ${WIPE} Source.ClrMonitor.o.main ${WFLAGS}
   ${WIPE} Source.FreePool.o.Freepool ${WFLAGS}
   ${WIPE} Utils.FreePool ${WFLAGS}
   ${WIPE} Utils.VProtect ${WFLAGS}
   ${WIPE} Source.PowerOff.o ${WFLAGS}
   ${WIPE} Library.PowerOff ${WFLAGS}
   ${WIPE} RO350Hook.Boot.PreDesk.MemFix ${WFLAGS}
d341 1
a341 1
   ${WIPE} ${INSTAPP} ${WFLAGS}
@


4.4
log
@ResetBoot internationalised.
Renamed HelpText to Help,fixes report of Help missing in ResetBoot 0.69
New ResetBoot sprites
Top level MakeFile adjusted for above changes.

Version 0.70. Tagged as 'Boot-0_70'
@
text
@d42 1
d59 1
a59 1
MKDIR   = cdir
d82 1
a82 1
SOCKLIB	  = TCPIPLibs:o.socklib
d89 1
a89 1
COMPAT = -DCOMPAT_INET4
d94 1
a94 1
INCLUDES  = -ITCPIPLibs:,C:
d96 8
a103 1
FILES = \
a105 1
   Utils.BootVars \
d110 1
d112 25
a136 3
   Utils.FreePool \
   Utils.VProtect \
   ClrMonitor
d154 1
a154 1
install: set_access install_${COMPONENT}
d157 9
a165 1
install_Boot: install_Configure install_appfiles ${FILES}
d167 22
a188 4
   ${CP} RO360Hook.Boot                         ${INSTAPP}.Choices.Boot ${CPFLAGS}
   ${CP} RO360Hook.Desktop                      ${INSTAPP}.Choices.Boot.Desktop ${CPFLAGS}
   ${CP} RO360Hook.PreDesktop                   ${INSTAPP}.Choices.Boot.PreDesktop ${CPFLAGS}
   ${CP} ^.InetSetup.Resources.<Locale>.Blanks.SetUpNet  ${INSTAPP}.Choices.Boot.PreDesk.SetupNet ${CPFLAGS}
d190 1
a190 1
   ${MKDIR}                                     ${INSTAPP}.Library
d193 3
d197 1
d224 1
d246 1
a256 2
   ${CP} RO500Hook.Desktop                      ${INSTAPP}.Choices.Boot.Desktop ${CPFLAGS}
   ${CP} RO500Hook.PreDesktop                   ${INSTAPP}.Choices.Boot.PreDesktop ${CPFLAGS}
d259 1
d263 1
a263 9
install_appfiles:
   ${MKDIR}                                     ${INSTAPP}
   ${CP} ${LDIR}.!Boot                          ${INSTAPP}.!Boot ${CPFLAGS}
   ${ATTR} -ol +ow                              ${INSTAPP}.!Help #Just in case it's already there
   Kitten Version ${LDIR}.!Help               > ${INSTAPP}.!Help
   ${CP} Source.!Run                            ${INSTAPP}.!Run ${CPFLAGS}
   ${CP} ${RDIR}.!Sprites                       ${INSTAPP}.!Sprites ${CPFLAGS}
   ${CP} ${RDIR}.!Sprites22                     ${INSTAPP}.!Sprites22 ${CPFLAGS}

a266 1
   ${MKDIR}                               ${INSTAPP}.Choices.Boot
d272 3
a274 1
   ${CP} Configure.2DTools                ${RESOURCES}.Configure.2DTools    ${CPFLAGS}
a283 1
   ${CP} Configure.Textures               ${RESOURCES}.Configure.Textures  ${CPFLAGS}
d285 1
d298 1
d303 6
a308 1
# NB leave ww access as it was!!
d323 1
d326 2
d336 3
a338 2
         ClrMonitor Source.ClrMonitor.o.main Utils.FreePool Utils.VProtect \
         RO350Hook.Boot.PreDesk.MemFix
d341 1
d372 6
d387 1
d396 1
a396 1
   ModSqz rm.VProtect $@@
a404 17
Library.Do: Hdr:ListOpts
Library.Do: Hdr:Macros
Library.Do: Hdr:System
Library.Do: Hdr:SWIs
Library.Do: Hdr:CPU.Generic26
Library.Do: Hdr:IO.GenericIO
Library.Do: Hdr:RISCOS
Library.IfThere: Hdr:ListOpts
Library.IfThere: Hdr:Macros
Library.IfThere: Hdr:System
Library.IfThere: Hdr:SWIs
Library.IfThere: Hdr:CPU.Generic26
Library.IfThere: Hdr:IO.GenericIO
Library.IfThere: Hdr:RISCOS
Library.IfThere: Hdr:Proc
Library.IfThere: Hdr:ModHand
Library.IfThere: Hdr:ResourceFS
@


4.3
log
@  Made the FreePool utility capable of building stand-alone.
Detail:
  Added a Makefile to the FreePool utility sources. I also converted it to
  use objasm and changed the GET directives. The main Makefile has been
  changed to cope with FreePool using objasm.

  As it stands, the main Makefile has some dynamic dependencies. I've left
  the ones which are not related to FreePool in there.
Admin:
  My changes have brought the component under srccommit control, but I
  haven't bothered to do anything about the "Version" file in the root.

Version 0.67. Tagged as 'Boot-0_67'
@
text
@d187 1
a187 3
   ${CP} ${RDIR}.!Help                          ${INSTAPP}.!Help ${CPFLAGS}
   ${ATTR} -ol +ow                              ${INSTAPP}.!HelpText #Just in case it's already there
   Kitten Version ${LDIR}.!HelpText           > ${INSTAPP}.!HelpText
d194 3
a196 3
   ${CP} RO360Hook.Boot                         ${INSTAPP}.Choices.Boot ${CPFLAGS}
   ${CP} RO360Hook.Desktop                      ${INSTAPP}.Choices.Boot.Desktop ${CPFLAGS}
   ${CP} RO360Hook.PreDesktop                   ${INSTAPP}.Choices.Boot.PreDesktop ${CPFLAGS}
@


4.2
log
@* Added EraseCVS and StripDepnd calls to !Clean.
* Updated Makefile to allow IfThere, Do & Freepool to be built
  independantly of the main boot app.

Work done for STB400 Baseline.
@
text
@d74 1
d317 6
a322 2
Utils.FreePool: Source.FreePool.Source.FreePool
   AAsm ${AFLAGS} Source.FreePool.Source.FreePool Utils.FreePool -stamp -quit
a351 6
Utils.FreePool: OS:Hdr.Macros
Utils.FreePool: OS:Hdr.OS
Utils.FreePool: OS:Hdr.Types
Utils.FreePool: OS:Hdr.Wimp
Utils.FreePool: OS:Hdr.OSSpriteOp
Utils.FreePool: OS:Hdr.Font
@


4.1
log
@  Rewrote BootVars and LoadCMOS to remove dependency on CoxheadLibs.
Detail:
  Rewrote BootVars/main.c and LoadCMOS/main.c in real C.
Admin:
  It builds - this is an intermediate checkin.
  Requires Econet 5.72 or later header export.
  Requires HdrSrc 0.30 or later header export.
@
text
@d41 1
d236 9
d330 23
@
