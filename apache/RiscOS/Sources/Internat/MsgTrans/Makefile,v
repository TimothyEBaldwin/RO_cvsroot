head	4.7;
access;
symbols
	MsgTrans-0_49:4.7
	MsgTrans-0_48:4.6
	MsgTrans-0_47-2:4.6
	RO_5_07:4.6
	MsgTrans-0_47:4.6
	MsgTrans-0_46:4.6
	MsgTrans-0_45:4.6
	MsgTrans-0_44:4.4
	MsgTrans-0_43:4.4
	dellis_autobuild_BaseSW:4.3
	MsgTrans-0_42:4.3
	MsgTrans-0_41:4.3
	MsgTrans-0_40:4.3
	MsgTrans-0_39:4.3
	MsgTrans-0_38:4.3
	MsgTrans-0_37:4.3
	MsgTrans-0_36:4.3
	MsgTrans-0_35:4.2
	sbrodie_sedwards_16Mar2000:4.2
	MsgTrans-0_34-4_2_2_1:4.2
	sbrodie_MsgTrans_dev_bp:4.2
	sbrodie_MsgTrans_dev:4.2.0.2
	dcotton_autobuild_BaseSW:4.4
	Ursula_merge:4.1.4.1
	MsgTrans-0_34:4.2
	nturton_MsgTrans-0_31:4.1
	mstphens_UrsulaRiscPCBuild_20Nov98:4.1.4.1
	Ursula_RiscPC:4.1.4.1.0.2
	nicke_MsgTrans-0_31:4.1.7.2
	rthornb_UrsulaBuild-19Aug1998:4.1.4.1
	UrsulaBuild_FinalSoftload:4.1.4.1
	rthornb_UrsulaBuild-12Aug1998:4.1.4.1
	aglover_UrsulaBuild-05Aug1998:4.1.4.1
	sbrodie_MsgTrans_0_33:4.1.4.1
	rthornb_UrsulaBuild-29Jul1998:4.1.4.1
	rthornb_UrsulaBuild-22Jul1998:4.1.4.1
	rthornb_UrsulaBuild-15Jul1998:4.1.4.1
	rthornb_UrsulaBuild-07Jul1998:4.1.4.1
	rthornb_UrsulaBuild-17Jun1998:4.1.4.1
	rthornb_UrsulaBuild-03Jun1998:4.1.4.1
	rthornb_UrsulaBuild-27May1998:4.1.4.1
	rthornb_UrsulaBuild-21May1998:4.1.4.1
	sbrodie_MsgTrans_experimental_bp:4.1
	sbrodie_MsgTrans_experimental:4.1.0.8
	rthornb_UrsulaBuild_01May1998:4.1.4.1
	afrost_NC2_Generic:4.1.7.1
	Spinner_B20_2:4.1.7.1
	Spinner_19_3:4.1.7.1
	Spinner_B18:4.1.7.1
	Spinner_B17:4.1.7.1
	Spinner_B15:4.1.7.1
	Spinner_B14:4.1.7.1
	Spinner_B13:4.1.7.1
	Spinner_B12:4.1.7.1
	Spinner_B10:4.1.7.1
	Daytona:4.1.0.6
	Daytona_bp:4.1
	Ursula:4.1.0.4
	Ursula_bp:4.1
	Spinner_B7:4.1.7.1
	RO_3_71:4.1.3.1
	ARTtmp_merge:4.1.7.1
	Spin_3Apr97:4.1.7.1
	ARTtmp:4.1.7.1.0.2
	Spin_merge:4.1.7.2
	MergeFiles:4.1.3.1
	RO_3_70:4.1.3.1
	NC_1_06:4.1.7.1
	Spinner:4.1.7
	Spin_xx:4.1.5
	NC_xx:4.1.5.1
	RO_3_60:4.1.1.1
	StrongARM:4.1.3
	Black:4.1.1;
locks; strict;
comment	@# @;


4.7
date	2014.09.24.20.33.13;	author rsprowson;	state Exp;
branches;
next	4.6;
commitid	3IWjUVrx85fIGDRx;

4.6
date	2003.12.02.15.52.02;	author bavison;	state Exp;
branches;
next	4.5;

4.5
date	2002.11.22.21.31.45;	author kbracey;	state Exp;
branches;
next	4.4;

4.4
date	2001.03.22.14.47.42;	author sbrodie;	state Exp;
branches;
next	4.3;

4.3
date	2000.05.02.14.17.26;	author sbrodie;	state Exp;
branches;
next	4.2;

4.2
date	99.08.04.18.25.26;	author kbracey;	state Exp;
branches
	4.2.2.1;
next	4.1;

4.1
date	96.11.05.09.40.12;	author nturton;	state Exp;
branches
	4.1.1.1
	4.1.3.1
	4.1.4.1
	4.1.5.1
	4.1.7.1;
next	;

4.2.2.1
date	2000.05.02.08.06.10;	author sbrodie;	state Exp;
branches;
next	;

4.1.1.1
date	96.11.05.09.40.12;	author nturton;	state Exp;
branches;
next	;

4.1.3.1
date	96.11.06.01.54.30;	author nturton;	state Exp;
branches;
next	;

4.1.4.1
date	98.03.26.14.13.55;	author rthornb;	state Exp;
branches;
next	;

4.1.5.1
date	96.11.21.12.45.19;	author nturton;	state Exp;
branches;
next	;

4.1.7.1
date	96.11.29.21.00.16;	author nturton;	state Exp;
branches;
next	4.1.7.2;

4.1.7.2
date	98.09.16.17.04.34;	author kbracey;	state Exp;
branches;
next	;


desc
@@


4.7
log
@Makefile tweak
Renamed SA_DEBUG to ASDFLAGS for BuildSys-6_50. Only affects debug version.
Retagged as MsgTrans-0_49.
@
text
@# Copyright 1996 Acorn Computers Ltd
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
# Makefile for MsgTrans
#
# ***********************************
# ***    C h a n g e   L i s t    ***
# ***********************************
# Date       Name         Description
# ----       ----         -----------
# 25-May-94  AMcC         Created.
#

COMPONENT = MessageTrans
TARGET    = MsgTrans
HEADER1   = MsgTrans
HEADER2   = MsgMenus

ASDFLAGS  =\
 -PD "AltTitleAndSWI SETL {TRUE}" \
 -PD "standalone SETL {TRUE}" \
 -PD "MergedMsgs SETS \"${MERGEDMSGS}\""

include StdTools
include AAsmModule

# Dynamic dependencies:
@


4.6
log
@Added newline at end of file.
@
text
@d30 1
a30 1
SA_DEBUG  =\
@


4.5
log
@Fix for tokens of the form notinthefile:defaultstring failing.
This was caused by R4 not being setup on entry to getbyte which then
thought it had fallen off the end of the messages file.

Version 0.45. Tagged as 'MsgTrans-0_45'
@
text
@d38 1
a38 1
# Dynamic dependencies:@


4.4
log
@  Updated build structure to use the shared AAsmModule makefile.
  Updated to build using objasm instead of aasm.
  Sources changed to be objasm-compatible.
Admin:
  Requires Library 0.71 or later.
  Requires BuildSys 3.06 or later.
  Requires Env 0.65 or later.

Version 0.43. Tagged as 'MsgTrans-0_43'
@
text
@d38 1
a38 1
# Dynamic dependencies:
@


4.3
log
@  New hashing facilities added to improve lookup times.
  Better debugging support added.
Detail:
  MessageTrans will construct hash tables for all the messages file that
    it thinks are worthwhile (>7 tokens, file is >80 bytes long).  API
    change documentation in Doc/HashingAPI.
  SVC stack tests now removed - proxy blocks are always used unless the
    caller used the new API (R3=FAST) and supplied a buffer in R2 on the
    call to MessageTrans_OpenFile.
  Test programs enhanced to not require the Palette messages file to be
    present - the Switcher messages are used instead.
  ShowMsgs test program now takes -c (show client blocks), -f (show flags
    as character strings) and <search substr> to restrict the output of
    the program to those blocks with filenames which contain the search
    substring.
  The old 16-byte client blocks contain the magic word, a flags word,
    pointer to the proxy block and a spare word.  Currently this spare
    word is filled in with a copy of the pointer to filename.  This is
    done for ShowMsgs benefit only - do not rely on this.  Similarly,
    the 7th word of the 32-byte blocks is used as a counter for the
    number of token lookups performed on that file - this is for testing
    only (to assess how much the hashing is helping) and must not be
    relied on either.
  MessageTrans no longer calls its own SWIs but uses BL to call them
    directly.  Saves SWI call overhead, plus makes the module standalone
    and the debug module tests are useful.
  Debug module capability added.  The debug module uses a different SWI
    name & number chunk and a different title to enable it to be loaded
    and tested without disrupting the rest of the machine.
  Messages re-organised so "Token not found" is the first in the file as
    this is the most commonly looked up message.
  Now built using objasm/link, instead of aasm.
Admin:
  Tested in Ursula ROM images for several weeks.  Test programs show
    data structures as expected.
  Requires link 5.15 (RiscOS/Library; tag Library-0_41 or later)


Version 0.36. Tagged as 'MsgTrans-0_36'
@
text
@d25 9
a33 4
#
# Paths
#
EXP_HDR = <export$dir>
d35 2
a36 76
#
# Generic options:
#
MKDIR   = cdir
AS      = objasm
LD      = link
CP      = copy
RM      = remove
WIPE    = -wipe
TOUCH   = create
CCFLAGS = -c -depend !Depend -IC:
ASFLAGS = -depend !Depend -Stamp -quit -module -To $@@ -From
ASDEBUG = -PD "AltTitleAndSWI SETL {TRUE}"
CPFLAGS = ~cfr~v
WFLAGS  = fr~c~v
LDFLAGS = -linkversion 515 -rmf

#
# Program specific options:
#
COMPONENT = MsgTrans
SOURCE    = s.MsgTrans
OBJ       = o.MsgTrans
TARGET    = rm.MsgTrans
DBGTARGET = rm.DbgMsgTrans
EXPORTS   = ${EXP_HDR}.MsgTrans \
            ${EXP_HDR}.MsgMenus
DIRS      = o._dirs
DBGOBJ    = o.DbgMsgTrans

#
# Generic rules:
#
rom: ${TARGET}
        @@echo ${COMPONENT}: rom module built

export: ${EXPORTS}
        @@echo ${COMPONENT}: export complete

install_rom: ${TARGET}
        ${CP} ${TARGET} ${INSTDIR}.${COMPONENT} ${CPFLAGS}
        @@echo ${COMPONENT}: rom module installed

clean:
        ${WIPE} o ${WFLAGS}
        ${RM} ${TARGET}
        @@echo ${COMPONENT}: cleaned

resources:
        ${MKDIR} ${RESDIR}.${COMPONENT}
        TokenCheck LocalRes:Messages
        ${CP} LocalRes:Messages  ${RESDIR}.${COMPONENT}.Messages  ${CPFLAGS}
        @@echo ${COMPONENT}: resource files copied

${TARGET}: ${OBJ}
        ${LD} ${LDFLAGS} -o $@@ ${OBJ}


${OBJ}: ${SOURCE} ${DIRS}
        ${AS} ${ASFLAGS} ${SOURCE}

${DBGTARGET}: ${DBGOBJ}
        ${LD} ${LDFLAGS} -o $@@ ${DBGOBJ}

${DBGOBJ}: ${SOURCE} ${DIRS}
        ${AS} ${ASDEBUG} ${ASFLAGS} ${SOURCE}

${DIRS}:
        ${MKDIR} o
        ${TOUCH} $@@

${EXP_HDR}.MsgTrans: hdr.MsgTrans
        ${CP} hdr.MsgTrans $@@ ${CPFLAGS}

${EXP_HDR}.MsgMenus: hdr.MsgMenus
        ${CP} hdr.MsgMenus $@@ ${CPFLAGS}
@


4.2
log
@Ursula and Spinner branches merged.
Changed to use srccommit.

Version 0.34. Tagged as 'MsgTrans-0_34'
@
text
@d34 2
a35 1
AS      = aasm
d38 2
d42 1
d44 2
d52 1
d54 1
d57 3
d74 1
d84 5
a88 1
${TARGET}: ${SOURCE}
d90 10
@


4.2.2.1
log
@Hash table fixes, debug version capability added
@
text
@d34 1
a34 2
AS      = objasm
LD      = link
a36 2
WIPE    = -wipe
TOUCH   = create
a38 1
ASDEBUG = -PD "AltTitleAndSWI SETL {TRUE}"
a39 2
WFLAGS  = fr~c~v
LDFLAGS = -rmf
a45 1
OBJ       = o.MsgTrans
a46 1
DBGTARGET = rm.DbgMsgTrans
a48 3
DIRS      = o._dirs
DBGOBJ    = o.DbgMsgTrans

a62 1
        ${WIPE} o ${WFLAGS}
d72 1
a72 5
${TARGET}: ${OBJ}
        ${LD} ${LDFLAGS} -o $@@ ${OBJ}


${OBJ}: ${SOURCE} ${DIRS}
a73 10

${DBGTARGET}: ${DBGOBJ}
        ${LD} ${LDFLAGS} -o $@@ ${DBGOBJ}

${DBGOBJ}: ${SOURCE} ${DIRS}
        ${AS} ${ASDEBUG} ${ASFLAGS} ${SOURCE}

${DIRS}:
        ${MKDIR} o
        ${TOUCH} $@@
@


4.1
log
@Initial revision
@
text
@d68 2
a69 1
        ${CP} Resources.${LOCALE}.Messages  ${RESDIR}.${COMPONENT}.Messages  ${CPFLAGS}
a81 21
rm.MsgTrans: Hdr:ListOpts
rm.MsgTrans: Hdr:Macros
rm.MsgTrans: Hdr:Symbols
rm.MsgTrans: Hdr:System
rm.MsgTrans: Hdr:SWIs
rm.MsgTrans: Hdr:CPU.Generic26
rm.MsgTrans: Hdr:IO.GenericIO
rm.MsgTrans: Hdr:RISCOS
rm.MsgTrans: Hdr:ModHand
rm.MsgTrans: Hdr:FSNumbers
rm.MsgTrans: Hdr:HighFSI
rm.MsgTrans: Hdr:NewErrors
rm.MsgTrans: Hdr:WimpSpace
rm.MsgTrans: Hdr:Messages
rm.MsgTrans: Hdr:Proc
rm.MsgTrans: Hdr:Services
rm.MsgTrans: Hdr:MsgTrans
rm.MsgTrans: Hdr:NDRDebug
rm.MsgTrans: Hdr:PublicWS
rm.MsgTrans: Hdr:Squash
rm.MsgTrans: Version
@


4.1.4.1
log
@Removed dynamic dependancies from Makefiles and removed all reference to Prefix
@
text
@d81 21
@


4.1.7.1
log
@NCOS 1.06 Imported from Zip drive
@
text
@@


4.1.7.2
log
@Makefile modified to use LocalRes$Path.
@
text
@d68 1
a68 2
        TokenCheck LocalRes:Messages
        ${CP} LocalRes:Messages  ${RESDIR}.${COMPONENT}.Messages  ${CPFLAGS}
@


4.1.5.1
log
@Import from SrcFiler
@
text
@@


4.1.3.1
log
@Import from cleaned 370 CD
@
text
@@


4.1.1.1
log
@Import from cleaned 360 CD
@
text
@@
