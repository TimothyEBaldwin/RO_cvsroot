head	4.9;
access;
symbols
	Manager-0_57:4.9
	Manager-0_56:4.9
	Manager-0_55:4.8
	Manager-0_54:4.7
	Manager-0_53:4.7
	Manager-0_52:4.6
	Manager-0_51:4.6
	Manager-0_50:4.6
	Manager-0_49:4.6
	Manager-0_48:4.6
	Manager-0_47:4.6
	Manager-0_46:4.5
	Manager-0_45:4.4
	Manager-0_44:4.3
	Manager-0_43:4.3
	RO_5_07:4.3
	Manager-0_42:4.3
	Manager-0_41:4.3
	Manager-0_40:4.3
	Manager-0_39:4.3
	Manager-0_38:4.3
	Manager-0_37:4.3
	dellis_autobuild_BaseSW:4.3
	Manager-0_36:4.3
	sbrodie_sedwards_16Mar2000:4.3
	dcotton_autobuild_BaseSW:4.3
	Manager-0_35:4.3
	Manager-0_34:4.3
	Manager-0_33:4.2
	Manager-0_32:4.2
	Manager-0_31:4.2
	Manager-0_30:4.2
	Manager-0_29:4.2
	Manager-0_28:4.2
	mstphens_UrsulaRiscPCBuild_20Nov98:4.1
	Ursula_RiscPC:4.1.0.8
	Manager-0_27:4.2
	Ursula_merge:4.1
	nicke_TerrManager-0_24:4.1.7.1
	bavison_TerritoryManager-0_26:4.1
	rthornb_UrsulaBuild-19Aug1998:4.1
	UrsulaBuild_FinalSoftload:4.1
	rthornb_UrsulaBuild-12Aug1998:4.1
	aglover_UrsulaBuild-05Aug1998:4.1
	rthornb_UrsulaBuild-29Jul1998:4.1
	rthornb_UrsulaBuild-22Jul1998:4.1
	rthornb_UrsulaBuild-15Jul1998:4.1
	rthornb_UrsulaBuild-07Jul1998:4.1
	rthornb_UrsulaBuild-17Jun1998:4.1
	rthornb_UrsulaBuild-03Jun1998:4.1
	rthornb_UrsulaBuild-27May1998:4.1
	rthornb_UrsulaBuild-21May1998:4.1
	rthornb_UrsulaBuild_01May1998:4.1
	afrost_Funai01-33:4.1.7.1
	afrost_NC2_Generic:4.1.7.1
	Spinner_RCA116:4.1.7.1
	Spinner_B20_2:4.1.7.1
	Spinner_19_3:4.1.7.1
	Spinner_B18:4.1.7.1
	Spinner_B17:4.1.7.1
	Spinner_B15:4.1.7.1
	Spinner_B14:4.1.7.1
	Spinner_B13:4.1.7.1
	Spinner_B12:4.1.7.1
	Spinner_B10:4.1.7.1
	Daytona:4.1.0.6
	Daytona_bp:4.1
	Ursula:4.1.0.4
	Ursula_bp:4.1
	Spinner_B7:4.1.7.1
	RO_3_71:4.1.3.1
	ARTtmp_merge:4.1.7.1
	Spin_3Apr97:4.1.7.1
	RCA_bp:4.1
	ARTtmp:4.1.7.1.0.2
	RCA:4.1.0.2
	Spin_merge:4.1.7.1
	MergeFiles:4.1.3.1
	RO_3_70:4.1.3.1
	NC_1_06:4.1.7.1
	Spinner:4.1.7
	Spin_xx:4.1.5
	NC_xx:4.1.5.1
	RO_3_60:4.1.1.1
	StrongARM:4.1.3
	Black:4.1.1;
locks; strict;
comment	@# @;


4.9
date	2013.11.24.12.03.56;	author rsprowson;	state Exp;
branches;
next	4.8;
commitid	LNbIAJL7D2eaEwex;

4.8
date	2013.03.09.15.53.37;	author rsprowson;	state Exp;
branches;
next	4.7;
commitid	TAx7w6YFEMz6h8Hw;

4.7
date	2012.08.02.19.45.16;	author rsprowson;	state Exp;
branches;
next	4.6;
commitid	i2SnhS1TFEhUA0fw;

4.6
date	2012.05.28.17.45.22;	author rsprowson;	state Exp;
branches;
next	4.5;
commitid	3IFk2KVqvs8f3w6w;

4.5
date	2012.03.10.08.50.40;	author rsprowson;	state Exp;
branches;
next	4.4;
commitid	TpQKBHqUPfJpDjWv;

4.4
date	2012.03.02.09.06.26;	author rsprowson;	state Exp;
branches;
next	4.3;
commitid	0xc2P99LjsJKYhVv;

4.3
date	99.04.19.12.33.45;	author kbracey;	state Exp;
branches;
next	4.2;

4.2
date	98.10.19.11.37.52;	author kbracey;	state Exp;
branches;
next	4.1;

4.1
date	96.11.05.09.40.29;	author nturton;	state Exp;
branches
	4.1.1.1
	4.1.3.1
	4.1.5.1
	4.1.7.1;
next	;

4.1.1.1
date	96.11.05.09.40.29;	author nturton;	state Exp;
branches;
next	;

4.1.3.1
date	96.11.06.01.55.56;	author nturton;	state Exp;
branches;
next	;

4.1.5.1
date	96.11.21.12.45.56;	author nturton;	state Exp;
branches;
next	;

4.1.7.1
date	96.11.29.21.00.51;	author nturton;	state Exp;
branches;
next	;


desc
@@


4.9
log
@Header definition of a collation flag

Version 0.56. Tagged as 'Manager-0_56'
@
text
@; Copyright 1996 Acorn Computers Ltd
;
; Licensed under the Apache License, Version 2.0 (the "License");
; you may not use this file except in compliance with the License.
; You may obtain a copy of the License at
;
;     http://www.apache.org/licenses/LICENSE-2.0
;
; Unless required by applicable law or agreed to in writing, software
; distributed under the License is distributed on an "AS IS" BASIS,
; WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
; See the License for the specific language governing permissions and
; limitations under the License.
;
        SUBT    Exported Territory Manager constants

OldOpt  SETA    {OPT}
        OPT     OptNoList+OptNoP1List

; ***********************************
; ***    C h a n g e   L i s t    ***
; ***********************************

; Date       Name         Description
; ----       ----         -----------
; 05-Feb-90  RMokady      Created file
; 07-Mar-91  ENevill      Added dummy defs for new SWIS for testing
; 10-Feb-93  BCockburn    Restored OPT correctly
; 21-Dec-93  BCockburn    Created numbers for the errors!
; 17-May-94  AMcC         Changed to using the preferred SWI base and name symbols
; 12-Oct-94  AMcC         Added SWIs TransformString and ConvertTextToString
;

SWIClass        SETS    TerritorySWI_Name

        ^       TerritorySWI_Base

        AddSWI  Number
        AddSWI  Register
        AddSWI  Deregister
        AddSWI  NumberToName
        AddSWI  Exists
        AddSWI  AlphabetNumberToName
        AddSWI  SelectAlphabet
        AddSWI  SetTime
        AddSWI  ReadCurrentTimeZone
        AddSWI  ConvertTimeToUTCOrdinals
        AddSWI  ReadTimeZones
        AddSWI  ConvertDateAndTime
        AddSWI  ConvertStandardDateAndTime
        AddSWI  ConvertStandardDate
        AddSWI  ConvertStandardTime
        AddSWI  ConvertTimeToOrdinals
        AddSWI  ConvertTimeStringToOrdinals
        AddSWI  ConvertOrdinalsToTime
        AddSWI  Alphabet
        AddSWI  AlphabetIdentifier
        AddSWI  SelectKeyboardHandler
        AddSWI  WriteDirection
        AddSWI  CharacterPropertyTable
        AddSWI  LowerCaseTable
        AddSWI  UpperCaseTable
        AddSWI  ControlTable
        AddSWI  PlainTable
        AddSWI  ValueTable
        AddSWI  RepresentationTable
        AddSWI  Collate
        AddSWI  ReadSymbols
        AddSWI  ReadCalendarInformation
        AddSWI  NameToNumber
        AddSWI  TransformString
        AddSWI  IME
        AddSWI  DaylightRules                  ; &43063
        
        ^       TerritorySWI_Base + &035

        AddSWI  ConvertTextToString            ; &43075
        AddSWI  Select
        AddSWI  DaylightSaving
        AddSWI  ConvertTimeFormats

WriteDirection_LeftToRight     *  0 :SHL: 0
WriteDirection_RightToLeft     *  1 :SHL: 0
WriteDirection_UpToDown        *  0 :SHL: 1
WriteDirection_DownToUp        *  1 :SHL: 1
WriteDirection_HorizontalLines *  0 :SHL: 2
WriteDirection_VerticalLines   *  1 :SHL: 2

                         ^ 0
Property_Control         #      1
Property_Uppercase       #      1
Property_Lowercase       #      1
Property_Alpha           #      1
Property_Punctuation     #      1
Property_Space           #      1
Property_Digit           #      1
Property_XDigit          #      1
Property_Accented        #      1
Property_ForwardFlow     #      1
Property_BackwardFlow    #      1

Collate_IgnoreCase             *  1 :SHL: 0
Collate_IgnoreAccent           *  1 :SHL: 1
Collate_InterpretCardinals     *  1 :SHL: 2
                         
ReadTimeZones_Extension  *      &454E4F5A

                                   ^ 0
DaylightSaving_ReadDSTState        #   1
DaylightSaving_WriteDSTState       #   1
DaylightSaving_DSTBit              *   1:SHL:0
DaylightSaving_AutoDSTBit          *   1:SHL:1
DaylightSaving_Supported           #   1
DaylightSaving_ApplyRuleToOrdinals #   1
DaylightSaving_ApplyRuleToTime     #   1
DaylightSaving_GetBounds           #   1

                                ^      0
TimeFormats_LocalOrdinals       #      1
TimeFormats_Local5Byte          #      1
TimeFormats_UTCOrdinals         #      1
TimeFormats_UTC5Byte            #      1
TimeFormats_InFormatShift       *      0
TimeFormats_OutFormatShift      *      8
TimeFormats_Flag_DST            *      1:SHL:16
TimeFormats_Flag_NoDST          *      0:SHL:16
TimeFormats_Flag_UseStdIfNoAuto *      1:SHL:17
TimeFormats_Flag_ErrorIfNoAuto  *      0:SHL:17
TimeFormats_Flag_UseAutoDST     *      1:SHL:18
TimeFormats_Flag_SpecifyTZ      *      0:SHL:19
TimeFormats_Flag_SpecifyOffset  *      1:SHL:19

DateAndTime_Flag_DST            *      1:SHL:28
DateAndTime_Flag_NoDST          *      0:SHL:28
DateAndTime_Flag_SpecifyTZ      *      1:SHL:29
DateAndTime_Flag_SpecifyOffset  *      0:SHL:29
DateAndTime_Flag_UseSpecified   *      1:SHL:30
DateAndTime_Flag_UseCurrent     *      0:SHL:30
DateAndTime_Flag_Extension      *      1:SHL:31

                                ^      ErrorBase_TerritoryManager
TerritoryError_UnknownTerritory #      1
TerritoryError_UnknownAlphabet  #      1
TerritoryError_NoTerritory      #      1
TerritoryError_UnknownProperty  #      1
TerritoryError_BadTimeString    #      1
TerritoryError_BadTimeBlock     #      1
TerritoryError_NoMoreZones      #      1
TerritoryError_NoRuleDefined    #      1
TerritoryError_Spare            #      8
                                ASSERT @@ <= &1A0

      [ :DEF: TerritoryService  ; Hide this during generation of CLib:swis.h
                                ^      TerritoryService
Service_TimeZoneChanged         #      1
      ]

        OPT     OldOpt

        END

@


4.8
log
@Add new flag to allow Territory_ConvertTimeFormats to take an arbitrary timezone offset in R4
Bit 19 clear behaves as before, R4 is the enumerated timezone offset within the territory, bit 19 set is an offset in centiseconds given by the caller.
ModHead.s: don't over declare the buffer size when enumerating !Territory, and mask the FS number with 0xFF to save an instruction and workaround a FileSwitch bug.
SWIs.s: New flag bit support in Territory_ConvertTimeFormats

Version 0.55. Tagged as 'Manager-0_55'
@
text
@d102 3
a104 2
Collate_IgnoreCase       *      1 :SHL: 0
Collate_IgnoreAccent     *      1 :SHL: 1
@


4.7
log
@Error from GetBounds now reports a consistent error number
Previously the error from the internal SWI call to the territory module was returned to the user, now it is translated into one in the territory manager's error range and that is returned instead.

Version 0.53. Tagged as 'Manager-0_53'
@
text
@d129 2
d135 3
a137 1
DateAndTime_Flag_SpecifyOffset  *      1:SHL:30
@


4.6
log
@Addition of support for automatic daylight saving switchover
Uses *CONFIGURE AutoDST to subsequently allow the computer to decide when to apply DST or not (the underlying CMOS bit is still set/cleared, for those applications reading it).
Messages files updated to include new syntax token.
SWI Territory_DaylightSaving and Territory_DaylightRules and Territory_ConvertTimeFormats added.
Flag definitions for all the SWIs added to exported header file.
The automatic switchover evaluates when the configure command is entered, territory is changed, or time is set (with Territory_SetTime) whether the rule is known for that year.
If no rule is known, standard time is selected, and a callback set to fire on New Year's day to try again.
If a rule is known, the next transition is calculated and a callback set.
ModHead.s
  Configure and status handlers updated for extra configuration command.
  Commoned up the OS_Byte bashing code (since the two flags bits are actually in two differenc CMOS bytes).
  *CONFIGURE <local_name_for_timezone> can now scan all timezones within a territory, not just the first.
  Magic numbers swapped for symbols where available.
  Message block and flag split into flag byte + handle word.
SWIs.s
  Daylight saving SWIs added.
  SWI Territory_ConvertTimeFormats addresses the inability to do some of the matrix of 16 combinations of local/UTC and 5 byte/ordinal conversions using the existing SWIs, and allows more conversion types to be added in the future.
TerrMgr.s
  Workspace shuffled for new functionality.
  Accept international_help switch passed in from outside.
SystemDisc
  Pixel errors in the Archimedes logo fixed.
Doc/AutoDST
Test/MultiTZTest
  Test program and SWI documentation.

Version 0.47. Tagged as 'Manager-0_47'
@
text
@a115 1
DaylightSaving_InternalSupported   #   1
d144 2
a145 1
TerritoryError_Spare            #      9
@


4.5
log
@Corrected definitions for Territory_WriteDirection.
Were encoding in bits 1-3 not bits 0-2 as documented.
Fortunately, the WindowManager used hardwired bit testing rather than these defines, and all existing territory modules use a write direction that results in zero anyway.
OSLib got it right, and the PRM details bits 0-2.
The only casualty is FontManager, therefore any newly created territories with right to left writing will need FontManager 3.72 or later.

Version 0.46. Tagged as 'Manager-0_46'
@
text
@d72 3
a74 2
        AddSWI  IME                            ; &43062

d79 2
a80 37

Territory_LookupR0  EQU XOS_SetCallBack
Territory_LookupR1  EQU XOS_SetCallBack
Territory_LookupR2  EQU XOS_SetCallBack
Territory_LookupR3  EQU XOS_SetCallBack
Territory_LookupR4  EQU XOS_SetCallBack
Territory_LookupR5  EQU XOS_SetCallBack
Territory_LookupR6  EQU XOS_SetCallBack
Territory_LookupR7  EQU XOS_SetCallBack
Territory_LookupR8  EQU XOS_SetCallBack
Territory_LookupR9  EQU XOS_SetCallBack
Territory_LookupR10 EQU XOS_SetCallBack
Territory_LookupR11 EQU XOS_SetCallBack
Territory_LookupR12 EQU XOS_SetCallBack
Territory_LookupR13 EQU XOS_SetCallBack
Territory_LookupR14 EQU XOS_SetCallBack
XTerritory_LookupR0  EQU XOS_SetCallBack
XTerritory_LookupR1  EQU XOS_SetCallBack
XTerritory_LookupR2  EQU XOS_SetCallBack
XTerritory_LookupR3  EQU XOS_SetCallBack
XTerritory_LookupR4  EQU XOS_SetCallBack
XTerritory_LookupR5  EQU XOS_SetCallBack
XTerritory_LookupR6  EQU XOS_SetCallBack
XTerritory_LookupR7  EQU XOS_SetCallBack
XTerritory_LookupR8  EQU XOS_SetCallBack
XTerritory_LookupR9  EQU XOS_SetCallBack
XTerritory_LookupR10 EQU XOS_SetCallBack
XTerritory_LookupR11 EQU XOS_SetCallBack
XTerritory_LookupR12 EQU XOS_SetCallBack
XTerritory_LookupR13 EQU XOS_SetCallBack
XTerritory_LookupR14 EQU XOS_SetCallBack
Territory_Write0 EQU OS_Write0
XTerritory_Write0 EQU XOS_Write0
Territory_WriteS EQU OS_WriteS
XTerritory_WriteS EQU XOS_WriteS
Territory_ErrorLookup EQU OS_GenerateError
XTerritory_ErrorLookup EQU XOS_GenerateError
d102 34
a135 2
Collate_IgnoreCase      *       1 :SHL: 0
Collate_IgnoreAccent    *       1 :SHL: 1
d147 6
a152 1
                                
@


4.4
log
@Allow flags to be passed to territory module SWIs from territory manager.
Allocate some more error numbers from the territory manager block.

Version 0.45. Tagged as 'Manager-0_45'
@
text
@d116 6
a121 7
WriteDirection_LeftToRight     *  0 :SHL: 1
WriteDirection_RightToLeft     *  1 :SHL: 1
WriteDirection_UpToDown        *  0 :SHL: 2
WriteDirection_DownToUp        *  1 :SHL: 2
WriteDirection_HorizontalLines *  0 :SHL: 3
WriteDirection_VerticalLines   *  1 :SHL: 3

@


4.3
log
@Added Territory_Select SWI and *Territory command.

Version 0.34. Tagged as 'Manager-0_34'
@
text
@d140 11
a150 6
                                ^       ErrorBase_TerritoryManager
TerritoryError_UnknownTerritory #       1       ; &00000190
TerritoryError_UnknownAlphabet  #       1       ; &00000191
TerritoryError_NoTerritory      #       1       ; &00000192


@


4.2
log
@Changed to use srccommit.
Modified to cope with new Hdr:CMOS.
Territory_IME SWI added.
Ursula branch merged.
German resources imported.

Version 0.27. Tagged as 'Manager-0_27'
@
text
@d77 1
@


4.1
log
@Initial revision
@
text
@d71 2
a72 1
        AddSWI  TransformString                ; &43061
d119 1
a119 1
WriteDirection_HorizontalLines *  0 :SHL: 3 
@


4.1.7.1
log
@NCOS 1.06 Imported from Zip drive
@
text
@@


4.1.5.1
log
@Import from SrcFiler
@
text
@@


4.1.3.1
log
@Import from cleaned 370 CD
@
text
@@


4.1.1.1
log
@Import from cleaned 360 CD
@
text
@@
