head	4.9;
access;
symbols
	Manager-0_57:4.8
	Manager-0_56:4.8
	Manager-0_55:4.8
	Manager-0_54:4.8
	Manager-0_53:4.8
	Manager-0_52:4.8
	Manager-0_51:4.8
	Manager-0_50:4.8
	Manager-0_49:4.8
	Manager-0_48:4.8
	Manager-0_47:4.8
	Manager-0_46:4.7
	Manager-0_45:4.7
	Manager-0_44:4.7
	Manager-0_43:4.7
	RO_5_07:4.7
	Manager-0_42:4.7
	Manager-0_41:4.7
	Manager-0_40:4.7
	Manager-0_39:4.6
	Manager-0_38:4.5
	Manager-0_37:4.5
	dellis_autobuild_BaseSW:4.4
	Manager-0_36:4.4
	sbrodie_sedwards_16Mar2000:4.4
	dcotton_autobuild_BaseSW:4.7
	Manager-0_35:4.4
	Manager-0_34:4.4
	Manager-0_33:4.4
	Manager-0_32:4.4
	Manager-0_31:4.4
	Manager-0_30:4.4
	Manager-0_29:4.3
	Manager-0_28:4.3
	mstphens_UrsulaRiscPCBuild_20Nov98:4.1.4.2
	Ursula_RiscPC:4.1.4.2.0.2
	Manager-0_27:4.2
	Ursula_merge:4.1.4.2
	nicke_TerrManager-0_24:4.1.7.2
	bavison_TerritoryManager-0_26:4.1.4.2
	rthornb_UrsulaBuild-19Aug1998:4.1.4.2
	UrsulaBuild_FinalSoftload:4.1.4.2
	rthornb_UrsulaBuild-12Aug1998:4.1.4.2
	aglover_UrsulaBuild-05Aug1998:4.1.4.2
	rthornb_UrsulaBuild-29Jul1998:4.1.4.2
	rthornb_UrsulaBuild-22Jul1998:4.1.4.2
	rthornb_UrsulaBuild-15Jul1998:4.1.4.2
	rthornb_UrsulaBuild-07Jul1998:4.1.4.2
	rthornb_UrsulaBuild-17Jun1998:4.1.4.2
	rthornb_UrsulaBuild-03Jun1998:4.1.4.2
	rthornb_UrsulaBuild-27May1998:4.1.4.2
	rthornb_UrsulaBuild-21May1998:4.1.4.2
	rthornb_UrsulaBuild_01May1998:4.1.4.2
	afrost_Funai01-33:4.1.7.2
	afrost_NC2_Generic:4.1.7.2
	Spinner_RCA116:4.1.7.2
	Spinner_B20_2:4.1.7.2
	Spinner_19_3:4.1.7.2
	Spinner_B18:4.1.7.2
	Spinner_B17:4.1.7.2
	Spinner_B15:4.1.7.2
	Spinner_B14:4.1.7.2
	Spinner_B13:4.1.7.2
	Spinner_B12:4.1.7.2
	Spinner_B10:4.1.7.2
	Daytona:4.1.0.6
	Daytona_bp:4.1
	Ursula:4.1.0.4
	Ursula_bp:4.1
	Spinner_B7:4.1.7.2
	RO_3_71:4.1.3.1
	ARTtmp_merge:4.1.7.2
	Spin_3Apr97:4.1.7.2
	RCA_bp:4.1
	ARTtmp:4.1.7.2.0.2
	RCA:4.1.0.2
	Spin_merge:4.1.7.1
	MergeFiles:4.1.3.1
	RO_3_70:4.1.3.1
	NC_1_06:4.1.7.1
	Spinner:4.1.7
	Spin_xx:4.1.5
	NC_xx:4.1.5.1
	RO_3_60:4.1.1.1
	StrongARM:4.1.3
	Black:4.1.1;
locks; strict;
comment	@# @;


4.9
date	2018.04.11.23.44.12;	author bavison;	state Exp;
branches;
next	4.8;
commitid	MmakmS4sLCZJ75yA;

4.8
date	2012.05.28.17.44.46;	author rsprowson;	state Exp;
branches;
next	4.7;
commitid	3IFk2KVqvs8f3w6w;

4.7
date	2001.03.19.15.32.37;	author sbrodie;	state Exp;
branches;
next	4.6;

4.6
date	2001.03.01.15.17.06;	author sforrest;	state Exp;
branches;
next	4.5;

4.5
date	2000.11.21.17.18.59;	author sforrest;	state Exp;
branches;
next	4.4;

4.4
date	99.01.15.18.25.49;	author kbracey;	state Exp;
branches;
next	4.3;

4.3
date	99.01.07.13.31.48;	author kbracey;	state Exp;
branches;
next	4.2;

4.2
date	98.10.19.11.37.42;	author kbracey;	state Exp;
branches;
next	4.1;

4.1
date	96.11.05.09.40.22;	author nturton;	state Exp;
branches
	4.1.1.1
	4.1.3.1
	4.1.4.1
	4.1.5.1
	4.1.7.1;
next	;

4.1.1.1
date	96.11.05.09.40.22;	author nturton;	state Exp;
branches;
next	;

4.1.3.1
date	96.11.06.01.55.23;	author nturton;	state Exp;
branches;
next	;

4.1.4.1
date	98.03.26.14.13.58;	author rthornb;	state Exp;
branches;
next	4.1.4.2;

4.1.4.2
date	98.04.14.14.40.22;	author mstphens;	state Exp;
branches;
next	;

4.1.5.1
date	96.11.21.12.45.39;	author nturton;	state Exp;
branches;
next	;

4.1.7.1
date	96.11.29.21.00.36;	author nturton;	state Exp;
branches;
next	4.1.7.2;

4.1.7.2
date	97.03.11.19.16.29;	author nturton;	state Exp;
branches;
next	;


desc
@@


4.9
log
@Leading spaces in makefile changed to tabs for GNU make compatibility
@
text
@# Copyright 1996 Acorn Computers Ltd
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
# Makefile for Territory Manager
#
# ***********************************
# ***    C h a n g e   L i s t    ***
# ***********************************
# Date       Name         Description
# ----       ----         -----------
# 25-May-94  AMcC         Created.
# 21-Nov-00  SBF          Added StripDepnd support.
# 26-Feb-01  SBF          StripDepnd support moved to MkClean
#

COMPONENT  = TerritoryManager
TARGET     = TerrMgr
HEADER1    = Territory
SPRITEFILE = z.SystemDisc

ASFLAGS    = -PD "SpriteDisc SETS \"${SPRITEFILE}\""

include StdTools
include AAsmModule

${SA_OBJECT} ${DBG_OBJECT} ${ROM_OBJECT}: ${SPRITEFILE}

${SPRITEFILE}: SystemDisc
	${SQUASH} SystemDisc $@@

clean ::
	${RM} ${SPRITEFILE}


# Dynamic dependencies:
@


4.8
log
@Addition of support for automatic daylight saving switchover
Uses *CONFIGURE AutoDST to subsequently allow the computer to decide when to apply DST or not (the underlying CMOS bit is still set/cleared, for those applications reading it).
Messages files updated to include new syntax token.
SWI Territory_DaylightSaving and Territory_DaylightRules and Territory_ConvertTimeFormats added.
Flag definitions for all the SWIs added to exported header file.
The automatic switchover evaluates when the configure command is entered, territory is changed, or time is set (with Territory_SetTime) whether the rule is known for that year.
If no rule is known, standard time is selected, and a callback set to fire on New Year's day to try again.
If a rule is known, the next transition is calculated and a callback set.
ModHead.s
  Configure and status handlers updated for extra configuration command.
  Commoned up the OS_Byte bashing code (since the two flags bits are actually in two differenc CMOS bytes).
  *CONFIGURE <local_name_for_timezone> can now scan all timezones within a territory, not just the first.
  Magic numbers swapped for symbols where available.
  Message block and flag split into flag byte + handle word.
SWIs.s
  Daylight saving SWIs added.
  SWI Territory_ConvertTimeFormats addresses the inability to do some of the matrix of 16 combinations of local/UTC and 5 byte/ordinal conversions using the existing SWIs, and allows more conversion types to be added in the future.
TerrMgr.s
  Workspace shuffled for new functionality.
  Accept international_help switch passed in from outside.
SystemDisc
  Pixel errors in the Archimedes logo fixed.
Doc/AutoDST
Test/MultiTZTest
  Test program and SWI documentation.

Version 0.47. Tagged as 'Manager-0_47'
@
text
@d40 1
a40 1
        ${SQUASH} SystemDisc $@@
d43 1
a43 1
        ${RM} ${SPRITEFILE}
@


4.7
log
@  Updated build structure to use the shared AAsmModule makefile.
  Updated to build using objasm instead of aasm.
  Sources changed to be objasm-compatible.
Detail:
  Removed additional BASIC tools that simply compress/decompress the Sprite
    file - standard squash application is used instead, and the code inside
    the Territory Manager has been updated to know that a full Squash file
    is what it has embedded within itself.  This also improves the memory
    allocation - the module is no longer praying that the sprite fits in
    25K when uncompressed ...
Admin:
  Requires Library 0.71 or later.
  Requires BuildSys 3.06 or later.
  Requires Env 0.65 or later.

Version 0.40. Tagged as 'Manager-0_40'
@
text
@d40 1
a40 1
        ${SQUASH} SystemDisc z.SystemDisc
@


4.6
log
@
  * Removed dependency on obsolete STB flag.

Detail:

  * No longer relies on the STB flag; instead utilises "Hdr:UserIF.<UserIF>"
    to provide the Embedded_UI flag.

    On Embedded systems, the picture of the Floppy disc is suppressed
    when the configured territory cannot be found.

Admin:

  * Built and tested on Lazarus 32-bit build.  Code is binary identical to
    previous versions that relied on the STB flag in both the Desktop and
    Embedded variants.

  * StripDepnd support moved from Makefile to MkClean.

  * Requires HdrSrc 1.17 or later.

Version 0.39. Tagged as 'Manager-0_39'
@
text
@d27 17
a43 66
#
# Paths
#
EXP_HDR = <export$dir>

#
# Generic options:
#
MKDIR   = cdir
AS      = objasm
LD      = link
CP      = copy
RM      = remove
WIPE    = -wipe
CCFLAGS = -c -depend !Depend -IC:
ASFLAGS = -depend !Depend -Stamp -quit ${OPTS} -To $@@ -From
LDFLAGS = -bin -o $@@
CPFLAGS = ~cfr~v
WFLAGS  = ~cfr~v

#
# Program specific options:
#
COMPONENT = TerrMgr
OBJECT    = o.TerrMgr
SOURCE    = s.TerrMgr
TARGET    = rm.TerrMgr
EXPORTS   = ${EXP_HDR}.Territory

#
# Generic rules:
#
rom: ${TARGET}
        @@echo ${COMPONENT}: rom module built

export: ${EXPORTS}
        @@echo ${COMPONENT}: export complete

install_rom: ${TARGET}
        ${CP} ${TARGET} ${INSTDIR}.${COMPONENT} ${CPFLAGS}
        @@echo ${COMPONENT}: rom module installed

clean:
        ${RM} ${TARGET}
	${WIPE} o ${WFLAGS}
        ${RM} z.SystemDisc
        @@echo ${COMPONENT}: cleaned

resources:
        ${MKDIR} ${RESDIR}.${COMPONENT}
	TokenCheck LocalRes:Messages
        ${CP} LocalRes:Messages  ${RESDIR}.${COMPONENT}.Messages  ${CPFLAGS}
        @@echo ${COMPONENT}: resource files copied

${OBJECT}: ${SOURCE} z.SystemDisc
	${MKDIR} o
        ${AS} ${ASFLAGS} ${SOURCE}

${TARGET}: ${OBJECT}
	${LD} ${LDFLAGS} ${OBJECT}
	SetType $@@ &FFA

z.SystemDisc: SystemDisc
        @@echo Compressing sprite
        MakeSprite
        stamp $@@
a44 2
${EXP_HDR}.Territory: hdr.Territory
        ${CP} hdr.Territory $@@ ${CPFLAGS}
@


4.5
log
@
  * Updated (and added) resource files.

  * Stripdepnd support included in Makefile.

Detail:

  * Taught the module about the South African territory.

  * Took the opportunity to add the missing messages files for Italy,
    Spain and Turkey.  (All the other locales fall back to the UK
    resources.)

Admin:

  * Built on RPC.

Version 0.37. Tagged as 'Manager-0_37'
@
text
@d24 1
a40 1
STRIP   = -stripdepnd
a72 1
        ${STRIP}
@


4.4
log
@Swedish messages file added. Makefile changed to use LocalRes$Path, because
we don't have any useful Norweigan, Danish or Finnish messages files.

Version 0.30. Tagged as 'Manager-0_30'
@
text
@d23 1
d40 1
d73 1
@


4.3
log
@If STB flag is set, don't bring up floppy disc prompt, just take last-
registered territory (ie last in ROM), if configured can't be found.
Also, if you add
     -options OPTS="-PD \"DontUseCMOS SETL {TRUE}\""
to the components file, it will always use the last territory in ROM,
totally ignoring the CMOS.

Version 0.28. Tagged as 'Manager-0_28'
@
text
@d75 2
a76 1
        ${CP} Resources.${LOCALE}.Messages  ${RESDIR}.${COMPONENT}.Messages  ${CPFLAGS}
@


4.2
log
@Changed to use srccommit.
Modified to cope with new Hdr:CMOS.
Territory_IME SWI added.
Ursula branch merged.
German resources imported.

Version 0.27. Tagged as 'Manager-0_27'
@
text
@d34 2
a35 1
AS      = aasm
d38 1
d40 2
a41 1
ASFLAGS = -depend !Depend -Stamp -quit -module -To $@@ -From
d43 1
d49 1
d69 1
d78 2
a79 1
${TARGET}: ${SOURCE} z.SystemDisc
d81 4
@


4.1
log
@Initial revision
@
text
@a83 27
rm.TerrMgr: Hdr:ListOpts
rm.TerrMgr: Hdr:Macros
rm.TerrMgr: Hdr:System
rm.TerrMgr: Hdr:SWIs
rm.TerrMgr: Hdr:CPU.Generic26
rm.TerrMgr: Hdr:IO.GenericIO
rm.TerrMgr: Hdr:RISCOS
rm.TerrMgr: Hdr:ModHand
rm.TerrMgr: Hdr:Services
rm.TerrMgr: Hdr:VduExt
rm.TerrMgr: Hdr:FSNumbers
rm.TerrMgr: Hdr:NewErrors
rm.TerrMgr: Hdr:Variables
rm.TerrMgr: Hdr:Proc
rm.TerrMgr: Hdr:Sprite
rm.TerrMgr: Hdr:Wimp
rm.TerrMgr: Hdr:Messages
rm.TerrMgr: Hdr:CMOS
rm.TerrMgr: Hdr:MsgTrans
rm.TerrMgr: Hdr:Squash
rm.TerrMgr: Hdr:ColourTran
rm.TerrMgr: Hdr:Territory
rm.TerrMgr: Hdr:NdrDebug
rm.TerrMgr: Version
rm.TerrMgr: s.ModHead
rm.TerrMgr: s.SWIs
rm.TerrMgr: s.Tail
@


4.1.4.1
log
@Removed dynamic dependancies from Makefiles and removed all reference to Prefix
@
text
@d84 27
@


4.1.4.2
log
@update to Ursula service format
@
text
@a83 1

@


4.1.7.1
log
@NCOS 1.06 Imported from Zip drive
@
text
@@


4.1.7.2
log
@Command line messages removed
@
text
@d67 1
a67 4
resources: resources-${CMDHELP}
        @@echo ${COMPONENT}: resource files copied

resources_common:
d70 1
a70 6

resources-None: resources_common
	@@

resources-: resources_common
	print Resources.${LOCALE}.CmdHelp { >> ${RESDIR}.${COMPONENT}.Messages }
@


4.1.5.1
log
@Import from SrcFiler
@
text
@@


4.1.3.1
log
@Import from cleaned 370 CD
@
text
@@


4.1.1.1
log
@Import from cleaned 360 CD
@
text
@@
