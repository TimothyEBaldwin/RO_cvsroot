head	4.12;
access;
symbols
	Manager-0_57:4.12
	Manager-0_56:4.12
	Manager-0_55:4.12
	Manager-0_54:4.12
	Manager-0_53:4.12
	Manager-0_52:4.11
	Manager-0_51:4.11
	Manager-0_50:4.10
	Manager-0_49:4.10
	Manager-0_48:4.10
	Manager-0_47:4.10
	Manager-0_46:4.9
	Manager-0_45:4.9
	Manager-0_44:4.9
	Manager-0_43:4.8
	RO_5_07:4.7
	Manager-0_42:4.7
	Manager-0_41:4.6
	Manager-0_40:4.5
	Manager-0_39:4.5
	Manager-0_38:4.5
	Manager-0_37:4.4
	dellis_autobuild_BaseSW:4.4
	Manager-0_36:4.4
	sbrodie_sedwards_16Mar2000:4.4
	dcotton_autobuild_BaseSW:4.5
	Manager-0_35:4.4
	Manager-0_34:4.4
	Manager-0_33:4.3
	Manager-0_32:4.3
	Manager-0_31:4.3
	Manager-0_30:4.3
	Manager-0_29:4.3
	Manager-0_28:4.3
	mstphens_UrsulaRiscPCBuild_20Nov98:4.2
	Ursula_RiscPC:4.2.0.8
	Manager-0_27:4.3
	Ursula_merge:4.2.2.1
	nicke_TerrManager-0_24:4.1.7.2
	bavison_TerritoryManager-0_26:4.2.2.1
	rthornb_UrsulaBuild-19Aug1998:4.2
	UrsulaBuild_FinalSoftload:4.2
	rthornb_UrsulaBuild-12Aug1998:4.2
	aglover_UrsulaBuild-05Aug1998:4.2
	rthornb_UrsulaBuild-29Jul1998:4.2
	rthornb_UrsulaBuild-22Jul1998:4.2
	rthornb_UrsulaBuild-15Jul1998:4.2
	rthornb_UrsulaBuild-07Jul1998:4.2
	rthornb_UrsulaBuild-17Jun1998:4.2
	rthornb_UrsulaBuild-03Jun1998:4.2
	rthornb_UrsulaBuild-27May1998:4.2
	rthornb_UrsulaBuild-21May1998:4.2
	rthornb_UrsulaBuild_01May1998:4.2
	afrost_Funai01-33:4.1.7.2
	afrost_NC2_Generic:4.1.7.2
	Spinner_RCA116:4.1.7.2
	Spinner_B20_2:4.1.7.2
	Spinner_19_3:4.1.7.2
	Spinner_B18:4.1.7.2
	Spinner_B17:4.1.7.2
	Spinner_B15:4.1.7.2
	Spinner_B14:4.1.7.2
	Spinner_B13:4.1.7.2
	Spinner_B12:4.1.7.2
	Spinner_B10:4.1.7.2
	Daytona:4.2.0.6
	Daytona_bp:4.2
	Ursula:4.2.0.2
	Ursula_bp:4.2
	Spinner_B7:4.1.7.2
	RO_3_71:4.1.3.1
	ARTtmp_merge:4.1.7.2
	Spin_3Apr97:4.1.7.2
	RCA_bp:4.2
	ARTtmp:4.1.7.2.0.2
	RCA:4.2.0.4
	Spin_merge:4.1.7.1
	MergeFiles:4.1.3.1
	RO_3_70:4.1.3.1
	NC_1_06:4.1.7.1
	Spinner:4.1.7
	Spin_xx:4.1.5
	NC_xx:4.1.5.1
	RO_3_60:4.1.1.1
	StrongARM:4.1.3
	Black:4.1.1;
locks; strict;
comment	@# @;


4.12
date	2012.08.02.19.45.13;	author rsprowson;	state Exp;
branches;
next	4.11;
commitid	i2SnhS1TFEhUA0fw;

4.11
date	2012.07.20.20.32.42;	author rsprowson;	state Exp;
branches;
next	4.10;
commitid	Z6X6fgnb49I6hldw;

4.10
date	2012.05.28.17.45.16;	author rsprowson;	state Exp;
branches;
next	4.9;
commitid	3IFk2KVqvs8f3w6w;

4.9
date	2012.02.20.21.44.00;	author rsprowson;	state Exp;
branches;
next	4.8;
commitid	42AbPoCtGtUswWTv;

4.8
date	2009.04.24.00.41.15;	author srevill;	state Exp;
branches;
next	4.7;

4.7
date	2002.12.12.11.15.47;	author rsprowson;	state Exp;
branches;
next	4.6;

4.6
date	2002.02.19.11.51.31;	author kbracey;	state Exp;
branches;
next	4.5;

4.5
date	2000.11.22.16.34.28;	author sforrest;	state Exp;
branches;
next	4.4;

4.4
date	99.04.19.12.33.39;	author kbracey;	state Exp;
branches;
next	4.3;

4.3
date	98.10.19.11.37.50;	author kbracey;	state Exp;
branches;
next	4.2;

4.2
date	97.01.20.14.12.42;	author nturton;	state Exp;
branches
	4.2.2.1;
next	4.1;

4.1
date	96.11.05.09.40.29;	author nturton;	state Exp;
branches
	4.1.1.1
	4.1.3.1
	4.1.5.1
	4.1.7.1;
next	;

4.2.2.1
date	98.09.11.18.40.15;	author bavison;	state Exp;
branches;
next	;

4.1.1.1
date	96.11.05.09.40.29;	author nturton;	state Exp;
branches;
next	;

4.1.3.1
date	96.11.06.01.55.58;	author nturton;	state Exp;
branches;
next	;

4.1.5.1
date	96.11.21.12.45.57;	author nturton;	state Exp;
branches;
next	;

4.1.7.1
date	96.11.29.21.00.52;	author nturton;	state Exp;
branches;
next	4.1.7.2;

4.1.7.2
date	97.03.11.19.16.32;	author nturton;	state Exp;
branches;
next	;


desc
@@


4.12
log
@Error from GetBounds now reports a consistent error number
Previously the error from the internal SWI call to the territory module was returned to the user, now it is translated into one in the territory manager's error range and that is returned instead.

Version 0.53. Tagged as 'Manager-0_53'
@
text
@T1:UK
T4:Italy
T5:Spain
T6:France
T7:Germany
T8:Portugal
T9:Esperanto
T10:Greece
T11:Sweden
T12:Finland
T14:Denmark
T15:Norway
T16:Iceland
T17:Canada1
T18:Canada2
T19:Canada
T20:Turkey
T21:Arabic
T22:Ireland
T23:Hong Kong
T24:Russia
T26:Israel
T27:Mexico
T28:Latin America
T29:Australia
T30:Austria
T31:Belgium
T32:Japan
T33:Middle East
T34:Netherlands
T35:Switzerland
T36:Wales
T37:Maori
T48:USA
T49:Wales2
T50:China
T51:Brazil
T52:South Africa
T53:Korea
T54:Taiwan
T70:UK (Dvorak)
T71:USA (Dvorak)
A100:BFont
A101:Latin1
A102:Latin2
A103:Latin3
A104:Latin4
A107:Greek
A108:Hebrew
A109:Latin5
A110:Welsh
A111:UTF-8
A112:Latin9
A113:Latin6
Unused:Unused?
CTSynt:Territory  <D>
CTStat:Territory  %0
TZSynt:TimeZone   [+|-]<Hours>[:<Minutes>]
TZStat:TimeZone   %0
CDSTSyn:[No|Auto]DST

#{DictTokens}
UnkTerr:Unknown territory number
UnkAlph:Unknown alphabet number
UnkSub:Unsupported subreason
Custom:Custom
NoTerr:Territory not present
BadTime:Bad time values
NoRule:No rule for given timezone
@


4.11
log
@Fix stack imbalance finding bounds for year with year = current
Add missing "BadTime" token to messages

Version 0.51. Tagged as 'Manager-0_51'
@
text
@d69 1
@


4.10
log
@Addition of support for automatic daylight saving switchover
Uses *CONFIGURE AutoDST to subsequently allow the computer to decide when to apply DST or not (the underlying CMOS bit is still set/cleared, for those applications reading it).
Messages files updated to include new syntax token.
SWI Territory_DaylightSaving and Territory_DaylightRules and Territory_ConvertTimeFormats added.
Flag definitions for all the SWIs added to exported header file.
The automatic switchover evaluates when the configure command is entered, territory is changed, or time is set (with Territory_SetTime) whether the rule is known for that year.
If no rule is known, standard time is selected, and a callback set to fire on New Year's day to try again.
If a rule is known, the next transition is calculated and a callback set.
ModHead.s
  Configure and status handlers updated for extra configuration command.
  Commoned up the OS_Byte bashing code (since the two flags bits are actually in two differenc CMOS bytes).
  *CONFIGURE <local_name_for_timezone> can now scan all timezones within a territory, not just the first.
  Magic numbers swapped for symbols where available.
  Message block and flag split into flag byte + handle word.
SWIs.s
  Daylight saving SWIs added.
  SWI Territory_ConvertTimeFormats addresses the inability to do some of the matrix of 16 combinations of local/UTC and 5 byte/ordinal conversions using the existing SWIs, and allows more conversion types to be added in the future.
TerrMgr.s
  Workspace shuffled for new functionality.
  Accept international_help switch passed in from outside.
SystemDisc
  Pixel errors in the Archimedes logo fixed.
Doc/AutoDST
Test/MultiTZTest
  Test program and SWI documentation.

Version 0.47. Tagged as 'Manager-0_47'
@
text
@d68 1
@


4.9
log
@Correct behaviour of Territory_ReadCurrentTimeZone.
Reading the current timezone now returns the current value read from the timezone CMOS (with DST applied or not as appropriate). The textual name in R0 comes from the respective territory module if the value in CMOS matches the standard time offset from the territory. If they do not match "Custom" is returned instead of pretending one thing but doing another,
Add new token "Custom" to all the messages files.

Behaviour of *CONFIGURE made more helpful.
When [un]setting the DST with *CONFIGURE [No]DST the DST bit is toggled on or off as expected.
When [un]setting the DST with *CONFIGURE [GMT|BST] (ie. the named zone for this territory) both the DST bit and timezone CMOS are updated. Likewise for other named timezones.
So, if you live in Spain using the Spain territory
*CONFIG.CET            => timezone +1:00, DST=off       "CET"
*CONFIG.TIMEZONE -4:45 => timezone -4:45, DST=unchanged "Custom"
*CONFIG.DST            => timezone -4:45, DST=on        "Custom"
*CONFIG.CEST           => timezone +1:00, DST=on        "CEST"

Fix stack imbalance when failing to resolve a territory name in *TERRITORY (Modhead line 84). Was causing an abort when toggling between two territories.
Fix a signed pointer comparison for the tail of *CONFIGURE command.
Change 1 register push/pull to use macros.
Remove trailing newlines from the non internationalised syntax messages.
Use OS_Args R0=R1=0 to read the current FS rather than having to parse the FS module's title string.
Get some more header files to remove some magic numbers in the source.
Change LNK'd files to use ".s" suffixes.

Version 0.44. Tagged as 'Manager-0_44'
@
text
@d60 1
a60 3
CDSTSyn:[NO]DST
On:DST On
Off:DST Off
d65 1
@


4.8
log
@Corrected the notation in the timezone syntax message.

Author: Rob Sprowson

Version 0.43. Tagged as 'Manager-0_43'
@
text
@d56 4
a59 2
CTSyntax:Territory  <Number>
Status:Territory  %0
a62 2
TZStat:TimeZone   %0
TZSyn:TimeZone   [+|-]<Hours>[:<Minutes>]
d67 1
a68 15

#{Token0=Territories}
HTRMTTS:*Territories lists the currently loaded territory modules. 
STRMTTS:Syntax: *Territories 
#{Token0=Territory}
HTRMTTY:*Territory sets the current territory.*Territory with no parameter displays the current territory. 
STRMTTY:Syntax: *Territory <Territory Number> 
HTRMCTY:*Configure Territory sets the default territory for the machine. 
STRMCTY:Syntax: *Configure Territory <Territory Number> 
#{Token0=}
HTRMCDS:*Configure DST sets the clock for Daylight Saving Time*Configure NODST sets the clock for Local Standard Time. 
STRMCDS:Syntax: *Configure DST | NODST 
#{Token0=TimeZone}
HTRMCTZ:*Configure TimeZone sets the time zone as an offset from UTC 
STRMCTZ:Syntax: *Configure TimeZone [+/-]<Hours>[:<Minutes>] 
@


4.7
log
@Fix to broken messages,the *configure syntax was being partially
tokenised from "Territor" to ESC PERTHOUSAND.
Also added some spaces because the status and configuration have never
lined up!

Version 0.42. Tagged as 'Manager-0_42'
@
text
@d62 1
a62 1
TZSyn:TimeZone   [+/-]<Hours>[:<Minutes>]
@


4.6
log
@Added some extra territory names to UK.Messages.

Version 0.41. Tagged as 'Manager-0_41'
@
text
@d56 2
a57 2
CTSyn:Territory <Number>
Status:Territory %0
d61 2
a62 2
TZStat:TimeZone %0
TZSyn:TimeZone [+/-]<Hours>[:<Minutes>]
@


4.5
log
@
  * The "Gremlins" have been at the files!  Added "South Africa" to the
    resources in the files that were missing the identifier.

Detail:

  * Japan, Sweden and UK were missing the territory identifier for
    territory 52 (South Africa).  Now rectified.

Admin:

  * Fault noted in development Bethany build.

Version 0.38. Tagged as 'Manager-0_38'
@
text
@d36 2
d39 2
@


4.4
log
@Added Territory_Select SWI and *Territory command.

Version 0.34. Tagged as 'Manager-0_34'
@
text
@d36 1
@


4.3
log
@Changed to use srccommit.
Modified to cope with new Hdr:CMOS.
Territory_IME SWI added.
Ursula branch merged.
German resources imported.

Version 0.27. Tagged as 'Manager-0_27'
@
text
@d68 2
@


4.2
log
@Merged
@
text
@a1 2
T2:Master
T3:Compact
a10 1
T13:Unused
d21 13
d35 3
d45 5
@


4.2.2.1
log
@Updated territory name list.
@
text
@d2 2
d13 1
a23 13
T24:Russia
T26:Israel
T27:Mexico
T28:Latin America
T29:Australia
T30:Austria
T31:Belgium
T32:Japan
T33:Middle East
T34:Netherlands
T35:Switzerland
T36:Wales
T37:Maori
a24 3
T49:Wales2
T70:UK (Dvorak)
T71:USA (Dvorak)
a31 5
A109:Latin5
A110:Welsh
A111:UTF8
A112:Latin9
A113:Latin6
@


4.1
log
@Initial revision
@
text
@d24 1
d38 2
a44 2
TZStat:TimeZone %0
TZSyn:TimeZone [+/-]<Hours>[:<Minutes>]
@


4.1.7.1
log
@NCOS 1.06 Imported from Zip drive
@
text
@a23 1
T48:USA
@


4.1.7.2
log
@Command line messages removed
@
text
@d45 13
@


4.1.5.1
log
@Import from SrcFiler
@
text
@a23 1
T48:USA
@


4.1.3.1
log
@Import from cleaned 370 CD
@
text
@a36 2
TZStat:TimeZone %0
TZSyn:TimeZone [+/-]<Hours>[:<Minutes>]
d42 2
@


4.1.1.1
log
@Import from cleaned 360 CD
@
text
@@
