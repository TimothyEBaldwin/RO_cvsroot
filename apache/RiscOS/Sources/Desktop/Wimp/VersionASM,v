head	4.185;
access;
symbols
	Wimp-5_62:4.185
	Wimp-5_61:4.184
	Wimp-5_60:4.183
	Wimp-5_59:4.182
	Wimp-5_58:4.181
	Wimp-5_57:4.180
	Wimp-5_56:4.179
	Wimp-5_55:4.178
	Wimp-5_54:4.177
	Wimp-5_53:4.176
	Wimp-5_52:4.175
	Wimp-5_51:4.174
	Wimp-5_50:4.173
	Wimp-5_49:4.172
	Wimp-5_48:4.171
	Wimp-5_47-file1ad:4.170
	Wimp-5_47:4.170
	Wimp-5_46:4.169
	Wimp-5_45:4.168
	Wimp-5_44:4.167
	Wimp-5_43:4.166
	Wimp-5_42:4.164
	Wimp-5_41:4.163
	Wimp-5_40:4.162
	Wimp-5_39:4.161
	Wimp-5_38:4.160
	Wimp-5_37:4.159
	Wimp-5_36:4.158
	Wimp-5_35:4.157
	Wimp-5_34:4.156
	Wimp-5_33:4.155
	Wimp-5_32:4.154
	Wimp-5_31:4.153
	Wimp-5_30:4.152
	Wimp-530-pre4:4.151
	Wimp-5_30-pre3:4.150
	Wimp-5_30-pre2:4.149
	Wimp-5_30-pre1:4.149
	Wimp-5_29:4.148
	Wimp-5_28:4.147
	Wimp-5_27:4.146
	Wimp-5_26:4.145
	Wimp-5_25:4.144
	Wimp-5_24:4.143
	Wimp-5_23:4.140
	Wimp-5_22:4.139
	Wimp-5_21:4.138
	Wimp-5_20:4.137
	Wimp-5_19:4.136
	Wimp-5_18:4.135
	Wimp-5_17:4.134
	Wimp-5_16:4.133
	Wimp-5_15:4.131
	Wimp-5_14:4.130
	Wimp-5_13:4.129
	Wimp-5_12:4.128
	Wimp-5_11:4.127
	Wimp-5_10:4.126
	Wimp-5_09:4.125
	Wimp-5_08:4.124
	Wimp-5_07:4.123
	Wimp-5_06:4.122
	Wimp-5_05:4.119
	Wimp-5_04:4.118
	Wimp-5_03:4.117
	Wimp-5_02:4.116
	Wimp-5_01:4.115
	Wimp-4_66-4_77_2_1:4.77.2.1
	bavison_Threads_dev:4.77.0.2
	bavison_Threads_dev_bp:4.77
	Wimp-5_00:4.113
	Wimp-4_100:4.112
	Wimp-4_99:4.111
	Wimp-4_98:4.110
	Wimp-4_97:4.109
	Wimp-4_96:4.108
	Wimp-4_95:4.107
	Wimp-4_94:4.106
	RO_5_07:4.105
	Wimp-4_93:4.105
	Wimp-4_92:4.104
	Wimp-4_91:4.103
	Wimp-4_90:4.102
	Wimp-4_89:4.101
	Wimp-4_88:4.100
	Wimp-4_87:4.99
	Wimp-4_86:4.98
	Wimp-4_85:4.97
	Wimp-4_84:4.96
	Wimp-4_83:4.95
	Wimp-4_82:4.94
	Wimp-4_81:4.93
	Wimp-4_80:4.92
	Wimp-4_79:4.91
	Wimp-4_78:4.90
	Wimp-4_77:4.89
	Wimp-4_76:4.88
	Wimp-4_75:4.87
	Wimp-4_74:4.86
	Wimp-4_73:4.85
	Wimp-4_72:4.84
	Wimp-4_71:4.83
	Wimp-4_70:4.82
	Wimp-4_69:4.81
	Wimp-4_68:4.79
	Wimp-4_67:4.78
	Wimp-4_66:4.77
	Wimp-4_65:4.76
	Wimp-4_64:4.75
	Wimp-4_63:4.74
	Wimp-4_62:4.73
	Wimp-4_61:4.72
	Wimp-4_60:4.71
	Wimp-4_59:4.70
	Wimp-4_58:4.69
	Wimp-4_36-4_46_2_6:4.46.2.6
	Wimp-4_57:4.68
	Alpnet_approved:4.46.2.5
	Wimp-4_36-4_46_2_5:4.46.2.5
	Wimp-4_56:4.67
	dellis_autobuild_BaseSW:4.66
	Wimp-4_36-4_46_2_4:4.46.2.4
	Wimp-4_36-4_46_2_3:4.46.2.3
	Wimp-4_55:4.66
	Wimp-4_54:4.65
	Wimp-4_36-4_46_2_2:4.46.2.2
	Wimp-4_53:4.64
	Wimp-4_36-4_46_2_1:4.46.2.1
	Bethany:4.46.0.2
	Wimp-4_52:4.63
	Wimp-4_51:4.62
	Wimp-4_50:4.61
	Wimp-4_49:4.60
	Wimp-4_48:4.59
	Wimp-4_47:4.57
	Wimp-4_46:4.56
	Wimp-4_45:4.55
	Wimp-4_44:4.54
	Wimp-4_43:4.53
	Wimp-4_42:4.52
	sbrodie_sedwards_16Mar2000:4.51
	Wimp-4_41:4.51
	Wimp-4_40:4.50
	Wimp-4_39:4.49
	Wimp-4_38:4.48
	Wimp-4_37:4.47
	Wimp-4_36:4.46
	Wimp-4_35:4.45
	Wimp-4_34:4.44
	Wimp-4_33:4.42
	Wimp-4_32:4.41
	Wimp-4_31:4.40
	dcotton_autobuild_BaseSW:4.81
	Wimp-4_30:4.39
	Wimp-4_29:4.38
	Wimp-4_28:4.36
	Wimp-4_27:4.35
	Wimp-4_26:4.34
	Wimp-4_25:4.33
	Wimp-4_24:4.32
	Wimp-4_23:4.31
	Wimp-4_22:4.30
	Wimp-4_21:4.29
	Wimp-4_20:4.25
	Wimp-4_19:4.24
	Wimp-4_18:4.23
	Wimp-4_17:4.22
	Wimp-4_16:4.21
	Wimp-4_15:4.20
	Wimp-4_14:4.17
	Wimp-4_13:4.15
	Wimp-4_12:4.14
	bavison_Wimp-4_11:4.13
	Wimp-4_11:4.13
	Wimp-4_10:4.12
	Wimp-4_09:4.11
	Wimp-4_08:4.10
	Wimp-4_07:4.9
	Wimp-4_06:4.8
	Wimp-4_05:4.7
	Wimp-4_04:4.6
	bavison_Wimp-4_03_noshrinkables:4.5
	Wimp-4_03:4.5
	Wimp-4_02:4.4
	bavison_Wimp-4_01:4.2
	Wimp-4_01:4.2;
locks; strict;
comment	@# @;


4.185
date	2018.07.01.12.05.07;	author jlee;	state Exp;
branches;
next	4.184;
commitid	TwXih5IHBSRwEqIA;

4.184
date	2018.03.18.10.32.16;	author rsprowson;	state Exp;
branches;
next	4.183;
commitid	S9yLHgujbwdVvVuA;

4.183
date	2018.02.17.15.20.24;	author jlee;	state Exp;
branches;
next	4.182;
commitid	E4WYFV9zLEaz2erA;

4.182
date	2017.07.24.20.32.56;	author jlee;	state Exp;
branches;
next	4.181;
commitid	JCLe8rNfSgjisw0A;

4.181
date	2017.04.11.21.55.20;	author rsprowson;	state Exp;
branches;
next	4.180;
commitid	0CryT2wkOiYOfaNz;

4.180
date	2017.04.08.19.44.05;	author rool;	state Exp;
branches;
next	4.179;
commitid	UUrozP4arUCMCLMz;

4.179
date	2017.03.25.20.07.24;	author jlee;	state Exp;
branches;
next	4.178;
commitid	9fJyMcIucZtGcYKz;

4.178
date	2016.09.16.08.29.49;	author rsprowson;	state Exp;
branches;
next	4.177;
commitid	eKFkQ8ZKIex1sumz;

4.177
date	2016.05.28.18.52.50;	author jlee;	state Exp;
branches;
next	4.176;
commitid	TTWlrzl5OHkYsh8z;

4.176
date	2016.05.23.21.53.10;	author jlee;	state Exp;
branches;
next	4.175;
commitid	JVRG5UWTKsMNCE7z;

4.175
date	2016.05.08.16.48.40;	author jlee;	state Exp;
branches;
next	4.174;
commitid	xXPn2osqjffdqH5z;

4.174
date	2015.11.29.19.57.09;	author jlee;	state Exp;
branches;
next	4.173;
commitid	bEIfj6rhNgsJD1Ly;

4.173
date	2015.10.10.12.14.15;	author jlee;	state Exp;
branches;
next	4.172;
commitid	hTZlaaPZyibzGyEy;

4.172
date	2015.09.01.21.04.04;	author jlee;	state Exp;
branches;
next	4.171;
commitid	QMv9svFdvVc4SAzy;

4.171
date	2015.07.08.07.57.17;	author rsprowson;	state Exp;
branches;
next	4.170;
commitid	QCjUcO42q8VKhssy;

4.170
date	2014.11.15.15.08.38;	author rsprowson;	state Exp;
branches;
next	4.169;
commitid	Z8XGy2JwyQ0sdiYx;

4.169
date	2014.09.24.20.28.50;	author bavison;	state Exp;
branches;
next	4.168;
commitid	A3t3mIm4BN0zFDRx;

4.168
date	2014.09.05.07.37.41;	author rsprowson;	state Exp;
branches;
next	4.167;
commitid	fuQh7ElpvcoR08Px;

4.167
date	2014.08.18.19.56.16;	author rsprowson;	state Exp;
branches;
next	4.166;
commitid	e8CwH6bg9Kc7GSMx;

4.166
date	2014.07.20.08.02.04;	author rsprowson;	state Exp;
branches;
next	4.165;
commitid	dYAocC6tl2fSE5Jx;

4.165
date	2014.07.02.23.07.49;	author jlee;	state Exp;
branches;
next	4.164;
commitid	M6QkxZ2CarevfRGx;

4.164
date	2014.05.28.19.11.45;	author rsprowson;	state Exp;
branches;
next	4.163;
commitid	9QyMnCxTPiHg4lCx;

4.163
date	2014.04.19.09.39.15;	author rsprowson;	state Exp;
branches;
next	4.162;
commitid	wEWgncfqw43A9hxx;

4.162
date	2014.04.18.14.20.31;	author jlee;	state Exp;
branches;
next	4.161;
commitid	pByMhPD26mc4Kaxx;

4.161
date	2014.04.13.13.53.16;	author jlee;	state Exp;
branches;
next	4.160;
commitid	1vwXUmZfh2aHKwwx;

4.160
date	2014.03.27.23.23.02;	author jlee;	state Exp;
branches;
next	4.159;
commitid	peEWW3P1EQW1soux;

4.159
date	2014.03.09.17.39.40;	author jlee;	state Exp;
branches;
next	4.158;
commitid	jtr40bk3ymV683sx;

4.158
date	2014.03.01.22.42.54;	author jlee;	state Exp;
branches;
next	4.157;
commitid	KQ4bwdJetbz443rx;

4.157
date	2014.01.01.19.47.51;	author jlee;	state Exp;
branches;
next	4.156;
commitid	LFYgvVGTUEWBZrjx;

4.156
date	2013.11.30.01.22.01;	author jlee;	state Exp;
branches;
next	4.155;
commitid	NHBF77CIMgF0Uefx;

4.155
date	2013.10.07.22.18.31;	author jlee;	state Exp;
branches;
next	4.154;
commitid	ATrKhtPyAxgGAp8x;

4.154
date	2013.09.08.18.53.24;	author rsprowson;	state Exp;
branches;
next	4.153;
commitid	46q23XZLtAc5oF4x;

4.153
date	2013.08.06.23.31.39;	author jlee;	state Exp;
branches;
next	4.152;
commitid	UbPZokvIlfdkZr0x;

4.152
date	2013.06.01.17.06.13;	author rsprowson;	state Exp;
branches;
next	4.151;
commitid	cfrGRVe6q9kCYVRw;

4.151
date	2013.06.01.16.46.04;	author rsprowson;	state Exp;
branches;
next	4.150;
commitid	JN66OJ2rTo2LQVRw;

4.150
date	2013.06.01.16.24.59;	author rsprowson;	state Exp;
branches;
next	4.149;
commitid	ED2vOQIaX05JJVRw;

4.149
date	2013.06.01.16.05.13;	author rsprowson;	state Exp;
branches;
next	4.148;
commitid	vUA7bZz16PeFCVRw;

4.148
date	2013.05.21.20.43.56;	author rsprowson;	state Exp;
branches;
next	4.147;
commitid	Jlxs4TLFYcOfxxQw;

4.147
date	2013.05.18.21.34.00;	author rsprowson;	state Exp;
branches;
next	4.146;
commitid	B6xHcuBGwemoU9Qw;

4.146
date	2013.05.11.15.12.00;	author rsprowson;	state Exp;
branches;
next	4.145;
commitid	t0VXhGy6ECMh1ePw;

4.145
date	2013.05.09.20.53.27;	author rsprowson;	state Exp;
branches;
next	4.144;
commitid	AOn93h8uizkqYZOw;

4.144
date	2013.05.06.11.54.41;	author rsprowson;	state Exp;
branches;
next	4.143;
commitid	dyQdYmrTRpty5zOw;

4.143
date	2013.05.03.21.08.05;	author rsprowson;	state Exp;
branches;
next	4.142;
commitid	QS59VqQdUOQmfeOw;

4.142
date	2013.05.03.19.53.51;	author rsprowson;	state Exp;
branches;
next	4.141;
commitid	Bx7Y6yIqPRCWPdOw;

4.141
date	2013.04.27.10.17.30;	author rsprowson;	state Exp;
branches;
next	4.140;
commitid	qlaYPAdsRZtaQoNw;

4.140
date	2013.04.13.08.16.40;	author rsprowson;	state Exp;
branches;
next	4.139;
commitid	DLq3yhcS0mdCCALw;

4.139
date	2013.04.10.20.48.39;	author rsprowson;	state Exp;
branches;
next	4.138;
commitid	oyotsfYRPfGzSgLw;

4.138
date	2013.03.31.17.40.46;	author jlee;	state Exp;
branches;
next	4.137;
commitid	9aIcBqwZ8383aYJw;

4.137
date	2013.03.28.08.07.29;	author rsprowson;	state Exp;
branches;
next	4.136;
commitid	6IoKYZf9tBXk5xJw;

4.136
date	2012.10.09.10.46.23;	author srevill;	state Exp;
branches;
next	4.135;
commitid	WqfOR3Y0AhREqHnw;

4.135
date	2012.08.11.20.42.10;	author rsprowson;	state Exp;
branches;
next	4.134;
commitid	bqZXzQ4h5FSDCagw;

4.134
date	2012.07.14.20.24.02;	author jlee;	state Exp;
branches;
next	4.133;
commitid	FRUG5j8wS2ldqzcw;

4.133
date	2012.07.08.23.15.37;	author jlee;	state Exp;
branches;
next	4.132;
commitid	3zoMINGB5Xq2zObw;

4.132
date	2012.06.24.17.53.23;	author rsprowson;	state Exp;
branches;
next	4.131;
commitid	DcNZ4Jj5yRyneZ9w;

4.131
date	2012.06.23.09.22.13;	author rsprowson;	state Exp;
branches;
next	4.130;
commitid	EU9dc3pmPjF0rO9w;

4.130
date	2012.01.23.08.03.42;	author rsprowson;	state Exp;
branches;
next	4.129;
commitid	6P5Pgy6PliwZSgQv;

4.129
date	2011.08.04.20.33.27;	author jlee;	state Exp;
branches;
next	4.128;
commitid	gzFhtZcn753Zyeuv;

4.128
date	2011.04.14.14.43.28;	author bavison;	state Exp;
branches;
next	4.127;
commitid	1v7Zm1Siw2Y3eOfv;

4.127
date	2011.02.01.23.00.24;	author jlee;	state Exp;
branches;
next	4.126;

4.126
date	2010.12.04.17.48.51;	author jlee;	state Exp;
branches;
next	4.125;

4.125
date	2010.11.26.18.47.48;	author jlee;	state Exp;
branches;
next	4.124;

4.124
date	2010.03.14.17.51.32;	author jlee;	state Exp;
branches;
next	4.123;

4.123
date	2009.11.06.23.32.26;	author jlee;	state Exp;
branches;
next	4.122;

4.122
date	2009.10.01.01.26.39;	author srevill;	state Exp;
branches;
next	4.121;

4.121
date	2009.06.15.23.33.22;	author bavison;	state Exp;
branches;
next	4.120;

4.120
date	2009.06.11.20.57.37;	author bavison;	state Exp;
branches;
next	4.119;

4.119
date	2009.04.20.09.30.02;	author jballance;	state Exp;
branches;
next	4.118;

4.118
date	2008.09.10.15.49.08;	author srevill;	state Exp;
branches;
next	4.117;

4.117
date	2008.09.10.15.47.56;	author srevill;	state Exp;
branches;
next	4.116;

4.116
date	2008.09.10.15.47.13;	author srevill;	state Exp;
branches;
next	4.115;

4.115
date	2008.07.12.23.45.16;	author bavison;	state Exp;
branches;
next	4.114;

4.114
date	2007.10.07.02.45.15;	author bavison;	state Exp;
branches;
next	4.113;
commitid	Ly69j4EtCjOCyBAs;

4.113
date	2006.02.23.13.56.33;	author jballance;	state Exp;
branches;
next	4.112;

4.112
date	2006.02.22.09.17.53;	author jballance;	state Exp;
branches;
next	4.111;

4.111
date	2006.01.17.10.30.23;	author jballance;	state Exp;
branches;
next	4.110;

4.110
date	2006.01.11.14.17.18;	author srevill;	state Exp;
branches;
next	4.109;

4.109
date	2006.01.05.22.25.03;	author jballance;	state Exp;
branches;
next	4.108;

4.108
date	2006.01.05.13.00.16;	author jballance;	state Exp;
branches;
next	4.107;

4.107
date	2005.09.11.16.47.28;	author jballance;	state Exp;
branches;
next	4.106;

4.106
date	2005.04.26.13.10.40;	author kbracey;	state Exp;
branches;
next	4.105;

4.105
date	2004.08.12.14.31.24;	author jballance;	state Exp;
branches;
next	4.104;

4.104
date	2004.07.05.13.17.42;	author bavison;	state Exp;
branches;
next	4.103;

4.103
date	2003.04.22.10.51.59;	author bavison;	state Exp;
branches;
next	4.102;

4.102
date	2003.03.31.16.30.30;	author bavison;	state Exp;
branches;
next	4.101;

4.101
date	2003.02.28.16.09.29;	author bavison;	state Exp;
branches;
next	4.100;

4.100
date	2003.02.04.14.22.19;	author bavison;	state Exp;
branches;
next	4.99;

4.99
date	2003.01.24.19.14.20;	author bavison;	state Exp;
branches;
next	4.98;

4.98
date	2003.01.23.19.41.13;	author bavison;	state Exp;
branches;
next	4.97;

4.97
date	2003.01.17.19.35.20;	author bavison;	state Exp;
branches;
next	4.96;

4.96
date	2002.12.20.19.48.16;	author bavison;	state Exp;
branches;
next	4.95;

4.95
date	2002.12.13.21.57.22;	author bavison;	state Exp;
branches;
next	4.94;

4.94
date	2002.12.05.19.28.06;	author bavison;	state Exp;
branches;
next	4.93;

4.93
date	2002.11.28.17.25.35;	author bavison;	state Exp;
branches;
next	4.92;

4.92
date	2002.11.28.10.52.49;	author kbracey;	state Exp;
branches;
next	4.91;

4.91
date	2002.10.31.17.00.15;	author bavison;	state Exp;
branches;
next	4.90;

4.90
date	2002.10.30.17.43.41;	author bavison;	state Exp;
branches;
next	4.89;

4.89
date	2002.10.25.15.34.23;	author bavison;	state Exp;
branches;
next	4.88;

4.88
date	2002.10.23.17.12.26;	author bavison;	state Exp;
branches;
next	4.87;

4.87
date	2002.08.22.21.40.05;	author bavison;	state Exp;
branches;
next	4.86;

4.86
date	2002.02.21.17.32.01;	author mmoir;	state Exp;
branches;
next	4.85;

4.85
date	2002.02.20.17.26.33;	author srevill;	state Exp;
branches;
next	4.84;

4.84
date	2002.01.11.09.53.22;	author bavison;	state Exp;
branches;
next	4.83;

4.83
date	2001.11.30.19.32.39;	author srevill;	state Exp;
branches;
next	4.82;

4.82
date	2001.10.29.16.49.56;	author srevill;	state Exp;
branches;
next	4.81;

4.81
date	2001.09.14.21.27.14;	author bavison;	state Exp;
branches;
next	4.80;

4.80
date	2001.07.13.11.58.13;	author dcotton;	state Exp;
branches;
next	4.79;

4.79
date	2001.06.26.13.31.52;	author ahodgkin;	state Exp;
branches;
next	4.78;

4.78
date	2001.05.29.11.44.05;	author bavison;	state Exp;
branches;
next	4.77;

4.77
date	2001.05.25.09.28.53;	author jkelly;	state Exp;
branches
	4.77.2.1;
next	4.76;

4.76
date	2001.03.23.16.49.08;	author bavison;	state Exp;
branches;
next	4.75;

4.75
date	2001.03.16.17.04.38;	author sbrodie;	state Exp;
branches;
next	4.74;

4.74
date	2001.03.15.15.17.47;	author bavison;	state Exp;
branches;
next	4.73;

4.73
date	2001.02.23.18.19.03;	author sbrodie;	state Exp;
branches;
next	4.72;

4.72
date	2001.01.05.13.42.49;	author sbrodie;	state Exp;
branches;
next	4.71;

4.71
date	2000.11.30.15.44.03;	author bavison;	state Exp;
branches;
next	4.70;

4.70
date	2000.11.08.10.47.49;	author kbracey;	state Exp;
branches;
next	4.69;

4.69
date	2000.11.03.16.01.16;	author bavison;	state Exp;
branches;
next	4.68;

4.68
date	2000.10.20.12.44.25;	author bavison;	state Exp;
branches;
next	4.67;

4.67
date	2000.10.19.15.17.12;	author sforrest;	state Exp;
branches;
next	4.66;

4.66
date	2000.09.08.16.17.05;	author sforrest;	state Exp;
branches;
next	4.65;

4.65
date	2000.08.11.14.47.34;	author sforrest;	state Exp;
branches;
next	4.64;

4.64
date	2000.06.20.14.33.56;	author bavison;	state Exp;
branches;
next	4.63;

4.63
date	2000.06.15.09.23.38;	author bavison;	state Exp;
branches;
next	4.62;

4.62
date	2000.06.06.12.38.23;	author bavison;	state Exp;
branches;
next	4.61;

4.61
date	2000.05.15.11.04.44;	author sbrodie;	state Exp;
branches;
next	4.60;

4.60
date	2000.04.28.17.28.46;	author pskirrow;	state Exp;
branches;
next	4.59;

4.59
date	2000.04.27.14.30.38;	author jberanek;	state Exp;
branches;
next	4.58;

4.58
date	2000.04.26.10.11.22;	author kbracey;	state Exp;
branches;
next	4.57;

4.57
date	2000.04.25.12.23.59;	author kbracey;	state Exp;
branches;
next	4.56;

4.56
date	2000.04.13.14.20.53;	author jberanek;	state Exp;
branches;
next	4.55;

4.55
date	2000.04.10.10.37.41;	author jberanek;	state Exp;
branches;
next	4.54;

4.54
date	2000.04.06.12.07.53;	author bavison;	state Exp;
branches;
next	4.53;

4.53
date	2000.03.30.14.38.33;	author bavison;	state Exp;
branches;
next	4.52;

4.52
date	2000.03.29.13.58.59;	author bavison;	state Exp;
branches;
next	4.51;

4.51
date	2000.03.07.10.39.34;	author jberanek;	state Exp;
branches;
next	4.50;

4.50
date	2000.02.16.16.07.50;	author bavison;	state Exp;
branches;
next	4.49;

4.49
date	2000.02.04.17.02.21;	author kbracey;	state Exp;
branches;
next	4.48;

4.48
date	2000.02.02.15.24.25;	author jberanek;	state Exp;
branches;
next	4.47;

4.47
date	2000.01.07.13.18.25;	author kbracey;	state Exp;
branches;
next	4.46;

4.46
date	99.11.24.16.41.30;	author sforrest;	state Exp;
branches
	4.46.2.1;
next	4.45;

4.45
date	99.11.22.12.09.20;	author bavison;	state Exp;
branches;
next	4.44;

4.44
date	99.11.09.11.00.10;	author nbingham;	state Exp;
branches;
next	4.43;

4.43
date	99.11.04.13.48.25;	author sforrest;	state Exp;
branches;
next	4.42;

4.42
date	99.11.03.13.43.20;	author sforrest;	state Exp;
branches;
next	4.41;

4.41
date	99.10.07.13.28.06;	author bavison;	state Exp;
branches;
next	4.40;

4.40
date	99.09.28.10.58.17;	author sforrest;	state Exp;
branches;
next	4.39;

4.39
date	99.09.23.13.12.45;	author sforrest;	state Exp;
branches;
next	4.38;

4.38
date	99.09.10.11.03.21;	author sforrest;	state Exp;
branches;
next	4.37;

4.37
date	99.09.08.13.17.23;	author sforrest;	state Exp;
branches;
next	4.36;

4.36
date	99.09.07.16.06.45;	author sforrest;	state Exp;
branches;
next	4.35;

4.35
date	99.08.18.12.58.12;	author kbracey;	state Exp;
branches;
next	4.34;

4.34
date	99.08.05.16.39.06;	author nbingham;	state Exp;
branches;
next	4.33;

4.33
date	99.08.05.14.23.15;	author nbingham;	state Exp;
branches;
next	4.32;

4.32
date	99.08.04.14.15.08;	author bavison;	state Exp;
branches;
next	4.31;

4.31
date	99.08.03.18.45.43;	author bavison;	state Exp;
branches;
next	4.30;

4.30
date	99.07.26.17.23.33;	author rthornb;	state Exp;
branches;
next	4.29;

4.29
date	99.07.26.15.44.55;	author nbingham;	state Exp;
branches;
next	4.28;

4.28
date	99.06.23.10.52.49;	author sforrest;	state Exp;
branches;
next	4.27;

4.27
date	99.05.26.15.55.06;	author smiddle;	state Exp;
branches;
next	4.26;

4.26
date	99.05.12.16.09.15;	author smiddle;	state Exp;
branches;
next	4.25;

4.25
date	99.04.29.14.33.32;	author kbracey;	state Exp;
branches;
next	4.24;

4.24
date	99.04.29.11.01.56;	author kbracey;	state Exp;
branches;
next	4.23;

4.23
date	99.04.28.13.04.47;	author kbracey;	state Exp;
branches;
next	4.22;

4.22
date	99.03.25.14.15.35;	author smiddle;	state Exp;
branches;
next	4.21;

4.21
date	99.03.17.15.01.31;	author bavison;	state Exp;
branches;
next	4.20;

4.20
date	99.02.25.14.46.51;	author nturton;	state Exp;
branches;
next	4.19;

4.19
date	99.02.08.12.12.18;	author nturton;	state Exp;
branches;
next	4.18;

4.18
date	99.01.11.18.04.42;	author nturton;	state Exp;
branches;
next	4.17;

4.17
date	99.01.07.12.07.01;	author kbracey;	state Exp;
branches;
next	4.16;

4.16
date	98.12.09.12.56.45;	author bavison;	state Exp;
branches;
next	4.15;

4.15
date	98.11.27.20.56.05;	author bavison;	state Exp;
branches;
next	4.14;

4.14
date	98.11.26.14.04.38;	author bavison;	state Exp;
branches;
next	4.13;

4.13
date	98.11.09.12.48.45;	author bavison;	state Exp;
branches;
next	4.12;

4.12
date	98.10.29.13.18.49;	author bavison;	state Exp;
branches;
next	4.11;

4.11
date	98.10.23.15.48.07;	author bavison;	state Exp;
branches;
next	4.10;

4.10
date	98.10.22.13.55.14;	author bavison;	state Exp;
branches;
next	4.9;

4.9
date	98.10.21.14.50.11;	author bavison;	state Exp;
branches;
next	4.8;

4.8
date	98.10.20.16.20.01;	author bavison;	state Exp;
branches;
next	4.7;

4.7
date	98.10.12.14.53.27;	author sforrest;	state Exp;
branches;
next	4.6;

4.6
date	98.10.12.14.08.41;	author kbracey;	state Exp;
branches;
next	4.5;

4.5
date	98.10.09.11.15.44;	author sforrest;	state Exp;
branches;
next	4.4;

4.4
date	98.10.07.16.34.17;	author scormie;	state Exp;
branches;
next	4.3;

4.3
date	98.10.01.14.12.57;	author kbracey;	state Exp;
branches;
next	4.2;

4.2
date	98.09.30.09.05.17;	author kbracey;	state Exp;
branches;
next	4.1;

4.1
date	98.09.30.08.51.35;	author kbracey;	state Exp;
branches;
next	;

4.77.2.1
date	2007.10.07.02.17.28;	author bavison;	state Exp;
branches;
next	;
commitid	NSavcPvbNd36pBAs;

4.46.2.1
date	2000.06.15.14.55.51;	author sforrest;	state Exp;
branches;
next	4.46.2.2;

4.46.2.2
date	2000.08.11.14.40.17;	author sforrest;	state Exp;
branches;
next	4.46.2.3;

4.46.2.3
date	2000.09.08.16.21.21;	author sforrest;	state Exp;
branches;
next	4.46.2.4;

4.46.2.4
date	2000.09.25.12.58.16;	author sforrest;	state Exp;
branches;
next	4.46.2.5;

4.46.2.5
date	2000.10.19.15.20.54;	author sforrest;	state Exp;
branches;
next	4.46.2.6;

4.46.2.6
date	2000.10.25.14.57.34;	author sforrest;	state Exp;
branches;
next	;


desc
@@


4.185
log
@Fix handling of tool sprite palettes in alpha-blended screen modes
Detail:
  s/Wimp10 - Update mastertoactive to force the palette/translation table to be sent through ColourTrans if either &RGB component ordering or alpha blending is in use for the current screen mode. Otherwise, for alpha modes, the alpha channel would typically be left at zero.
Admin:
  Tested on Raspberry Pi 3


Version 5.62. Tagged as 'Wimp-5_62'
@
text
@;
; This file is automatically maintained by srccommit, do not edit manually.
; Last processed by srccommit version: 1.1.
;
                        GBLS    Module_MajorVersion
                        GBLA    Module_Version
                        GBLS    Module_MinorVersion
                        GBLS    Module_Date
                        GBLS    Module_FullVersion
                        GBLS    Module_ApplicationDate
                        GBLS    Module_HelpVersion
                        GBLS    Module_ComponentName
                        GBLS    Module_ComponentPath
Module_MajorVersion     SETS    "5.62"
Module_Version          SETA    562
Module_MinorVersion     SETS    ""
Module_Date             SETS    "01 Jul 2018"
Module_ApplicationDate  SETS    "01-Jul-18"
Module_ComponentName    SETS    "Wimp"
Module_ComponentPath    SETS    "castle/RiscOS/Sources/Desktop/Wimp"
Module_FullVersion      SETS    "5.62"
Module_HelpVersion      SETS    "5.62 (01 Jul 2018)"
                        END
@


4.184
log
@Fix for bad error pointer deleting non existent sprite
Doing *WimpKillSprite _not_there_  had the following behaviour

Priority   | Sprite exists  Sprite doesn't  Sprite is ROM
Lo then Hi | Deletes        Bad error ptr   Silence
Hi then Lo | Deletes        Silence         Silence

The bad error pointer was caused by an early return if the high priority pool is the ROM sprites (because the earlier failure to find it in the low priority pools set V, and the early return used TEQ, so the error pointer in R0 was the SpriteOp reason code).
Proceed to try to look up the sprite, even if there's no hope of deleting it, in order to get a valid error message.

Version 5.61. Tagged as 'Wimp-5_61'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.61"
Module_Version          SETA    561
d17 2
a18 2
Module_Date             SETS    "18 Mar 2018"
Module_ApplicationDate  SETS    "18-Mar-18"
d21 2
a22 2
Module_FullVersion      SETS    "5.61"
Module_HelpVersion      SETS    "5.61 (18 Mar 2018)"
@


4.183
log
@Fix crashes when a Wimp_Poll post-filter causes the Wimp to postpone switching to a VFP-enabled task
Detail:
  s/Wimp07 - In ExitPoll, swap around the order of restoring the FP context and calling the poll post-filter so that the FP context is restored after the post-poll filter has been invoked. Previously, the VFP(+FPA) context would be restored, then the post-poll filter would be invoked. If the post-poll filter was claimed, the Wimp would then scan the pollwords again and most likely decide to switch to a different task. The appslot will then be switched over, and ExitPoll will be invoked again, attempting to restore the VFP/FPA context for that task - potentially causing a crash or other bad things because the VFP context used by the original choice of task is no longer paged in. For FPA this was never really a problem, since the context is stored in the RMA rather than being potentially stored in appspace.
  s/Wimp03 - Add some extra debug out for tracking VFP context management
Admin:
  Tested on wandboard
  Fixes issue reported on forums, where using the numpad in VFP SciCalc would cause a crash if KeyExtend was loaded:
  https://www.riscosopen.org/forum/forums/4/topics/10293


Version 5.60. Tagged as 'Wimp-5_60'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.60"
Module_Version          SETA    560
d17 2
a18 2
Module_Date             SETS    "17 Feb 2018"
Module_ApplicationDate  SETS    "17-Feb-18"
d21 2
a22 2
Module_FullVersion      SETS    "5.60"
Module_HelpVersion      SETS    "5.60 (17 Feb 2018)"
@


4.182
log
@Remove startup delay from power saving code
Detail:
  s/Wimp02 - Get rid of the magic ~30 second delay before the Portable_Speed/Portable_Idle power saving kicks in. The fast/slow thresholds are self-adjusting, and any non-null poll event will kick the system into high speed, so removing the startup delay isn't likely to have any adverse affect on desktop startup time.
  s/Wimp01 - MaxIdleEvents is now redundant, remove it
Admin:
  Tested on Raspberry Pi 3
  Should resolve issue reported on the forums where RPCEmu thrashes the hosts's CPU for 30 seconds after entering the desktop:
  https://www.riscosopen.org/forum/forums/10/topics/8990


Version 5.59. Tagged as 'Wimp-5_59'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.59"
Module_Version          SETA    559
d17 2
a18 2
Module_Date             SETS    "24 Jul 2017"
Module_ApplicationDate  SETS    "24-Jul-17"
d21 2
a22 2
Module_FullVersion      SETS    "5.59"
Module_HelpVersion      SETS    "5.59 (24 Jul 2017)"
@


4.181
log
@Gate the recache of currentmode
The operations at module init and at Service_PreReset are both implicitly pre desktop, however it is valid to have Service_ModeFileChanged while in the desktop (for example, if selecting a different MDF from !ScrnSetup).
Gate the one hanging off Service_ModeFileChanged to only act when there are no tasks active (ie. outside the Wimp).
Fixes problem reported https://www.riscosopen.org/forum/forums/4/topics/9206 with NetSurf redraw.

Version 5.58. Tagged as 'Wimp-5_58'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.58"
Module_Version          SETA    558
d17 2
a18 2
Module_Date             SETS    "11 Apr 2017"
Module_ApplicationDate  SETS    "11-Apr-17"
d21 2
a22 2
Module_FullVersion      SETS    "5.58"
Module_HelpVersion      SETS    "5.58 (11 Apr 2017)"
@


4.180
log
@Recache currentmode at the right time
Detail:
  Modification to make the Wimp reread 'currentmode' by calling OS_ReadSysInfo 1 in the following circumstances
  1. On module init (accounts for being softloaded off disc)
  2. At Service_Reset (accounts for any graphics driver starting after it in ROM module order)
  3. When Service_ModeFileChange (new, this catches the new mode selected by an MDF or EDID during !Boot)
  Commoned up these 3 cases into 1 function.
  This restores the design intent that to get the monitor's native resolution it is *not* required to configure the MonitorType=EDID, indeed doing so wouldn't have helped loading EDID off disc if the monitor's data is found to be incorrect and needing overriding.
Admin:
  Tested on a Pandaboard with MonitorType=Auto and resolution chosen as "Native", resulting in a desktop at the panel resolution.

Version 5.57. Tagged as 'Wimp-5_57'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.57"
Module_Version          SETA    557
d17 2
a18 2
Module_Date             SETS    "08 Apr 2017"
Module_ApplicationDate  SETS    "08-Apr-17"
d21 2
a22 2
Module_FullVersion      SETS    "5.57"
Module_HelpVersion      SETS    "5.57 (08 Apr 2017)"
@


4.179
log
@Fix use of uninitialised pointer
Detail:
  s/Wimp01 - initwcfda tries to look up the dynamic area name using MsgTrans, so make sure the 'messages' pointer is initialised before we call it
Admin:
  Tested on iMx6


Version 5.56. Tagged as 'Wimp-5_56'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.56"
Module_Version          SETA    556
d17 2
a18 2
Module_Date             SETS    "25 Mar 2017"
Module_ApplicationDate  SETS    "25-Mar-17"
d21 2
a22 2
Module_FullVersion      SETS    "5.56"
Module_HelpVersion      SETS    "5.56 (25 Mar 2017)"
@


4.178
log
@[399] Menu shortcuts misplaced if the menu has a scroll bar
When a menu is so tall it gains a scroll bar, the shortcuts were incorrectly justified.
Change the MOVE VDU sequence prior to plotting the menu entry so Font Manager justifies the text correctly.

Version 5.55. Tagged as 'Wimp-5_55'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.55"
Module_Version          SETA    555
d17 2
a18 2
Module_Date             SETS    "16 Sep 2016"
Module_ApplicationDate  SETS    "16-Sep-16"
d21 2
a22 2
Module_FullVersion      SETS    "5.55"
Module_HelpVersion      SETS    "5.55 (16 Sep 2016)"
@


4.177
log
@Remove redundant GET
Detail:
  s/Wimp - IO header doesn't appear to be necessary for build, so don't get it
Admin:
  Tested with PlingSystem build (new "26" machine type aims to be machine-independent, so doesn't define $GetIO)
  Untested at runtime


Version 5.54. Tagged as 'Wimp-5_54'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.54"
Module_Version          SETA    554
d17 2
a18 2
Module_Date             SETS    "28 May 2016"
Module_ApplicationDate  SETS    "28-May-16"
d21 2
a22 2
Module_FullVersion      SETS    "5.54"
Module_HelpVersion      SETS    "5.54 (28 May 2016)"
@


4.176
log
@Fix invalid AMB node handle being used when low on memory
Detail:
  s/Wimp08s - If OS_AMBControl allocate is asked for a AMB node with a size > 0, but no pages can be claimed, it frees the node and returns an invalid handle (0). Make sure that the Wimp's allocateslot routine is aware of this, so that we don't try passing that bad handle back to AMBControl later on
  s/Iconbar - Use nullptr constant instead of -1 when checking task_slotsize (aka AMB node handle on modern machines)
Admin:
  Tested on BB-xM
  Fixes abort seen when attempting to start a task with no pages in the free pool


Version 5.53. Tagged as 'Wimp-5_53'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.53"
Module_Version          SETA    553
d17 2
a18 2
Module_Date             SETS    "23 May 2016"
Module_ApplicationDate  SETS    "23-May-16"
d21 2
a22 2
Module_FullVersion      SETS    "5.53"
Module_HelpVersion      SETS    "5.53 (23 May 2016)"
@


4.175
log
@Avoid unnecessary remainder calculations
Detail:
  s/Wimp01, s/Wimp02, s/Wimp05, s/Wimp08s, s/Wimp10 - Avoid unnecessary remainder calculations in DivRem macro. Also make more use of DivRem's ability to accept a constant (not a register) as the divisor.
Admin:
  Tested on Cortex-A15


Version 5.52. Tagged as 'Wimp-5_52'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.52"
Module_Version          SETA    552
d17 2
a18 2
Module_Date             SETS    "08 May 2016"
Module_ApplicationDate  SETS    "08-May-16"
d21 2
a22 2
Module_FullVersion      SETS    "5.52"
Module_HelpVersion      SETS    "5.52 (08 May 2016)"
@


4.174
log
@Make use of power saving features when sat waiting for user input
Detail:
  s/Wimp03 - Move two key bits of power-saving logic out of repollwimp and into a new subroutine (powersave_tick)
  s/Wimp01, s/Wimp07 - Call powersave_tick when displaying an error box or "Press SPACE or click mouse to continue", so that CPU will drop speed and enter WFI state instead of running at full tilt.
Admin:
  Tested on Pandaboard
  Fixes issue reported on forums with CPUs getting hot for no good reason:
  https://www.riscosopen.org/forum/forums/4/topics/3749


Version 5.51. Tagged as 'Wimp-5_51'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.51"
Module_Version          SETA    551
d17 2
a18 2
Module_Date             SETS    "29 Nov 2015"
Module_ApplicationDate  SETS    "29-Nov-15"
d21 2
a22 2
Module_FullVersion      SETS    "5.51"
Module_HelpVersion      SETS    "5.51 (29 Nov 2015)"
@


4.173
log
@Reinstate Wimp_ClaimFreeMemory
Detail:
  This restores support for Wimp_ClaimFreeMemory, via having the Wimp manage a small-ish (4MB) DA that is used to satisfy Wimp_ClaimFreeMemory requests. The Wimp will only ever grow the DA, but the DA is shrinkable, so the system should shrink it as necessary should the free pool run too low.
  Options/s/!Default, Options/s/32, Options/s/Ursula - Add DynamicAreaWCF option to control support for the Wimp_ClaimFreeMemory DA. Enable the option for any builds of the module destined for RISC OS 5.
  Options/s/!Debug - New debug option for Wimp_ClaimFreeMemory debugging (mainly DynamicAreaWCF code path)
  Wimp/s/Wimp01 - Add calls to create/destroy DA on startup/shutdown
  Wimp/s/Wimp08s - DA create/destroy implementation. DA is only used if the free pool is a PMP or the Wimp expects kernel free pool locking but the kernel doesn't support it. Modify Wimp_ClaimFreeMemory to use the DA if it's present.
Admin:
  Tested on Raspberry Pi
  Restores compatibility with software which relies on Wimp_ClaimFreeMemory, e.g. GDraw module (cause of "No free memory" errors reported by many)
  Note that Wimp_ClaimFreeMemory is still considered deprecated and support may be removed in future OS versions.


Version 5.50. Tagged as 'Wimp-5_50'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.50"
Module_Version          SETA    550
d17 2
a18 2
Module_Date             SETS    "10 Oct 2015"
Module_ApplicationDate  SETS    "10-Oct-15"
d21 2
a22 2
Module_FullVersion      SETS    "5.50"
Module_HelpVersion      SETS    "5.50 (10 Oct 2015)"
@


4.172
log
@Disable Wimp_ClaimFreeMemory if the free pool is a PMP
Detail:
  s/Wimp08s - If the free pool is a PMP, it's fairly safe to say there'll be no logical mapping, so don't allow Wimp_ClaimFreeMemory to succeed. Also cope with OS_Memory 10 potentially being unimplemented - swallow any error it generates, and refuse to claim the free pool.
Admin:
  Tested on Pandaboard
  Fixes crashes and subsequent OS_ChangeDynamicArea failures caused by software trying to claim the free pool (e.g. FileCore temp buffers).


Version 5.49. Tagged as 'Wimp-5_49'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.49"
Module_Version          SETA    549
d17 2
a18 2
Module_Date             SETS    "01 Sep 2015"
Module_ApplicationDate  SETS    "01-Sep-15"
d21 2
a22 2
Module_FullVersion      SETS    "5.49"
Module_HelpVersion      SETS    "5.49 (01 Sep 2015)"
@


4.171
log
@Only skip ColourTrans calls for 32bpp TBGR
The whizzy new TRGB modes can't assume 32bpp sprite data is equivalent to 32bpp palette entries, so must use ColourTrans.
* Disable the use-in-place optimisation if that's the case
* Update the comments to reflect this logic more clearly
Fix bug in non Medusa case, STRB was using the wrong register as the base address.

Tested briefly with 'Raspberry' theme, unchanged from previous version.

Version 5.48. Tagged as 'Wimp-5_48'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.48"
Module_Version          SETA    548
d17 2
a18 2
Module_Date             SETS    "08 Jul 2015"
Module_ApplicationDate  SETS    "08-Jul-15"
d21 2
a22 2
Module_FullVersion      SETS    "5.48"
Module_HelpVersion      SETS    "5.48 (08 Jul 2015)"
@


4.170
log
@Add ptr_drop to the sprite pool
This is a left handed pointer to signify a drag and drop operation in progress.
The sprite makes use of the mask to define the hotspot to be the tip of the arrow, for Wimp/SpriteExtends that understand that.

Propagated the hotspot definition on ptr_write to the other sprite sets, previously it was only in the Iyonix theme.
Missing ptr_menu and friends added to Morris theme.
Made file_ffb more distinct from the other system files in Ursula theme.

Version 5.47. Tagged as 'Wimp-5_47'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.47"
Module_Version          SETA    547
d17 2
a18 2
Module_Date             SETS    "15 Nov 2014"
Module_ApplicationDate  SETS    "15-Nov-14"
d21 2
a22 2
Module_FullVersion      SETS    "5.47"
Module_HelpVersion      SETS    "5.47 (15 Nov 2014)"
@


4.169
log
@  Fix to warning
Detail:
  Previous test for include order of Hdr:Services and Hdr:Wimp was broken.
  See HdrSrc 2.46 for the other half of this fix.


Version 5.46. Tagged as 'Wimp-5_46'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.46"
Module_Version          SETA    546
d17 2
a18 2
Module_Date             SETS    "24 Sep 2014"
Module_ApplicationDate  SETS    "24-Sep-14"
d21 2
a22 2
Module_FullVersion      SETS    "5.46"
Module_HelpVersion      SETS    "5.46 (24 Sep 2014)"
@


4.168
log
@Fix for background colour too light on non-bordered icons
Wimp04.s:
 Line 991, a register fumble meant the special case check (when the icon background colour equals the window work area colour) always failed so the icon background was lightened.
 Removed unnecessary ADR.
Wimp10.s:
 Function getborder() made more readable by use of symbols instead of magic numbers
Fixes ticket #395 reported by Paul Reuvers.

Version 5.45. Tagged as 'Wimp-5_45'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.45"
Module_Version          SETA    545
d17 2
a18 2
Module_Date             SETS    "05 Sep 2014"
Module_ApplicationDate  SETS    "05-Sep-14"
d21 2
a22 2
Module_FullVersion      SETS    "5.45"
Module_HelpVersion      SETS    "5.45 (05 Sep 2014)"
@


4.167
log
@Fix for incorrect menu widths in system font
Width counting of menus in the system font would continue until a control terminator was found, however in the case of a non indirected menu entry of exactly 12 characters there is no terminator, so the menu would be too wide (by however many non terminator bytes happened to follow the menu definition in memory). This would normally end up 16 OS units too wide (because it'd encounter a zero after the menu items flags of the next menu entry).

Version 5.44. Tagged as 'Wimp-5_44'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.44"
Module_Version          SETA    544
d17 2
a18 2
Module_Date             SETS    "18 Aug 2014"
Module_ApplicationDate  SETS    "18-Aug-14"
d21 2
a22 2
Module_FullVersion      SETS    "5.44"
Module_HelpVersion      SETS    "5.44 (18 Aug 2014)"
@


4.166
log
@Add definitions of button types 11/14/15
Button type 11 was added in 1988 so is about time it had a symbol to refer to it in the sources. Added & used said symbols.
Removed 'DoubleIcon' switch, prototype button type 12.
Built binary identical module, not tested.

Version 5.43. Not tagged
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.43"
Module_Version          SETA    543
d17 2
a18 2
Module_Date             SETS    "20 Jul 2014"
Module_ApplicationDate  SETS    "20-Jul-14"
d21 2
a22 2
Module_FullVersion      SETS    "5.43"
Module_HelpVersion      SETS    "5.43 (20 Jul 2014)"
@


4.165
log
@Fix G16 modes
Detail:
  s/Wimp02 - With Kernel-5_35-4_79_2_210 and later, the greyscale palette flag updates in real time to reflect the current state of the palette. Therefore we must read the state of the flag before we set our colour palette, otherwise we won't know that we need to apply the greyscale fixup afterwards.
Admin:
  Tested on BB-xM


Version 5.43. Tagged as 'Wimp-5_43'
@
text
@d17 2
a18 2
Module_Date             SETS    "02 Jul 2014"
Module_ApplicationDate  SETS    "02-Jul-14"
d22 1
a22 1
Module_HelpVersion      SETS    "5.43 (02 Jul 2014)"
@


4.164
log
@Fix for incorrect names on pinned windows
The post increment of R14 when looking for a control/space terminator meant that the search for a leafname started one too far along.
So in the situation where memory contained something like
  <window_title><null><dot><garbage>
the code would pick up the dot and try to use <garbage> as a leafname.
Submission from Fred Graute.
Fix for ticket #244.

Version 5.42. Tagged as 'Wimp-5_42'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.42"
Module_Version          SETA    542
d17 2
a18 2
Module_Date             SETS    "28 May 2014"
Module_ApplicationDate  SETS    "28-May-14"
d21 2
a22 2
Module_FullVersion      SETS    "5.42"
Module_HelpVersion      SETS    "5.42 (28 May 2014)"
@


4.163
log
@Fix for missing window backgrounds/scroll bars when tiled sprite op not supported
For the backgrounds, the code was switched with 'standalone' however the Wimp actively wipes SA_FLAGS in its makefile so the standalone switch is always false during the install phase of a disc build. Also, the standalone switch is used to include resources which are ordinarily handled by the boot sequence prefixing the WindowManager$Path rather than using ResourceFS.
For the scroll bars, the decision to plot manually was being made by looking at the V flag on return from Tool_SpriteOp, except that that function uses EntryS/EXITS so the caller can't see the return flags.
Added new switch CanTileManually, removed 0 use tilewithspriteops switch.
Changed single use of NoFontBodge switch to use preferred 'outlinefont'.
Tested on RISC OS 4.02.

Version 5.41. Tagged as 'Wimp-5_41'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.41"
Module_Version          SETA    541
d17 2
a18 2
Module_Date             SETS    "19 Apr 2014"
Module_ApplicationDate  SETS    "19-Apr-14"
d21 2
a22 2
Module_FullVersion      SETS    "5.41"
Module_HelpVersion      SETS    "5.41 (19 Apr 2014)"
@


4.162
log
@Fix *WimpMode/Wimp_SetMode to return an error when given a bad mode selector block. Re-read configured mode on Sevice_Reset.
Detail:
  s/Wimp01 - Reinitialise currentmode on Service_Reset in order to get the correct mode in the case of a GraphicsV driver overriding it (driver may not have been initialised at the time of the first call in module init). Add a bit more mode debugging and ensure ValidateAddress code completely removed under Medusa.
  s/Wimp02 - Issue OS_CheckModeValid in validatemode so we can detect cases where a valid looking mode selector block doesn't actually map to a mode definition. Add more mode debugging code.
Admin:
  Tested on Raspberry Pi
  Fixes issue where "F12 -> *BASIC -> MODE 0 -> QUIT -> return" wouldn't restore screen mode correctly if currentmode had been set to a bad mode selector (e.g. after a CMOS reset nukes the LoadModeFile command), due to WimpMode's lack of error checking
  Note that this merely prevents currentmode being set to a bad mode at the time of *WimpMode/Wimp_SetMode - if a mode which is valid suddenly becomes invalid (e.g. due to loading a new MDF but not reselecting a valid wimp mode) then the Wimp will still fail to set a sensible mode on return to the desktop.


Version 5.40. Tagged as 'Wimp-5_40'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.40"
Module_Version          SETA    540
d17 2
a18 2
Module_Date             SETS    "18 Apr 2014"
Module_ApplicationDate  SETS    "18-Apr-14"
d21 2
a22 2
Module_FullVersion      SETS    "5.40"
Module_HelpVersion      SETS    "5.40 (18 Apr 2014)"
@


4.161
log
@Protect memory above MemoryLimit being nuked when starting a task
Detail:
  s/Wimp08s - Improve testapplication to detect situations where data is being stored above MemoryLimit, e.g. if a C app uses system() to issue *WimpTask
  Usually the CAO check will detect this kind of situation, except for the case where a single-tasking app issues *WimpTask - in which case the CAO will get reset to the Wimp module due to ModHandReason_Enter being used to get into USR mode so a temp parent task can be created
  Wimp_SlotSize checks MemoryLimit against ApplicationSpaceSize before allowing the wimpslot to be resized, so it seems to be a bit of an oversight that the task startup code wasn't doing the same
Admin:
  Tested on BB-xM
  Fixes ticket #279:
  https://www.riscosopen.org/tracker/tickets/279


Version 5.39. Tagged as 'Wimp-5_39'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.39"
Module_Version          SETA    539
d17 2
a18 2
Module_Date             SETS    "13 Apr 2014"
Module_ApplicationDate  SETS    "13-Apr-14"
d21 2
a22 2
Module_FullVersion      SETS    "5.39"
Module_HelpVersion      SETS    "5.39 (13 Apr 2014)"
@


4.160
log
@Disallow Wimp_SpriteOp 38 (create/remove alpha)
Detail:
  - s/Wimp01 - Add OS_SpriteOp 38 (create/remove alpha) to the list of banned SpriteOp's for Wimp_SpriteOp. OS_SpriteOp 38 is almost always guaranteed to modify the target sprite, and so in keeping with other sprite modification ops it shouldn't be allowed via Wimp_SpriteOp.
Admin:
  Tested on BB-xM


Version 5.38. Tagged as 'Wimp-5_38'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.38"
Module_Version          SETA    538
d17 2
a18 2
Module_Date             SETS    "27 Mar 2014"
Module_ApplicationDate  SETS    "27-Mar-14"
d21 2
a22 2
Module_FullVersion      SETS    "5.38"
Module_HelpVersion      SETS    "5.38 (27 Mar 2014)"
@


4.159
log
@Fix to build with HdrSrc-2_42. Use OS_SpriteOp 65 where possible.
Detail:
  s/Wimp01 - Update Wimp_SpriteOp handler to cope with the new SpriteReason_BadReasonCode value. Initialise unused bits of spritebits to 1 so that it acts as a whitelist, only allowing through operations that we know are safe.
  s/Tiling3D - Use OS_SpriteOp 65 for drawing tiled window backgrounds. Softload versions will fall back to using the old manual tiling code if OS_SpriteOp 65 is unavailable.
  s/Wimp10 - Use OS_SpriteOp 65 for drawing the tiled sprites that make up scrollbar wells and bars. Falls back to manual tiling in softload versions.
Admin:
  Tested on Iyonix, BB-xM
  Requires HdrSrc-2_42


Version 5.37. Tagged as 'Wimp-5_37'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.37"
Module_Version          SETA    537
d17 2
a18 2
Module_Date             SETS    "09 Mar 2014"
Module_ApplicationDate  SETS    "09-Mar-14"
d21 2
a22 2
Module_FullVersion      SETS    "5.37"
Module_HelpVersion      SETS    "5.37 (09 Mar 2014)"
@


4.158
log
@Implement sprite translation table caching
Detail:
  This set of changes allows the Wimp to cache the last-used translation table, and cleans up some instances where translation tables were being generated and then not used
  s/Wimp01 - Expand selecttable_args to store all 8 registers needed by ColourTrans_GenerateTable. Add 1K of space for caching the palette that the cached translation table was generated from. Remove unused spriteX, spriteY variables.
  s/Wimp04 - Split cachespritedata in two. cachespritedata now only caches the basic information, while the new cachespritepixtable rotuine will generate a translation table (shaded/inverted if required). This allows table generation to be deferred until we're just about to render the sprite, ensuring that the table isn't generated only to not be used. Also updated icon sprite rendering to check the sprite is within the graphics window before attempting to render it, allowing removal of one more case where tables can be needlessly generated.
  s/NewSWIs, s/Wimp09 - Change ADR to ADRL
  s/Tiling, s/Tiling3D - Use cachespritepixtable when needed
Admin:
  Tested on Iyonix, BB-xM, StrongARM RiscPC


Version 5.36. Tagged as 'Wimp-5_36'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.36"
Module_Version          SETA    536
d17 2
a18 2
Module_Date             SETS    "01 Mar 2014"
Module_ApplicationDate  SETS    "01-Mar-14"
d21 2
a22 2
Module_FullVersion      SETS    "5.36"
Module_HelpVersion      SETS    "5.36 (01 Mar 2014)"
@


4.157
log
@Change Wimp_ReadSysInfo 2 to not return alpha sprite names. Add Wimp_ReadSysInfo 29 and Wimp_Extend 257.
Detail:
  s/Wimp01 - Change romspr_suffix initialisation so that it won't store alpha sprite suffixes. This has the knock-on effect of making Wimp_ReadSysInfo 2 no longer return alpha sprite suffixes, without affecting any of the sprite search code
  hdr/Wimp, s/Wimp01 - Add Wimp_ReadSysInfo 29 to read the alphaspriteflag value - i.e. whether alpha sprites are supported by the OS/Wimp and *IconSprites, Wimp_Extend 13, etc. will look for them
  hdr/Wimp - Document the private Wimp_Extend reason codes and add a couple of ROL's reason codes
  s/NewSWIs - Tidy up Wimp_Extend implementation to use a jump table instead of a load of tests and branches. Add an implementation of ROL's Wimp_Extend 257, which just acts as a wrapper around Wimp_Extend 13
Admin:
  Tested on Raspberry Pi
  Wimp_ReadSysInfo 2 change should fix issue reported on forums with software unexpectedly using low-res sprites or failing altogether:
  http://www.riscosopen.org/forum/forums/4/topics/2274


Version 5.35. Tagged as 'Wimp-5_35'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.35"
Module_Version          SETA    535
d17 2
a18 2
Module_Date             SETS    "01 Jan 2014"
Module_ApplicationDate  SETS    "01-Jan-14"
d21 2
a22 2
Module_FullVersion      SETS    "5.35"
Module_HelpVersion      SETS    "5.35 (01 Jan 2014)"
@


4.156
log
@Add support for *iconspriting of alpha-masked sprites. Fix icon shading/inverting to work with true colour sprites.
Detail:
  Options/s/!Default, s/NewSWIs, s/Wimp01:

  Updated ROM sprite find code, *IconSprites and Wimp_Extend 13 to understand a new spritefile suffix.
  If the Wimp detects that RISC OS Select style alpha masked sprites are supported, and we're not using the mode 23 sprites, then the code will enable support for alpha masked sprites of the form !SpritesA1, !SpritesA2, !SpritesA, etc. Alpha-masked sprites are only looked for when looking for square pixel sprites or just before looking for the default sprites. This means the full search pattern for (e.g.) a !Sprites21 mode would be as follows:

  !Sprites21  (original mode)
  !SpritesA2  (next squarer mode, alpha sprites)
  !Sprites22  (next squarer mode)
  !SpritesA   (default alpha sprites)
  !Sprites    (default sprites)

  Like with !Sprites11 support, this feature can be toggled off via the SpritesA option if necessary.

  s/Wimp01, s/Wimp04:

  Updated icon plotting code (wimp_SpriteOp_putsprite and calculateinverse) to allow true colour sprites/icons to be rendered shaded/inverted.
  For this to work the Wimp needs a version of SpriteExtend which supports colour mapping (specifically it checks for the relevant ROOL version number).
  The colour mapping function which is used to build the translation tables used for shading/inverting palettised sprites is too slow to be sensibly used on a per-pixel basis, so the first time a shaded/inverted true colour sprite is requested the Wimp will generate a set of lookup tables which can be used by a much simpler colour mapping routine.
  To keep memory usage down these lookup tables only use 4K colours each; however the quality isn't always that great and so this may need revising in future.

Admin:
  Tested on BB-xM


Version 5.34. Tagged as 'Wimp-5_34'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.34"
Module_Version          SETA    534
d17 2
a18 2
Module_Date             SETS    "30 Nov 2013"
Module_ApplicationDate  SETS    "30-Nov-13"
d21 2
a22 2
Module_FullVersion      SETS    "5.34"
Module_HelpVersion      SETS    "5.34 (30 Nov 2013)"
@


4.155
log
@Fix logic which decides whether to plot sprites using the Kernel or SpriteExtend to take into account the new sprite modes
Detail:
  s/Wimp01 - Add NColour mode variable to the list of variables cached for the current screen mode. Add modeflags & ncolour to the sprite & tool sprite variables.
  s/Wimp04, s/Wimp10 - Update cachespritedata and cachetoolspritedata to look at the modeflags, ncolour and alpha mask flag when deciding if sprite_needsfactors should be set or not (i.e. whether the code ultimately uses OS_SpriteOp 52 or 34). This should allow the Wimp to correctly detect if a sprite can safely be rendered by the Kernel or not (except for double pixel vs. non-double pixel - but presumably nobody's using double pixel mode sprites for icons/tool sprites, otherwise it would be fixed by now?)
  s/Wimp04 - Add an extra safety check to icon text rendering after a crash was seen when calling Wimp_PlotIcon outside of a redraw loop
Admin:
  Tested on BB-xM
  Fixes problem reported on forums with 32bpp, alpha-masked sm!Netsurf icon vanishing from filer when viewed in 32bpp modes
  https://www.riscosopen.org/forum/forums/3/topics/309?page=4#posts-25995


Version 5.33. Tagged as 'Wimp-5_33'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.33"
Module_Version          SETA    533
d17 2
a18 2
Module_Date             SETS    "07 Oct 2013"
Module_ApplicationDate  SETS    "07-Oct-13"
d21 2
a22 2
Module_FullVersion      SETS    "5.33"
Module_HelpVersion      SETS    "5.33 (07 Oct 2013)"
@


4.154
log
@3 minor fixes, 2 minor enhancements
Makefile:
* Conditionally copy the disc resources, saving a little build time.
Wimp10.s; hdr/Wimp:
* Issue Service_WimpToolSpritesChanged when the tool sprite area is changed.
Wimp05:
* Fix bug in softloaded versions of the Wimp where menus would randomly lose the keyboard shortcut text. This was caused by use of an LDR to retrieve a byte wide variable. This specifically affected some softloads because the Wimp gets squeezed, and during unsqueezing the Wimp's workspace ends up being allocated from the same bit of RMA that used to contain the squeezed copy of the module (=lots of random numbers).
Wimp09:
* Fix bug where configuring WimpSpritePrecedence to ROM when a theme is loaded would cause redrawing of window textures to fail. This is because the Wimp intersects the ROM and RAM sprite areas and deletes any duplicates from the RAM area when remaking the fast lookup sprite list. So if the RAM sprites include the "tile_1" (etc) sprite on redrawing the desktop the Wimp points to this, then intersects the lists and deletes the sprite, leaving the pointers pointing at junk. Now, on deleting something, the window tile pointers are invalidated. Fixes ticket #346.
Wimp02:
* Fix bug where the title bar text, when the desktop font is the system font, is incorrectly rendered in the colour selected by WimpVisualFlag -WindowOutlineColour. The Wimp now restores the text colour if -WOC has set the graphics colour to something other than black.

Administrative -
In Wimp01, swap a couple of SpriteReasons from magic numbers. In the init of variables use the common reset_all_tiling_sprite function.
In Tiling3D, more SpriteReasons, and rationalise the registers used in reset_all_tiling_sprites.

Version 5.32. Tagged as 'Wimp-5_32'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.32"
Module_Version          SETA    532
d17 2
a18 2
Module_Date             SETS    "08 Sep 2013"
Module_ApplicationDate  SETS    "08-Sep-13"
d21 2
a22 2
Module_FullVersion      SETS    "5.32"
Module_HelpVersion      SETS    "5.32 (08 Sep 2013)"
@


4.153
log
@Replace OS_SpriteOp reason code magic numbers with definitions. Add support for new screen modes.
Detail:
  s/Tiling, s/Tiling3D, s/Watchdog, s/Wimp05, s/Wimp07, s/Wimp09 - Replaced OS_SpriteOp reason code magic numbers with symbolic definitions.
  s/Wimp01 - Update *WimpMode / Wimp_SetMode to use OS_ScreenMode 13 (mode string to specifer) in place of its own code if a mode specifier string has been given. Note - mode number handling is unchanged, so a mode specifier string which begins with a mode number will currently have the specifier part ignored.
  s/Wimp01, s/Wimp02 - Flag_* -> ModeFlag_* renaming
  s/Wimp02 - Fix mode specifier copying to only stop copying when we hit a mode variable of -1. Previous code would also stop if the variable value was -1. Update mode set code to apply the Wimp's special greyscale palettes if the greyscale mode flag is set (i.e. greyscale mode was set via specifier generated by OS_ScreenMode 13)
Admin:
  Tested on BB-xM


Version 5.31. Tagged as 'Wimp-5_31'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.31"
Module_Version          SETA    531
d17 2
a18 2
Module_Date             SETS    "07 Aug 2013"
Module_ApplicationDate  SETS    "07-Aug-13"
d21 2
a22 2
Module_FullVersion      SETS    "5.31"
Module_HelpVersion      SETS    "5.31 (07 Aug 2013)"
@


4.152
log
@Add flexible scheme to allow non-grey/opaque toolsprites
The Wimp can now accept toolsprite sets which have precalculated (non default) colour translation tables supplied by the designer.
This allows the link between window template colour and displayed tool colour to be reestablished when the tools aren't grey (previously, the Ursula Wimp would only tint greys).
For full design details see Doc/ToolTables.
An example test set, TestO/TTTTest is provided. This is the 'Newlook' set but with a splotch in the corner of each sprite which is then replaced by the hex of the Wimp colour being requested.
Detail:
 Wimp01.s: New workspace requirements
 Wimp04.s: Pull out the RGB to greyscale function so it can be used elsewhere
 Wimp10.s: New tool table support code

Fixes ticket #323.
Also introduces a disc variant (with the extra EX0 EY0 resolution) of the 'Steel' theme, thus making it generally available.

Version 5.30. Tagged as 'Wimp-5_30'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.30"
Module_Version          SETA    530
d17 2
a18 2
Module_Date             SETS    "01 Jun 2013"
Module_ApplicationDate  SETS    "01-Jun-13"
d21 2
a22 2
Module_FullVersion      SETS    "5.30"
Module_HelpVersion      SETS    "5.30 (01 Jun 2013)"
@


4.151
log
@Change to method of window highlighting
The change made in Wimp-5_02 to Wimp-5_03 (to permit 'f' prefixed toolsprites) introduced a set of interesting boundary cases not covered by that scheme.
This commit restores the former behaviour, while retaining its simplification of H/V scrollbar plotting (beefed up with a few ASSERTs).
Part of fix for ticket #323.

Tagged as Wimp-5_30-pre4.
@
text
@d4 1
a4 1
; 
d14 2
a15 2
Module_MajorVersion     SETS    "5.29"
Module_Version          SETA    529
d17 2
a18 2
Module_Date             SETS    "21 May 2013"
Module_ApplicationDate  SETS    "21-May-13"
d21 2
a22 2
Module_FullVersion      SETS    "5.29"
Module_HelpVersion      SETS    "5.29 (21 May 2013)"
@


4.150
log
@Fix to incorrect tint of back & close icon after changing tool sets
If the last window drawn before dropping to the command line had the input focus then a *TOOLSPRITES command is used the default translation table would be tinted.
On reentering the desktop the back & close icon of the first window draw (= top of stack) would be the wrong colour.

Tagged as Wimp-5_30-pre3.
@
text
@d4 1
a4 1
;
@


4.149
log
@Fix for corrupt register in pushfontstring with password-style substitution
When CnP=TRUE but UTF8=FALSE the code path through pushfontstring for icons using the 'D' validation string would use R11 as a temporary without having preserved it (the UTF8 case preserves it because it uses R11 as a bitmask of substitutes).
Changed to always preserve R11, the routine is so huge one extra pushed register isn't going to slow it down measurably.
Adjusted options files now this combination is safe.

Tagged as Wimp-5_30-pre1.
@
text
@d4 1
a4 1
; 
@


4.148
log
@Fix for null pointer dereference & data abort on swapping to no toolsprites
Way back in Wimp-4_76 the range check for being in ROM (in the free tool area function) was reworked as the ROM was no longer at the top of the 64M address space. In doing so the sense of the function got inverted and actually the tool area was not freed at all.
The result of this would be that swapping to no toolsprites (for that retro RISC OS 2 look) would data abort when the kernel tried to plot a sprite from address 0 because the check prior to the title bar plot believed a tool area existed.

Version 5.29. Tagged as 'Wimp-5_29'
@
text
@d4 1
a4 1
;
@


4.147
log
@Fix for missing window gadgets when no tool sprites are loaded
When 'outlinefont' is enabled, the drawicon_system function used to plot the close/back/resize etc icons tries to do so from the currently selected outline font.
This usually results in various top bit set characters inappropriately being shown.
Now, when there are no tool sprites loaded the gadgets are forced to be plotted in the system font (where the Wimp has carefully redefined the font), but the remainder of the desktop (eg. the title bar, user text) stays in the selected desktop font.

Version 5.28. Tagged as 'Wimp-5_28'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.28"
Module_Version          SETA    528
d17 2
a18 2
Module_Date             SETS    "18 May 2013"
Module_ApplicationDate  SETS    "18-May-13"
d21 2
a22 2
Module_FullVersion      SETS    "5.28"
Module_HelpVersion      SETS    "5.28 (18 May 2013)"
@


4.146
log
@Introduce definitions of the 16 standard Wimp colours
Substitute magic numbers through the code.
Squash some UAL warnings from missing #'s in Wimp10.s

Version 5.27. Tagged as 'Wimp-5_27'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.27"
Module_Version          SETA    527
d17 2
a18 2
Module_Date             SETS    "11 May 2013"
Module_ApplicationDate  SETS    "11-May-13"
d21 2
a22 2
Module_FullVersion      SETS    "5.27"
Module_HelpVersion      SETS    "5.27 (11 May 2013)"
@


4.145
log
@Change to RMA shrinkage in *ICONSPRITES pre Medusa
On completing the sprite area merge the Wimp would try to minimise the RMA by -256MB (to account for the fact that during the merge the RMA is enlarged to hold both the existing sprites and the new ones to be merged, in the case of duplicates).
However, this meant that the common construct

  IconSprites MySprites
  Run MyApp

where MyApp wanted to use more than a teaspoon of RMA would fail due to the lack of free pool and that the RMA can't be resized when an application is running as a result.

Now, the Wimp notes the free space in the RMA, does the -256MB shrink, then ensures there's still the same free space after the event (ie. overall it may have grown by the size of any extra sprites added during the command).
Tested on RISC OS 3.10.

Version 5.26. Tagged as 'Wimp-5_26'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.26"
Module_Version          SETA    526
d17 2
a18 2
Module_Date             SETS    "09 May 2013"
Module_ApplicationDate  SETS    "09-May-13"
d21 2
a22 2
Module_FullVersion      SETS    "5.26"
Module_HelpVersion      SETS    "5.26 (09 May 2013)"
@


4.144
log
@Refinements to disc based targets especially
Previous attempt to disable Sprites11 support for 3.10 and 3.50 hadn't spotted it was reenabled in the common options, also the Sprites11 switch was also tied up in Wimp$IconTheme support.
Title bars would flicker when picked up when using a tool sprite set with no 'p' pushed equivalents on RISC OS 4.0x due to screen cache.
Makefile now installs a default set of tools & sprites when target is ThemeDefs.
CLI limit reduced to 256 pre Ursula to save RAM.

Options/!Common:
  Promote Sprites11 switch into !Default
  Remove fixrmatools
Options/!Default:
  Sprites11 true by default
  LongCommandLines true by default, false on targets pre Ursula
  Remove ServiceCallTable (harmless to have it in all cases)
NewSWIs.s:
  Enable Wimp_Extend 13 all the time
Wimp01.s:
  Reduce RMA use by vital 1.5k for non long command line case
  Change sense of Sprites11 switch to adopt all its previous functionality, but not look for '11' suffix when the switch is false
  Adopt ServiceCallTable switch permanently
Wimp02.s:
  Comments ammended
Wimp07.s:
  Range of ADR
Wimp10.s:
  Change sense of Sprites11 switch to adopt all its previous functionality, but not look for '11' suffix when the switch is false
  Adopt :LNOT: fixrmatools switch permanently
  Supress title bar sprite plotting when none of the sprites exist

Version 5.25. Tagged as 'Wimp-5_25'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.25"
Module_Version          SETA    525
d17 2
a18 2
Module_Date             SETS    "06 May 2013"
Module_ApplicationDate  SETS    "06-May-13"
d21 2
a22 2
Module_FullVersion      SETS    "5.25"
Module_HelpVersion      SETS    "5.25 (06 May 2013)"
@


4.143
log
@Slacken pointer checks
The pointer comparison checking required when running in a system with > 64M memory was tightened up from Wimp-4_75 to Wimp-4_76, but to allow the module to target pre RISC OS 5 systems an option to relax those checks is required.
Each check has been revisited and where appropriate demarked with a "AcceptLoosePointer" macro, which just remaps the pointer into the stricter form and carries on. In the strict checking case, the macro reduces to nothing.

Detail:
Add AcceptLoosePointers switch.
Retire singular use of StrongARM switch (calling XOS_SynchroniseCodeAreas is harmless pre StrongARM anyway).
Rename Ursula_RPC options to RO400.
Put duplicate documentation in the attic.
Allow -2 or -1 as the iconbar handle in Wimp_ResizeIcon (ticket #203).
Tighten up the list terminator check in the DebugMemory switch of Memory.s

Tested on RISC OS 3.10 (emulated), 3.50, 3.60, 3.70, 4.02.

Version 5.24. Tagged as 'Wimp-5_24'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.24"
Module_Version          SETA    524
d17 2
a18 2
Module_Date             SETS    "03 May 2013"
Module_ApplicationDate  SETS    "03-May-13"
d21 2
a22 2
Module_FullVersion      SETS    "5.24"
Module_HelpVersion      SETS    "5.24 (03 May 2013)"
@


4.142
log
@Fixes for pre AMBControl versions
Wimp03.s: check that pollword was in application space was corrupting R3 leading to an address exception (!) on pre Medusa targets
Wimp08.s: compare had erroneously been change to equality check, leading to screwy memory allocation and much instability on 3.50 and 3.60 especially when applications quit

Version 5.23. Not tagged
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.23"
Module_Version          SETA    523
d21 2
a22 2
Module_FullVersion      SETS    "5.23"
Module_HelpVersion      SETS    "5.23 (03 May 2013)"
@


4.141
log
@Reverse sense of international help switch
In Wimp-5_22 change (to not use the bitfield definition as a build switch) the sense got inverted, so would have hardwired text for international versions.

Version 5.23. Not tagged
@
text
@d17 2
a18 2
Module_Date             SETS    "27 Apr 2013"
Module_ApplicationDate  SETS    "27-Apr-13"
d22 1
a22 1
Module_HelpVersion      SETS    "5.23 (27 Apr 2013)"
@


4.140
log
@Fix bug in Wimp_WhichIcon
When matching an icon on the iconbar the window is initially matched correctly, but the "is this the right task" filter step was trying to compare the handle with -1. The result was that you would get the first match for any iconbar icon rather than a match for *your* iconbar icon.
Unrelated: Tiling.s/Iconbar.s add a couple of comments and use symbols instead of magic numbers.
Tested with a quality 3 line BASIC program, no longer returns icon #0 all the time.

Version 5.23. Tagged as 'Wimp-5_23'
@
text
@d17 2
a18 2
Module_Date             SETS    "13 Apr 2013"
Module_ApplicationDate  SETS    "13-Apr-13"
d22 1
a22 1
Module_HelpVersion      SETS    "5.23 (13 Apr 2013)"
@


4.139
log
@Build fixes for variants pre RISC OS 5
Minor fixups as part of univeral !Boot work.
Options no longer ASSERT on International_Help (which is a definition exported by the kernel, rather than a build switch), and instead define a switch which is true for > 3.50.
Non UTF8 supporting case has simple substitutes for Wimp_TextOp.
Legacy_DomainId and LegacyIRQsema no longer cause NULL pointer dereference.
MOVeQ => MOVEQ to placate ObjAsm.

Ursula_RPC version built and used briefly on RISC OS 4.02 host. No other run time testing.

Version 5.22. Tagged as 'Wimp-5_22'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.22"
Module_Version          SETA    522
d17 2
a18 2
Module_Date             SETS    "10 Apr 2013"
Module_ApplicationDate  SETS    "10-Apr-13"
d21 2
a22 2
Module_FullVersion      SETS    "5.22"
Module_HelpVersion      SETS    "5.22 (10 Apr 2013)"
@


4.138
log
@Fix RMA corruption when caching colour translation tables
Detail:
  s/Wimp10 - cachetoolspritedata was using two slightly different ColourTrans calls for reading the table size and then filling the table in. This was resulting in the 'generate wide table' flag sometimes being ignored when the table size was checked, resulting in too little memory being allocated and so heap corruption when the table generation call overflowed the end.
Admin:
  Tested on Pandora
  Fixes "not a heap block" errors when entering desktop


Version 5.21. Tagged as 'Wimp-5_21'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.21"
Module_Version          SETA    521
d17 2
a18 2
Module_Date             SETS    "31 Mar 2013"
Module_ApplicationDate  SETS    "31-Mar-13"
d21 2
a22 2
Module_FullVersion      SETS    "5.21"
Module_HelpVersion      SETS    "5.21 (31 Mar 2013)"
@


4.137
log
@Add support for wide translation tables for window tool furniture
With the introduction of 16bpp/32bpp modes it became possible to request tables from ColourTrans which used > 1 byte per colour, but the Wimp wasn't using this extension. Therefore tool sprites designed in 8bpp or less would be quantised horribly when plotted in a 16bpp or 32bpp mode.
The Wimp now requests and plots with a wide table, and to avoid thrashing ColourTrans so much with the prevalence of individually paletted icon sprites, keeps the table seperately to the icon sprites ones. At worst (in 32bpp) this uses an extra 256x4 bytes of RAM.
Trace.s: Split out the tracing routines from Wimp10 as it was getting a bit big.
Tiling.s: Namespace change for the icons versus tools distinction. Removed some unnecessary PC+8/PC+12 confused NOPs.
Tiling3D.s: Namespace change for the icons versus tools distinction.
Wimp01.s: New set of variables to track the tool translation tables separately. Various jiggling to keep ADRs in range.
Wimp02.s: Namespace change. Remove some double handling in Wimp_SetColourMapping.
Wimp04.s: Namespace change. Made factor rationalisation common to both the icon and tool grinding code. Removed dual use of cachespritedata for both icons and tools. The tintfunc moves to Wimp10. Service_InvalidateCache confusion resolved by adding a new flag to remember that the tools need regenerating rather than just marking the tool list as missing (which subsequently got restored in Tool_SpriteOp without actually doing any palette work.
Wimp10.s: Label tools_area renamed as it was immensely confusing to have that (which was actually holding the RMA allocation of the tool_list) and tool_area (which contains the sprite area) hanging around. Changed references to use tools-only cachetolspritedata routine. Added 'wide' flags to sprite op and colour trans calls. Tool_SpriteOp changed to actually regenerate the colour tables when they're known invalid (previously the tools list pointer was merely restored and no colour tables used). Trace functions extracted. Resolved confusion as to what recache_tools_trans and recache_tools_trans2 should be doing.

Tested with 4bpp "NewLook" sprites in 4bpp/8bpp/16bpp/32bpp and 8bpp smooth greyscaled "Steel" tool sprites in same modes.
Also ran a task window doing repeated Service_InvalidateCache calls while monitoring the RMA for leaks.
Generally navigated around some directories to ensure that inverse icons (during double click) and filer windows (with individually paletted sprites) were being rendered.

Version 5.20. Tagged as 'Wimp-5_20'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.20"
Module_Version          SETA    520
d17 2
a18 2
Module_Date             SETS    "28 Mar 2013"
Module_ApplicationDate  SETS    "28-Mar-13"
d21 2
a22 2
Module_FullVersion      SETS    "5.20"
Module_HelpVersion      SETS    "5.20 (28 Mar 2013)"
@


4.136
log
@Fixed errors during export phase when TARGET=ThemeDefs

Version 5.19. Tagged as 'Wimp-5_19'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.19"
Module_Version          SETA    519
d17 2
a18 2
Module_Date             SETS    "09 Oct 2012"
Module_ApplicationDate  SETS    "09-Oct-12"
d21 2
a22 2
Module_FullVersion      SETS    "5.19"
Module_HelpVersion      SETS    "5.19 (09 Oct 2012)"
@


4.135
log
@Add option to install disc sprites as a seperate target

Version 5.18. Tagged as 'Wimp-5_18'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.18"
Module_Version          SETA    518
d17 2
a18 2
Module_Date             SETS    "11 Aug 2012"
Module_ApplicationDate  SETS    "11-Aug-12"
d21 2
a22 2
Module_FullVersion      SETS    "5.18"
Module_HelpVersion      SETS    "5.18 (11 Aug 2012)"
@


4.134
log
@Speculative fix for crash when high processor vectors are in use
Detail:
  s/Wimp04 - in SWIWimp_ReadPixTrans, check whether we've got a pixtable before trying to read from it
Admin:
  Tested on BB-xM with high processor vectors
  Although I was unable to reproduce the issue myself, judging by the address given in the bug report this should fix an abort when dragging certain files in the filer
  See here for bug report: http://www.riscosopen.org/forum/forums/2/topics/226?page=2#posts-13500


Version 5.17. Tagged as 'Wimp-5_17'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.17"
Module_Version          SETA    517
d17 2
a18 2
Module_Date             SETS    "14 Jul 2012"
Module_ApplicationDate  SETS    "14-Jul-12"
d21 2
a22 2
Module_FullVersion      SETS    "5.17"
Module_HelpVersion      SETS    "5.17 (14 Jul 2012)"
@


4.133
log
@Fix getborder thinking indirected sprites have validation strings
Detail:
  s/Wimp10 - Corrected interrogation of icon flag word IST bits to avoid trying to parse the sprite area pointer of an indirected sprite as a validation string
Admin:
  Tested on BB-xM with high processor vectors
  Fixes crash when dragging file icons in saveas dialogs


Version 5.16. Tagged as 'Wimp-5_16'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.16"
Module_Version          SETA    516
d17 2
a18 2
Module_Date             SETS    "09 Jul 2012"
Module_ApplicationDate  SETS    "09-Jul-12"
d21 2
a22 2
Module_FullVersion      SETS    "5.16"
Module_HelpVersion      SETS    "5.16 (09 Jul 2012)"
@


4.132
log
@Be more specific when after all tries the sprites aren't found
Messages updated to be more specific/helpful.
Magic numbers for OS_File swapped to use names from Hdr:HighFSI.

Version 5.15. Not tagged
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.15"
Module_Version          SETA    515
d17 2
a18 2
Module_Date             SETS    "24 Jun 2012"
Module_ApplicationDate  SETS    "24-Jun-12"
d21 2
a22 2
Module_FullVersion      SETS    "5.15"
Module_HelpVersion      SETS    "5.15 (24 Jun 2012)"
@


4.131
log
@Preset Wimp$IconTheme on initialisation to UserIF if not already set
Therefore, when in ROM, the ROM theme can be inferred. When a different theme is selected by the user in the boot sequence, that is respected.
Restore a lost error message for *ICONSPRITES when the file doesn't exist even after trying all the 11/22/23 suffix and prefixes. This seems to have been lost post RISC OS 3.10 when Sprites22 support was added, but it is an error for the file given to not exist at all (cf. *TOOLSPRITES).
Typos in docs ammended.

Version 5.15. Tagged as 'Wimp-5_15'
@
text
@d17 2
a18 2
Module_Date             SETS    "23 Jun 2012"
Module_ApplicationDate  SETS    "23-Jun-12"
d22 1
a22 1
Module_HelpVersion      SETS    "5.15 (23 Jun 2012)"
@


4.130
log
@Add extra Wimp_ReadSysInfo reasons 23/24/25/26/28.
RISC OS Select has added reasons 18-27 and this change implements those that map directly to features that already exist (unimplemented ones return an error as before).
One additional reason, 28, permits the reading of the flags collected from the *WimpVisualFlags command so that applications can discover if the cheesy 3D borders are on or not.

Version 5.14. Tagged as 'Wimp-5_14'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.14"
Module_Version          SETA    514
d17 2
a18 2
Module_Date             SETS    "23 Jan 2012"
Module_ApplicationDate  SETS    "23-Jan-12"
d21 2
a22 2
Module_FullVersion      SETS    "5.14"
Module_HelpVersion      SETS    "5.14 (23 Jan 2012)"
@


4.129
log
@Make compatible with zero page relocation
Detail:
  s/Wimp, s/Wimp01, s/Wimp02, s/Wimp07, s/Wimp08 - Try using OS_ReadSysInfo 6 to get IRQsema & DomainId locations before falling back on legacy values. Store the pointers in module workspace for speedy access.
Admin:
  Tested on rev A2 BB-xM


Version 5.13. Tagged as 'Wimp-5_13'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.13"
Module_Version          SETA    513
d17 2
a18 2
Module_Date             SETS    "04 Aug 2011"
Module_ApplicationDate  SETS    "04-Aug-11"
d21 2
a22 2
Module_FullVersion      SETS    "5.13"
Module_HelpVersion      SETS    "5.13 (04 Aug 2011)"
@


4.128
log
@  Updated Iyonix theme sprites supplied by Colin Granville.
Detail:
  These utilise SpriteExtend 1.42 to set the pointer active point from the
  sprite mask.

Version 5.12. Tagged as 'Wimp-5_12'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.12"
Module_Version          SETA    512
d17 2
a18 2
Module_Date             SETS    "14 Apr 2011"
Module_ApplicationDate  SETS    "14-Apr-11"
d21 2
a22 2
Module_FullVersion      SETS    "5.12"
Module_HelpVersion      SETS    "5.12 (14 Apr 2011)"
@


4.127
log
@Update Wimp to use new VFPSupport_ChangeContext_AppSpace flag
Detail:
  s/Wimp03, s/Wimp07 - When saving the VFP context the Wimp now uses lazy context switching where possible, via a combination of the Lazy & AppSpace flags
Admin:
  Tested on rev A2 BB-xM
  Requires VFPSupport 0.02


Version 5.11. Tagged as 'Wimp-5_11'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.11"
Module_Version          SETA    511
d17 2
a18 2
Module_Date             SETS    "01 Feb 2011"
Module_ApplicationDate  SETS    "01-Feb-11"
d21 2
a22 2
Module_FullVersion      SETS    "5.11"
Module_HelpVersion      SETS    "5.11 (01 Feb 2011)"
@


4.126
log
@Update checkhandle to check that window pointers are word aligned
Detail:
  s/Wimp04 - The checkhandle* routines now checks that the window pointer is word aligned before attempting to load any data from it.
  This prevents alignment faults on ARMv6+, and should result in more accurate sanity checks in general.
Admin:
  Tested on rev C2 beagleboard.
  Fixes issue reported on forums:
  http://www.riscosopen.org/forum/forums/5/topics/517


Version 5.10. Tagged as 'Wimp-5_10'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.10"
Module_Version          SETA    510
d17 2
a18 2
Module_Date             SETS    "04 Dec 2010"
Module_ApplicationDate  SETS    "04-Dec-10"
d21 2
a22 2
Module_FullVersion      SETS    "5.10"
Module_HelpVersion      SETS    "5.10 (04 Dec 2010)"
@


4.125
log
@Make the Wimp automatically switch VFP contexts
Detail:
  s/Wimp, s/Wimp01, s/Wimp02, s/Wimp03, s/Wimp07 - The Wimp now uses the VFPSupport module to switch VFP contexts when performing task switches.
  Each task begins with the null context active (i.e. no VFP/NEON access). When paging out a task the ID of the active context is saved in the Wimp's per-task workspace. This context is then restored when the task is about to be resumed.
  Context save/restore is performed while the right task's memory is paged in, so it's safe to use with contexts located in application space.
Admin:
  Tested with Iyonix & Beagle ROM builds.


Version 5.09. Tagged as 'Wimp-5_09'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.09"
Module_Version          SETA    509
d17 2
a18 2
Module_Date             SETS    "26 Nov 2010"
Module_ApplicationDate  SETS    "26-Nov-10"
d21 2
a22 2
Module_FullVersion      SETS    "5.09"
Module_HelpVersion      SETS    "5.09 (26 Nov 2010)"
@


4.124
log
@Fix a few nasty Wimp bugs
Detail:
  s/Wimp05 (setcaretcoords_fancy), s/Wimp07 - Fix some dodgy comments that had trailing backslashes, causing the next line of code to be gobbled by objasm and omitted from the compiled code. The code in question has been around for a long time, so I guess a recent objasm change (or the switch from aasm) has caused the dodgy comments to turn malicious. The setcaretcoords_fancy bug was the cause of bug #241 in the ROOL tracker.
  s/Wimp05 (int_set_caret_position) - While testing the #241 fix, I found that opening the filer 'rename' menu, typing text (enough to cause the icon to scroll), and then clicking away to close the menu would cause an infinite abort loop. The cause seemed to be int_set_caret_position mistakenly setting the caret window ptr to 0 instead of nullptr (-1), which would then cause setwindowptrs to die when it tried dereferencing what it thought was a valid pointer. Although initially confused about how this bug has gone unnoticed so far, I've now realised the abort was just down to alignment exceptions being turned on and the code would have "worked" on <=ARMv5.
Admin:
  Tested on rev C2 beagleboard.
  Fixes bug #241.


Version 5.08. Tagged as 'Wimp-5_08'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.08"
Module_Version          SETA    508
d17 2
a18 2
Module_Date             SETS    "14 Mar 2010"
Module_ApplicationDate  SETS    "14-Mar-10"
d21 2
a22 2
Module_FullVersion      SETS    "5.08"
Module_HelpVersion      SETS    "5.08 (14 Mar 2010)"
@


4.123
log
@Make Wimp NoUnaligned-safe
Detail:
  The "pointer leaving window" code now checks that ptrtask != nullptr before attempting to use it as an offset to the workspace pointer. This is required when alignment exceptions are enabled because nullptr is -1.
Admin:
  Tested on rev C2 beagleboard


Version 5.07. Tagged as 'Wimp-5_07'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.07"
Module_Version          SETA    507
d17 2
a18 2
Module_Date             SETS    "06 Nov 2009"
Module_ApplicationDate  SETS    "06-Nov-09"
d21 2
a22 2
Module_FullVersion      SETS    "5.07"
Module_HelpVersion      SETS    "5.07 (06 Nov 2009)"
@


4.122
log
@Added the disc-based sprite resources for RISC OS 5.

Version 5.06. Tagged as 'Wimp-5_06'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.06"
Module_Version          SETA    506
d17 2
a18 2
Module_Date             SETS    "01 Oct 2009"
Module_ApplicationDate  SETS    "01-Oct-09"
d21 2
a22 2
Module_FullVersion      SETS    "5.06"
Module_HelpVersion      SETS    "5.06 (01 Oct 2009)"
@


4.121
log
@  Build change
Detail:
  CPU version is no longer specified in the makefile - it's better to inherit
  it from the build environment now that we actually set it appropriately.
Admin:
  Built and briefly tested. Binary should be unchanged - this only affects
  the warnings generated during assembly.

Version 5.05. Not tagged
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.05"
Module_Version          SETA    505
d17 2
a18 2
Module_Date             SETS    "16 Jun 2009"
Module_ApplicationDate  SETS    "16-Jun-09"
d21 2
a22 2
Module_FullVersion      SETS    "5.05"
Module_HelpVersion      SETS    "5.05 (16 Jun 2009)"
@


4.120
log
@  GET file pathnames changed
Detail:
  Uses suffixed file extensions for compatiblity with both objasm and asasm.
Admin:
  Supplied by Peter Naulls, tested at ROOL

Version 5.05. Not tagged
@
text
@d17 2
a18 2
Module_Date             SETS    "11 Jun 2009"
Module_ApplicationDate  SETS    "11-Jun-09"
d22 1
a22 1
Module_HelpVersion      SETS    "5.05 (11 Jun 2009)"
@


4.119
log
@  3D window outline colour default initialiesed to black
Detail:
  Wimp found to have ininitialised WindowOutlineColour until the
  WimpVisualFlags had been run. Now initialised at module startup.
Admin:
  Tested in ROM build. J Ballance, Castle


Version 5.05. Tagged as 'Wimp-5_05'
@
text
@d17 2
a18 2
Module_Date             SETS    "20 Apr 2009"
Module_ApplicationDate  SETS    "20-Apr-09"
d22 1
a22 1
Module_HelpVersion      SETS    "5.05 (20 Apr 2009)"
@


4.118
log
@  Make colour used for the window outline configurable.
  Allow the outline to be plotted over the window tools.
Detail:
  The options available through WimpVisualFlags have been extended with two
  new options that control how the window outline is plotted.

  WimpVisualFlags -WindowOutlineColour <&RRGGBB> -WindowOutlineOver

  WindowOutlineColour defines the colour to be used for the window outline.
  It allows theme designers to choose a window outline colour that fits
  in with a theme's general colour scheme. Default value is black.

  WindowOutlineOver controls if the window outline is plotted over the
  toolicons. It can be used to ensure that there is a window outline
  visible even when the toolicons are borderless. Default value is off.
Admin:
  Tested on RO 5.11
Author:
  Fred Graute

Version 5.04. Tagged as 'Wimp-5_04'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.04"
Module_Version          SETA    504
d17 2
a18 2
Module_Date             SETS    "10 Sep 2008"
Module_ApplicationDate  SETS    "10-Sep-08"
d21 2
a22 2
Module_FullVersion      SETS    "5.04"
Module_HelpVersion      SETS    "5.04 (10 Sep 2008)"
@


4.117
log
@  Allow a different set of window toolicons for the window with the input focus.
Detail:
  Previous versions of the Window Manager required toolicons to have pixels
  that were transparent so that the background colour could be used to indicate
  whether a window had input focus or not. This means that new sets of toolicons
  either have to have transparent pixels or lose indication of input focus.
  To remove this limitation the support for toolicons has been extended so
  that a different set of toolicons can be used for the window with the input
  focus.

  The new icons have the prefix 'f' added to their names as follows:
    <toolname>    standard version of toolicon
    p<toolname>   pressed version of toolicon
    f<toolname>   focus version of toolicon
    pf<toolname>  pressed+focus version of toolicon

  Code has been added to ensure that all toolicons are represented.
  This is done in two stages; first the pressed icons are checked and for any
  missing its non-pressed equivalent will be filled in. Next the focus icons
  are checked and for missing ones its non-focus equivalent will be used.
Admin:
  Tested on Iyonix RO5.11
Author:
  Fred Graute

Version 5.03. Tagged as 'Wimp-5_03'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.03"
Module_Version          SETA    503
d21 2
a22 2
Module_FullVersion      SETS    "5.03"
Module_HelpVersion      SETS    "5.03 (10 Sep 2008)"
@


4.116
log
@  Fixed misalignment of WimpWriteDir code.
  Fixed corruption of table with characters to be mapped to WimpSymbol.
Detail:
  There was an ALIGN statement missing just above the code for WimpWriteDir

  The table used to map characters to the WimpSymbol font had become corrupted
  which prevented the mapping from working correctly. This resulted in keyboard
  shortcuts disappearing in menus when using fonts that don't have definitions
  for the required characters, in particular the up-arrow representing shift.
Admin:
  Tested on RO 5.11
Author:
  Fred Graute

Version 5.02. Tagged as 'Wimp-5_02'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.02"
Module_Version          SETA    502
d21 2
a22 2
Module_FullVersion      SETS    "5.02"
Module_HelpVersion      SETS    "5.02 (10 Sep 2008)"
@


4.115
log
@  Fixed potentially fatal bug in Watchdog.
Detail:
  Unnecessarily complex code in Watchdog for killing tasks other than the
  currently active task ended up corrupting the environment handlers for
  the current task.
Admin:
  Fixes the test case of running a BASIC program consisting of
    REPEAT UNTIL FALSE
  which previously caused random errors or complete crashes if you ran it
  and then Al-Breaked and tried to kill a different task.

Version 5.01. Tagged as 'Wimp-5_01'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "5.01"
Module_Version          SETA    501
d17 2
a18 2
Module_Date             SETS    "13 Jul 2008"
Module_ApplicationDate  SETS    "13-Jul-08"
d21 2
a22 2
Module_FullVersion      SETS    "5.01"
Module_HelpVersion      SETS    "5.01 (13 Jul 2008)"
@


4.114
log
@Added a test harness that may be useful if anyone fancies finishing off
drag and drop in writeable icons.

Version 5.00. Not tagged
@
text
@d3 1
a3 1
; Last processed by srccommit version: 1.2.
d14 2
a15 2
Module_MajorVersion     SETS    "5.00"
Module_Version          SETA    500
d17 2
a18 2
Module_Date             SETS    "07 Oct 2007"
Module_ApplicationDate  SETS    "07-Oct-07"
d21 2
a22 2
Module_FullVersion      SETS    "5.00"
Module_HelpVersion      SETS    "5.00 (07 Oct 2007)"
@


4.113
log
@	re check in as v5.00 rather than v4.100, which srccommit created
Detail:

Admin:


Version 5.00. Tagged as 'Wimp-5_00'
@
text
@d17 2
a18 2
Module_Date             SETS    "23 Feb 2006"
Module_ApplicationDate  SETS    "23-Feb-06"
d20 1
a20 1
Module_ComponentPath    SETS    "RiscOS/Sources/Desktop/Wimp"
d22 1
a22 1
Module_HelpVersion      SETS    "5.00 (23 Feb 2006)"
@


4.112
log
@	Removemessages entry failed to put rma base in R2..
Detail:
	caused occasional aborts on task quit.
Admin:	castle added IP


Version 4.100. Tagged as 'Wimp-4_100'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.100"
Module_Version          SETA    410
d17 2
a18 2
Module_Date             SETS    "22 Feb 2006"
Module_ApplicationDate  SETS    "22-Feb-06"
d21 2
a22 2
Module_FullVersion      SETS    "4.100"
Module_HelpVersion      SETS    "4.100 (22 Feb 2006)"
@


4.111
log
@	tidy fixes in Wimp09 .
Detail:
	tidied up logic of wimp_addmessages memory salvage
Admin:
	(this is a file that built!)

Version 4.99. Tagged as 'Wimp-4_99'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.99"
Module_Version          SETA    499
d17 2
a18 2
Module_Date             SETS    "17 Jan 2006"
Module_ApplicationDate  SETS    "17-Jan-06"
d21 2
a22 2
Module_FullVersion      SETS    "4.99"
Module_HelpVersion      SETS    "4.99 (17 Jan 2006)"
@


4.110
log
@  Fixed so it builds.
Detail:
  s.Wimp09 contained a stray line saying "block count" which surprisingly
  didn't assemble. Removed.
Admin:
  Builds. Haven't tested whether it performs to spec yet.

Version 4.98. Tagged as 'Wimp-4_98'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.98"
Module_Version          SETA    498
d17 2
a18 2
Module_Date             SETS    "11 Jan 2006"
Module_ApplicationDate  SETS    "11-Jan-06"
d21 2
a22 2
Module_FullVersion      SETS    "4.98"
Module_HelpVersion      SETS    "4.98 (11 Jan 2006)"
@


4.109
log
@	tuned memory recovery in addmessage in Wimp09 to take account of the
	granularity of RMA allocation. now does not consume/not return rma
Detail:
Admin: castle added ip


Version 4.97. Tagged as 'Wimp-4_97'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.97"
Module_Version          SETA    497
d17 2
a18 2
Module_Date             SETS    "05 Jan 2006"
Module_ApplicationDate  SETS    "05-Jan-06"
d21 2
a22 2
Module_FullVersion      SETS    "4.97"
Module_HelpVersion      SETS    "4.97 (05 Jan 2006)"
@


4.108
log
@	Fixed small memory leak in Wimp09 when adding and removing
	messages
Detail:
	use of R3 value in OS_Module extend block entry was incorrect..
	it was used as absolute size required, should be changed size required.
	resulted in wrong block re-sizing.

Admin:
	castle added IP.


Version 4.96. Tagged as 'Wimp-4_96'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.96"
Module_Version          SETA    496
d21 2
a22 2
Module_FullVersion      SETS    "4.96"
Module_HelpVersion      SETS    "4.96 (05 Jan 2006)"
@


4.107
log
@	Added a CLRV to ensure V starts clear when using a Wimp_Pollword
Detail:
	usergroup had identified a Hi bit set (32bit) issue with
	PollWords that existed in a hi bit set DA. There is evidence of
	previous work to avoid this, but a hi bit set pollword address
	could leave a V set condition floating around. Added CLRV to ensure it
	was cleared.
Admin:  tested in ROM at castle.. passes test from user that previously
	failed.  Castle added IP


Version 4.95. Tagged as 'Wimp-4_95'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.95"
Module_Version          SETA    495
d17 2
a18 2
Module_Date             SETS    "11 Sep 2005"
Module_ApplicationDate  SETS    "11-Sep-05"
d21 2
a22 2
Module_FullVersion      SETS    "4.95"
Module_HelpVersion      SETS    "4.95 (11 Sep 2005)"
@


4.106
log
@Icon bar Shift F12 behaviour changed back to RISC OS 3.7 style, which made
far more sense than the bizarre "simplified" scheme some Ursula spec review
cooked up.

Version 4.94. Tagged as 'Wimp-4_94'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.94"
Module_Version          SETA    494
d17 2
a18 2
Module_Date             SETS    "26 Apr 2005"
Module_ApplicationDate  SETS    "26-Apr-05"
d21 2
a22 2
Module_FullVersion      SETS    "4.94"
Module_HelpVersion      SETS    "4.94 (26 Apr 2005)"
@


4.105
log
@
  Ensure thet usrblk is valid before checking fast pollwords

Details:
  s.Wimp03 : lines 502 to 505 moved 4 lines later
Admin:
  Tested in rom at Castle. fix believed benign at Tematic


Version 4.93. Tagged as 'Wimp-4_93'
@
text
@d3 1
a3 1
; Last processed by srccommit version: 1.68.
d14 2
a15 2
Module_MajorVersion     SETS    "4.93"
Module_Version          SETA    493
d17 2
a18 2
Module_Date             SETS    "12 Aug 2004"
Module_ApplicationDate  SETS    "12-Aug-04"
d21 2
a22 2
Module_FullVersion      SETS    "4.93"
Module_HelpVersion      SETS    "4.93 (12 Aug 2004)"
@


4.104
log
@Changes from Kevin:
* New options file for STB
* Changed some ADRs to ADRLs so that they reach for the options combination
  for STB

Version 4.92. Tagged as 'Wimp-4_92'
@
text
@d3 1
a3 1
; Last processed by srccommit version: 1.2.
d14 2
a15 2
Module_MajorVersion     SETS    "4.92"
Module_Version          SETA    492
d17 2
a18 2
Module_Date             SETS    "05 Jul 2004"
Module_ApplicationDate  SETS    "05-Jul-04"
d21 2
a22 2
Module_FullVersion      SETS    "4.92"
Module_HelpVersion      SETS    "4.92 (05 Jul 2004)"
@


4.103
log
@Icon flag bit 10 works again (bug introduced in 32-bitting).
Variants pre-Ursula now build again.

Version 4.91. Tagged as 'Wimp-4_91'
@
text
@d3 1
a3 1
; Last processed by srccommit version: 1.68.
d14 2
a15 2
Module_MajorVersion     SETS    "4.91"
Module_Version          SETA    491
d17 2
a18 2
Module_Date             SETS    "22 Apr 2003"
Module_ApplicationDate  SETS    "22-Apr-03"
d21 2
a22 2
Module_FullVersion      SETS    "4.91"
Module_HelpVersion      SETS    "4.91 (22 Apr 2003)"
@


4.102
log
@Added soe documentation on API changes since Ursula.
Fixed an errant top-bit-set pointer problem with submenu pointers.
Removed startup sprites from Wimp sprite pool - now live in Desktop module.

Version 4.90. Tagged as 'Wimp-4_90'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.90"
Module_Version          SETA    490
d17 2
a18 2
Module_Date             SETS    "31 Mar 2003"
Module_ApplicationDate  SETS    "31-Mar-03"
d21 2
a22 2
Module_FullVersion      SETS    "4.90"
Module_HelpVersion      SETS    "4.90 (31 Mar 2003)"
@


4.101
log
@Added a new window flag (extra flags byte bit 4) to indicate that
Wimp_GetPointerInfo should include shaded icons, in particular so that they
can now have interactive help. Included some information on RISC OS Select
APIs so that we can avoid clashes.

Version 4.89. Tagged as 'Wimp-4_89'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.89"
Module_Version          SETA    489
d17 2
a18 2
Module_Date             SETS    "28 Feb 2003"
Module_ApplicationDate  SETS    "28-Feb-03"
d21 2
a22 2
Module_FullVersion      SETS    "4.89"
Module_HelpVersion      SETS    "4.89 (28 Feb 2003)"
@


4.100
log
@Added a couple of new Wimp_TextOp reason codes. Current clients are Filer
2.08 and Pinboard 0.80.

Version 4.88. Tagged as 'Wimp-4_88'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.88"
Module_Version          SETA    488
d17 2
a18 2
Module_Date             SETS    "04 Feb 2003"
Module_ApplicationDate  SETS    "04-Feb-03"
d21 2
a22 2
Module_FullVersion      SETS    "4.88"
Module_HelpVersion      SETS    "4.88 (04 Feb 2003)"
@


4.99
log
@Added automatic translation of spaces to hard spaces in writeable icons
that forbid the former but allow the latter. This effectively allows spaces
in filenames.

Version 4.87. Tagged as 'Wimp-4_87'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.87"
Module_Version          SETA    487
d17 2
a18 2
Module_Date             SETS    "24 Jan 2003"
Module_ApplicationDate  SETS    "24-Jan-03"
d21 2
a22 2
Module_FullVersion      SETS    "4.87"
Module_HelpVersion      SETS    "4.87 (24 Jan 2003)"
@


4.98
log
@  Bugfixes.
Detail:
  * All tasks have erroneously been flagged as receiving all messages since
    version 4.78. Correct behaviour is now restored, and the previous
    fix (to ignore Wimp_AddMessages calls for tasks that already wanted
    all messages) should be unaffected.
  * Check for "P"-validation icon creation under the pointer was broken
    in three ways, now works.
  * The optimisation of multiple Message_SlotSize calls is overenthusiastic,
    and can lead to some messages being lost if the slot size is changed
    (including as a side-effect of OS_ChangeDynamicArea) during
    high-priority pollword-nonzero handlers or message handlers for
    Message_SlotSize - in both situations, a message block that may have
    already been delivered to some tasks is still present at the head of
    the message list. Now, the optimisation always ignores the message at
    the head of the message list.
Admin:
  Tested on Tungsten.

Version 4.86. Tagged as 'Wimp-4_86'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.86"
Module_Version          SETA    486
d17 2
a18 2
Module_Date             SETS    "23 Jan 2003"
Module_ApplicationDate  SETS    "23-Jan-03"
d21 2
a22 2
Module_FullVersion      SETS    "4.86"
Module_HelpVersion      SETS    "4.86 (23 Jan 2003)"
@


4.97
log
@  Menu bugfixes and sprite variation support.
Detail:
  * Adjust clicking on menu items was leading to Message_MenusDeleted being
    broadcast, resulting in incorrect behaviour in many applications.
  * Sprite-only menu items (eg !Draw's line pattern submenu) now highlight
    correctly when tiled menus are configured.
  * Added Wimp_Extend 13, which works out the appropriate resolution suffix
    for a given sprite pathname - required since Sprites11 support needs
    an iterative approach. This supercedes Wimp_ReadSysInfo 2.
  * *IconSprites now tries prefixing the last element of its path argument
    with "<Wimp$IconTheme>".
Admin:
  Tested on Tungsten.

Version 4.85. Tagged as 'Wimp-4_85'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.85"
Module_Version          SETA    485
d17 2
a18 2
Module_Date             SETS    "17 Jan 2003"
Module_ApplicationDate  SETS    "17-Jan-03"
d21 2
a22 2
Module_FullVersion      SETS    "4.85"
Module_HelpVersion      SETS    "4.85 (17 Jan 2003)"
@


4.96
log
@  Bugfixing, Sprites11 support and stretchy command windows.
Detail:
  * Bugfix: the contents of the pollword returned in the poll block by
    a PollWordNonZero event, where the pollword was flagged as high
    priority, was rotated by 8 bits due to a internal top-bit-set
    workaround. This no longer happens. (This was causing OmniClient never
    to complete initialisation on my machine.)
  * Extended the alternate resolution icon scheme for RAM/ROM sprites and
    toolsprites to be multi-pass, enabling the use of extra sprite sets for
    weird modes (most notably EX0 EY0 ones). After '23' or '0' suffixes
    (the latter still only applies to toolsprites), the suffix for the
    equivalent polychromatic resolution is tried. After rectangular
    suffixes, the next larger squarer suffix is tried. After '11', '22' is
    tried. Failing all of these, a match is attempted with no suffix.
  * The command window is now scaled and centred to match the current screen
    mode - up to a maximum size of 1280 x 1024 OS units.
  * Fixed the *WimpVisualFlags help strings (again).
  * Fixed 'task2' debugging to know about the structure of the SVC stack on
    32-bit machines.
  * Added support for generation of GPA files.
Admin:
  Tested on Tungsten.

Version 4.84. Tagged as 'Wimp-4_84'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.84"
Module_Version          SETA    484
d17 2
a18 2
Module_Date             SETS    "20 Dec 2002"
Module_ApplicationDate  SETS    "20-Dec-02"
d21 2
a22 2
Module_FullVersion      SETS    "4.84"
Module_HelpVersion      SETS    "4.84 (20 Dec 2002)"
@


4.95
log
@  Bugfix and feature.
Detail:
  * Validation string commands to set the pointer shape were incorrectly
    interpreted if they contained commas to set the active point.
  * Holding down shift when clicking on the back icon will only move the
    window by one position within the window stack.
Admin:
  Tested on Tungsten.

Version 4.83. Tagged as 'Wimp-4_83'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.83"
Module_Version          SETA    483
d17 2
a18 2
Module_Date             SETS    "13 Dec 2002"
Module_ApplicationDate  SETS    "13-Dec-02"
d21 2
a22 2
Module_FullVersion      SETS    "4.83"
Module_HelpVersion      SETS    "4.83 (13 Dec 2002)"
@


4.94
log
@  A few bugfixes, and some muching around with WimpVisualFlags that I did
  ages ago but hasn't made it into a build yet.
Detail:
  * Deleting icon 0 in a window that had no windows would rotate the
    contents of word &00000010 by 16 bits. This had the effect of causing
    lazy task swapping to blow up with an "undefined instruction" error.
  * Setting the caret to a byte position beyond the end of an icon's text
    would (a) loop indefinitely if the alphabet is UTF-8, or (b) data abort
    for any other alphabet. This was due to the code trying to determine the
    number of characters in the string, and ignoring the terminator;
    skipcharR would never advance far enough to satisfy the loop in UTF-8,
    in other alphabets it would advance as far as necessary, leading to the
    later code to try to step a huge number of characters through the
    pushfontstring copy of the text, running off the top of the SVC stack
    (which is mapped out on Tungsten, previously it abutted the system heap,
    so no ill effects were observed).
  * Keyboard shortcuts are now correctly positoned when 3D menus are selected.
  * Corrected spelling of "dialogue" in *WimpVisualFlags help.
  * Changed *WimpVisualFlags so that no parameters gives RISC OS 3
    behaviour, and -All gives default RISC OS 4 behaviour. (Previously, font
    blending was enabled in both cases, unless explicitly disabled by an
    additional -NoFontBlending switch.) This required a sense change in the
    font blending switch: -FontBlending now enables font blending.
    -NoFontBlending is still accepted without error, but is ineffectual
    (since the no-options state upon which it acts already has font blending
    disabled).
  * Default setting is now as though *WimpVisualFlags -RemoveIconBoxes had
    been executed. (In practice, this will not be noticeably different from
    previous Tematic versions, see below.)
  * The state -RemoveIconBoxes switch was previously assumed always set -
    now, if it is not specified, you get the old RISC OS 3 behaviour back.
Admin:
  Tested on Tungsten.

Version 4.82. Tagged as 'Wimp-4_82'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.82"
Module_Version          SETA    482
d17 2
a18 2
Module_Date             SETS    "05 Dec 2002"
Module_ApplicationDate  SETS    "05-Dec-02"
d21 2
a22 2
Module_FullVersion      SETS    "4.82"
Module_HelpVersion      SETS    "4.82 (05 Dec 2002)"
@


4.93
log
@  Messages changes.
Detail:
  * Removed Acorn/ACORN from keyboard shortcuts.
  * Added Red/RED/Green/GREEN/Blue/BLUE (and an attempt at German
    versions too) to keyboard shortcuts.
  * Capitalised the 'B' in -Fully3DIconBar to hint that it's necessary in
    the short form of the switch to *WimpVisualFlags.
Admin:
  Not tested.

Version 4.81. Tagged as 'Wimp-4_81'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.81"
Module_Version          SETA    481
d17 2
a18 2
Module_Date             SETS    "28 Nov 2002"
Module_ApplicationDate  SETS    "28-Nov-02"
d21 2
a22 2
Module_FullVersion      SETS    "4.81"
Module_HelpVersion      SETS    "4.81 (28 Nov 2002)"
@


4.92
log
@Fix to Wimp_DeleteIcon stiffing the machine when trying to delete an
icon which doesn't yet exist.Now fails gracefully.
Import of another set of awful icons in the Iyonix resources.
Tweak to the number of CLI parameters accepted by * commands.

Version 4.80. Tagged as 'Wimp-4_80'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.80"
Module_Version          SETA    480
d21 2
a22 2
Module_FullVersion      SETS    "4.80"
Module_HelpVersion      SETS    "4.80 (28 Nov 2002)"
@


4.91
log
@  Bugfixes.
Detail:
  * Message list pointers passed into Wimp_Initialises that didn't follow
    Wimp_StartTask used to be corrupted
  * Stack imbalance in ExitPoll if SWI Portable_Speed didn't preserve flags
  * 32-bit mode test speedups
  * Builds without RO4 option set
Admin:
  Tested on Tungsten and Risc PC.

Version 4.79. Tagged as 'Wimp-4_79'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.79"
Module_Version          SETA    479
d17 2
a18 2
Module_Date             SETS    "31 Oct 2002"
Module_ApplicationDate  SETS    "31-Oct-02"
d21 2
a22 2
Module_FullVersion      SETS    "4.79"
Module_HelpVersion      SETS    "4.79 (31 Oct 2002)"
@


4.90
log
@  Merged in RISC OS 4.02 changes (including ROM patches). Also som bugfixes.
Detail:
  RISC OS 4 changes:
  * Font blending for desktop font (based on NC code, but now configurable)
  * 3-D window/menu/iconbar borders
  * Textured menu backgrounds
  * Loss of rubout box in unfilled text+sprite icons
  * *WimpVisualFlags controls various aspects of cosmetic changes above
  * Iconise button "slot" glyph slightly shorter (but only adopted in the RO400
    Resource directory)
  * Command window has front-window flag set
  * Byte at +39 of the window block has gained two new flag bits:
      bit 2 set => this window must never be given a 3D border
      bit 3 set => this window must always be given a 3D border
      (note that ResEd erroneously created windows with both bits set,
      this case is treated as though both bits were clear)
  * Another two colour specifiers on the end of C validation string command
    for icons controls the foreground and background colours to be used when
    the icon is selected
  * Pointer shape is correctly reprogrammed by the creation of icon
    underneath it
  * Full stops in writable icons are treated the same as spaces from the
    point of view of cursor navigation
  * spritesize routine returns a size of 0 if the sprite didn't exist
    (probably fixes some rendering problems)
  * Adjust-click on back icon brings window to front
  My changes:
  * DeleteRight turned on
  * Icon bar title background is set to default in all resource sets (avoids
    translation table recalc)
  * Error box title now cream across all resource sets
  * RISC OS 4 changes made 32-bit compatible / high addresses safe
  * Undocumented FullIconClipping option disabled
  * Command help made consistent for internationalised and non-
    internationalised builds
  * WimpVisualFlags defaults made sensible
  * Menu side width affected by ThreeD option at *run* time not assemble time
  * Right-clicking on menus with writable items no longer data aborts
  * Auto-opened menus are now at RHS of current icon (matches RISC OS 3.1)
  * Colour menus were knackered unless menu tiling was enabled
  * Fixed a bug whereby adding messages to a task that wanted all messages
    actually caused it to lose all other messages. The RISC OS 4 fix for
    this didn't work
  * Fixed bug introduced in version 4.76: tasks that wanted no messages got
    all of them
  * Autoscrolling is updated every 8 cs rather than every 12 cs
  * Added menu texture to pre-RISC OS 4 sprites files
Admin:
  Tested on Tungsten.

Version 4.78. Tagged as 'Wimp-4_78'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.78"
Module_Version          SETA    478
d17 2
a18 2
Module_Date             SETS    "30 Oct 2002"
Module_ApplicationDate  SETS    "30-Oct-02"
d21 2
a22 2
Module_FullVersion      SETS    "4.78"
Module_HelpVersion      SETS    "4.78 (30 Oct 2002)"
@


4.89
log
@  Memory-related stuff.
Detail:
  * Default UpCall handler is installed when an application is paged out,
    so there is no danger of it being called by naughty people issuing
    UpCalls in the background.
  * AMBControl builds now sit on Service_MemoryMoved so that they can issue
    Message_SlotSize when the kernel has resized the application slot
    independently (eg because the memory was needed to grow a dynamic area,
    and nobody objected via Service_Memory or UpCall_MovingMemory).
  * Medusa-onwards builds no longer request Service_ValidateAddress, because
    we're not managing the free pool any more, and the code that was here
    only called an ineffectual SWI!
  * SafeChangeDynamic wasn't setting the CAO high enough to be free of big
    application slots; now it points it at itself.
  * The free pool wasn't being shrunk/grown enough on initfirsttask /
    closelast. It still can't do by more than 1GB without stiffing - bug in
    kernel?
  * Bugs in top-bit-safe changes fixed: dragbox resizing was broken, Escape
    state wasn't being restored for new tasks.
Admin:
  Tested on high-ROM/stack, 48M-appslot Tungsten.

Version 4.77. Tagged as 'Wimp-4_77'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.77"
Module_Version          SETA    477
d17 2
a18 2
Module_Date             SETS    "25 Oct 2002"
Module_ApplicationDate  SETS    "25-Oct-02"
d21 2
a22 2
Module_FullVersion      SETS    "4.77"
Module_HelpVersion      SETS    "4.77 (25 Oct 2002)"
@


4.88
log
@  Given a good thrashing.
Detail:
  All pointers passed to the Wimp (mode selectors, menus, sprite areas,
  palettes, pollwords, validation strings, message lists, routines etc etc)
  in any of its APIs can now be anywhere within the 32-bit address range.
  In general, whenever "<= 0" was accepted as a null condition, the value
  must now be either 0 or -1. It should also be tolerant of system memory
  areas (supervisor stack and RMA) being in the top half of memory.
  Also:
  * Default next slot now a build option - Ursula builds (eg Tungsten) use
    1024K instead of 640K
  * Ursula builds no longer have a build variant in the help string
  * Autosenses ROM location
  * CR-LFs in *Configure messages replaced with LF-CRs
  * Added Iyonix resources (currently based on Morris4)
  * Morris4 sprites files have gained file_lxa, small_lxa, file_unf,
    small_unf and lo!help sprites
  * Ursula sprites files have gained lo!help sprites
  * *WimpSlot can take memory sizes in megabytes or gigabytes
Admin:
  Tested on a "traditional" memory-mapped Tungsten.

Version 4.76. Tagged as 'Wimp-4_76'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.76"
Module_Version          SETA    476
d17 2
a18 2
Module_Date             SETS    "23 Oct 2002"
Module_ApplicationDate  SETS    "23-Oct-02"
d21 2
a22 2
Module_FullVersion      SETS    "4.76"
Module_HelpVersion      SETS    "4.76 (23 Oct 2002)"
@


4.87
log
@Commented out a lump of dead code to avoid anyone else getting confused by
it in future.

Version 4.75. Tagged as 'Wimp-4_75'
@
text
@d3 1
a3 1
; Last processed by srccommit version: 1.67.
d10 1
a10 2
                        GBLS    Module_ApplicationDate2
                        GBLS    Module_ApplicationDate4
d14 2
a15 2
Module_MajorVersion     SETS    "4.75"
Module_Version          SETA    475
d17 2
a18 3
Module_Date             SETS    "22 Aug 2002"
Module_ApplicationDate2 SETS    "22-Aug-02"
Module_ApplicationDate4 SETS    "22-Aug-2002"
d21 2
a22 2
Module_FullVersion      SETS    "4.75"
Module_HelpVersion      SETS    "4.75 (22 Aug 2002)"
@


4.86
log
@  Creates Resources.Korea and Resources.Taiwan
Detail:
  Resources.Korea.Messages has translations for Cancel, Continue, OK,
    and Error.
  Resources.Taiwan.Messages has translations for Cancel, Continue, OK,
    and Error.
Admin:
  No testing


Version 4.74. Tagged as 'Wimp-4_74'
@
text
@d3 1
a3 1
; Last processed by srccommit version: 1.62.
d15 2
a16 2
Module_MajorVersion     SETS    "4.74"
Module_Version          SETA    474
d18 3
a20 3
Module_Date             SETS    "21 Feb 2002"
Module_ApplicationDate2 SETS    "21-Feb-02"
Module_ApplicationDate4 SETS    "21-Feb-2002"
d23 2
a24 2
Module_FullVersion      SETS    "4.74"
Module_HelpVersion      SETS    "4.74 (21 Feb 2002)"
@


4.85
log
@  A fix and some changes.
Detail:
  * Makefile change to allow install phase to work correctly with the
    shared makefiles.
  * Added some Japanese resources for the STB.
Admin:
  Builds and installs.

Version 4.73. Tagged as 'Wimp-4_73'
@
text
@d15 2
a16 2
Module_MajorVersion     SETS    "4.73"
Module_Version          SETA    473
d18 3
a20 3
Module_Date             SETS    "20 Feb 2002"
Module_ApplicationDate2 SETS    "20-Feb-02"
Module_ApplicationDate4 SETS    "20-Feb-2002"
d23 2
a24 2
Module_FullVersion      SETS    "4.73"
Module_HelpVersion      SETS    "4.73 (20 Feb 2002)"
@


4.84
log
@  Menu-related tinkering.
Detail:
  * Keyboard shortcuts in menus are now correctly aligned (and menus will
    be one pixel wider to compensate for the downwards rounding in SWI
    Font_ConverttoOS).
  * There is no longer any danger of menu titles being treated as though
    they contain a keyboard shortcut.
  * Dialogue boxes may now contain nested windows.
Admin:
  Tested on a Risc PC.

Version 4.72. Tagged as 'Wimp-4_72'
@
text
@d3 1
d15 2
a16 2
Module_MajorVersion     SETS    "4.72"
Module_Version          SETA    472
d18 3
a20 3
Module_Date             SETS    "11 Jan 2002"
Module_ApplicationDate2 SETS    "11-Jan-02"
Module_ApplicationDate4 SETS    "11-Jan-2002"
d23 2
a24 2
Module_FullVersion      SETS    "4.72"
Module_HelpVersion      SETS    "4.72 (11 Jan 2002)"
@


4.83
log
@  Change to STB build options.
Detail:
  Auto scroll in Filer windows is now on to stop blank error boxes
  when you try "rubber band" selections.
Admin:
  Tested and works.

Version 4.71. Tagged as 'Wimp-4_71'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.71"
Module_Version          SETA    471
d17 3
a19 3
Module_Date             SETS    "30 Nov 2001"
Module_ApplicationDate2 SETS    "30-Nov-01"
Module_ApplicationDate4 SETS    "30-Nov-2001"
d22 2
a23 2
Module_FullVersion      SETS    "4.71"
Module_HelpVersion      SETS    "4.71 (30 Nov 2001)"
@


4.82
log
@  Minor resources change to all templates files.
Detail:
  The titlebar and input focus colours for the window template for
  error boxes is now cream (12). This is more intuitive. Builds which
  do not have a title bar will not look any different.
Admin:
  Included the little utility which did the modification in Test/ResMod
  (as in Resources Modifier - but who cares). May be of use in future.

Version 4.70. Tagged as 'Wimp-4_70'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.70"
Module_Version          SETA    470
d17 3
a19 3
Module_Date             SETS    "29 Oct 2001"
Module_ApplicationDate2 SETS    "29-Oct-01"
Module_ApplicationDate4 SETS    "29-Oct-2001"
d22 2
a23 2
Module_FullVersion      SETS    "4.70"
Module_HelpVersion      SETS    "4.70 (29 Oct 2001)"
@


4.81
log
@  Commit of my Wimp changes that have trickled in over the last four months.
Detail:
  * The pointer passed to Wimp_CommandWindow can now be top-bit-set.
  * Bugfix to Wimp_CommandWindow: if the current task was uninitialised,
    or initialised as a non-multitasking task, then although entering the
    CommandWindow would restore escape condition generation to the way it
    was before entering the desktop, exiting the CommandWindow did not
    reset escape condition generation to the default desktop state (which is
    for escape condition generation to be disabled).
  * Escape condition generation is disabled for the duration of SWI
    Wimp_ReportError (instead of setting the default escape key for the
    duration). The previous state is restored on exit.
  * Added a minimal environment for the service call
    Service_ErrorButtonPressed, so that claimants can call OS_Exit without
    leaving the global Wimp error box in an undefined state.
  * In the Wimp_Poll loop, if there are no events to deliver to any tasks
    (not even null events), then rather than sitting in a SVC mode loop,
    the Wimp now triggers transient callbacks. This is particularly
    important in order not to halt all activity in the Internet stack.
    The option LeaveOS can be set to make the Wimp use the as-yet
    unimplemented SWI OS_LeaveOS for this purpose; this is currently unset
    for all builds.
  * By (persistent) request, reinstated the old iconbar popping code,
    though it is currently a build switch that is turned off for all builds.
Admin:
  Tested on a Risc PC.

Version 4.69. Tagged as 'Wimp-4_69'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.69"
Module_Version          SETA    469
d17 3
a19 3
Module_Date             SETS    "14 Sep 2001"
Module_ApplicationDate2 SETS    "14-Sep-01"
Module_ApplicationDate4 SETS    "14-Sep-2001"
d22 2
a23 2
Module_FullVersion      SETS    "4.69"
Module_HelpVersion      SETS    "4.69 (14 Sep 2001)"
@


4.80
log
@    Added !Edit sprite to Lazarus resources.

Detail:
    As above.

Admin:
    Untested.

Version 4.68. Not tagged
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.68"
Module_Version          SETA    468
d17 3
a19 3
Module_Date             SETS    "13 Jul 2001"
Module_ApplicationDate2 SETS    "13-Jul-01"
Module_ApplicationDate4 SETS    "13-Jul-2001"
d22 2
a23 2
Module_FullVersion      SETS    "4.68"
Module_HelpVersion      SETS    "4.68 (13 Jul 2001)"
@


4.79
log
@  Stack imbalance corrected.
Detail:
  When building a copy for RISC OS 3.1, this bug would be hit. Now fixed.
Admin:
  Checked on RISC OS 3.1; seems to work fine now.

Version 4.68. Tagged as 'Wimp-4_68'
@
text
@d17 3
a19 3
Module_Date             SETS    "26 Jun 2001"
Module_ApplicationDate2 SETS    "26-Jun-01"
Module_ApplicationDate4 SETS    "26-Jun-2001"
d23 1
a23 1
Module_HelpVersion      SETS    "4.68 (26 Jun 2001)"
@


4.78
log
@  Minor fixes, some of which have been waiting to be committed for a while.
Detail:
  * Command line buffer for Wimp_StartTask (and anything that uses it,
    eg *WimpTask) increased from 256 bytes to 1024 bytes.
  * Top-bit-set message list pointers passed to Wimp_Initialise and
    Wimp_RemoveMessages now work (there was never a problem with
    Wimp_AddMessages!)
  * The fix for top-bit-set application name pointers in Wimp 4.65 actually
    only fixed lookup for "<application> may have gone wrong" lookups. They
    now work correctly in error window title construction, and when
    constructing an application sprite name if flag bit 8 is clear.
  * A pointer value of 0 is now accepted in addition to -1 for an
    "<application> may have gone wrong" lookup - this brings it into line
    with the other two places where the application name pointer is
    referenced.
  * When constructing an error window title, the Wimp would skip any leading
    backslash character. Now it does so when constructing "<application> may
    have gone wrong" too - this is a simple way to disable the application
    sprite in the error window.
Admin:
  Error box behaviour actually tested this time!

Version 4.67. Tagged as 'Wimp-4_67'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.67"
Module_Version          SETA    467
d17 3
a19 3
Module_Date             SETS    "29 May 2001"
Module_ApplicationDate2 SETS    "29-May-01"
Module_ApplicationDate4 SETS    "29-May-2001"
d22 2
a23 2
Module_FullVersion      SETS    "4.67"
Module_HelpVersion      SETS    "4.67 (29 May 2001)"
@


4.77
log
@         Added Martha components.

Detail:
        Added Martha directories to Resources/UK by directly coping and renaming Lazarus
        directory.

Admin:
      Work in progress on Martha build machine.

Version 4.66. Tagged as 'Wimp-4_66'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.66"
Module_Version          SETA    466
d17 3
a19 3
Module_Date             SETS    "25 May 2001"
Module_ApplicationDate2 SETS    "25-May-01"
Module_ApplicationDate4 SETS    "25-May-2001"
d22 2
a23 2
Module_FullVersion      SETS    "4.66"
Module_HelpVersion      SETS    "4.66 (25 May 2001)"
@


4.77.2.1
log
@  Added Dan Ellis's multithreading support, on a development branch for now.
Detail:
  This breaks the equivalence between tasks and AMB slots, allowing many
  threads of execution to share the same AMB slot, where an application's
  heap is usually located. In API terms, it is presented as an extension to
  Wimp_StartTask, see Docs/Multithreading for more information. It is the
  caller's responsibility to create a new stack chunk for the new thread if
  required. Note that BASIC's variable storage model is fundamentally
  unsuited for multithreading.
Admin:
  This was developed in 2001 and was not committed at the time due to lack
  of testing and peer review. It is now being added as a branch from a
  contemporary trunk Wimp. Hopefully somebody will be interested enough to
  merge the branch into a recent version!

Version 4.66, 4.77.2.1. Tagged as 'Wimp-4_66-4_77_2_1'
@
text
@a2 1
; Last processed by srccommit version: 1.2.
d9 2
a10 1
                        GBLS    Module_ApplicationDate
d16 4
a19 3
Module_MinorVersion     SETS    "4.77.2.1"
Module_Date             SETS    "07 Oct 2007"
Module_ApplicationDate  SETS    "07-Oct-07"
d21 3
a23 3
Module_ComponentPath    SETS    "castle/RiscOS/Sources/Desktop/Wimp"
Module_FullVersion      SETS    "4.66 (4.77.2.1)"
Module_HelpVersion      SETS    "4.66 (07 Oct 2007) 4.77.2.1"
@


4.76
log
@  Fixed a number of long-standing but low priority bugs in the Wimp.
Detail:
  * Any top-bit-set sprite area pointer in a window definition was treated
    as a null pointer, and any top-bit-set program name pointer in
    Wimp_ReportError was similarly treated as a null pointer.
  * For 24-bit window colour builds, when the Wimp drew a title bar with
    the input focus, and there were sprite icons in the previously redrawn
    window, and the most recently plotted icon sprite was unpaletted and not
    selected or inverted, then the translation table for the icon sprite (in
    the RMA) would leak. I suppose that's what I get for re-using a bit of
    dead code without fully working out why it was bypassed in the first
    place...
  * The key handling code used to be over-eager to read bytes from the
    keyboard buffer: it would attempt to read up to 6 bytes ahead to ease
    the recognition of UTF-8 character sequences. This could cause problems,
    in particular if F12 was one of those 6 bytes, then any following bytes
    would be queued for use as Wimp keypresses, rather than being left in
    the keyboard buffer for use by ShellCLI. The Wimp now analyses the first
    byte read to make a sensible estimate of how many bytes it needs to read
    ahead.
  * Select-dragging (including Select-resizing) of windows with panes used
    to soak up all the processor time. This was because when the task
    received an Open_Window_Request, it would re-open the pane in front of
    the main window, but this would cause the Wimp to believe that it had to
    re-open the main window at the front of the stack again when Wimp_Poll
    was next called. The problem has been fixed so that the Wimp now
    examines all the windows in front of the drag window to see if they have
    the pane window flag bit set, and doesn't reshuffle the windows if they
    all do. (Actually, the test is performed such that foreground windows
    in front of the drag window are also ignored.)
Admin:
  Tested on a desktop machine.

Version 4.65. Tagged as 'Wimp-4_65'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.65"
Module_Version          SETA    465
d17 3
a19 3
Module_Date             SETS    "23 Mar 2001"
Module_ApplicationDate2 SETS    "23-Mar-01"
Module_ApplicationDate4 SETS    "23-Mar-2001"
d22 2
a23 2
Module_FullVersion      SETS    "4.65"
Module_HelpVersion      SETS    "4.65 (23 Mar 2001)"
@


4.75
log
@  Updated build structure to use the shared AAsmModule makefile.
  Updated to build using objasm instead of aasm.
  Sources changed to be objasm-compatible.
Admin:
  Requires Library 0.71 or later.
  Requires BuildSys 3.06 or later.
  Requires Env 0.65 or later.

Version 4.64. Tagged as 'Wimp-4_64'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.64"
Module_Version          SETA    464
d17 3
a19 3
Module_Date             SETS    "16 Mar 2001"
Module_ApplicationDate2 SETS    "16-Mar-01"
Module_ApplicationDate4 SETS    "16-Mar-2001"
d22 2
a23 2
Module_FullVersion      SETS    "4.64"
Module_HelpVersion      SETS    "4.64 (16 Mar 2001)"
@


4.74
log
@  A couple of fixes for bugs that were crippling 32-bit Lazarus builds.
Detail:
  1) The pointer to the module flags word wasn't made relative to the start
     of the module; because the linker bases an image at &8000 by default,
     this meant that the module flags pointer pointed at a word 32K too far
     into the image, and there were even chances whether a given build of
     the Wimp would appear to be 32-bit compatible.
  2) Due to a missing alignment directive in the Wimp's workspace layout, if
     you did a build of the Wimp where one or more of the ClickSubmenus,
     IconiseButton, StickyEdges or BounceClose switches were on but the
     PoppingIconBar one was off, you would end up with several word-sized
     locations being non-word-aligned. This affected embedded builds, where
     only the ClickSubmenus switch (new in Wimp 4.57) is typically set, but
     not desktop builds, where PoppingIconBar is typically set.
Admin:
  Only tested on a desktop machine so far, but this wouldn't have shown up
  either of the problems in the first place...

Version 4.63. Tagged as 'Wimp-4_63'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.63"
Module_Version          SETA    463
d17 3
a19 3
Module_Date             SETS    "15 Mar 2001"
Module_ApplicationDate2 SETS    "15-Mar-01"
Module_ApplicationDate4 SETS    "15-Mar-2001"
d22 2
a23 2
Module_FullVersion      SETS    "4.63"
Module_HelpVersion      SETS    "4.63 (15 Mar 2001)"
@


4.73
log
@  Improvement to menu creation code.
Detail:
  Instead of continually extending the menu windows icon by icon, this
    version calculates how many icons it is going to need, and claims
    them en bloc, marking all the icons as deleted so that as the menu
    code creates each icon, no more block extending needs to be done.
  int_create_multiple_icons does the extension work; the menu generation
    code in Wimp05 does the initialising before calling int_create_icon
    lots of times (3*number of items in menu)
Admin:
  Tested in a desktop build.

Version 4.62. Tagged as 'Wimp-4_62'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.62"
Module_Version          SETA    462
d17 3
a19 3
Module_Date             SETS    "23 Feb 2001"
Module_ApplicationDate2 SETS    "23-Feb-01"
Module_ApplicationDate4 SETS    "23-Feb-2001"
d22 2
a23 2
Module_FullVersion      SETS    "4.62"
Module_HelpVersion      SETS    "4.62 (23 Feb 2001)"
@


4.72
log
@  BBE changes - exports only Resources.${LOCALE}.${USERIF} plus the
    Messages and CmdHelp files.
Admin:
  Required by BBE builds.

Version 4.61. Tagged as 'Wimp-4_61'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.61"
Module_Version          SETA    461
d17 3
a19 3
Module_Date             SETS    "05 Jan 2001"
Module_ApplicationDate2 SETS    "05-Jan-01"
Module_ApplicationDate4 SETS    "05-Jan-2001"
d22 2
a23 2
Module_FullVersion      SETS    "4.61"
Module_HelpVersion      SETS    "4.61 (05 Jan 2001)"
@


4.71
log
@  Wimp_SetMode called outside the desktop now has no effect again.
Detail:
  32-bitising introduced the bug: the routine copy_mode_specifier no longer
  preserves flags, but Wimp_SetMode was relying on it doing so. Wimp_SetMode
  has been changed to re-test the number of active tasks again after the flags
  have been corrupted.
Admin:
  Tested in a desktop build.

Version 4.60. Tagged as 'Wimp-4_60'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.60"
Module_Version          SETA    460
d17 3
a19 3
Module_Date             SETS    "30 Nov 2000"
Module_ApplicationDate2 SETS    "30-Nov-00"
Module_ApplicationDate4 SETS    "30-Nov-2000"
d22 2
a23 2
Module_FullVersion      SETS    "4.60"
Module_HelpVersion      SETS    "4.60 (30 Nov 2000)"
@


4.70
log
@Fixed a stack imbalance in autoscroll code in 32-bit builds.

Version 4.59. Tagged as 'Wimp-4_59'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.59"
Module_Version          SETA    459
d17 3
a19 3
Module_Date             SETS    "08 Nov 2000"
Module_ApplicationDate2 SETS    "08-Nov-00"
Module_ApplicationDate4 SETS    "08-Nov-2000"
d22 2
a23 2
Module_FullVersion      SETS    "4.59"
Module_HelpVersion      SETS    "4.59 (08 Nov 2000)"
@


4.69
log
@  Change to behaviour of writeable menu items.
Detail:
  As soon as a menu or submenu that contains a writeable menu item is opened,
  the caret is placed in the (first) writeable menu item. Furthermore, you
  can highlight any other menu item in such a menu without losing the input
  focus from the writeable menu item.
  The initial reason for this change was to allow the use of writeable menu
  items on a touchscreen device, since they have no way for you to move the
  pointer over the writeable menu item without selecting it. But, on the
  basis that this change is actually useful for mouse users, and that it makes
  the behaviour of such submenus more consistent with dialogue boxes, it has
  been made unconditional.
Admin:
  Tested in a desktop build.

Version 4.58. Tagged as 'Wimp-4_58'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.58"
Module_Version          SETA    458
d17 3
a19 3
Module_Date             SETS    "03 Nov 2000"
Module_ApplicationDate2 SETS    "03-Nov-00"
Module_ApplicationDate4 SETS    "03-Nov-2000"
d22 2
a23 2
Module_FullVersion      SETS    "4.58"
Module_HelpVersion      SETS    "4.58 (03 Nov 2000)"
@


4.68
log
@  Shock horror - a new feature for the Wimp! And some housekeeping too.
Detail:
  * Added new functionality for menu trees: submenus can now be opened by
    clicking on their parent menu item. This is particularly aimed at
    touchscreen devices, and is configurable via the new *Configure keyword
    WimpClickSubmenu.
  * Change to the menu inactivity timeout behaviour after auto-opening of
    submenus (either by hovering over the parent menu item or by the new
    click-to-open functionality): although all hover operations are still
    ignored for this period, any click operations *will* now be obeyed.
  * Corrected numerous misleading comments in the menu handling code.
  * Added some suspiciously absent ALIGNs in the *Configure keyword handlers.
  * Uses new ASCII case-forcing macros so there are now fewer warnings
    printed during assembly (and it should run faster now too).
  * Added an AREA directive so that objasm's -ABS switch is no longer needed.
  * Standardised ErrMem token across all Messages files that use English.
Admin:
  Tested on a desktop machine.
  Requires HdrSrc 1.06.

Version 4.57. Tagged as 'Wimp-4_57'
@
text
@d12 4
a15 2
Module_MajorVersion     SETS    "4.57"
Module_Version          SETA    457
d17 7
a23 5
Module_Date             SETS    "20 Oct 2000"
Module_ApplicationDate2 SETS    "20-Oct-00"
Module_ApplicationDate4 SETS    "20-Oct-2000"
Module_FullVersion      SETS    "4.57"
Module_HelpVersion      SETS    "4.57 (20 Oct 2000)"
@


4.67
log
@
  * Import of new resources, following verification by Alpnet (the
    translators).

Detail:

  * Minor corrections applied to the Spanish sprites.  Affects the
    Lazarus resources only.

Admin:

  * Untested.

  * Similar changes applied to Bethany branch.

Version 4.56. Tagged as 'Wimp-4_56'
@
text
@d12 2
a13 2
Module_MajorVersion     SETS    "4.56"
Module_Version          SETA    456
d15 5
a19 5
Module_Date             SETS    "19 Oct 2000"
Module_ApplicationDate2 SETS    "19-Oct-00"
Module_ApplicationDate4 SETS    "19-Oct-2000"
Module_FullVersion      SETS    "4.56"
Module_HelpVersion      SETS    "4.56 (19 Oct 2000)"
@


4.66
log
@
  * Fixed corrupted sprite ("splash_opts") in the German resources.

Admin:

  * Untested.  Fault noted in the Bethany project.

Version 4.55. Tagged as 'Wimp-4_55'
@
text
@d11 3
a13 2
Module_MajorVersion     SETS    "4.55"
Module_Version          SETA    455
d15 5
a19 4
Module_Date             SETS    "08 Sep 2000"
Module_ApplicationDate2 SETS    "08-Sep-00"
Module_ApplicationDate4 SETS    "08-Sep-2000"
Module_FullVersion      SETS    "4.55"
@


4.65
log
@
  * Translated resources for France, Germany, Italy, Spain and Turkey
    incorporated.

Detail:

  * Files changed include the Messages, Template and Sprite files, all of
    which now contain appropriate translated versions.

    This is a TRUNK version of the changes applied to the Bethany branch.

Admin:

  * Sprite files contain an equivalent set of sprites to those in the UK
    variant; these have been rationalised recently so as to remove duplicates
    contained in other software components.

  * New file structure preserved; this is NOT a direct copy from the Bethany
    branch version of the Wimp.

Version 4.54. Tagged as 'Wimp-4_54'
@
text
@d11 2
a12 2
Module_MajorVersion     SETS    "4.54"
Module_Version          SETA    454
d14 4
a17 4
Module_Date             SETS    "11 Aug 2000"
Module_ApplicationDate2 SETS    "11-Aug-00"
Module_ApplicationDate4 SETS    "11-Aug-2000"
Module_FullVersion      SETS    "4.54"
@


4.64
log
@  Minor bugfix.
Detail:
  On previous Wimps, if you chose to disassociate the Wimp's physical colour
  mapping from the Wimp palette (using SWI Wimp_SetColourMapping), then
  subsequent calls to Wimp_SetPalette would write over the physical colour
  mapping instead of the Wimp palette. *WimpPalette, conversely, had the
  correct behaviour (ie it only ever affected the Wimp palette).
Admin:
  There are actually loads of remaining bugs in the Wimp regarding the
  subtle difference between the physical colour mapping and the palette. Some
  calls try to cause a screen redraw in some circumstances, generally the
  wrong circumstances, and without all the necessary internal Wimp variables
  having been reset (so for example, you might find that window borders end
  up ibeing rendered incorrectly). It probably hasn't all worked properly
  since RISC OS 3.1...

Version 4.53. Tagged as 'Wimp-4_53'
@
text
@d11 2
a12 2
Module_MajorVersion     SETS    "4.53"
Module_Version          SETA    453
d14 4
a17 4
Module_Date             SETS    "20 Jun 2000"
Module_ApplicationDate2 SETS    "20-Jun-00"
Module_ApplicationDate4 SETS    "20-Jun-2000"
Module_FullVersion      SETS    "4.53"
@


4.63
log
@  A number of bugfixes.
Detail:
  * The character codes returned from the Key_Pressed event were incorrect
    when the caret was in a writeable icon with Kd in the validation string,
    and either (a) the caret was not at the start and Delete or Backspace were
    pressed, or (b) the caret was not at the end and Copy was pressed. (This
    was because, in these cases, the writeable icon code exited through
    passbacktouser rather than exitprocess; the former expects the keycode to
    be preserved, but the UTF-8 extensions to key handling were corrupting it.)
    Shift-Copy, Ctrl-Copy and Ctrl-U were not affected.
  * The various checkhandle routines now preserve flags again, as they did
    before 32-bit support was added. This is crucial in a number of spots,
    because the flags are based upon a test of handle, and checkhandle
    corrupts the handle register. This fixes at least two bugs: you can now
    send messages to menus or dialogue boxes again, and Wimp_RedrawWindow
    called without a Redraw_Window_Request is back (so for example, the
    Desktop Welcome screen now works again).
  * Fixed a bit of errant 26-bitism in the multiple-window iconise code.
Admin:
  Tested briefly on an Ursula build.

Version 4.52. Tagged as 'Wimp-4_52'
@
text
@d11 2
a12 2
Module_MajorVersion     SETS    "4.52"
Module_Version          SETA    452
d14 4
a17 4
Module_Date             SETS    "15 Jun 2000"
Module_ApplicationDate2 SETS    "15-Jun-00"
Module_ApplicationDate4 SETS    "15-Jun-2000"
Module_FullVersion      SETS    "4.52"
@


4.62
log
@  Bugfix: screen mode is now always correctly set when exiting the desktop.
Detail:
  When the last task closes, the Wimp tries to change to the configured screen
  mode (as determined using OS_ReadSysInfo 1). However, the Wimp was using
  VDU 22,x to set the screen mode, so results were undefined when the default
  screen mode was a pointer to a mode selector. The Wimp now uses OS_ScreenMode
  to change mode (except on RISC OS 3.1 builds where the SWI is not available).
Admin:
  Not tested.

Version 4.51. Tagged as 'Wimp-4_51'
@
text
@d9 4
a12 2
Module_MajorVersion     SETS    "4.51"
Module_Version          SETA    451
d14 4
a17 2
Module_Date             SETS    "06 Jun 2000"
Module_FullVersion      SETS    "4.51"
@


4.61
log
@  Removed conditional pull on Wimp_CloseDown task validation,
Detail:
  Wimp 4.47-4.49 would die horribly if Wimp_CloseDown was passed an
    invalid task handle in R0 (the Repeat command in BootCommands does
    this!).  The pull is now unconditional.
Admin:
  Tested in Ursula build.

Version 4.50. Tagged as 'Wimp-4_50'
@
text
@d9 2
a10 2
Module_MajorVersion     SETS    "4.50"
Module_Version          SETA    450
d12 2
a13 2
Module_Date             SETS    "15 May 2000"
Module_FullVersion      SETS    "4.50"
@


4.60
log
@  Fixed Japan.NC2 Error Box which should have indirected title bar text.

Detail:
  Title bar is not visible on the NC but it is still written to and must
  be indirected with 60 byte string.
  This fault was introduced in Wimp 4.48.

Admin:
  Should fix customer fault 075. Untested.

Version 4.49. Tagged as 'Wimp-4_49'
@
text
@d9 2
a10 2
Module_MajorVersion     SETS    "4.49"
Module_Version          SETA    449
d12 2
a13 2
Module_Date             SETS    "28 Apr 2000"
Module_FullVersion      SETS    "4.49"
@


4.59
log
@  Sprites file change
Detail:
  Removed palette from ptr_default and ptr_double srpites in
   NC2.UK resources.

Admin:
  Requires a boot structure that sets up the pointer colours
   as you want them.

Version 4.48. Tagged as 'Wimp-4_48'
@
text
@d9 2
a10 2
Module_MajorVersion     SETS    "4.48"
Module_Version          SETA    448
d12 2
a13 2
Module_Date             SETS    "27 Apr 2000"
Module_FullVersion      SETS    "4.48"
@


4.58
log
@Japanese messages for the various customers merged following discussion with James
Byrne.

Version 4.47. Not tagged
@
text
@d9 2
a10 2
Module_MajorVersion     SETS    "4.47"
Module_Version          SETA    447
d12 2
a13 2
Module_Date             SETS    "26 Apr 2000"
Module_FullVersion      SETS    "4.47"
@


4.57
log
@  Made 32-bit compatible.
Detail:
  Lots of little changes throughout a lot of source.
Admin:
  Appears to work - not stress tested with things like lots of tasks, big
  transfers, and all the other things that tend to go wrong.

Version 4.47. Tagged as 'Wimp-4_47'
@
text
@d12 1
a12 1
Module_Date             SETS    "25 Apr 2000"
@


4.56
log
@  Fixed Japan.NC2 Templates file (hopefully)
Detail:
  !WinEdit appears to have corrupted the Templates file when it was
  editted to change the Japanese translations.

  Hopefully rectified this by reapplying the translation changes using
  !FormEd.  Also changed the translation for the middle button in the
  error box back so that it reads "Cancel" (in Japanese of course).


Version 4.46. Tagged as 'Wimp-4_46'
@
text
@d9 2
a10 2
Module_MajorVersion     SETS    "4.46"
Module_Version          SETA    446
d12 2
a13 2
Module_Date             SETS    "13 Apr 2000"
Module_FullVersion      SETS    "4.46"
@


4.55
log
@  Updated Japanese translations
Detail:
  Added Japanese translations received from customer into Messages
  and Templates files


Version 4.45. Tagged as 'Wimp-4_45'
@
text
@d9 2
a10 2
Module_MajorVersion     SETS    "4.45"
Module_Version          SETA    445
d12 2
a13 2
Module_Date             SETS    "10 Apr 2000"
Module_FullVersion      SETS    "4.45"
@


4.54
log
@Moved an LTORG so that non-WIMPSymbol builds work again.

Version 4.44. Tagged as 'Wimp-4_44'
@
text
@d9 2
a10 2
Module_MajorVersion     SETS    "4.44"
Module_Version          SETA    444
d12 2
a13 2
Module_Date             SETS    "06 Apr 2000"
Module_FullVersion      SETS    "4.44"
@


4.53
log
@  System windows (eg STB command window) can now have window furniture but
  no 1-pixel borders.
Detail:
  The code that checked for a Wimp_Initialise version number of >= 380 before
  applying the new interpretation of title foreground colour &FF was broken:
  it was checking the current task handle instead of the task handle of the
  window's creator. A few other things needed tampering with in order to ensure
  that the window's task handle word is correctly set up at the time that the
  colour check is performed.
Admin:
  Tested in a desktop build, using STB resources.

Version 4.43. Tagged as 'Wimp-4_43'
@
text
@d9 2
a10 2
Module_MajorVersion     SETS    "4.43"
Module_Version          SETA    443
d12 2
a13 2
Module_Date             SETS    "30 Mar 2000"
Module_FullVersion      SETS    "4.43"
@


4.52
log
@  Various little changes.
Detail:
  * New STB Sprites, Templates and Tools files imported, based upon the
    Lazarus UI rather than the old STB UI.
  * STB build now includes WIMPSymbol.
  * No longer attempts to use WIMPSymbol font in UTF8 builds which didn't
    register the font in ResourceFS.
  * Simplified Resources directories by assigning only a single pair of
    Messages files to each locale, rather than for each UI directory within
    each locale directory. The only code change required is to make the Wimp
    error box always use the "Continue" token for NC/STB builds, rather than
    using one of "OK" and "Continue", as with desktop builds.
Admin:
  Not tested.

Version 4.42. Tagged as 'Wimp-4_42'
@
text
@d9 2
a10 2
Module_MajorVersion     SETS    "4.42"
Module_Version          SETA    442
d12 2
a13 2
Module_Date             SETS    "29 Mar 2000"
Module_FullVersion      SETS    "4.42"
@


4.51
log
@  Sprite pool changes
Detail:
  Removed Fresco sprites from sprite files.
Admin:
  Has yet to be tested in a ROM.


Version 4.41. Tagged as 'Wimp-4_41'
@
text
@d9 2
a10 2
Module_MajorVersion     SETS    "4.41"
Module_Version          SETA    441
d12 2
a13 2
Module_Date             SETS    "07 Mar 2000"
Module_FullVersion      SETS    "4.41"
@


4.50
log
@Adjusted STB build options:
* NoCommandPrompt is disabled, so we'll get "Press SPACE or click mouse to
  continue" back again on exit from command windows
* UseAMBControl and StrongARM flags are no longer conditional, since the
  new STB kernel is guaranteed to support them

Version 4.40. Tagged as 'Wimp-4_40'
@
text
@d9 2
a10 2
Module_MajorVersion     SETS    "4.40"
Module_Version          SETA    440
d12 2
a13 2
Module_Date             SETS    "16 Feb 2000"
Module_FullVersion      SETS    "4.40"
@


4.49
log
@90K of sprites removed from STB.

Version 4.39. Tagged as 'Wimp-4_39'
@
text
@d9 2
a10 2
Module_MajorVersion     SETS    "4.39"
Module_Version          SETA    439
d12 2
a13 2
Module_Date             SETS    "04 Feb 2000"
Module_FullVersion      SETS    "4.39"
@


4.48
log
@  Removed unnecessary sprites
Detail:
  Removed onscreen keyboard sprites from a number of builds, these
  sprites are now held in NCKeyboard's resources.


Version 4.38. Tagged as 'Wimp-4_38'
@
text
@d9 2
a10 2
Module_MajorVersion     SETS    "4.38"
Module_Version          SETA    438
d12 2
a13 2
Module_Date             SETS    "02 Feb 2000"
Module_FullVersion      SETS    "4.38"
@


4.47
log
@STB resources and options duplicated from old STB.

Version 4.37. Tagged as 'Wimp-4_37'
@
text
@d9 2
a10 2
Module_MajorVersion     SETS    "4.37"
Module_Version          SETA    437
d12 2
a13 2
Module_Date             SETS    "07 Jan 2000"
Module_FullVersion      SETS    "4.37"
@


4.46
log
@
  * Lazarus UI change.  (Fault fix for ID 1140.)

Detail:

  * The top of the toolbar had a single pixel light-grey line along the
    edge.  This caused unpleasant twittering on TV displays.  Although
    the twittering is always going to be a problem, due to the boundary
    between the toolbar and the browser window, this small change to
    remove the light-grey line improves the situation.  A thick dark-grey
    line is now used instead which significantly reduces the effect of
    the twitter.

    (This change applied to NCFrescoRO also; I doubt whether the WIMP
    sprite pool version is actually used but I've changed this anyway
    just in case!)

Admin:

  * Tested as a softload on Lazarus hardware.

Version 4.36. Tagged as 'Wimp-4_36'
@
text
@d4 10
a13 10
			GBLS	Module_MajorVersion
			GBLA    Module_Version
			GBLS	Module_MinorVersion
			GBLS	Module_Date
			GBLS	Module_FullVersion
Module_MajorVersion	SETS    "4.36"
Module_Version          SETA    436
Module_MinorVersion	SETS	""
Module_Date		SETS    "24 Nov 1999"
Module_FullVersion      SETS    "4.36"
@


4.46.2.1
log
@
  * Sprite changes for Bethany, based upon the Lazarus original.

Detail:

  * Sprite "gright" exchanged for a new version that complements the
    Bethany user-interface.

  * Sprites "ot_country" and "ot_country2" added to support the Language
    options screens available in Bethany.

    (Note that the log message for LazarusUI 0.59.1.60.2.1 was incorrect
    in that the sprites live within the WIMP sprite file and NOT within
    NCFresco.)

Admin:

  * Tested within a softloaded NCFresco (Lazarus variant) on an RPC with
    the Bethany user-interface resources.

Version 4.36, 4.46.2.1. Tagged as 'Wimp-4_36-4_46_2_1'
@
text
@d4 6
a9 8
                        GBLS    Module_MajorVersion
                        GBLA    Module_Version
                        GBLS    Module_MinorVersion
                        GBLS    Module_Date
                        GBLS    Module_FullVersion
                        GBLS    Module_ApplicationDate2
                        GBLS    Module_ApplicationDate4
Module_MajorVersion     SETS    "4.36"
d11 3
a13 5
Module_MinorVersion     SETS    "4.46.2.1"
Module_Date             SETS    "15 Jun 2000"
Module_ApplicationDate2 SETS    "15-Jun-00"
Module_ApplicationDate4 SETS    "15-Jun-2000"
Module_FullVersion      SETS    "4.36 (4.46.2.1)"
@


4.46.2.2
log
@
  * Translations for Bethany project incorporated.

Detail:

  * Translated resources added for the following locales:

      France, Germany, Italy, Spain, Turkey

    Files changed include the Messages, Template and Sprite files, all
    of which now contain appropriate translated versions.

Admin:

  * Tested in Bethany multi-locale builds.

  * Sprite file contains an equivalent set of sprites to those in the
    UK variant; no rationalisation has been applied to remove duplicates
    contained in the NCFrescoRO resources (jberanek_NCFrescoRO-2_67_Lazarus
    branch version).

Version 4.36, 4.46.2.2. Tagged as 'Wimp-4_36-4_46_2_2'
@
text
@d13 5
a17 5
Module_MinorVersion     SETS    "4.46.2.2"
Module_Date             SETS    "11 Aug 2000"
Module_ApplicationDate2 SETS    "11-Aug-00"
Module_ApplicationDate4 SETS    "11-Aug-2000"
Module_FullVersion      SETS    "4.36 (4.46.2.2)"
@


4.46.2.3
log
@
  * Fixed corrupted sprite ("splash_opts") in the German resources.

Admin:

  * Untested.  Fault noted in the Bethany project.

Version 4.36, 4.46.2.3. Tagged as 'Wimp-4_36-4_46_2_3'
@
text
@d13 5
a17 5
Module_MinorVersion     SETS    "4.46.2.3"
Module_Date             SETS    "08 Sep 2000"
Module_ApplicationDate2 SETS    "08-Sep-00"
Module_ApplicationDate4 SETS    "08-Sep-2000"
Module_FullVersion      SETS    "4.36 (4.46.2.3)"
@


4.46.2.4
log
@
  * Pointer sprites changed to use mouse palette.

Detail:

  * The green pointer returned on the French Bethany user interface.
    This was because the old versions had been used, rather than those
    that utilise the WIMP mouse palette.  Now fixed.

    (Remember: if you want to change the colour of the pointer, then use
    the mouse palette and change the palette entries in the file loaded
    during the boot sequence!)

Admin:

  * Untested.  Sprites replaced by those from the UK interface.

Version 4.36, 4.46.2.4. Tagged as 'Wimp-4_36-4_46_2_4'
@
text
@d13 5
a17 5
Module_MinorVersion     SETS    "4.46.2.4"
Module_Date             SETS    "25 Sep 2000"
Module_ApplicationDate2 SETS    "25-Sep-00"
Module_ApplicationDate4 SETS    "25-Sep-2000"
Module_FullVersion      SETS    "4.36 (4.46.2.4)"
@


4.46.2.5
log
@
  * Import of new resources, following verification by Alpnet (the
    translators).

Detail:

  * Minor corrections applied to the German, Spanish and Turkish
    sprites.  Affects the Lazarus resources only.

Admin:

  * Untested.

  * Same changes applied to the TRUNK version (Wimp-4_56).

Version 4.36, 4.46.2.5. Tagged as 'Wimp-4_36-4_46_2_5'
@
text
@a10 1
                        GBLS    Module_HelpVersion
d13 5
a17 6
Module_MinorVersion     SETS    "4.46.2.5"
Module_Date             SETS    "19 Oct 2000"
Module_ApplicationDate2 SETS    "19-Oct-00"
Module_ApplicationDate4 SETS    "19-Oct-2000"
Module_FullVersion      SETS    "4.36 (4.46.2.5)"
Module_HelpVersion      SETS    "4.36 (19 Oct 2000) 4.46.2.5"
@


4.46.2.6
log
@
  * Fix to Turkish graphical resources.

Detail:

  * The "Call Waiting" banner was incorrect (on the options pages).
    Another extraneous dotted-"i" was found where one shouldn't have been!

Admin:

  * Untested.  Graphic verified against the Alpnet translations.

Version 4.36, 4.46.2.6. Tagged as 'Wimp-4_36-4_46_2_6'
@
text
@d14 6
a19 6
Module_MinorVersion     SETS    "4.46.2.6"
Module_Date             SETS    "25 Oct 2000"
Module_ApplicationDate2 SETS    "25-Oct-00"
Module_ApplicationDate4 SETS    "25-Oct-2000"
Module_FullVersion      SETS    "4.36 (4.46.2.6)"
Module_HelpVersion      SETS    "4.36 (25 Oct 2000) 4.46.2.6"
@


4.45
log
@  Rendering problems with Lazarus title bars and error box buttons fixed.

Detail:
  Title bars: one of the Ursula redraw optimisations was that if the title
  bar sprites had no mask, then the title bar is no longer filled in before the
  sprites are plotted. Lazarus' toolsprites were falling foul of this, because
  the title bar top and bottom sprites (tbarmidt/tbarmidb) had a lesser height
  than the end sprites (tbarlcap/tbarrcap). Because pre-Ursula Wimps filled
  in the title bar regardless, this may not have shown up in the past. The Wimp
  now has an additional check: if there is a gap between the title bar sprites,
  then it always fills in the title bar background before plotting the sprites.

  Error box buttons: the "illuminated" side of the 3D plinths have always been
  white, so they were getting lost against the white Lazarus UI background.
  Used Ursula Wimp icon colour validation string extension to colour the
  borders a uniform grey.

Admin:
  Tested on a desktop machine, soft-loading the Lazarus Wimp resources.
  Fixes faults 1115 and 1121.

Version 4.35. Tagged as 'Wimp-4_35'
@
text
@d9 2
a10 2
Module_MajorVersion	SETS    "4.35"
Module_Version          SETA    435
d12 2
a13 2
Module_Date		SETS    "22 Nov 1999"
Module_FullVersion      SETS    "4.35"
@


4.44
log
@  Updates to Ursula resources.
Detail:
  * Added missing Resources/UK/Ursula/CmdHelp file.
  * Added missing Resources/UK/Ursula/Messages file.
Admin:
  * Tested on build 'Ursula'.

Version 4.34. Tagged as 'Wimp-4_34'
@
text
@d9 2
a10 2
Module_MajorVersion	SETS    "4.34"
Module_Version          SETA    434
d12 2
a13 2
Module_Date		SETS    "09 Nov 1999"
Module_FullVersion      SETS    "4.34"
@


4.43
log
@
  * An addition to the Lazarus sprites.

Detail:

  * Added the toolbar level indicator sprites; they were accidentally
    missed out of the previous set of sprites.

Admin:

  * Untested, but the new sprites should appear in the right location on
    the browser toolbars.

Version 4.33. Not tagged
@
text
@d9 2
a10 2
Module_MajorVersion	SETS    "4.33"
Module_Version          SETA    433
d12 2
a13 2
Module_Date		SETS    "04 Nov 1999"
Module_FullVersion      SETS    "4.33"
@


4.42
log
@
  * Updated Lazarus sprite pool.

Detail:

  * New WIMP sprites for the updated Lazarus user-interface.

Admin:

  * Tested on new LazarusUI and NCFresco as a softload on Lazarus hardware.

Version 4.33. Tagged as 'Wimp-4_33'
@
text
@d12 1
a12 1
Module_Date		SETS    "03 Nov 1999"
@


4.41
log
@Switched Euro option on for all builds, at Kevin's request.

(This stops system font character 128 being reprogrammed to a tick, and also
stops the desktop font being switched to WimpSymbol when character 128 is
encountered.)

Version 4.32. Tagged as 'Wimp-4_32'
@
text
@d9 2
a10 2
Module_MajorVersion	SETS    "4.32"
Module_Version          SETA    432
d12 2
a13 2
Module_Date		SETS    "07 Oct 1999"
Module_FullVersion      SETS    "4.32"
@


4.40
log
@
  Lazarus resource changes.

Detail:

  Changes made to Lazarus resources only in progressing towards the
  final UI for the IAC.  Affected files are:

    * Sprites: reduced-palette sprites used where possible to minimize
      memory usage.

    * Templates: the foreground colour of icon #0 in the error dialogue
      box has been altered to be colour 0 (black) in line with the
      other template changes made in previous versions.  (This icon
      was accidentally missed.)

Admin:

  Minor changes, but untested.

Version 4.31. Tagged as 'Wimp-4_31'
@
text
@d9 2
a10 2
Module_MajorVersion	SETS    "4.31"
Module_Version          SETA    431
d12 2
a13 2
Module_Date		SETS    "28 Sep 1999"
Module_FullVersion      SETS    "4.31"
@


4.39
log
@A further change to the resources for the Lazarus project:

  * Changed the foreground text colour to black in the "Error"
    window of the template file.

Version 4.30. Tagged as 'Wimp-4_30'
@
text
@d9 2
a10 2
Module_MajorVersion	SETS    "4.30"
Module_Version          SETA    430
d12 2
a13 2
Module_Date		SETS    "23 Sep 1999"
Module_FullVersion      SETS    "4.30"
@


4.38
log
@Further resource changes for the Lazarus project:

  * Added transparancy to the radio buttons.

  * Included the online indicator sprites.

Version 4.29. Tagged as 'Wimp-4_29'
@
text
@d9 2
a10 2
Module_MajorVersion	SETS    "4.29"
Module_Version          SETA    429
d12 2
a13 2
Module_Date		SETS    "10 Sep 1999"
Module_FullVersion      SETS    "4.29"
@


4.37
log
@Modified Lazarus template file:

  * Made background of error dialogue box white to match the UI.

  * Changed the WIMP backwindow colour to black; this stops the
    grey flash as the desktop starts up on booting.

Version 4.28. Not tagged
@
text
@d9 2
a10 2
Module_MajorVersion	SETS    "4.28"
Module_Version          SETA    428
d12 2
a13 2
Module_Date		SETS    "08 Sep 1999"
Module_FullVersion      SETS    "4.28"
@


4.36
log
@Initial import of new Lazarus UI resources.

Version 4.28. Tagged as 'Wimp-4_28'
@
text
@d12 1
a12 1
Module_Date		SETS    "07 Sep 1999"
@


4.35
log
@On-screen keyboard sprites removed from Lazarus sprite pool.

Version 4.27. Tagged as 'Wimp-4_27'
@
text
@d9 2
a10 2
Module_MajorVersion	SETS    "4.27"
Module_Version          SETA    427
d12 2
a13 2
Module_Date		SETS    "18 Aug 1999"
Module_FullVersion      SETS    "4.27"
@


4.34
log
@Lazarus Sprites file:
  * Added Timeouts sprites for NCOptions startup page.
  * Removed sprites for Favourites and Telephone Dialling that were spelt
    American-style and replaced with UK variants.

Version 4.26. Tagged as 'Wimp-4_26'
@
text
@d9 2
a10 2
Module_MajorVersion	SETS    "4.26"
Module_Version          SETA    426
d12 2
a13 2
Module_Date		SETS    "05 Aug 1999"
Module_FullVersion      SETS    "4.26"
@


4.33
log
@Updated Sprites for Lazarus build.  Added sprites for 'WWW' and 'Options'
as used on Connect.html in NCMAlite.

Version 4.25. Tagged as 'Wimp-4_25'
@
text
@d9 2
a10 2
Module_MajorVersion	SETS    "4.25"
Module_Version          SETA    425
d13 1
a13 1
Module_FullVersion      SETS    "4.25"
@


4.32
log
@Doing all of recalcmodevars on Service_ModeChanging turns out to be a Bad Idea
because some of the Wimp's copies of VDU variables end up out-of-date. Now
only the parts pertaining to command windows are done on Service_ModeChanging
(for that was the bit we were having trouble with), and the rest is back on
Service_ModeChange.

Version 4.24. Tagged as 'Wimp-4_24'
@
text
@d9 2
a10 2
Module_MajorVersion	SETS    "4.24"
Module_Version          SETA    424
d12 2
a13 2
Module_Date		SETS    "04 Aug 1999"
Module_FullVersion      SETS    "4.24"
@


4.31
log
@Now calls recalcmodevars on Service_ModeChanging instead of Service_ModeChange
(this was clashing with the Interlace module at one point during STB
development, and had the potential to trip us up again in the future).

No longer produces build errors if some resources are absent.

Corrected token in Japan messages file to use valid UTF-8 character.

Service call table now included by default.

Version 4.23. Tagged as 'Wimp-4_23'
@
text
@d9 2
a10 2
Module_MajorVersion	SETS    "4.23"
Module_Version          SETA    423
d12 2
a13 2
Module_Date		SETS    "03 Aug 1999"
Module_FullVersion      SETS    "4.23"
@


4.30
log
@Imported new user interface changes for special customer build.

Version 4.22. Tagged as 'Wimp-4_22'
@
text
@d9 2
a10 2
Module_MajorVersion	SETS    "4.22"
Module_Version          SETA    422
d12 2
a13 2
Module_Date		SETS    "26 Jul 1999"
Module_FullVersion      SETS    "4.22"
@


4.29
log
@Initial import of Lazarus resources.  Based on Resources/UK/NC2 with
sprites file changed appropriately.

Version 4.21. Tagged as 'Wimp-4_21'
@
text
@d9 2
a10 2
Module_MajorVersion	SETS    "4.21"
Module_Version          SETA    421
d13 1
a13 1
Module_FullVersion      SETS    "4.21"
@


4.28
log
@Added new "Timeout" sprites to the Japan Wimp sprite pool.  Note that
these are named "TimeoutG" (for generic timeout) because they do not
include modem- or Ethernet-build specific sub-text; this also allows
the modem variant to remain unaltered because this uses the original
sprites.

Version number NOT incremented.

Version 4.20. Not tagged
@
text
@d9 2
a10 2
Module_MajorVersion	SETS    "4.20"
Module_Version          SETA    420
d12 2
a13 2
Module_Date		SETS    "23 Jun 1999"
Module_FullVersion      SETS    "4.20"
@


4.27
log
@Renamed ptr sprites and set backwindow colour to black in Japan.

Version 4.20. Not tagged
@
text
@d12 1
a12 1
Module_Date		SETS    "26 May 1999"
@


4.26
log
@Updated Japan sprites to workaround ColourTrans funny.

Version 4.20. Not tagged
@
text
@d12 1
a12 1
Module_Date		SETS    "12 May 1999"
@


4.25
log
@TrueIcon2 and TrueIcon3 turned on by default.

Version 4.20. Tagged as 'Wimp-4_20'
@
text
@d12 1
a12 1
Module_Date		SETS    "29 Apr 1999"
@


4.24
log
@Increased size of indirected data buffer for error template from 256 to 1024.

Version 4.19. Tagged as 'Wimp-4_19'
@
text
@d9 2
a10 2
Module_MajorVersion	SETS    "4.19"
Module_Version          SETA    419
d13 1
a13 1
Module_FullVersion      SETS    "4.19"
@


4.23
log
@Japan resources added.

Version 4.18. Tagged as 'Wimp-4_18'
@
text
@d9 2
a10 2
Module_MajorVersion	SETS    "4.18"
Module_Version          SETA    418
d12 2
a13 2
Module_Date		SETS    "28 Apr 1999"
Module_FullVersion      SETS    "4.18"
@


4.22
log
@Removed the code that restores the original pointer shape when
leaving an error box (NCErrorBox conditional in Wimp07:finisherror).
This option is no longer necessary now that the Wimp_Extend support
ensures that the pointer appears and disappears as the user expects.

Version 4.17. Tagged as 'Wimp-4_17'
@
text
@d8 3
a10 2
Module_MajorVersion	SETS    "4.17"
Module_Version          SETA    417
d12 3
a14 2
Module_Date		SETS    "25 Mar 1999"
		        END
@


4.21
log
@Changes to STB options file:
* removed obsolete PreservePointerOnError option
* turned off development option CnP

Version 4.16. Tagged as 'Wimp-4_16'
@
text
@d8 2
a9 2
Module_MajorVersion	SETS    "4.16"
Module_Version          SETA    416
d11 1
a11 1
Module_Date		SETS    "17 Mar 1999"
@


4.20
log
@Turned on TrueIcon2 and TrueIcon3 options for STB.

Version 4.15. Tagged as 'Wimp-4_15'
@
text
@d8 2
a9 2
Module_MajorVersion	SETS    "4.15"
Module_Version          SETA    415
d11 1
a11 1
Module_Date		SETS    "25 Feb 1999"
@


4.19
log
@Changed background to black on STB.

Version 4.14. Not tagged
@
text
@d8 2
a9 2
Module_MajorVersion	SETS    "4.14"
Module_Version          SETA    414
d11 1
a11 1
Module_Date		SETS    "08 Feb 1999"
@


4.18
log
@Added STB build option

Version 4.14. Not tagged
@
text
@d11 1
a11 1
Module_Date		SETS    "11 Jan 1999"
@


4.17
log
@Changed Japanese NC resources so OK/Continue buttons contain "OK" in
full-width characters.

Version 4.14. Tagged as 'Wimp-4_14'
@
text
@d11 1
a11 1
Module_Date		SETS    "07 Jan 1999"
@


4.16
log
@Bugfix: if a >=256-colour sprite icon is plotted, and then a shaded and/or
selected text-plus-sprite icon is plotted, where the sprite in the latter icon
is unspecified (no validation string, or no 'S' command), then a SpriteOp call
from within ColourTrans data aborts. This caused aborts when certain rectangles
of the ImageFS options window were redrawn.

Version 4.13. Not tagged
@
text
@d8 2
a9 2
Module_MajorVersion	SETS    "4.13"
Module_Version          SETA    413
d11 1
a11 1
Module_Date		SETS    "09 Dec 1998"
@


4.15
log
@Another bugfix to and a new feature of NC error box code:
* If pointer was hidden-until-next-mouse-move, the act of confining the mouse
  to the error box window no longer causes it to be redisplayed.
* In error boxes, the pointer and the IconHigh highlight are now initially
  positioned over the rightmost (default) button. There is one exception to
  this rule: when "Next task" is clicked in a Watchdog window, the pointer
  stays over the "Next task" button.

Version 4.13. Tagged as 'Wimp-4_13'
@
text
@d11 1
a11 1
Module_Date		SETS    "27 Nov 1998"
@


4.14
log
@* Disabled checking of both mouse button transitions in error boxes in NC
  builds: now behaves like desktop builds (only detects button-down events).
* When mouse pointer is hidden following Wimp_Extend 12, changes of mouse
  button state will no longer cause the pointer to be reinstated.

Version 4.12. Tagged as 'Wimp-4_12'
@
text
@d8 2
a9 2
Module_MajorVersion	SETS    "4.12"
Module_Version          SETA    412
d11 1
a11 1
Module_Date		SETS    "26 Nov 1998"
@


4.13
log
@Optimisation to new WimpSymbol substitution code: in icons containing fonts
  other than the desktop font, the substitution table is only calculated
  when a symbol character is encountered.
Embryonic cut-n-paste support introduced (currently in desktop builds only):
  * workspace is allocated and initialised;
  * extended Wimp_GetCaretPosition implemented;
  * pushfontstring adapted to allow insertion of arbitrary control sequences in
    font strings (to allow selected text to be plotted in inverted colours).
Inverted, unfilled text icons now work properly again in <256-colour modes.
Reworked NC error box code: see Doc.IconHigh.

Version 4.11. Tagged as 'Wimp-4_11'
@
text
@d8 2
a9 2
Module_MajorVersion	SETS    "4.11"
Module_Version          SETA    411
d11 1
a11 1
Module_Date		SETS    "09 Nov 1998"
@


4.12
log
@
my_StringBBox rewritten - effects are:
* Deprecated Font SWIs no longer used
* Height of UTF-8 strings now calculated correctly
* Fancy fonts in icons are now aligned the same as outline desktop-font icons
* Text rubout boxes for icons with text above the sprite are correctly sized

Lazy WimpSymbol subsitution implemented: characters are only substituted if
they are not already present in the font. For the first time, substitution
now works in UTF-8 text - but for the proper Unicode positions of the
relevant symbols, instead of usurping undefined positions (as in other
alphabets).

Version 4.10. Tagged as 'Wimp-4_10'
@
text
@d8 2
a9 2
Module_MajorVersion	SETS    "4.10"
Module_Version          SETA    410
d11 1
a11 1
Module_Date		SETS    "29 Oct 1998"
@


4.11
log
@Adapted assembly process so that the choice of Options file (previously based
purely on the "System" variable) can be overridden by passing "OPTIONS=foo" as
an argument to either MkRom, or to amu/amu_machine directly, or indirectly,
by specifying it in the components file for a build. To accomplish this, it
was necessary to switch from using aasm to objasm - hence the large number of
source files affected in this commit.

Version 4.09. Tagged as 'Wimp-4_09'
@
text
@d8 2
a9 2
Module_MajorVersion	SETS    "4.09"
Module_Version          SETA    409
d11 1
a11 1
Module_Date		SETS    "23 Oct 1998"
@


4.10
log
@Bugfix: the opening-windows list could get corrupted if int_flush_opens was
called while a command window was active - but only if autoscrolling of windows
was compiled in. In practice, this meant that OmniClient often hung desktop
machines.

Version 4.08. Tagged as 'Wimp-4_08'
@
text
@d8 2
a9 2
Module_MajorVersion	SETS    "4.08"
Module_Version          SETA    408
d11 1
a11 1
Module_Date		SETS    "22 Oct 1998"
@


4.9
log
@Service_SwitchingOutputToSprite code optimised: graphics parameters are now
only cached when making the first Wimp_PlotIcon call while output is switched
to a sprite, and upon return to screen output after such an occurrence.

All error box templates featuring "border" icons updated to have button type
0 (never). This prevents IconHigh from mistakenly allowing them to be selected.

Version 4.07. Tagged as 'Wimp-4_07'
@
text
@d8 2
a9 2
Module_MajorVersion	SETS    "4.07"
Module_Version          SETA    407
d11 1
a11 1
Module_Date		SETS    "21 Oct 1998"
@


4.8
log
@UTF-8 support from previous version switched in; additional alphabet-
conditional support added as follows:
* Correctly converts character index returned from Font_FindCaret into byte
  index into raw string.
* Left-arrow, right-arrow, delete-left and delete-right now act as far as
  the next character boundary, instead of to the next byte.
* Menu item text justification works again (it relies on overwriting spaces
  with hard space characters, which are two-byte characters in UTF-8).
* General key handling code has been rewritten. The Wimp now has three
  internal key input buffers - one each for taking keyboard-generated,
  task-generated, and function-key-generated strings. Each input buffer is
  processed in chunks of one character, rather than one byte; malformed
  UTF-8 characters are rejected, so tasks don't have to worry about them
  (simplifying their character-handling code). There is also a key output
  buffer, to ensure that (UTF-8) sequences of Key_Pressed events are not
  broken up.
* As a result of the above, multiple calls to Wimp_ProcessKey are now
  possible between calls to Wimp_Poll. Previously, this resulted in bytes
  getting jumbled up - making it useless for input of UTF-8 characters.
* Multi-byte characters are inserted into writeable icons in one go, so you
  don't see a brief flicker of the "malformed character" symbol while the
  initial bytes are being inserted.
* Multi-byte characters that don't entirely fit in a writeable icon buffer
  are not inserted at all.
* A new validation string command ("U") can limit the contents of a
  writeable by number of characters, instead of bytes. This will hide the
  character sizes from the user interface.
* Allowable characters (validation string command "A") now works on Unicode
  characters and character ranges.
* Various other minor bugs are fixed (Wimp_ProcessKey 13 can activate a
  writeable menu item, Shift-arrow keys are always consistent in firing off
  Key_Pressed events, etc.)
* Password icons supported: one symbol is displayed for each character
  (instead of for each byte); the display character (validation string
  command "D") can be any UTF-8 character; correctly displays the caret
  after set-caret-by-index calls, even though characters in the processed
  string are different width to those in the raw string, in password icons.

Other changes:
* The border around NC-style error boxes is resized when the error window
  is grown or shrunk.
* Messages, CmdHelp and Template files made consistent across resource
  directories, including support for all Ursula features.
* ShrinkableAreas turned back on in System=RCA builds.
* User interface features of desktop OS builds standardised.

Version 4.06. Tagged as 'Wimp-4_06'
@
text
@d8 2
a9 2
Module_MajorVersion	SETS    "4.06"
Module_Version          SETA    406
d11 1
a11 1
Module_Date		SETS    "20 Oct 1998"
@


4.7
log
@Completed the NC2 generic window furniture: added the missing
sprites to the NC2 Tools spritefile.

Version 4.05. Tagged as 'Wimp-4_05'
@
text
@d8 2
a9 2
Module_MajorVersion	SETS    "4.05"
Module_Version          SETA    405
d11 1
a11 1
Module_Date		SETS    "12 Oct 1998"
@


4.6
log
@Several more messages translated into Japanese.
Following resources updated for Ursula changes: Germany/Ursula, Japan/NC2,
UK/NC2. Others will probably still need doing.

Version 4.04. Tagged as 'Wimp-4_04'
@
text
@d8 2
a9 2
Module_MajorVersion	SETS    "4.04"
Module_Version          SETA    404
@


4.5
log
@Added resources for Denmark, Finland, Norway and Sweden, to support
the NC2 Scandinavian user-interfaces.

Version 4.03. Tagged as 'Wimp-4_03'
@
text
@d8 2
a9 2
Module_MajorVersion	SETS    "4.03"
Module_Version          SETA    403
d11 1
a11 1
Module_Date		SETS    "09 Oct 1998"
@


4.4
log
@Modify behaviour of pointer on Wimp errors for NCs.

Version 4.02. Tagged as 'Wimp-4_02'
@
text
@d8 2
a9 2
Module_MajorVersion	SETS    "4.02"
Module_Version          SETA    402
d11 1
a11 1
Module_Date		SETS    "07 Oct 1998"
@


4.3
log
@Propogated Ursula message file changes to all the various copies.

Version 4.01. Not tagged
@
text
@d8 2
a9 2
Module_MajorVersion	SETS    "4.01"
Module_Version          SETA    401
d11 1
a11 1
Module_Date		SETS    "01 Oct 1998"
@


4.2
log
@Spinner branch merged.
Changed to use srccommit.
All conditionals on "Version" removed.

Version 4.01. Tagged as 'Wimp-4_01'
@
text
@d11 1
a11 1
Module_Date		SETS    "30 Sep 1998"
@


4.1
log
@created by srccommit.
@
text
@d8 2
a9 2
Module_MajorVersion	SETS    "4.00"
Module_Version          SETA    400
@
