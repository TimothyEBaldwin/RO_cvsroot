head	4.7;
access;
symbols
	RO_5_07:4.7
	mstphens_UrsulaRiscPCBuild_20Nov98:4.5.2.27
	Ursula_RiscPC:4.5.2.27.0.2
	Ursula_merge:4.5.2.28
	nicke_Wimp_3_96M:4.1.7.12
	bavison_Wimp-4_00_TRUNK:4.6
	bavison_Wimp-4_00:4.5.2.28
	nicke_Wimp_3_96:4.1.7.11
	mjrobert_Wimp_3_98:4.5.2.8
	rthornb_UrsulaBuild-19Aug1998:4.5.2.27
	UrsulaBuild_FinalSoftload:4.5.2.27
	bavison_Wimp-3_99t:4.5.2.27
	rthornb_UrsulaBuild-12Aug1998:4.5.2.26
	bavison_Wimp-3_99s:4.5.2.26
	aglover_UrsulaBuild-05Aug1998:4.5.2.25
	bavison_Wimp-3_99r:4.5.2.25
	rthornb_UrsulaBuild-29Jul1998:4.5.2.24
	bavison_Wimp-3_99q:4.5.2.24
	jfarrell_NCWimp_3_96:4.1.7.11
	rthornb_UrsulaBuild-22Jul1998:4.5.2.23
	bavison_Wimp-3_99p:4.5.2.23
	rthornb_UrsulaBuild-15Jul1998:4.5.2.22
	bavison_Wimp-3_99o:4.5.2.22
	bavison_Wimp-3_99n:4.5.2.21
	rthornb_UrsulaBuild-07Jul1998:4.5.2.20
	bavison_Wimp-3_99m:4.5.2.20
	rthornb_UrsulaBuild-17Jun1998:4.5.2.19
	rthornb_UrsulaBuild-03Jun1998:4.5.2.19
	bavison_Wimp-3_99l:4.5.2.19
	rthornb_UrsulaBuild-27May1998:4.5.2.18
	rthornb_UrsulaBuild-21May1998:4.5.2.17
	bavison_Wimp-3_99k:4.5.2.18
	bavison_Wimp-3_99j:4.5.2.17
	bavison_Wimp-3_99i:4.5.2.16
	bavison_Wimp-3_99h:4.5.2.16
	rthornb_UrsulaBuild_01May1998:4.5.2.15
	bavison_Wimp_399g:4.5.2.15
	bavison_Wimp_399f:4.5.2.14
	afrost_NC2_Generic:4.1.7.9
	bavison_Wimp_399e:4.5.2.13
	bavison_Wimp_399d:4.5.2.12
	bavison_Wimp_399c:4.5.2.11
	Wimp_3_98:4.5.2.8
	kbracey_AW97:4.5.2.5
	Spinner_B20_2:4.1.7.7
	Spinner_19_3:4.1.7.6
	Spinner_B18:4.1.7.5
	Spinner_B17:4.1.7.5
	Spinner_B15:4.1.7.5
	Spinner_B14:4.1.7.5
	Spinner_B13:4.1.7.5
	Spinner_B12:4.1.7.4
	Spinner_B10:4.1.7.4
	Daytona:4.5.0.4
	Daytona_bp:4.5
	Ursula:4.5.0.2
	Ursula_bp:4.5
	Wimp_3_91:4.5
	Spin_merge_7May97:4.1.7.1
	ARTtmp_bp:4.1.7.2
	Spinner_B7:4.1.7.4
	RO_3_71:4.1.3.2
	ARTtmp_merge:4.1.7.2.2.3
	Spin_3Apr97:4.1.7.3
	ARTtmp:4.1.7.2.0.2
	RCA:4.3.0.2
	Spin_merge:4.1.7.13
	MergeFiles:4.1.3.1
	RO_3_70:4.1.3.1
	NC_1_06:4.1.7.1
	Spinner:4.1.7
	Spin_xx:4.1.5
	NC_xx:4.1.5.1
	RO_3_60:4.1.1.1
	StrongARM:4.1.3
	Black:4.1.1;
locks; strict;
comment	@# @;


4.7
date	98.09.30.09.05.17;	author kbracey;	state dead;
branches;
next	4.6;

4.6
date	98.09.18.16.13.09;	author bavison;	state Exp;
branches;
next	4.5;

4.5
date	97.05.07.17.01.14;	author kbracey;	state Exp;
branches
	4.5.2.1;
next	4.4;

4.4
date	97.05.07.14.14.39;	author kbracey;	state Exp;
branches;
next	4.3;

4.3
date	97.03.27.11.05.29;	author rbuckley;	state Exp;
branches;
next	4.2;

4.2
date	97.01.13.13.23.06;	author nturton;	state Exp;
branches;
next	4.1;

4.1
date	96.11.05.09.30.22;	author nturton;	state Exp;
branches
	4.1.1.1
	4.1.3.1
	4.1.5.1
	4.1.7.1;
next	;

4.5.2.1
date	97.05.16.13.43.33;	author kbracey;	state Exp;
branches;
next	4.5.2.2;

4.5.2.2
date	97.06.11.15.14.18;	author rleggett;	state Exp;
branches;
next	4.5.2.3;

4.5.2.3
date	97.07.07.11.24.17;	author bavison;	state Exp;
branches;
next	4.5.2.4;

4.5.2.4
date	97.10.15.11.46.49;	author kbracey;	state Exp;
branches;
next	4.5.2.5;

4.5.2.5
date	97.10.16.14.00.57;	author kbracey;	state Exp;
branches;
next	4.5.2.6;

4.5.2.6
date	97.10.21.14.00.55;	author mstphens;	state Exp;
branches;
next	4.5.2.7;

4.5.2.7
date	97.10.28.11.08.41;	author kbracey;	state Exp;
branches;
next	4.5.2.8;

4.5.2.8
date	98.02.02.16.27.04;	author kbracey;	state Exp;
branches;
next	4.5.2.9;

4.5.2.9
date	98.03.10.16.10.53;	author bavison;	state Exp;
branches;
next	4.5.2.10;

4.5.2.10
date	98.03.26.19.31.16;	author bavison;	state Exp;
branches;
next	4.5.2.11;

4.5.2.11
date	98.04.03.19.38.19;	author bavison;	state Exp;
branches;
next	4.5.2.12;

4.5.2.12
date	98.04.07.17.53.29;	author bavison;	state Exp;
branches;
next	4.5.2.13;

4.5.2.13
date	98.04.17.16.53.51;	author bavison;	state Exp;
branches;
next	4.5.2.14;

4.5.2.14
date	98.04.21.16.58.58;	author bavison;	state Exp;
branches;
next	4.5.2.15;

4.5.2.15
date	98.04.27.15.18.20;	author bavison;	state Exp;
branches;
next	4.5.2.16;

4.5.2.16
date	98.05.08.11.49.05;	author bavison;	state Exp;
branches;
next	4.5.2.17;

4.5.2.17
date	98.05.18.15.50.56;	author bavison;	state Exp;
branches;
next	4.5.2.18;

4.5.2.18
date	98.05.25.18.12.37;	author bavison;	state Exp;
branches;
next	4.5.2.19;

4.5.2.19
date	98.05.29.13.47.46;	author bavison;	state Exp;
branches;
next	4.5.2.20;

4.5.2.20
date	98.07.03.17.59.29;	author bavison;	state Exp;
branches;
next	4.5.2.21;

4.5.2.21
date	98.07.13.14.10.28;	author bavison;	state Exp;
branches;
next	4.5.2.22;

4.5.2.22
date	98.07.14.16.33.27;	author bavison;	state Exp;
branches;
next	4.5.2.23;

4.5.2.23
date	98.07.21.16.14.20;	author bavison;	state Exp;
branches;
next	4.5.2.24;

4.5.2.24
date	98.07.28.17.10.34;	author bavison;	state Exp;
branches;
next	4.5.2.25;

4.5.2.25
date	98.08.05.09.09.20;	author bavison;	state Exp;
branches;
next	4.5.2.26;

4.5.2.26
date	98.08.11.15.32.43;	author bavison;	state Exp;
branches;
next	4.5.2.27;

4.5.2.27
date	98.08.18.21.13.55;	author bavison;	state Exp;
branches;
next	4.5.2.28;

4.5.2.28
date	98.09.18.14.14.06;	author bavison;	state Exp;
branches;
next	;

4.1.1.1
date	96.11.05.09.30.22;	author nturton;	state Exp;
branches;
next	;

4.1.3.1
date	96.11.05.23.31.13;	author nturton;	state Exp;
branches
	4.1.3.1.2.1;
next	4.1.3.2;

4.1.3.2
date	97.05.01.14.30.29;	author kbracey;	state Exp;
branches;
next	;

4.1.3.1.2.1
date	97.04.30.11.39.44;	author kbracey;	state Exp;
branches;
next	;

4.1.5.1
date	96.11.21.12.22.37;	author nturton;	state Exp;
branches;
next	;

4.1.7.1
date	96.11.29.20.20.17;	author nturton;	state Exp;
branches;
next	4.1.7.2;

4.1.7.2
date	97.03.14.10.23.30;	author kbracey;	state Exp;
branches
	4.1.7.2.2.1;
next	4.1.7.3;

4.1.7.3
date	97.03.27.11.14.25;	author rbuckley;	state Exp;
branches;
next	4.1.7.4;

4.1.7.4
date	97.04.30.16.49.42;	author scormie;	state Exp;
branches;
next	4.1.7.5;

4.1.7.5
date	97.06.11.10.04.37;	author scormie;	state Exp;
branches;
next	4.1.7.6;

4.1.7.6
date	97.07.25.13.27.04;	author jcoxhead;	state Exp;
branches;
next	4.1.7.7;

4.1.7.7
date	97.07.28.14.31.06;	author jcoxhead;	state Exp;
branches;
next	4.1.7.8;

4.1.7.8
date	97.07.31.16.16.06;	author scormie;	state Exp;
branches;
next	4.1.7.9;

4.1.7.9
date	97.08.19.15.03.45;	author arodger;	state Exp;
branches;
next	4.1.7.10;

4.1.7.10
date	98.06.15.10.05.03;	author olove;	state Exp;
branches;
next	4.1.7.11;

4.1.7.11
date	98.06.25.08.58.29;	author scormie;	state Exp;
branches;
next	4.1.7.12;

4.1.7.12
date	98.09.10.10.34.28;	author kbracey;	state Exp;
branches;
next	4.1.7.13;

4.1.7.13
date	98.10.07.16.14.11;	author scormie;	state Exp;
branches;
next	;

4.1.7.2.2.1
date	97.04.10.13.51.02;	author kbracey;	state Exp;
branches;
next	4.1.7.2.2.2;

4.1.7.2.2.2
date	97.04.14.12.21.48;	author kbracey;	state Exp;
branches;
next	4.1.7.2.2.3;

4.1.7.2.2.3
date	97.04.28.16.48.58;	author kbracey;	state Exp;
branches;
next	;


desc
@@


4.7
log
@Spinner branch merged.
Changed to use srccommit.
All conditionals on "Version" removed.

Version 4.01. Tagged as 'Wimp-4_01'
@
text
@; > Version

        GBLA    Version
        GBLS    VString
        GBLS    Date

Version SETA    400
VString SETS    "4.00"
Date    SETS    "17 Sep 1998"

        END
@


4.6
log
@Ursula branch Wimp merged back onto trunk.
@
text
@@


4.5
log
@Corrected setting of WatchdogTimer option to false.
Made options files specify any text wanted after the module version number.
Auto-fronting iconbar now returns to previous position rather than back, so
it interacts with Shift+F12 better.
@
text
@d7 3
a9 3
Version SETA    391
VString SETS    "3.91"
Date    SETS    "07 May 1997"
@


4.5.2.1
log
@Version incremented for printer upcall changes
@
text
@d7 3
a9 3
Version SETA    392
VString SETS    "3.92"
Date    SETS    "16 May 1997"
@


4.5.2.2
log
@Added Message_IconizeAt before Message_Iconize is sent
@
text
@d7 3
a9 3
Version SETA    393
VString SETS    "3.93"
Date    SETS    "11 Jun 1997"
@


4.5.2.3
log
@Hourglass depth now incremented by 1 between calls to Wimp_Poll; effect is
to automatically display hourglass whenever applications hog the CPU,
irrespective of whether they already display the hourglass themselves or not.
Hourglass is automatically smashed before any Command Windows are displayed
so that output-generating single-tasking programs are not forced to show the
hourglass due to the behaviour described above.
@
text
@d7 3
a9 3
Version SETA    394
VString SETS    "3.94"
Date    SETS    "03 Jul 1997"
@


4.5.2.4
log
@Stopped cursor jumping to top left when a task was killed outside the
desktop (eg *RMKill ShareFS at the F12 prompt).
@
text
@d7 3
a9 3
Version SETA    395
VString SETS    "3.95"
Date    SETS    "15 Oct 1997"
@


4.5.2.5
log
@Made the Wimp always call the postfilter when returning from Wimp_StartTask,
rather than only if the child didn't Wimp_Poll. Also ensured that nothing
untowards happens if the filter tries to claim this apparent "null event".
@
text
@d7 3
a9 3
Version SETA    396
VString SETS    "3.96"
Date    SETS    "16 Oct 1997"
@


4.5.2.6
log
@ - corrected comments re Wimp08 versus Wimp08s
 - tidied up Wimp08s
 - Added optional use of kernel lock for Wimp_ClaimFreeMemory, controlled
   by KernelLocksFreePool in Options (currently true for Ursula only)
 - restricted max size of Wimp Sprite Pool dynamic area to 16M (controlled
   by WimpSpritePoolMaxSize in s.Memory) to avoid wasted address space on
   large memory machines
@
text
@d9 1
a9 1
Date    SETS    "21 Oct 1997"
@


4.5.2.7
log
@Fixed problem with PostFilters getting called when doing a Wimp_StartTask
callback exit.
@
text
@d7 3
a9 3
Version SETA    397
VString SETS    "3.97"
Date    SETS    "28 Oct 1997"
@


4.5.2.8
log
@Fixed occasional lock-ups when error boxes displayed.
Added ALIGN directive before watchdog callback label.
Added option to select double-height VDU 4 modes.
Added German resources.
Added necessary options for parallel-port debugging via the PDebugM module.
@
text
@d7 3
a9 3
Version SETA    398
VString SETS    "3.98"
Date    SETS    "15 Jan 1998"
@


4.5.2.9
log
@Main new features in Ursula build so far
(some are also available in other builds):

* New icon highlighting scheme - hue rotated 180°, photographic negative,
  darkened 25% - suits Ursula icons better.
* Release-button window tools compile-time switch turned on.
* Any "TASK" word cleared on exit from Wimp_OpenWindow, Wimp_GetWindowState,
  Wimp_ForceRedraw and Wimp_CloseDown.
* Child windows are no longer allowed to be opened inside the icon bar.
* Message_IconizeAt generation optimised, and no longer calls non-X SWIs.
* Message_IconsChanged implemented, and switched out on speed grounds.
* Wimp_ReadSysInfo 15 removed, replaced with (new) Wimp_Extend 11.
* Backwindows are now segregated from normal windows. A new category,
  foreground windows, are added, and stay above all other windows. (The error
  box template is updated to make it a foreground window.)
* ROM sprites override RAM sprites (and duplicate RAM sprites are deleted
  during the building of the sprite lookup list, preceding the first sprite
  plot after a sprite pool update).
* Wimp_ReadSysInfo 16 added, to return sprite area pointers in order of
  priority (Wimp_BaseOfSprites retains the ROM/RAM distinction).
* Error box code altered:
  + symbolic names used for offsets into tempworkspace
  + error button text buffer enlarged
  + stretched error buttons now shrink back for next use
  + int_flush_opens called at appropriate points to ensure buttons are seen to
    slab in, and to reduce flicker when redisplaying error box at a different
    width (also fixes some redraw bugs)
  + Cancel button given the R6 type border when it will be activated by Return
    (and is therefore moved to the extreme right in such cases)
  + Escape now always selects the second-right button (unless there's only one
    button!) - this also fixes a bug when there's a single user-defined button
  + keypresses in "xxx may have gone wrong" error boxes are now correctly
    interpreted - previously the buttons available in the underlying box were
    being used to determine the effect of keys
  + maximum number of buttons increased from 4 to 8, and the machine no longer
    crashes when the maximum is exceeded
  + window stretches horizontally to keep error message to 7 lines or less
* Bugfix: opening or creating a window with a minimum x visible area coordinate
  of -1 was leading to any of smearing/flickering/recursive drawing. (This was
  actually due to a failure to recognise which windows' positions had been
  updated.)
* Features merged in from spinner branch Wimp:
  + support for UpCall_MediaSearchEndMessage added
  + control-termination allowed in upcalls (used to require null-termination)
  + escape character switched to default during error box display, then
    switched back again afterwards
* GetRectangle filters are now called with (internal) window handle in R10.
* Autohourglass is deactivated whenever WrchV is invoked. (Also optimised.)
* Action button bugfixes:
  + action buttons now deselect if the pointer is dragged off and a window tool
    is the pressed before all the buttons have been released
  + action buttons now slab in following a long (autorepeating) press on a
    scroll arrow window tool
@
text
@d7 3
a9 3
Version SETA    399
VString SETS    "3.99"
Date    SETS    "09 Mar 1998"
@


4.5.2.10
log
@New features:
Dragboxes can now be clipped by and/or fixed to a given window's work area
SWI Wimp_AutoScroll implemented
Ursula icon highlighting scheme redesigned

Bugfixes:
Wimp_Extend 11 now performs the same check on R1 as the main SWI handling code
Message blocks now updated if in a dynamic area
Screenblanker now turned off when error box is displayed
ptr_double now turned off when a drag starts
@
text
@d9 1
a9 1
Date    SETS    "26 Mar 1998"
@


4.5.2.11
log
@Iconise button removed from child windows
Icon bar now jumps to the back of the stack as soon as a window is opened above
it (excluding menus, dialogue boxes and foregroud windows). This is to avoid
the ambiguous situation when the icon bar can be part-way down the window stack.
Improved co-odination between auto-fronting and Shift-F12 behaviour.
Stopped scroll offset overflow during icon bar scroll.
Numerous features made configurable:
  WimpIconBarSpeed
  WimpIconBarAcceleration
  WimpSpritePrecedence
  WimpIconiseButton
  WimpStickyEdges (although not actually implemented yet)
  WimpAutoFrontIconBar
  WimpAutoFrontDelay
  WimpAutoScrollDelay
To make room for these in CMOS, Wimp<Drag|DoubleClick><Delay|Move> and
Wimp<AutoMenu|MenuDrag>Delay options are now stored in a more compressed form
in CMOS - but the *Configure interface is unaltered.
@
text
@d9 1
a9 1
Date    SETS    "03 Apr 1998"
@


4.5.2.12
log
@Added Ursula Service Call table
Flushes cached screen after dragbox updates
Fixed window stack behaviour so background windows interact conventionally again
  (fixes a number of window positioning bugs)
Disabled Shift-Select-close for child windows
@
text
@d9 1
a9 1
Date    SETS    "07 Apr 1998"
@


4.5.2.13
log
@Redraw of dragboxes when being resized/translated optimised to reduce flicker.

Autoscroll update period extended to 12cs to reduce flicker.

Added Wimp_ReadSysInfo 17 to return configured drag-and-drop scroll startup
delay (in cs) because the CMOS storage isn't easy to read.

Identified and bracketed changes from 3.9x responsible for 24-bit icon colours.

defaultfontcolours now works correctly again.

Introduced new icon colour code. This holds icon colours in 24 bits internally
throughout, rather than treating 24-bit colour specifiers as a special case.
This results in the following bugfixes/improvements:
 * 3D faces and moat colours, and slabbed-in action button backgrounds, can
   all be specified in 24-bits
 * fading of icons is now consistent across icon types, and utilises the
   colour range of >16 colour modes
 * 3D borders now get faded along with the rest of the icon
 * action buttons can now contain sprites (background is correct, and sprite
   is not inverted)
 * various cases where anti-aliasing didn't blend in to the background
   correctly are now fixed
 * conventional and 24-bit specifiers now behave equivalently to each other -
   the same colour specified either way behaves the same when faded, used as
   an EOR colour etc. (greys are now always dithered in 1-bpp modes, even if
   specified in 24-bit)
 * behaviour is now the same whether the Wimp font is the system font or a
   fancy font (amazingly, this wasn't always the case)
 * except for 3D icons, if the icon background matches the work area
   background, it is unaffected by fading - so for example, group boxes can now
   be faded correctly

Switched out AutoHourglass (Mike was concerned about the speed hit).

Corrected *Help syntax strings for On/Off configuration options.
@
text
@d9 1
a9 1
Date    SETS    "17 Apr 1998"
@


4.5.2.14
log
@Bugfixes:

Re-opening a menu structure containing a dialogue box (especially one
containing the caret) was causing data aborts under some OSes/builds.

The minimum title bar length is now the same for windows without line borders,
even if the vertical scroll bar is also absent. This prevents cases when the
title bar shrunk so far that a graphics clipping error occurred.

Wimp_DragBox was looking in R0 for its flags, rather than R3, as specified!

If the pointer was to the right of the central zone, vertical autoscrolling
was working too slowly.

On Service_SwitchingOutputToSprite, the Wimp now re-assesses its idea of the
screen limits. This prevents Wimp_PlotIcon plots outside the current screen
bounds from being optimised out.
@
text
@d9 1
a9 1
Date    SETS    "21 Apr 1998"
@


4.5.2.15
log
@* When a window was reopened such that the iconise button replaces the
  toggle-size icon (or vice versa), the Wimp now spots that the relevant
  rectangle needs redrawing.
* When a window stays put, but scrolls in one direction, the unaffected
  scrollbar is no longer redrawn, in order to reduce flicker. This was
  coded, but broken, on Risc PC Wimps, but doubly broken in the Nested Wimps
  - and the flicker was particularly noticeable with Ursula's cached screen
  enabled...
* Fixed nasty bug in nested window open flushing: this seems to have been
  caused by faulty behaviour of addsub when passed a rectangle where cx0>cx1
  and/or cy0>cy1. Filtering out such cases from subrect calls in
  (old)subtract_openingchildren prevents this from being the case. The old
  behaviour was trashing the borderrects list, which resulted in the loss of
  the invalidrects list, causing full-screen redraw when a window containing
  seven (or more) child windows was scrolled or resized.
* Fixed a bug introduced in last version, whereby program error and watchdog
  error box text was overwritten with "WindowManager:Sprites22".
* Supported long pathnames for *IconSprites.
@
text
@d9 1
a9 1
Date    SETS    "27 Apr 1998"
@


4.5.2.16
log
@The title bar, and the back, close and iconise buttons, are no longer redrawn
when a window is resized in just the vertical direction.

All window colours can now be specified in 24-bit colour.

Where a sprite is used to plot the back, close, title, iconise, toggle-size,
adjust-size or scroll arrow icons, the sprite is now plotted using a distorted
translation table, to give the sprites the appearance of being coloured
according to the window colours.

The 3D toolsprite set now has solid titlebar sprites.

The icon bar template now uses the standard title bar colours (this optimises
redraw because of the new border tinting code).

When the toggle-size icon or title bar are to be plotted using solid sprites,
the background is no longer filled in just prior to the event (although this
will still be performed if the relevant sprite is masked). This is to reduce
flicker. Similarly, the erroneous rectangle outlines plotted behind scrollbars
have been removed.

New "TASK"-form Wimp_ForceRedraw reason codes:
  R2 = 0 => redraw whole window border (includes line borders).
  R2 = 8 => redraw iconise button.
@
text
@d9 1
a9 1
Date    SETS    "08 May 1998"
@


4.5.2.17
log
@Added a couple of extra compile-time options for use in specialied
applications; both are switched out in all standard builds.

ForceTwitter: used in combination with Twitter flag, this causes
   antitwittering to be employed irrespective of ModeFlags bit 8,
   and also irrespective of whether a window is auto-redraw or not.

HideIconBar: ensures that the icon bar is behind the backwindow, unless
   it has been brought to the front (by either method). In conjunction with
   a modified Pinboard, this can produce a quick-and-dirty iconbar-less
   machine.
@
text
@d9 1
a9 1
Date    SETS    "14 May 1998"
@


4.5.2.18
log
@Fixed "multi-coloured borders" bug: a single TEQ statement had been commented
out when it should have been optioned out. Not my fault!!
@
text
@d9 1
a9 1
Date    SETS    "25 May 1998"
@


4.5.2.19
log
@Bugfix: window colours now correctly set up on exit from Wimp_UpdateWindow
and Wimp_GetRectangle calls following a Wimp_UpdateWindow. This was also
causing the background colour of some "unfilled", shaded, text-plus-sprite
icons to be incorrectly calculated if they had previously been unshaded.
@
text
@d9 1
a9 1
Date    SETS    "27 May 1998"
@


4.5.2.20
log
@Window tool button type is now configurable.
Windows now keep the same depth when toggle-size tool is clicked with Adjust.
Fixed bug where drags in Eureka caused branch-through-zeros and other
miscellaneous errors.
Fixed a few stray non-X form SWI calls.
Extended applicability/functionality of "MyEntry" debug macro.
@
text
@d9 1
a9 1
Date    SETS    "03 Jul 1998"
@


4.5.2.21
log
@Window status flag bit 17 "window is fully visible" is now correctly set for
nested windows.
If the lowest window (eg most recently iconised window) is a hotkey window,
the Wimp used to hang if a keypress was not claimed by any task. Now fixed.
Hotkey events can now be delivered to nested windows.
Ctrl-Alt-Close now closes all windows, at the same nesting level, provided
that they have close buttons.
Ctr-Alt-Iconise now iconises all top-level windows that have close buttons.
Low-res versions of autoscroll pointers fixed: they had been in 256 greys!
@
text
@d9 1
a9 1
Date    SETS    "13 Jul 1998"
@


4.5.2.22
log
@Redraw of unfilled, font-specified icons now fixed; this caused antialising
errors, for example in CC applications' banner windows.

No longer maps anti-aliased system font character 128 to WimpSymbol tick;
this leaves character 128 free for use by Euro currency glyph.

Fixed Data Aborts in Wimp_SpriteOps 54, 57 and 58, and in *WimpKillSprite for
a sprite name found only in the ROM sprite pool.

Eureka window titles should now be redrawn correctly, without impacting the
redraw of Wimp-drawn titlebars, provided the ROM toolsprites are used. Note
that the toolsprite spritefile has regained sprite masks, but the colours
"behind" the mask are different to those in the last masked toolsprite file.
@
text
@d9 1
a9 1
Date    SETS    "14 Jul 1998"
@


4.5.2.23
log
@Faded text-plus-sprite icons in Impression and ArtWorks were being plotted
incorrectly, due to what appears to have been a workaround for a RISC OS 2
Wimp bug.

A redraw problem turned out to be due to the rectangle limit, so this has been
doubled again.

A number of window-toggling bugs are fixed:
* if a window had no title bar, shift-toggle left a gap before the top of the
  screen
* window status flag bit 19 was always cleared during a call to Wimp_SetExtent
* tasks which called Wimp_SetExtent after an Open_Window_Request (eg the Filer)
  weren't always being considered "full-size" after a shift-toggle operation
* when a non-toggled window and its shift-toggled version were the same size,
  various problems arose (window status flags being wrongly set, toggle button
  being non-responsive for next click, toggle button not being redrawn
  correctly)
@
text
@d9 1
a9 1
Date    SETS    "21 Jul 1998"
@


4.5.2.24
log
@Corrected active point for autoscrolling pointers (was wrong in low-res modes).

Certain user-drawn dragbox routines (eg via DragASprite) don't pass the object
bounding box as the box; this was conflicting with one of the redraw
optimisations, and causing smearing when the underlying object was redrawn.
Relevant optimisation optioned out.

If a window stack-change causes the iconise button to appear or disappear,
this is now caught, and the window border is redrawn immediately.

Toggling of child windows now works - the return coordinates are linked to
the parent in the same way as the current ones. Note that this is unlikely to
be useful for anything other than alignment 0/0/0/0/0/0 children.

Return codes for the "Quit" and "Continue" buttons in "xxx may have gone wrong"
error boxes can now be specified.

Both scrollbars push in for adjust-drags.
@
text
@d9 1
a9 1
Date    SETS    "28 Jul 1998"
@


4.5.2.25
log
@Text is now correctly justified when in an icon with validation string
commands R8, R9, R10, ...

R5/R6 type icons now behave more usefully with button types other than click,
release and auto-repeat.

Prevented coordinate overflow in dragboxes.

Stopped clipped dragboxes from flickering more than non-clipped ones.

Fixed a bug whereby data aborts occurred when generating the translation table
for inverted and/or shaded 256-colour sprites, if the first 256-colour sprite
plotted since the Wimp's cached translation table was invalidated (either by
Service_InvalidateCache or by plotting a 256-colour sprite after a non-256-
colour sprite one) was at an address that had since been invalidated or paged
out. This fixes a long-standing problem with 256-colour sprites in the desktop,
but which only happened sporadically.

Prevented palette corruption in paletted ( <256-colour) modes when the pointer
reverts from an autoscroll pointer to its original setting.

Fixed bug introduced in last build, where clicking on the bottom pixel row of a
horixontal scrollbar, or the left pixel column of a back icon, caused a crash.

All Wimp-drawn solid rectangles are now be plotted much faster - typically
around twice as fast - translating to a typical 30% increase in speed of
plotting filled icons. Improvements will be better still in cases where icons
are drawn in a non-contiguous order: this commonly affects Toolbox applications.

When a dialogue box is opened from a menu, the Wimp will no longer attempt to
place the caret in a shaded or deleted icon, but it will do so for a type-14
(writable/click/drag) icon, as well as the standard type-15 (writable) icons.
This brings it in line with KA-validation up/down arrow actions.
@
text
@d9 1
a9 1
Date    SETS    "05 Aug 1998"
@


4.5.2.26
log
@Stopped the Wimp from reprogramming system font character 128, as this was
overwriting International's definition of the Euro symbol there.
@
text
@d9 1
a9 1
Date    SETS    "07 Aug 1998"
@


4.5.2.27
log
@Bugfixes:
* icons with border R5 or R6 and button type 5-8 now slab in/out as on old
  Wimps again: this had been causing Marcel problems
* window titles with leading spaces and/or trailing periods no longer result
  in an iconised icon with a null text string
@
text
@d9 1
a9 1
Date    SETS    "18 Aug 1998"
@


4.5.2.28
log
@Re-inserted the fixed low-res autoscroll pointers (they disappeared in the
final softload ROM).
Fixed half-specified font-colour validation-string-command bug.
Partial UTF-8 support included, but switched out, since UTF-8 won't be any
theoretical future Ursula build.

Finally...
Cranked version number up to 4.00, to signify the end of Ursula development.
@
text
@d7 3
a9 3
Version SETA    400
VString SETS    "4.00"
Date    SETS    "17 Sep 1998"
@


4.4
log
@ARTtmp branch folded in
@
text
@d7 3
a9 3
Version SETA    390
VString SETS    "3.90"
Date    SETS    "28 Apr 1997"
@


4.3
log
@Incremented version number to 3.88.
@
text
@d7 3
a9 3
Version SETA    388
VString SETS    "3.88"
Date    SETS    "27 Mar 1997"
@


4.2
log
@Merged WIMP imported
@
text
@d6 4
a9 4
    
Version SETA    387
VString SETS    "3.87"
Date    SETS    "16 Dec 1996"
@


4.1
log
@Initial revision
@
text
@d7 3
a9 3
Version SETA    366
VString SETS    "3.66"
Date    SETS    "06 Mar 1995"
@


4.1.7.1
log
@NCOS 1.06 Imported from Zip drive
@
text
@d7 3
a9 3
Version SETA    385
VString SETS    "3.85"
Date    SETS    "02 Oct 1996"
@


4.1.7.2
log
@Rectangle filters not called when caret moves.
Post-rectangle and post-icon filters added.
@
text
@d7 3
a9 3
Version SETA    386
VString SETS    "3.86"
Date    SETS    "13 Mar 1997"
@


4.1.7.2.2.1
log
@AMBControl task switching merged from RO_3_70 branch.
PlotSpritesFromPalette and TwitterOnlyMenus options added.
ChildWindows merged in.
@
text
@d6 4
a9 4

Version SETA    389
VString SETS    "3.89"
Date    SETS    "10 Apr 1997"
@


4.1.7.2.2.2
log
@Some obsolete assembly switches removed (chwidth in particular).
Behaviour of scrollbars with large extents improved.
Window tools now press in correctly after a Service_InvalidateCache.
Plotting of solid window tools optimised - background isn't drawn in.
Auto-fronting iconbar added.
Various optimisations, such as multiple OS_WriteI -> OS_WriteN.
HiResMono flag no longer relied on.
"22" tool sprites now chosen for 1x2,2x1 or 1x1 screen modes.
Buttons restored correctly after "application may have gone wrong" error box.
Positioning of outline font text shifted right 2 OS units to match system font.
Parameter of L validation string implemented.
Positioning of outline font "L" (multiple line) icons fixed.
Shift-toggle size behaviour fixed.
Wimp_TransferBlock above 2Gb should be fixed.
Post-rectangle filters implemented.
FPE4 flag added (to use LFM/SFM instead of LDFE/STFE).
Plotting of non-pixel aligned 3d icons fixed.
3d borders now solid in EX0/EY0 modes.
@
text
@d9 1
a9 1
Date    SETS    "14 Apr 1997"
@


4.1.7.2.2.3
log
@Added support for multiple options files (RO310, RO350, RO360, RO370, RCA,
Ursula).
Removed run-time MedusaOS checks.
Enabled correct build for RISC OS 3.1 machines.
Ensured that "freepoolinuse" is cleared before OS_ChangeDynamicArea
is intercepted.
Increased maxrects to 256.
Gave copy filter window handle in R10 (if ChildWindows).
Corrected a few border problems when no toolsprites.
Made toolsprites press in immediately - in particular close and toggle can
now be highlighted.
BounceClose flag no affects all of back,close,iconise and toggle.
Made "L" validation string parsing check manually for presence of a number,
to prevent error from OS_ReadUnsigned trashing MessageTrans' error buffers.
Allow error box buttons to stretch to fit text.
Fixed bug: floating point registers were not being saved unless on a portable.
Integrated some of the Wimp_TransferBlock fixes into Wimp08 from Wimp08s.
@
text
@d7 3
a9 3
Version SETA    390
VString SETS    "3.90"
Date    SETS    "28 Apr 1997"
@


4.1.7.3
log
@Incremented version number to 3.88.
@
text
@d6 4
a9 4

Version SETA    388
VString SETS    "3.88"
Date    SETS    "27 Mar 1997"
@


4.1.7.4
log
@Modify UpCall handler; restore font colours before calling Service_WimpReportError at end of SWI Wimp_ReportError.
@
text
@d7 3
a9 3
Version SETA    389
VString SETS    "3.89"
Date    SETS    "29 Apr 1997"
@


4.1.7.5
log
@When building for NCs, use IconHigh in error boxes, use different button
border colours, use replacement Templates file.
@
text
@d7 3
a9 3
Version SETA    390
VString SETS    "3.90"
Date    SETS    "09 Jun 1997"
@


4.1.7.6
log
@   When turning the pointer off before Wimp_Report, save the state and
set it back to that state afterwards.
   Allow Wimp_GetPointerInfo, Wimp_GetWindowInfo, Wimp_GetWindowState outside
a task: needed to make IconHigh work in a ReportError box which has itself been
invoked from outside a task.
@
text
@d7 3
a9 3
Version SETA    391
VString SETS    "3.91"
Date    SETS    "25 Jul 1997"
@


4.1.7.7
log
@   Return result from Wimp_Report *before* corrupting it.
@
text
@d7 3
a9 3
Version SETA    392
VString SETS    "3.92"
Date    SETS    "28 Jul 1997"
@


4.1.7.8
log
@Moved turning off IconHigh on error windows to BEFORE the window is closed.
@
text
@d7 3
a9 3
Version SETA    393
VString SETS    "3.93"
Date    SETS    "31 Jul 1997"
@


4.1.7.9
log
@Build for NC tested positive and negative transitions in key presses.  This
avoided the double clicks.
@
text
@d7 3
a9 3
Version SETA    394
VString SETS    "3.94"
Date    SETS    "19 Aug 1997"
@


4.1.7.10
log
@Updated version number.
@
text
@d7 3
a9 3
Version SETA    395
VString SETS    "3.95"
Date    SETS    "15 Jul 1998"
@


4.1.7.11
log
@Added new flag, PreservePointerOnError, to control whether the mouse pointer
state is preserved over errors. This is also dependent on BuildForNC being true.
@
text
@d7 3
a9 3
Version SETA    396
VString SETS    "3.96"
Date    SETS    "23 Jul 1998"
@


4.1.7.12
log
@Makefile changed to use LocalRes$Path.
Automatic switching to WimpSymbol disabled if WimpSymbol font not registered.
@
text
@d9 1
a9 1
Date    SETS    "10 Sep 1998"
@


4.1.7.13
log
@Modified behaviour of pointer during Wimp error boxes for NCs.
@
text
@d7 3
a9 3
Version SETA    397
VString SETS    "3.97"
Date    SETS    "07 Oct 1998"
@


4.1.5.1
log
@Import from SrcFiler
@
text
@d7 3
a9 3
Version SETA    385
VString SETS    "3.85"
Date    SETS    "02 Oct 1996"
@


4.1.3.1
log
@Import from cleaned 370 CD
@
text
@d7 3
a9 3
Version SETA    368
VString SETS    "3.68"
Date    SETS    "23 May 1996"
@


4.1.3.2
log
@Version RO_3_71 taken
@
text
@d7 3
a9 3
Version SETA    369
VString SETS    "3.69"
Date    SETS    "18 Feb 1997"
@


4.1.3.1.2.1
log
@Updated from 3.71 CD
@
text
@d7 3
a9 3
Version SETA    369
VString SETS    "3.69"
Date    SETS    "18 Feb 1997"
@


4.1.1.1
log
@Import from cleaned 360 CD
@
text
@@
