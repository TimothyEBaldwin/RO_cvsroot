head	4.10;
access;
symbols
	Wimp-5_62:4.10
	Wimp-5_61:4.10
	Wimp-5_60:4.10
	Wimp-5_59:4.10
	Wimp-5_58:4.10
	Wimp-5_57:4.10
	Wimp-5_56:4.10
	Wimp-5_55:4.10
	Wimp-5_54:4.10
	Wimp-5_53:4.10
	Wimp-5_52:4.10
	Wimp-5_51:4.10
	Wimp-5_50:4.10
	Wimp-5_49:4.10
	Wimp-5_48:4.10
	Wimp-5_47-file1ad:4.10
	Wimp-5_47:4.10
	Wimp-5_46:4.10
	Wimp-5_45:4.9
	Wimp-5_44:4.9
	Wimp-5_43:4.9
	Wimp-5_42:4.9
	Wimp-5_41:4.9
	Wimp-5_40:4.9
	Wimp-5_39:4.9
	Wimp-5_38:4.9
	Wimp-5_37:4.9
	Wimp-5_36:4.9
	Wimp-5_35:4.8
	Wimp-5_34:4.7
	Wimp-5_33:4.7
	Wimp-5_32:4.7
	Wimp-5_31:4.6
	Wimp-5_30:4.6
	Wimp-530-pre4:4.6
	Wimp-5_30-pre3:4.6
	Wimp-5_30-pre2:4.6
	Wimp-5_30-pre1:4.6
	Wimp-5_29:4.6
	Wimp-5_28:4.6
	Wimp-5_27:4.6
	Wimp-5_26:4.6
	Wimp-5_25:4.6
	Wimp-5_24:4.6
	Wimp-5_23:4.6
	Wimp-5_22:4.6
	Wimp-5_21:4.6
	Wimp-5_20:4.6
	Wimp-5_19:4.6
	Wimp-5_18:4.6
	Wimp-5_17:4.6
	Wimp-5_16:4.6
	Wimp-5_15:4.6
	Wimp-5_14:4.6
	Wimp-5_13:4.5
	Wimp-5_12:4.5
	Wimp-5_11:4.5
	Wimp-5_10:4.5
	Wimp-5_09:4.5
	Wimp-5_08:4.5
	Wimp-5_07:4.5
	Wimp-5_06:4.5
	Wimp-5_05:4.5
	Wimp-5_04:4.5
	Wimp-5_03:4.5
	Wimp-5_02:4.5
	Wimp-5_01:4.5
	Wimp-4_66-4_77_2_1:4.4
	bavison_Threads_dev:4.4.0.4
	bavison_Threads_dev_bp:4.4
	Wimp-5_00:4.5
	Wimp-4_100:4.5
	Wimp-4_99:4.5
	Wimp-4_98:4.5
	Wimp-4_97:4.5
	Wimp-4_96:4.5
	Wimp-4_95:4.5
	Wimp-4_94:4.5
	RO_5_07:4.5
	Wimp-4_93:4.5
	Wimp-4_92:4.5
	Wimp-4_91:4.5
	Wimp-4_90:4.4
	Wimp-4_89:4.4
	Wimp-4_88:4.4
	Wimp-4_87:4.4
	Wimp-4_86:4.4
	Wimp-4_85:4.4
	Wimp-4_84:4.4
	Wimp-4_83:4.4
	Wimp-4_82:4.4
	Wimp-4_81:4.4
	Wimp-4_80:4.4
	Wimp-4_79:4.4
	Wimp-4_78:4.4
	Wimp-4_77:4.4
	Wimp-4_76:4.4
	Wimp-4_75:4.4
	Wimp-4_74:4.4
	Wimp-4_73:4.4
	Wimp-4_72:4.4
	Wimp-4_71:4.4
	Wimp-4_70:4.4
	Wimp-4_69:4.4
	Wimp-4_68:4.4
	Wimp-4_67:4.4
	Wimp-4_66:4.4
	Wimp-4_65:4.4
	Wimp-4_64:4.4
	Wimp-4_63:4.4
	Wimp-4_62:4.4
	Wimp-4_61:4.4
	Wimp-4_60:4.4
	Wimp-4_59:4.4
	Wimp-4_58:4.4
	Wimp-4_36-4_46_2_6:4.4
	Wimp-4_57:4.4
	Alpnet_approved:4.4
	Wimp-4_36-4_46_2_5:4.4
	Wimp-4_56:4.4
	dellis_autobuild_BaseSW:4.4
	Wimp-4_36-4_46_2_4:4.4
	Wimp-4_36-4_46_2_3:4.4
	Wimp-4_55:4.4
	Wimp-4_54:4.4
	Wimp-4_36-4_46_2_2:4.4
	Wimp-4_53:4.4
	Wimp-4_36-4_46_2_1:4.4
	Bethany:4.4.0.2
	Wimp-4_52:4.4
	Wimp-4_51:4.4
	Wimp-4_50:4.4
	Wimp-4_49:4.4
	Wimp-4_48:4.4
	Wimp-4_47:4.4
	Wimp-4_46:4.4
	Wimp-4_45:4.4
	Wimp-4_44:4.4
	Wimp-4_43:4.4
	Wimp-4_42:4.4
	sbrodie_sedwards_16Mar2000:4.4
	Wimp-4_41:4.4
	Wimp-4_40:4.4
	Wimp-4_39:4.4
	Wimp-4_38:4.4
	Wimp-4_37:4.4
	Wimp-4_36:4.4
	Wimp-4_35:4.4
	Wimp-4_34:4.4
	Wimp-4_33:4.4
	Wimp-4_32:4.4
	Wimp-4_31:4.4
	dcotton_autobuild_BaseSW:4.4
	Wimp-4_30:4.4
	Wimp-4_29:4.4
	Wimp-4_28:4.4
	Wimp-4_27:4.4
	Wimp-4_26:4.4
	Wimp-4_25:4.4
	Wimp-4_24:4.4
	Wimp-4_23:4.4
	Wimp-4_22:4.4
	Wimp-4_21:4.4
	Wimp-4_20:4.4
	Wimp-4_19:4.4
	Wimp-4_18:4.4
	Wimp-4_17:4.4
	Wimp-4_16:4.4
	Wimp-4_15:4.4
	Wimp-4_14:4.4
	Wimp-4_13:4.4
	Wimp-4_12:4.4
	mstphens_UrsulaRiscPCBuild_20Nov98:4.2.2.4
	bavison_Wimp-4_11:4.4
	Ursula_RiscPC:4.2.2.4.0.2
	Wimp-4_11:4.4
	Wimp-4_10:4.4
	Wimp-4_09:4.4
	Wimp-4_08:4.4
	Wimp-4_07:4.4
	Wimp-4_06:4.4
	Wimp-4_05:4.3
	Wimp-4_04:4.3
	bavison_Wimp-4_03_noshrinkables:4.3
	Wimp-4_03:4.3
	Wimp-4_02:4.3
	Ursula_merge:4.2.2.4
	bavison_Wimp-4_01:4.3
	Wimp-4_01:4.3
	nicke_Wimp_3_96M:4.1.7.2
	bavison_Wimp-4_00_TRUNK:4.3
	bavison_Wimp-4_00:4.2.2.4
	nicke_Wimp_3_96:4.1.7.2
	mjrobert_Wimp_3_98:4.2.2.2
	rthornb_UrsulaBuild-19Aug1998:4.2.2.4
	UrsulaBuild_FinalSoftload:4.2.2.4
	bavison_Wimp-3_99t:4.2.2.4
	rthornb_UrsulaBuild-12Aug1998:4.2.2.4
	bavison_Wimp-3_99s:4.2.2.4
	aglover_UrsulaBuild-05Aug1998:4.2.2.4
	bavison_Wimp-3_99r:4.2.2.4
	rthornb_UrsulaBuild-29Jul1998:4.2.2.4
	bavison_Wimp-3_99q:4.2.2.4
	jfarrell_NCWimp_3_96:4.1.7.2
	rthornb_UrsulaBuild-22Jul1998:4.2.2.4
	bavison_Wimp-3_99p:4.2.2.4
	rthornb_UrsulaBuild-15Jul1998:4.2.2.4
	bavison_Wimp-3_99o:4.2.2.4
	bavison_Wimp-3_99n:4.2.2.4
	rthornb_UrsulaBuild-07Jul1998:4.2.2.4
	bavison_Wimp-3_99m:4.2.2.4
	rthornb_UrsulaBuild-17Jun1998:4.2.2.4
	rthornb_UrsulaBuild-03Jun1998:4.2.2.4
	bavison_Wimp-3_99l:4.2.2.4
	rthornb_UrsulaBuild-27May1998:4.2.2.4
	rthornb_UrsulaBuild-21May1998:4.2.2.4
	bavison_Wimp-3_99k:4.2.2.4
	bavison_Wimp-3_99j:4.2.2.4
	bavison_Wimp-3_99i:4.2.2.4
	bavison_Wimp-3_99h:4.2.2.4
	rthornb_UrsulaBuild_01May1998:4.2.2.4
	bavison_Wimp_399g:4.2.2.4
	bavison_Wimp_399f:4.2.2.4
	afrost_NC2_Generic:4.1.7.2
	bavison_Wimp_399e:4.2.2.4
	bavison_Wimp_399d:4.2.2.3
	bavison_Wimp_399c:4.2.2.3
	Wimp_3_98:4.2.2.2
	kbracey_AW97:4.2.2.2
	Spinner_B20_2:4.1.7.2
	Spinner_19_3:4.1.7.2
	Spinner_B18:4.1.7.2
	Spinner_B17:4.1.7.2
	Spinner_B15:4.1.7.2
	Spinner_B14:4.1.7.2
	Spinner_B13:4.1.7.2
	Spinner_B12:4.1.7.2
	Spinner_B10:4.1.7.2
	Daytona:4.2.0.4
	Daytona_bp:4.2
	Ursula:4.2.0.2
	Ursula_bp:4.2
	Wimp_3_91:4.2
	Spin_merge_7May97:4.1.7.1
	ARTtmp_bp:4.1.7.2
	Spinner_B7:4.1.7.2
	RO_3_71:4.1.3.1
	ARTtmp_merge:4.1.7.2
	Spin_3Apr97:4.1.7.2
	ARTtmp:4.1.7.2.0.2
	Spin_merge:4.1.7.2
	MergeFiles:4.1.3.1
	RO_3_70:4.1.3.1
	NC_1_06:4.1.7.1
	Spinner:4.1.7
	Spin_xx:4.1.5
	NC_xx:4.1.5.1
	RO_3_60:4.1.1.1
	StrongARM:4.1.3
	Black:4.1.1;
locks; strict;
comment	@# @;


4.10
date	2014.09.24.20.28.53;	author bavison;	state Exp;
branches;
next	4.9;
commitid	A3t3mIm4BN0zFDRx;

4.9
date	2014.01.06.00.46.48;	author bavison;	state Exp;
branches;
next	4.8;
commitid	KcEsCEwwZgjMvZjx;

4.8
date	2014.01.01.19.47.54;	author jlee;	state Exp;
branches;
next	4.7;
commitid	LFYgvVGTUEWBZrjx;

4.7
date	2013.09.08.18.53.26;	author rsprowson;	state Exp;
branches;
next	4.6;
commitid	46q23XZLtAc5oF4x;

4.6
date	2012.01.23.08.03.48;	author rsprowson;	state Exp;
branches;
next	4.5;
commitid	6P5Pgy6PliwZSgQv;

4.5
date	2003.12.03.21.34.00;	author bavison;	state Exp;
branches;
next	4.4;

4.4
date	98.10.20.16.21.15;	author bavison;	state Exp;
branches;
next	4.3;

4.3
date	98.09.18.16.13.57;	author bavison;	state Exp;
branches;
next	4.2;

4.2
date	97.05.07.14.15.19;	author kbracey;	state Exp;
branches
	4.2.2.1;
next	4.1;

4.1
date	96.11.05.09.30.32;	author nturton;	state Exp;
branches
	4.1.1.1
	4.1.3.1
	4.1.5.1
	4.1.7.1;
next	;

4.2.2.1
date	97.05.21.16.37.40;	author kbracey;	state Exp;
branches;
next	4.2.2.2;

4.2.2.2
date	97.07.09.12.28.41;	author kbracey;	state Exp;
branches;
next	4.2.2.3;

4.2.2.3
date	98.03.26.19.31.28;	author bavison;	state Exp;
branches;
next	4.2.2.4;

4.2.2.4
date	98.04.17.16.54.04;	author bavison;	state Exp;
branches;
next	;

4.1.1.1
date	96.11.05.09.30.32;	author nturton;	state Exp;
branches;
next	;

4.1.3.1
date	96.11.05.23.31.57;	author nturton;	state Exp;
branches;
next	;

4.1.5.1
date	96.11.21.12.23.29;	author nturton;	state Exp;
branches;
next	;

4.1.7.1
date	96.11.29.20.21.00;	author nturton;	state Exp;
branches;
next	4.1.7.2;

4.1.7.2
date	97.03.14.10.23.46;	author kbracey;	state Exp;
branches;
next	;


desc
@@


4.10
log
@  Fix to warning
Detail:
  Previous test for include order of Hdr:Services and Hdr:Wimp was broken.
  See HdrSrc 2.46 for the other half of this fix.


Version 5.46. Tagged as 'Wimp-5_46'
@
text
@; Copyright 1996 Acorn Computers Ltd
;
; Licensed under the Apache License, Version 2.0 (the "License");
; you may not use this file except in compliance with the License.
; You may obtain a copy of the License at
;
;     http://www.apache.org/licenses/LICENSE-2.0
;
; Unless required by applicable law or agreed to in writing, software
; distributed under the License is distributed on an "AS IS" BASIS,
; WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
; See the License for the specific language governing permissions and
; limitations under the License.
;
        SUBT    Exported Window Manager constants

OldOpt  SETA    {OPT}
        OPT     OptNoList+OptNoP1List

; ***********************************
; ***    C h a n g e   L i s t    ***
; ***********************************

; Date       Name  Description
; ----       ----  -----------
; 20-Jul-87  NDR   Added change list
; 28-Jul-87  NDR   Put in missing variables & change Wimp to check for them!
; 29-Oct-87  NDR   Add Wimp_ReportError
;  2-Nov-87  NDR   Add Wimp_TaskHandle
;  3-Nov-87  NDR   Remove Wimp_TaskHandle
; 26-Nov-87  NDR   Add Wimp_GetWindowOutline
; 21-Jan-88  NDR   Add Wimp_PollIdle
; 26-Jan-88  NDR   Add Wimp_SetMode
; 28-Jan-88  NDR   Add Wimp_SetPalette and Wimp_ReadPalette
; 29-Jan-88  NDR   Add Wimp_SetColour
;  8-Feb-88  NDR   Add Wimp_SendMessage
; 15-Feb-88  NDR   Add Wimp_MergeSpriteFile and Wimp_BaseOfSprites
; 16-Feb-88  NDR   Add Wimp_BlockCopy
; 25-Feb-88  NDR   Add Wimp_SlotSize
; 29-Feb-88  NDR   Add Wimp message action numbers as well
;  2-Mar-88  NDR   Add Wimp_ReadPixTrans
; 21-Mar-88  NDR   Add Wimp_ClaimFreeMemory
; 12-Apr-88  NDR   Add Wimp_CommandWindow
; 14-Apr-88  NDR   Add Wimp_TextColour
; 18-May-88  NDR   Add Wimp_TransferBlock
; 23-May-88  NDR   Add Wimp_ReadSysInfo
; 21-Jun-88  NDR   Changed Wimp_MergeSpriteFile to Wimp_SpriteOp
;  5-Jul-88  NDR   Add Wimp_SetFontColours
; 27-Jul-89  NDR   Added Wimp_GetMenuState (Wimp 2.18 onwards)
; 26-Feb-90  NDR   Added WimpPriority settings
; 30-Nov-90  RM    Added Wimp_RegisterFilter
; 18-Jul-91  RM    Added Wimp_AddMessages
; 03-Dec-91  DDV   Added Wimp_SetColourMapping
; 10-Jan-92  DDV   Added list of ReadSysInfo requests
; 17-Jan-92  DDV   Split off Task Manager SWIs section
; 30-Jan-92  DDV   Added list of filter reasons
; 13-Feb-92  DDV   Inserted Wimp_RemoveMessages (before SetColourMapping)
; 18-Feb-92  DDV   Added WimpSysInfo_CurrentTask
; 03-Apr-92  LRust Added WimpSysInfo_WimpVersion and WimpValidation definitions
; 15-Apr-92  DDV   Added token for the Interface Manager in WimpValidation defs.
; 23-Mar-93  NK    Added Wimp_GetIconInfo SWI call.
; 12-Jul-93  SMC   Added WimpPriority_ModeChooser.
; 15-Jul-93  NK    Added SWIs SetWatchdogState,Extend and ResizeIcon
;                  Added Macro BL_Wimp for direct calling of wimp code
;                  Added new codes for ReadSysInfo
; 20-Aug-93  NK    Changed GetIconInfo to TextOp
; 31-Jan-94  NK    Added reason codes
; 02-Aug-94  AMcC  Changed to using the preferred SWI base and name symbols
; 18-Aug-94  SMC   Fixed MED-03541 and MED-03390: Wimp failed to lookup error/button texts
;

        GBLL    Included_Hdr_Wimp
Included_Hdr_Wimp SETL {TRUE}

SWIClass        SETS    WimpSWI_Name

        ^       WimpSWI_Base

        AddSWI  Initialise              ; &400C0
        AddSWI  CreateWindow            ; &400C1
        AddSWI  CreateIcon              ; &400C2
        AddSWI  DeleteWindow            ; &400C3
        AddSWI  DeleteIcon              ; &400C4
        AddSWI  OpenWindow              ; &400C5
        AddSWI  CloseWindow             ; &400C6
        AddSWI  Poll                    ; &400C7
        AddSWI  RedrawWindow            ; &400C8
        AddSWI  UpdateWindow            ; &400C9
        AddSWI  GetRectangle            ; &400CA
        AddSWI  GetWindowState          ; &400CB
        AddSWI  GetWindowInfo           ; &400CC
        AddSWI  SetIconState            ; &400CD
        AddSWI  GetIconState            ; &400CE
        AddSWI  GetPointerInfo          ; &400CF
        AddSWI  DragBox                 ; &400D0
        AddSWI  ForceRedraw             ; &400D1
        AddSWI  SetCaretPosition        ; &400D2
        AddSWI  GetCaretPosition        ; &400D3
        AddSWI  CreateMenu              ; &400D4
        AddSWI  DecodeMenu              ; &400D5
        AddSWI  WhichIcon               ; &400D6
        AddSWI  SetExtent               ; &400D7
        AddSWI  SetPointerShape         ; &400D8
        AddSWI  OpenTemplate            ; &400D9
        AddSWI  CloseTemplate           ; &400DA
        AddSWI  LoadTemplate            ; &400DB
        AddSWI  ProcessKey              ; &400DC
        AddSWI  CloseDown               ; &400DD
        AddSWI  StartTask               ; &400DE
        AddSWI  ReportError             ; &400DF
        AddSWI  GetWindowOutline        ; &400E0
        AddSWI  PollIdle                ; &400E1
        AddSWI  PlotIcon                ; &400E2
        AddSWI  SetMode                 ; &400E3
        AddSWI  SetPalette              ; &400E4
        AddSWI  ReadPalette             ; &400E5
        AddSWI  SetColour               ; &400E6
        AddSWI  SendMessage             ; &400E7
        AddSWI  CreateSubMenu           ; &400E8
        AddSWI  SpriteOp                ; &400E9
        AddSWI  BaseOfSprites           ; &400EA
        AddSWI  BlockCopy               ; &400EB
        AddSWI  SlotSize                ; &400EC
        AddSWI  ReadPixTrans            ; &400ED
        AddSWI  ClaimFreeMemory         ; &400EE
        AddSWI  CommandWindow           ; &400EF
        AddSWI  TextColour              ; &400F0
        AddSWI  TransferBlock           ; &400F1
        AddSWI  ReadSysInfo             ; &400F2
        AddSWI  SetFontColours          ; &400F3
        AddSWI  GetMenuState            ; &400F4        Wimp 2.18 onwards
        AddSWI  RegisterFilter          ; &400F5        Wimp 2.85 onwards
        AddSWI  AddMessages             ; &400F6        Wimp 2.95 onwards
        AddSWI  RemoveMessages          ; &400F7        Wimp 3.05 onwards
        AddSWI  SetColourMapping        ; &400F8
        AddSWI  TextOp                  ; &400F9        Wimp 3.23 onwards
        AddSWI  SetWatchdogState        ; &400FA        Wimp 3.22 onwards
        AddSWI  Extend                  ; &400FB
        AddSWI  ResizeIcon              ; &400FC
        AddSWI  AutoScroll              ; &400FD        Wimp 4.00 onwards
;       AddSWI  MiscOp                  ; &400FE

; Service calls

  [ :LNOT::DEF: WimpService ; While migrating to Hdr:Services 
WimpService                     *       &400C0
  ]
                                ^       WimpService
  [ :LNOT::DEF: Service_ErrorStarting ; While migrating from Hdr:Services
Service_ErrorStarting           #       1
Service_ErrorButtonPressed      #       1
Service_ErrorEnding             #       1
  ]
                                GBLA    Service_WimpToolSpritesChanged
Service_WimpToolSpritesChanged  SETA    WimpService+3

; ReadSysInfo reason codes
                                ^       0
WimpSysInfo_TasksActive         #       1
WimpSysInfo_Mode                #       1
WimpSysInfo_ReadSpriteSuffix    #       1
WimpSysInfo_DesktopState        #       1
WimpSysInfo_WriteDirection      #       1
WimpSysInfo_CurrentTask         #       1
WimpSysInfo_Swapping            #       1               ; reserved for swapping Window Manager
WimpSysInfo_WimpVersion         #       1
WimpSysInfo_SystemFont          #       1
WimpSysInfo_ToolSprites         #       1
WimpSysInfo_IconBar             #       1
WimpSysInfo_AppSpaceSize        #       1
WimpSysInfo_MessagesDebug       #       1               ; debugging only
WimpSysInfo_MemoryDebug         #       1               ; debugging only
WimpSysInfo_TransTables         #       1               ; internal use
WimpSysInfo_IconiseButton       #       1               ; disabled in Wimp 3.99 onwards
WimpSysInfo_BaseOfSprites       #       1               ; Wimp 3.99 onwards
WimpSysInfo_ScrollPause         #       1               ; Wimp 3.99 onwards
WimpSysInfo_Reserved_ROL18      #       1               ; RISC OS Select
WimpSysInfo_Reserved_ROL19      #       1               ; RISC OS Select
WimpSysInfo_Reserved_ROL20      #       1               ; RISC OS Select
WimpSysInfo_Reserved_ROL21      #       1               ; RISC OS Select
WimpSysInfo_Reserved_ROL22      #       1               ; RISC OS Select
WimpSysInfo_DragPause           #       1               ; Wimp 5.14 onwards
WimpSysInfo_DoubleClickPause    #       1               ; Wimp 5.14 onwards
WimpSysInfo_AutoMenuPause       #       1               ; Wimp 5.14 onwards
WimpSysInfo_IconbarFactors      #       1               ; Wimp 5.14 onwards
WimpSysInfo_Reserved_ROL27      #       1               ; RISC OS Select
WimpSysInfo_ThreeDFlags         #       1               ; Wimp 5.14 onwards
WimpSysInfo_AlphaSprites        #       1               ; Wimp 5.35 onwards
WimpSysInfo_MAX                 #       0

; Extend reason codes
                                ^       1
WimpExtend_Workspace            #       1               ;  1 Private
WimpExtend_Jumptable            #       1               ;  2 Private
WimpExtend_SWICallback          #       1               ;  3 Private
WimpExtend_SpriteNamePointers   #       1               ;  4 Private
WimpExtend_TilingCallback       #       1               ;  5 Private
WimpExtend_Parent               #       1               ;  6
WimpExtend_FrontChild           #       1               ;  7
WimpExtend_BackChild            #       1               ;  8
WimpExtend_SiblingAbove         #       1               ;  9
WimpExtend_SiblingBehind        #       1               ; 10
WimpExtend_GetBorderInfo        #       1               ; 11 Wimp 3.99 onwards
WimpExtend_NCErrorPointerSuspend #      1               ; 12 Private/STB-only
WimpExtend_SpriteSuffix         #       1               ; 13 Wimp 4.85 onwards
WimpExtend_MAX                  #       0

WimpExtend_SpriteSuffix_ROL     *       257             ; ROOL Wimp 5.35 onwards
WimpExtend_SpriteColourmap_ROL  *       258             ; ROOL unimplemented

; TextOp

Wimp_SetTextColour              *       0
Wimp_TextWidth                  *       1
Wimp_RenderText                 *       2

WimpTextOp_RightJustify         *       1 :SHL: 31
WimpTextOp_VerticalJustify      *       1 :SHL: 30
WimpTextOp_Style                *       1 :SHL: 29

; Priority for Wimp_CreateIcon (iconbar)

WimpPriority_Maximum            *       &78000000       ; used for handle = -3 or -4

WimpPriority_TaskManager        *       &60000000
WimpPriority_Help               *       &40000000
WimpPriority_Palette            *       &20000000
WimpPriority_ModeChooser        *       &20000000
WimpPriority_Apps               *       &00000000
WimpPriority_Utilities          *      -&40000000

WimpPriority_HardDiscs          *       &70000000
WimpPriority_FloppyDiscs        *       &60000000
WimpPriority_ResourceFS         *       &50000000
WimpPriority_RAMFS              *       &40000000
WimpPriority_Ethernet           *       &30000000
WimpPriority_Econet             *       &20000000
WimpPriority_OtherFS            *       &10000000
WimpPriority_Printers           *       &0F000000
WimpPriority_TinyDirs           *       &0E000000
WimpPriority_HFS                *       &0D000000

; Reason codes passed to Wimp_RegisterFilter

                                ^       0
WimpFilter_PrePoll              #       1
WimpFilter_PostPoll             #       1
WimpFilter_BlockCopy            #       1
WimpFilter_GetRectangle         #       1
WimpFilter_PostGetRectangle	#	1
WimpFilter_PostIconGetRectangle #	1
WimpFilter_MAX                  #       0


; Validation string commands

WimpValidation_Allow            * 'A'           ; Allow following chars
WimpValidation_InterfaceModule  * 'B'           ; Border type used by interface module
WimpValidation_Colour           * 'C'           ; Select icon colours (in 24-bit)
WimpValidation_Display          * 'D'           ; Display char following for password
WimpValidation_Font             * 'F'           ; Select font foreground/background hex colours
WimpValidation_Key              * 'K'           ; Allow wimp key processing
WimpValidation_Line             * 'L'           ; Set line spacing in OS units
WimpValidation_Name             * 'N'           ; Used by some template editors
WimpValidation_Pointer          * 'P'           ; Set pointer from sprite name and active posn
WimpValidation_Border           * 'R'           ; Border type
WimpValidation_Sprite           * 'S'           ; Sprite name
WimpValidation_CharLimit        * 'U'           ; Max number of Unicode characters allowed
WimpValidation_NoAuto           * 'X'           ; wimp doesn't auto size iconbar icons

WimpValidationKey_Return        * 'R'           ; Handle return key
WimpValidationKey_Arrow         * 'A'           ; Handle arrow keys
WimpValidationKey_Tab           * 'T'           ; Handle tab key
WimpValidationKey_Edit          * 'D'           ; Notify task of editing keys
WimpValidationKey_Any           * 'N'           ; Notify task of any key

        MACRO
$label  BL_Wimp $n
$label
        Push    "R12"
        LDR     R14,wimpextend
        LDR     R12,wimpr12
        ADD     R14,R14,$n
        Push    "R14"
        MOV     R14,PC                ; points to pull R12
        Pull    "PC"

        NOP
        Pull    "R12"
;        NOP
        MEND

        OPT     OldOpt

        END

@


4.9
log
@  Fix detection of Hdr:Wimp being included before Hdr:Services
Detail:
  The trick used only works with variable name symbols; other symbols remain
  defined after the end of the first pass of assembly
Admin:
  Should enable us to track down components that will need changing from
  examination of the build logs
@
text
@d72 3
@


4.8
log
@Change Wimp_ReadSysInfo 2 to not return alpha sprite names. Add Wimp_ReadSysInfo 29 and Wimp_Extend 257.
Detail:
  s/Wimp01 - Change romspr_suffix initialisation so that it won't store alpha sprite suffixes. This has the knock-on effect of making Wimp_ReadSysInfo 2 no longer return alpha sprite suffixes, without affecting any of the sprite search code
  hdr/Wimp, s/Wimp01 - Add Wimp_ReadSysInfo 29 to read the alphaspriteflag value - i.e. whether alpha sprites are supported by the OS/Wimp and *IconSprites, Wimp_Extend 13, etc. will look for them
  hdr/Wimp - Document the private Wimp_Extend reason codes and add a couple of ROL's reason codes
  s/NewSWIs - Tidy up Wimp_Extend implementation to use a jump table instead of a load of tests and branches. Add an implementation of ROL's Wimp_Extend 257, which just acts as a wrapper around Wimp_Extend 13
Admin:
  Tested on Raspberry Pi
  Wimp_ReadSysInfo 2 change should fix issue reported on forums with software unexpectedly using low-res sprites or failing altogether:
  http://www.riscosopen.org/forum/forums/4/topics/2274


Version 5.35. Tagged as 'Wimp-5_35'
@
text
@d151 2
a152 2
                                ^       WimpService+3
Service_WimpToolSpritesChanged  #       1
@


4.7
log
@3 minor fixes, 2 minor enhancements
Makefile:
* Conditionally copy the disc resources, saving a little build time.
Wimp10.s; hdr/Wimp:
* Issue Service_WimpToolSpritesChanged when the tool sprite area is changed.
Wimp05:
* Fix bug in softloaded versions of the Wimp where menus would randomly lose the keyboard shortcut text. This was caused by use of an LDR to retrieve a byte wide variable. This specifically affected some softloads because the Wimp gets squeezed, and during unsqueezing the Wimp's workspace ends up being allocated from the same bit of RMA that used to contain the squeezed copy of the module (=lots of random numbers).
Wimp09:
* Fix bug where configuring WimpSpritePrecedence to ROM when a theme is loaded would cause redrawing of window textures to fail. This is because the Wimp intersects the ROM and RAM sprite areas and deletes any duplicates from the RAM area when remaking the fast lookup sprite list. So if the RAM sprites include the "tile_1" (etc) sprite on redrawing the desktop the Wimp points to this, then intersects the lists and deletes the sprite, leaving the pointers pointing at junk. Now, on deleting something, the window tile pointers are invalidated. Fixes ticket #346.
Wimp02:
* Fix bug where the title bar text, when the desktop font is the system font, is incorrectly rendered in the colour selected by WimpVisualFlag -WindowOutlineColour. The Wimp now restores the text colour if -WOC has set the graphics colour to something other than black.

Administrative -
In Wimp01, swap a couple of SpriteReasons from magic numbers. In the init of variables use the common reset_all_tiling_sprite function.
In Tiling3D, more SpriteReasons, and rationalise the registers used in reset_all_tiling_sprites.

Version 5.32. Tagged as 'Wimp-5_32'
@
text
@d185 1
d189 14
a202 7
                                ^       6               ; earlier codes are internal use only
WimpExtend_Parent               #       1
WimpExtend_FrontChild           #       1
WimpExtend_BackChild            #       1
WimpExtend_SiblingAbove         #       1
WimpExtend_SiblingBehind        #       1
WimpExtend_GetBorderInfo        #       1               ; Wimp 3.99 onwards
d205 3
@


4.6
log
@Add extra Wimp_ReadSysInfo reasons 23/24/25/26/28.
RISC OS Select has added reasons 18-27 and this change implements those that map directly to features that already exist (unimplemented ones return an error as before).
One additional reason, 28, permits the reading of the flags collected from the *WimpVisualFlags command so that applications can discover if the cheesy 3D borders are on or not.

Version 5.14. Tagged as 'Wimp-5_14'
@
text
@d140 13
@


4.5
log
@Third-party validation string symbol noted for reference.
@
text
@d161 11
@


4.4
log
@UTF-8 support from previous version switched in; additional alphabet-
conditional support added as follows: 
* Correctly converts character index returned from Font_FindCaret into byte
  index into raw string.
* Left-arrow, right-arrow, delete-left and delete-right now act as far as
  the next character boundary, instead of to the next byte.
* Menu item text justification works again (it relies on overwriting spaces
  with hard space characters, which are two-byte characters in UTF-8).
* General key handling code has been rewritten. The Wimp now has three
  internal key input buffers - one each for taking keyboard-generated,
  task-generated, and function-key-generated strings. Each input buffer is
  processed in chunks of one character, rather than one byte; malformed
  UTF-8 characters are rejected, so tasks don't have to worry about them
  (simplifying their character-handling code). There is also a key output
  buffer, to ensure that (UTF-8) sequences of Key_Pressed events are not
  broken up.
* As a result of the above, multiple calls to Wimp_ProcessKey are now
  possible between calls to Wimp_Poll. Previously, this resulted in bytes
  getting jumbled up - making it useless for input of UTF-8 characters.
* Multi-byte characters are inserted into writeable icons in one go, so you
  don't see a brief flicker of the "malformed character" symbol while the
  initial bytes are being inserted.
* Multi-byte characters that don't entirely fit in a writeable icon buffer
  are not inserted at all.
* A new validation string command ("U") can limit the contents of a
  writeable by number of characters, instead of bytes. This will hide the
  character sizes from the user interface.
* Allowable characters (validation string command "A") now works on Unicode
  characters and character ranges.
* Various other minor bugs are fixed (Wimp_ProcessKey 13 can activate a
  writeable menu item, Shift-arrow keys are always consistent in firing off
  Key_Pressed events, etc.)
* Password icons supported: one symbol is displayed for each character
  (instead of for each byte); the display character (validation string
  command "D") can be any UTF-8 character; correctly displays the caret
  after set-caret-by-index calls, even though characters in the processed
  string are different width to those in the raw string, in password icons.
 
Other changes:
* The border around NC-style error boxes is resized when the error window
  is grown or shrunk.
* Messages, CmdHelp and Template files made consistent across resource
  directories, including support for all Ursula features.
* ShrinkableAreas turned back on in System=RCA builds.
* User interface features of desktop OS builds standardised.

Version 4.06. Tagged as 'Wimp-4_06'
@
text
@d226 1
@


4.3
log
@Ursula branch Wimp merged back onto trunk.
@
text
@d229 1
@


4.2
log
@ARTtmp branch folded in
@
text
@d137 2
a138 1
;       AddSWI  MiscOp                  ; &400FD
d155 6
d163 10
d221 1
@


4.2.2.1
log
@Wimp_ReadSysInfo extended to report width of iconise button (if any)
@
text
@a153 4
WimpSysInfo_MessagesDebug       #       1               ; debugging only
WimpSysInfo_MemoryDebug         #       1               ; debugging only
WimpSysInfo_TransTables         #       1               ; internal use
WimpSysInfo_IconiseButton       #       1
@


4.2.2.2
log
@Added 24-bit colour selections for icons
@
text
@a207 1
WimpValidation_Colour           * 'C'           ; Select icon colours (in 24-bit)
@


4.2.2.3
log
@New features:
Dragboxes can now be clipped by and/or fixed to a given window's work area
SWI Wimp_AutoScroll implemented
Ursula icon highlighting scheme redesigned

Bugfixes:
Wimp_Extend 11 now performs the same check on R1 as the main SWI handling code
Message blocks now updated if in a dynamic area
Screenblanker now turned off when error box is displayed
ptr_double now turned off when a drag starts
@
text
@d137 1
a137 2
        AddSWI  AutoScroll              ; &400FD        Wimp 4.00 onwards
;       AddSWI  MiscOp                  ; &400FE
d157 1
a157 2
WimpSysInfo_IconiseButton       #       1               ; disabled in Wimp 3.99 onwards
WimpSysInfo_BaseOfSprites       #       1
a158 10

; Extend reason codes
                                ^       6               ; earlier codes are internal use only
WimpExtend_Parent               #       1
WimpExtend_FrontChild           #       1
WimpExtend_BackChild            #       1
WimpExtend_SiblingAbove         #       1
WimpExtend_SiblingBehind        #       1
WimpExtend_GetBorderInfo        #       1               ; Wimp 3.99 onwards
WimpExtend_MAX                  #       0
@


4.2.2.4
log
@Redraw of dragboxes when being resized/translated optimised to reduce flicker.

Autoscroll update period extended to 12cs to reduce flicker.

Added Wimp_ReadSysInfo 17 to return configured drag-and-drop scroll startup
delay (in cs) because the CMOS storage isn't easy to read.

Identified and bracketed changes from 3.9x responsible for 24-bit icon colours.

defaultfontcolours now works correctly again.

Introduced new icon colour code. This holds icon colours in 24 bits internally
throughout, rather than treating 24-bit colour specifiers as a special case.
This results in the following bugfixes/improvements:
 * 3D faces and moat colours, and slabbed-in action button backgrounds, can
   all be specified in 24-bits
 * fading of icons is now consistent across icon types, and utilises the
   colour range of >16 colour modes
 * 3D borders now get faded along with the rest of the icon
 * action buttons can now contain sprites (background is correct, and sprite
   is not inverted)
 * various cases where anti-aliasing didn't blend in to the background
   correctly are now fixed
 * conventional and 24-bit specifiers now behave equivalently to each other -
   the same colour specified either way behaves the same when faded, used as
   an EOR colour etc. (greys are now always dithered in 1-bpp modes, even if
   specified in 24-bit)
 * behaviour is now the same whether the Wimp font is the system font or a
   fancy font (amazingly, this wasn't always the case)
 * except for 3D icons, if the icon background matches the work area
   background, it is unaffected by fading - so for example, group boxes can now
   be faded correctly

Switched out AutoHourglass (Mike was concerned about the speed hit).

Corrected *Help syntax strings for On/Off configuration options.
@
text
@d159 1
a159 2
WimpSysInfo_BaseOfSprites       #       1               ; Wimp 3.99 onwards
WimpSysInfo_ScrollPause         #       1               ; Wimp 3.99 onwards
@


4.1
log
@Initial revision
@
text
@d135 1
a135 1
        AddSWI  Extend                  ; &400FB                         
d154 1
a154 1
WimpSysInfo_MAX                 #       0                            
d195 2
@


4.1.7.1
log
@NCOS 1.06 Imported from Zip drive
@
text
@@


4.1.7.2
log
@Rectangle filters not called when caret moves.
Post-rectangle and post-icon filters added.
@
text
@d135 1
a135 1
        AddSWI  Extend                  ; &400FB
d154 1
a154 1
WimpSysInfo_MAX                 #       0
a194 2
WimpFilter_PostGetRectangle	#	1
WimpFilter_PostIconGetRectangle #	1
@


4.1.5.1
log
@Import from SrcFiler
@
text
@@


4.1.3.1
log
@Import from cleaned 370 CD
@
text
@@


4.1.1.1
log
@Import from cleaned 360 CD
@
text
@@
