head	4.11;
access;
symbols
	Desktop-2_77:4.11
	Desktop-2_76:4.11
	Desktop-2_75:4.10
	Desktop-2_74:4.10
	Desktop-2_73:4.10
	Desktop-2_72:4.9
	Desktop-2_71:4.9
	Desktop-2_70:4.8
	Desktop-2_69:4.8
	Desktop-2_68:4.8
	Desktop-2_67:4.8
	Desktop-2_66:4.8
	RO_5_07:4.7
	Desktop-2_65a:4.7
	Desktop-2_65:4.7
	Desktop-2_64:4.6
	Desktop-2_63:4.6
	Desktop-2_62:4.6
	Desktop-2_61:4.5
	Desktop-2_60:4.4
	Desktop-2_59:4.4
	Desktop-2_58:4.4
	Desktop-2_57:4.4
	dcotton_Spin_merge:4.1.7.3
	Desktop-2_56:4.4
	Desktop-2_55:4.3
	Ursula_merge:4.2.2.1
	Ursula_RiscPC_merge:4.2.2.1
	nturton_Desktop-2_54:4.2
	mstphens_UrsulaRiscPCBuild_20Nov98:4.2.2.1
	Ursula_RiscPC:4.2.2.1.0.2
	nicke_Desktop-2_52:4.1.7.3
	rthornb_UrsulaBuild-19Aug1998:4.2.2.1
	UrsulaBuild_FinalSoftload:4.2.2.1
	rthornb_UrsulaBuild-12Aug1998:4.2.2.1
	aglover_UrsulaBuild-05Aug1998:4.2.2.1
	rthornb_UrsulaBuild-29Jul1998:4.2.2.1
	rthornb_UrsulaBuild-22Jul1998:4.2.2.1
	rthornb_UrsulaBuild-15Jul1998:4.2.2.1
	rthornb_UrsulaBuild-07Jul1998:4.2.2.1
	rthornb_UrsulaBuild-17Jun1998:4.2.2.1
	rthornb_UrsulaBuild-03Jun1998:4.2.2.1
	rthornb_UrsulaBuild-27May1998:4.2.2.1
	rthornb_UrsulaBuild-21May1998:4.2.2.1
	rthornb_UrsulaBuild_01May1998:4.2.2.1
	afrost_NC2_Generic:4.1.7.2
	afrost_Funai01-33:4.1.7.2
	Spinner_RCA116:4.1.7.2
	Spinner_B20_2:4.1.7.2
	Spinner_19_3:4.1.7.2
	Spinner_B18:4.1.7.2
	Spinner_B17:4.1.7.2
	Spinner_B15:4.1.7.2
	Spinner_B14:4.1.7.2
	Spinner_B13:4.1.7.2
	Spinner_B12:4.1.7.2
	Spinner_B10:4.1.7.2
	Daytona:4.2.0.6
	Daytona_bp:4.2
	Ursula:4.2.0.2
	Ursula_bp:4.2
	Spinner_B7:4.1.7.2
	RO_3_71:4.1.3.1
	ARTtmp_merge:4.1.7.2
	Spin_3Apr97:4.1.7.2
	RCA_bp:4.2
	ARTtmp:4.1.7.2.0.2
	RCA:4.2.0.4
	Spin_merge:4.1.7.1
	MergeFiles:4.1.3.1
	RO_3_70:4.1.3.1
	NC_1_06:4.1.7.1
	Spinner:4.1.7
	Spin_xx:4.1.5
	NC_xx:4.1.5.1
	RO_3_60:4.1.1.1
	StrongARM:4.1.3
	Black:4.1.1;
locks; strict;
comment	@# @;


4.11
date	2016.05.29.13.52.52;	author rsprowson;	state Exp;
branches;
next	4.10;
commitid	6skpw8kZ6BI4Mn8z;

4.10
date	2012.08.11.20.40.42;	author rsprowson;	state Exp;
branches;
next	4.9;
commitid	5F7c4H8I9uN8Cagw;

4.9
date	2010.07.19.21.27.14;	author jlee;	state Exp;
branches;
next	4.8;

4.8
date	2004.11.12.16.28.16;	author bavison;	state Exp;
branches;
next	4.7;

4.7
date	2003.04.11.08.44.01;	author rsprowson;	state Exp;
branches;
next	4.6;

4.6
date	2001.03.16.17.10.50;	author sbrodie;	state Exp;
branches;
next	4.5;

4.5
date	2001.03.01.13.23.21;	author sforrest;	state Exp;
branches;
next	4.4;

4.4
date	99.11.15.09.46.23;	author dcotton;	state Exp;
branches;
next	4.3;

4.3
date	99.08.17.13.36.08;	author sbrodie;	state Exp;
branches;
next	4.2;

4.2
date	97.01.02.16.52.46;	author nturton;	state Exp;
branches
	4.2.2.1
	4.2.4.1;
next	4.1;

4.1
date	96.11.05.09.29.08;	author nturton;	state Exp;
branches
	4.1.1.1
	4.1.3.1
	4.1.5.1
	4.1.7.1;
next	;

4.2.2.1
date	98.03.26.14.03.03;	author rthornb;	state Exp;
branches;
next	;

4.2.4.1
date	97.04.04.08.36.25;	author nturton;	state Exp;
branches;
next	;

4.1.1.1
date	96.11.05.09.29.08;	author nturton;	state Exp;
branches;
next	;

4.1.3.1
date	96.11.05.23.26.19;	author nturton;	state Exp;
branches;
next	;

4.1.5.1
date	96.11.21.12.14.23;	author nturton;	state Exp;
branches;
next	;

4.1.7.1
date	96.11.29.20.14.54;	author nturton;	state Exp;
branches;
next	4.1.7.2;

4.1.7.2
date	97.03.11.19.12.32;	author nturton;	state Exp;
branches;
next	4.1.7.3;

4.1.7.3
date	98.09.14.12.44.55;	author kbracey;	state Exp;
branches;
next	;


desc
@@


4.11
log
@Remove use of RESOURCEEXTRA
Requires BuildSys-6_91.

Version 2.76. Tagged as 'Desktop-2_76'
@
text
@# Copyright 1996 Acorn Computers Ltd
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
# Makefile for Desktop
#

COMPONENT       = Desktop
INSTRES_FILES   = Sprites Templates
INSTRES_DEPENDS = compress

ifeq (${TARGET},ThemeDefs)
CUSTOMSA        = custom
install: 
        ${MKDIR} ${INSTDIR}.${USERIF}
        ${CP} LocalRes:${USERIF}.Sprites ${INSTDIR}.${USERIF}.Banner ${CPFLAGS}
        @@${ECHO} ${COMPONENT}: disc theme resources installed
endif

compress:
        ${SQUASH} LocalRes:${USERIF}.Sprites Sprites

clean::
        ${RM} Sprites

include StdTools
include AAsmModule

# Dynamic dependencies:
@


4.10
log
@Add option to install disc sprites as a seperate target
Resources phase also simplified a little, given recent AasmModule makefile improvements.

Version 2.73. Tagged as 'Desktop-2_73'
@
text
@d18 3
a20 16
COMPONENT     = Desktop
RESOURCEEXTRA = resources_banner resources_templates

#
# Resource specials
# In ROM
#   This component has messages, a template, and squashed sprites
#   which are copied in the 'resources' phase
# In RAM
#   The 'install' rule produces a RAM loading standalone module
# On disc
#   If the target is the ThemeDefs application, the 'install' rule is
#   overridden to just install the various banner themes
#
resources_banner: LocalRes:<UserIF>.Sprites
        ${SQUASH} LocalRes:<UserIF>.Sprites ${RESFSDIR}.Sprites
d23 1
a23 1
CUSTOMSA = custom
d30 6
@


4.9
log
@Squash the sprites used by the Desktop module
Detail:
  Makefile - Use Squash to compress the startup banner spritefile. Saves about 40k of ROM space.
  s/Desktop - Add code for loading the squashed sprites.
Admin:
  Tested in ROM softload on Iyonix


Version 2.71. Tagged as 'Desktop-2_71'
@
text
@d17 14
a30 6
# ***********************************
# ***    C h a n g e   L i s t    ***
# ***********************************
# Date       Name         Description
# ----       ----         -----------
# 07-Mar-01  SNB          Recreated
d32 2
d35 7
a41 9
COMPONENT = Desktop
RESOURCES = manual

resources:
   ${MKDIR} ${RESFSDIR}
   ${CP}  LocalRes:Messages ${RESFSDIR}.Messages        ${CPFLAGS}
   ${CAT} LocalRes:CmdHelp { >> ${RESFSDIR}.Messages }
   ${CP}  LocalRes:Templates ${RESFSDIR}.Templates      ${CPFLAGS}
   ${SQUASH} LocalRes:<UserIF>.Sprites ${RESFSDIR}.Sprites
a45 8
BBETYPE = desktop
bbe-desktop: bbe-generic-resources-get-alias
        BBE_Export_File_In_Dir Resources.${LOCALE} CmdHelp
        BBE_Export_File_In_Dir Resources.${LOCALE} Messages
        BBE_Export_File_In_Dir Resources.${LOCALE} Templates
        BBE_Export_Dir Resources.${LOCALE}.${USERIF}
        BBE_Export_File VersionNum

@


4.8
log
@  BBE tidying.
Detail:
  Tightened up BBE resources export, to exclude in appropriate files (this
  component has a non-standard resources directory structure).
Admin:
  Tested in a Tungsten BBE build.

Retagged, since this won't affect any existing builds.
@
text
@d33 1
a33 1
   ${CP}  LocalRes:<UserIF>.Sprites ${RESFSDIR}.Sprites ${CPFLAGS}
@


4.7
log
@Now gets the sprites for the startup banner from its own personal
resources rather than from the Wimp pool,then frees them once the
banner has gone.
3 sets of sprites added here
Iyonix = used on Tungsten
Morris4 = L7205 demo actually
Ursula = big green Acorn logo

Version 2.65. Tagged as 'Desktop-2_65'
@
text
@d38 8
@


4.6
log
@  Updated build structure to use the shared AAsmModule makefile.
  Updated to build using objasm instead of aasm.
  Sources changed to be objasm-compatible.
Admin:
  Requires Library 0.71 or later.
  Requires BuildSys 3.06 or later.
  Requires Env 0.65 or later.

Version 2.62. Tagged as 'Desktop-2_62'
@
text
@d26 8
a33 1
RESOURCEEXTRA = resources_templates
@


4.5
log
@
  * Removed dependency on obsolete STB flag.

Detail:

  * No longer relies on the STB flag; instead utilises "Hdr:UserIF.<UserIF>"
    to provide the Embedded_UI flag.

Admin:

  * Built and tested on Lazarus 32-bit build.  Code is binary identical
    to previous version in both STB and non-STB cases.

  * Requires HdrSrc 1.17 or later.

Version 2.61. Tagged as 'Desktop-2_61'
@
text
@d22 1
a22 1
# 25-May-94  AMcC         Created.
a24 14
#
# Generic options:
#
MKDIR   = cdir
AS      = aasm
CP      = copy
RM      = remove
CCFLAGS = -c -depend !Depend -IC:
ASFLAGS = -depend !Depend -Stamp -quit -module -To $@@ -From
CPFLAGS = ~cfr~v

#
# Program specific options:
#
d26 1
a26 35
SOURCE    = s.Desktop
TARGET    = rm.Desktop

#
# Generic rules:
#
rom: ${TARGET}
        @@echo ${COMPONENT}: rom module built

export: ${EXPORTS}
        @@echo ${COMPONENT}: export complete

install_rom: ${TARGET}
        ${CP} ${TARGET} ${INSTDIR}.${COMPONENT} ${CPFLAGS}
        @@echo ${COMPONENT}: rom module installed

clean:
        ${RM} ${TARGET}
        @@echo ${COMPONENT}: cleaned

resources: resources-${CMDHELP}
        @@echo ${COMPONENT}: resource files copied

resources_common:
        ${MKDIR} ${RESDIR}.${COMPONENT}
        TokenCheck LocalRes:Messages
        ${CP} LocalRes:Messages   ${RESDIR}.${COMPONENT}.Messages  ${CPFLAGS}
        ${CP} LocalRes:Templates  ${RESDIR}.${COMPONENT}.Templates  ${CPFLAGS}

resources-None: resources_common
	@@

resources-: resources_common
        TokenCheck LocalRes:CmdHelp
	print LocalRes:CmdHelp { >> ${RESDIR}.${COMPONENT}.Messages }
d28 2
a29 2
${TARGET}: ${SOURCE}
        ${AS} ${ASFLAGS} ${SOURCE}
@


4.4
log
@	Merged the latest changes on Spinner branch.

Detail:
	Needed the localres alterations off the Spinner branch that had been
added since the branch was last merged.
	Added strdepend to the clean phase.

Admin:
	Built locally and on STB build machine.

Version 2.56. Tagged as 'Desktop-2_56'
@
text
@a31 1
STRIP   = stripdepnd
a57 1
        ${STRIP}
@


4.3
log
@  Moved to srccommit.
  Removed dynamic dependencies from Makefile.
  Merged updated desktop startup banner (to RISC OS 4 version)
Detail:
  Banner file updated to RISC OS 4 version in favour of the previous
    RISC OS 3.7 banner.  Does not affecet STB builds.
Admin:

Version 2.55. Tagged as 'Desktop-2_55'
@
text
@d32 1
d59 1
d62 4
a65 1
resources:
d67 10
a76 3
        ${CP} Resources.${LOCALE}.Messages  ${RESDIR}.${COMPONENT}.Messages  ${CPFLAGS}
        ${CP} Resources.${LOCALE}.Templates  ${RESDIR}.${COMPONENT}.Templates  ${CPFLAGS}
        @@echo ${COMPONENT}: resource files copied
@


4.2
log
@Merge of RiscOS 3.70 and NCOS 1.06
@
text
@a69 27
rm.Desktop: Hdr:ListOpts
rm.Desktop: Hdr:Macros
rm.Desktop: Hdr:System
rm.Desktop: Hdr:SWIs
rm.Desktop: Hdr:CPU.Generic26
rm.Desktop: Hdr:IO.GenericIO
rm.Desktop: Hdr:RISCOS
rm.Desktop: Hdr:ModHand
rm.Desktop: Hdr:Services
rm.Desktop: Hdr:Machine.<Machine>
rm.Desktop: Hdr:CMOS
rm.Desktop: Hdr:Proc
rm.Desktop: Hdr:FSNumbers
rm.Desktop: Hdr:HighFSI
rm.Desktop: Hdr:LowFSi
rm.Desktop: Hdr:NewErrors
rm.Desktop: Hdr:Variables
rm.Desktop: Hdr:Wimp
rm.Desktop: Hdr:WimpSpace
rm.Desktop: Hdr:Messages
rm.Desktop: Hdr:ResourceFS
rm.Desktop: Hdr:MsgTrans
rm.Desktop: Hdr:Font
rm.Desktop: Hdr:Draw
rm.Desktop: Hdr:ColourTran
rm.Desktop: Version
rm.Desktop: Hdr:NDRDebug
@


4.2.2.1
log
@Removed dynamic dependancies from Makefiles and removed all reference to Prefix
@
text
@d70 27
@


4.2.4.1
log
@File merged
@
text
@d60 1
a60 4
resources: resources-${CMDHELP}
        @@echo ${COMPONENT}: resource files copied

resources_common:
a63 6

resources-None: resources_common
        @@echo ${COMPONENT}: resource files copied

resources-: resources_common
	print Resources.${LOCALE}.CmdHelp { >> ${RESDIR}.${COMPONENT}.Messages }
@


4.1
log
@Initial revision
@
text
@d63 1
d79 1
@


4.1.7.1
log
@NCOS 1.06 Imported from Zip drive
@
text
@a77 1
rm.Desktop: Hdr:Machine.<Machine>
@


4.1.7.2
log
@Command line messages removed
@
text
@d60 1
a60 4
resources: resources-${CMDHELP}
        @@echo ${COMPONENT}: resource files copied

resources_common:
d63 1
a63 6

resources-None: resources_common
	@@

resources-: resources_common
	print Resources.${LOCALE}.CmdHelp { >> ${RESDIR}.${COMPONENT}.Messages }
@


4.1.7.3
log
@Updated to use LocalRes$Path.
@
text
@d65 1
a65 2
        TokenCheck LocalRes:Messages
        ${CP} LocalRes:Messages  ${RESDIR}.${COMPONENT}.Messages  ${CPFLAGS}
d71 1
a71 2
        TokenCheck LocalRes:CmdHelp
	print LocalRes:CmdHelp { >> ${RESDIR}.${COMPONENT}.Messages }
d77 27
@


4.1.5.1
log
@Import from SrcFiler
@
text
@a75 1
rm.Desktop: Hdr:Machine.<Machine>
a77 1
rm.Desktop: Hdr:Machine.<Machine>
@


4.1.3.1
log
@Import from cleaned 370 CD
@
text
@a62 1
        ${CP} Resources.${LOCALE}.Templates  ${RESDIR}.${COMPONENT}.Templates  ${CPFLAGS}
@


4.1.1.1
log
@Import from cleaned 360 CD
@
text
@@
