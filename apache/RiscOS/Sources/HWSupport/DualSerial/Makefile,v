head	4.6;
access;
symbols
	DualSerial-0_25-4_8_2_16-1:4.4.4.5
	DualSerial-0_25-4_8_2_16:4.4.4.5
	DualSerial-0_25-4_8_2_15:4.4.4.5
	DualSerial-0_25-4_8_2_14:4.4.4.5
	DualSerial-0_25-4_8_2_13:4.4.4.5
	DualSerial-0_25-4_8_2_12:4.4.4.5
	DualSerial-0_25-4_8_2_11:4.4.4.5
	DualSerial-0_29:4.6
	DualSerial-0_25-4_8_2_10:4.4.4.4
	RO_5_07:4.4.4.4
	DualSerial-0_28:4.6
	DualSerial-0_25-4_8_2_9:4.4.4.4
	DualSerial-0_25-4_8_2_8:4.4.4.3
	DualSerial-0_25-4_8_2_7:4.4.4.3
	DualSerial-0_25-4_8_2_6:4.4.4.2
	DualSerial-0_27:4.5
	DualSerial-0_25-4_8_2_5:4.4.4.1
	DualSerial-0_25-4_8_2_4:4.4.4.1
	DualSerial-0_25-4_8_2_3:4.4.4.1
	DualSerial-0_25-4_8_2_2:4.4.4.1
	DualSerial-0_25-4_8_2_1:4.4
	HAL:4.4.0.4
	DualSerial-0_26:4.5
	DualSerial-0_25:4.4
	kbracey_32bit_merge:4.4
	DualSerial-0_24-4_7_2_4:4.4
	DualSerial-0_24-4_7_2_3:4.4
	DualSerial-0_24-4_7_2_2:4.4
	dellis_autobuild_BaseSW:4.4
	DualSerial-0_24-4_7_2_1:4.4
	kbracey_32bit:4.4.0.2
	DualSerial-0_24:4.4
	sbrodie_sedwards_16Mar2000:4.4
	DualSerial-0_23:4.4
	dcotton_autobuild_BaseSW:4.5
	DualSerial-0_22:4.4
	mstphens_UrsulaRiscPCBuild_20Nov98:4.2.2.3
	Ursula_RiscPC:4.2.2.3.0.2
	DualSerial-0_21:4.3
	DualSerial-0_18:4.3
	Daytona_merge:4.2
	DualSerial-0_17:4.3
	rthornb_UrsulaBuild-19Aug1998:4.2.2.3
	UrsulaBuild_FinalSoftload:4.2.2.3
	rthornb_UrsulaBuild-12Aug1998:4.2.2.3
	aglover_UrsulaBuild-05Aug1998:4.2.2.3
	rthornb_UrsulaBuild-29Jul1998:4.2.2.3
	rthornb_UrsulaBuild-22Jul1998:4.2.2.3
	wturner_DualSerial-0_20:4.2.2.3
	rthornb_UrsulaBuild-15Jul1998:4.2.2.1
	rthornb_UrsulaBuild-07Jul1998:4.2.2.1
	rthornb_UrsulaBuild-17Jun1998:4.2.2.1
	rthornb_UrsulaBuild-03Jun1998:4.2.2.1
	rthornb_UrsulaBuild-27May1998:4.2.2.1
	rthornb_UrsulaBuild-21May1998:4.2.2.1
	rthornb_UrsulaBuild_01May1998:4.2.2.1
	afrost_NC2_Generic:4.1.7.2
	Spinner_B20_2:4.1.7.2
	Spinner_19_3:4.1.7.2
	Spinner_B18:4.1.7.2
	Spinner_B17:4.1.7.2
	Spinner_B15:4.1.7.2
	Spinner_B14:4.1.7.2
	Spinner_B13:4.1.7.2
	Spinner_B12:4.1.7.2
	Spinner_B10:4.1.7.2
	Daytona:4.2.0.6
	Daytona_bp:4.2
	Ursula:4.2.0.2
	Ursula_bp:4.2
	Spinner_B7:4.1.7.2
	ARTtmp_merge:4.1.7.2
	Spin_3Apr97:4.1.7.2
	ARTtmp:4.1.7.2.0.2
	RCA:4.2.0.4
	Spin_merge:4.1.7.2
	MergeFiles:4.1.7.1
	NC_1_06:4.1.7.1
	Spinner:4.1.7
	Spin_xx:4.1.5
	NC_xx:4.1.5.1;
locks; strict;
comment	@# @;


4.6
date	2004.07.31.19.47.04;	author srevill;	state Exp;
branches;
next	4.5;

4.5
date	2001.03.16.15.55.52;	author sbrodie;	state Exp;
branches;
next	4.4;

4.4
date	99.08.16.17.04.21;	author kbracey;	state Exp;
branches
	4.4.4.1;
next	4.3;

4.3
date	98.09.21.14.21.45;	author kbracey;	state Exp;
branches;
next	4.2;

4.2
date	97.01.22.13.37.59;	author nturton;	state Exp;
branches
	4.2.2.1;
next	4.1;

4.1
date	96.11.21.12.06.22;	author nturton;	state Exp;
branches
	4.1.5.1
	4.1.7.1;
next	;

4.4.4.1
date	2001.03.20.13.13.46;	author kbracey;	state Exp;
branches;
next	4.4.4.2;

4.4.4.2
date	2003.03.29.18.20.23;	author kbracey;	state Exp;
branches;
next	4.4.4.3;

4.4.4.3
date	2003.03.31.09.28.06;	author rsprowson;	state Exp;
branches;
next	4.4.4.4;

4.4.4.4
date	2004.07.13.14.26.26;	author srevill;	state Exp;
branches;
next	4.4.4.5;

4.4.4.5
date	2012.06.04.23.36.03;	author jlee;	state Exp;
branches;
next	;
commitid	lqDFJl0aX8rOLr7w;

4.2.2.1
date	98.03.26.14.59.08;	author rthornb;	state Exp;
branches;
next	4.2.2.2;

4.2.2.2
date	98.07.21.13.19.27;	author wturner;	state dead;
branches;
next	4.2.2.3;

4.2.2.3
date	98.07.21.14.34.34;	author wturner;	state Exp;
branches;
next	;

4.1.5.1
date	96.11.21.12.06.22;	author nturton;	state Exp;
branches;
next	;

4.1.7.1
date	96.11.29.20.45.32;	author nturton;	state Exp;
branches;
next	4.1.7.2;

4.1.7.2
date	97.01.29.15.05.59;	author nturton;	state Exp;
branches;
next	;


desc
@@


4.6
log
@  Tiny tweak to makefile.
Detail:
  You can specify the target as a build option.
Admin:
  Tested in STB Baseline build.

Version 0.28. Tagged as 'DualSerial-0_28'
@
text
@# Copyright 1996 Acorn Computers Ltd
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
# Makefile for Serial
#
# ***********************************
# ***    C h a n g e   L i s t    ***
# ***********************************
# Date       Name         Description
# ----       ----         -----------
# 07-Mar-01  SNB          Recreated
#

#
# Program specific options:
#

COMPONENT  = DualSerial
TARGET    ?= Serial
ROM_SOURCE = init.s
CHEADER1   = serial
EXPORTS    = ${C_EXP_HDR}.${CHEADER1}

include StdTools
include AAsmModule

# Dynamic dependencies:
@


4.5
log
@  Updated build structure to use the shared AAsmModule makefile.
  Updated to build using objasm instead of aasm.
  Sources changed to be objasm-compatible.
Admin:
  Requires Library 0.71 or later.
  Requires BuildSys 3.06 or later.
  Requires Env 0.65 or later.

Version 0.26. Tagged as 'DualSerial-0_26'
@
text
@d30 1
a30 1
TARGET     = Serial
@


4.4
log
@Service call table added.

Version 0.22. Tagged as 'DualSerial-0_22'
@
text
@d22 1
a22 2
# 29-Mar-96 Rich Buckley  Created
# 09-Sep-96 Rich Buckley  Added export
a25 18
# Paths
#
EXP_HDR = <export$dir>
EXP_C_H = <Cexport$dir>.h
EXP_C_O = <Cexport$dir>.o

#
# Generic options:
#
MKDIR   = cdir
AS      = aasm
CP      = copy
RM      = remove
CCFLAGS = -c -depend !Depend -IC:
ASFLAGS = -depend !Depend -Stamp -quit -module -To $@@ -From
CPFLAGS = ~cfr~v

#
a27 34
COMPONENT  = Serial
SOURCE     = s.init
SOURCESA   = s.standalone
TARGET     = rm.${COMPONENT}
TARGETSA   = ${COMPONENT}
EXPORTS    = ${EXP_C_H}.${COMPONENT}

#
# Generic rules:
#
rom: ${TARGET}
        @@echo ${COMPONENT}: rom module built

export: ${EXPORTS}
        @@echo ${COMPONENT}: export complete

install_rom: ${TARGET}
        ${CP} ${TARGET} ${INSTDIR}.${COMPONENT} ${CPFLAGS}
        @@echo ${COMPONENT}: rom module installed

install: ${TARGET}
        ${CP} ${TARGET} ${INSTDIR}.${COMPONENT} ${CPFLAGS}
        @@echo ${COMPONENT}: module installed

clean:
        ${RM} ${TARGET}
        ${RM} ${TARGETSA}
        @@echo ${COMPONENT}: cleaned

resources:
        ${MKDIR} ${RESDIR}.${COMPONENT}
	TokenCheck LocalRes:Messages
        ${CP} LocalRes:Messages  ${RESDIR}.${COMPONENT}.Messages  ${CPFLAGS}
        @@echo ${COMPONENT}: resource files copied
d29 5
a33 2
all: ${TARGETSA}
        @@echo ${COMPONENT}: standalone module built
d35 2
a36 8
${TARGET}: ${SOURCE}
        ${AS} ${ASFLAGS} ${SOURCE}
        
${TARGETSA}: ${SOURCESA}
        ${AS} ${ASFLAGS} ${SOURCESA}
        
${EXP_C_H}.${COMPONENT}:	h.${COMPONENT}
        ${CP} h.${COMPONENT} $@@ ${CPFLAGS}
@


4.4.4.1
log
@Second attempt to check this in.

Version 0.25, 4.8.2.2. Tagged as 'DualSerial-0_25-4_8_2_2'
@
text
@d41 1
a41 1
ASFLAGS =  -throwback -depend !Depend -Stamp -quit -module -To $@@ -From
@


4.4.4.2
log
@Change to DTR/RTS handling.

Version 0.25, 4.8.2.6. Tagged as 'DualSerial-0_25-4_8_2_6'
@
text
@d47 1
a47 1
COMPONENT  = DualSerial
d77 1
a77 1
        ${MKDIR} ${RESDIR}.DualSerial
d79 1
a79 1
        ${CP} LocalRes:Messages  ${RESDIR}.DualSerial.Messages  ${CPFLAGS}
@


4.4.4.3
log
@Change to use objasm (the non HAL one already has): fixes report that
it blew messagetrans away when rmkilled.
Change to have a zero in the command table word: fixes report that
serialinfo and serialtest don't do anything,indeed they don't in this
HAL version!

Version 0.25, 4.8.2.7. Tagged as 'DualSerial-0_25-4_8_2_7'
@
text
@d22 2
a23 1
# 07-Mar-01  SNB          Recreated
d27 18
d47 19
d67 17
a83 6
COMPONENT  = DualSerial
TARGET     = DualSerial
ROM_SOURCE = init.s
RAM_SOURCE = init.s
CHEADER1   = serial
EXPORTS    = ${C_EXP_HDR}.${CHEADER1}
d85 8
a92 2
include StdTools
include AAsmModule
@


4.4.4.4
log
@  Changed makefile so that you can override the default TARGET
Admin:
  Tested in STB Baseline build

Version 0.25, 4.8.2.9. Tagged as 'DualSerial-0_25-4_8_2_9'
@
text
@d30 1
a30 1
TARGET    ?= DualSerial
@


4.4.4.5
log
@Rewrite module to add support for acting as a client of SerialSupport
Detail:
  In order to act as a client of SerialSupport, DualSerial needs to support the set of device calls that SerialSupport uses to talk to the serial driver.
  This set of device calls operates at a lower level than the IOCtl interface which DualSerial already supports.
  Therefore simply adding the new device call interface ontop of DualSerial (or modifying SerialSupport to add IOCtl support) would have been a risky venture, due to the many complexities hidden in the Serial module sources.
  So to reduce the amount of risk inherent in the change, I've instead taken the Serial module, stripped out 6551 support, rewritten the 710 interface to use HAL calls, and then bolted the IOCtl interface on top.
  This should ensure the SerialSupport/OS_SerialOp interface is identical to that provided by the Serial module, and only the simpler to understand DualSerial/IOCtl interface is the one likely to contain any bugs.
  File changes:
  - Docs/serial.htm - Added a copy of the IOCtl interface docs, from the Ursula branch
  - s/common, s/errors, s/init, s/macros, s/main - New implementation of the module, based around modified Serial sources
  - s/serialhal - The business end of the module, based around s/Serial710 in the Serial sources
  - s/ioctl - New file containing reimplemented IOCtl interface
  - s/devicecall, s/hardware, s/interrupts, s/standalone - Deleted redundant files from old implementation
  - Makefile - Trimmed somewhat redundant comment
  - resources/UK/messages - Added new error messages
Admin:
  Tested in OMAP3 & Tungsten ROMs


Version 0.25, 4.8.2.11. Tagged as 'DualSerial-0_25-4_8_2_11'
@
text
@d25 4
@


4.3
log
@Makefile changed to use LocalRes$Path.
Changed to use srccommit.
Spinner branch merged.

Version 0.17. Tagged as 'DualSerial-0_17'
@
text
@a94 31
rm.Serial: Hdr:ListOpts
rm.Serial: Hdr:NdrDebug
rm.Serial: Hdr:Macros
rm.Serial: Hdr:System
rm.Serial: Hdr:SWIs
rm.Serial: Hdr:CPU.Generic26
rm.Serial: Hdr:IO.GenericIO
rm.Serial: Hdr:RISCOS
rm.Serial: Hdr:Machine.<Machine>
rm.Serial: Hdr:Machine.Machine
rm.Serial: Hdr:ModHand
rm.Serial: Hdr:HighFSI
rm.Serial: Hdr:DevNos
rm.Serial: Hdr:Services
rm.Serial: Hdr:Symbols
rm.Serial: Hdr:MsgTrans
rm.Serial: Hdr:Proc
rm.Serial: Hdr:Buffer
rm.Serial: Hdr:ResourceFS
rm.Serial: Hdr:DeviceFS
rm.Serial: Hdr:IO.IOEB
rm.Serial: Hdr:IO.IOC
rm.Serial: Hdr:RS423
rm.Serial: Hdr:IO.IOMDL
rm.Serial: VersionASM
rm.Serial: s.errors
rm.Serial: s.macros
rm.Serial: s.main
rm.Serial: s.hardware
rm.Serial: s.interrupts
rm.Serial: s.devicecall
@


4.2
log
@Version Spin_merge taken
@
text
@d78 2
a79 1
        ${CP} Resources.${LOCALE}.Messages  ${RESDIR}.${COMPONENT}.Messages  ${CPFLAGS}
a94 31
Serial: s.init
Serial: Hdr:ListOpts
Serial: Hdr:NdrDebug
Serial: Hdr:Macros
Serial: Hdr:System
Serial: Hdr:SWIs
Serial: Hdr:CPU.Generic26
Serial: Hdr:IO.GenericIO
Serial: Hdr:RISCOS
Serial: Hdr:Machine.<Machine>
Serial: Hdr:ModHand
Serial: Hdr:HighFSI
Serial: Hdr:DevNos
Serial: Hdr:Services
Serial: Hdr:Symbols
Serial: Hdr:MsgTrans
Serial: Hdr:Proc
Serial: Hdr:Buffer
Serial: Hdr:ResourceFS
Serial: Hdr:DeviceFS
Serial: Hdr:IO.IOEB
Serial: Hdr:IO.IOC
Serial: Hdr:RS423
Serial: Hdr:IO.IOMDL
Serial: Version
Serial: s.errors
Serial: s.macros
Serial: s.main
Serial: s.hardware
Serial: s.interrupts
Serial: s.devicecall
d104 1
d119 1
a119 1
rm.Serial: Version
@


4.2.2.1
log
@Removed dynamic dependancies from Makefiles and removed all reference to Prefix
@
text
@d94 61
@


4.2.2.2
log
@*** empty log message ***
@
text
@@


4.2.2.3
log
@A couple of superficial changes to the file structure have resulted in CVS
needing this complete deletion/recreation.

Basically, the IOCtl code is getting too big to be tacked onto the
DeviceCall file. So this has been split into the file 'IOCtls'. Given that
this alone is enough to stuff CVS, the opportunity was taken to rename the
'Init' file to 'GetAll', as it doesn't init anything, and Gets all the files
, GetAll being the traditional name for such a file.

Additionally, a Docs directory has been added, which contains a copy of the
functional spec, which will hopefully be kept up to date. Also this directory
is for miscellaneous files which may aid understanding of the thought processes
which led to various bits of code or design decisions, namely the Ursula file
at the present moment.
@
text
@d48 2
a49 2
SOURCE     = s.GetAll
SOURCESA   = s.Standalone
a93 32
Serial: s.GetAll
Serial: Hdr:ListOpts
Serial: Hdr:NdrDebug
Serial: Hdr:Macros
Serial: Hdr:System
Serial: Hdr:SWIs
Serial: Hdr:CPU.Generic26
Serial: Hdr:IO.GenericIO
Serial: Hdr:RISCOS
Serial: Hdr:Machine.<Machine>
Serial: Hdr:ModHand
Serial: Hdr:HighFSI
Serial: Hdr:DevNos
Serial: Hdr:Services
Serial: Hdr:Symbols
Serial: Hdr:MsgTrans
Serial: Hdr:Proc
Serial: Hdr:Buffer
Serial: Hdr:ResourceFS
Serial: Hdr:DeviceFS
Serial: Hdr:IO.IOEB
Serial: Hdr:IO.IOC
Serial: Hdr:RS423
Serial: Hdr:IO.IOMDL
Serial: Version
Serial: s.errors
Serial: s.macros
Serial: s.main
Serial: s.hardware
Serial: s.interrupts
Serial: s.devicecall
Serial: s.IOCtls
@


4.1
log
@Initial revision
@
text
@a93 30
rm.Serial: Hdr:ListOpts
rm.Serial: Hdr:NdrDebug
rm.Serial: Hdr:Macros
rm.Serial: Hdr:System
rm.Serial: Hdr:SWIs
rm.Serial: Hdr:CPU.Generic26
rm.Serial: Hdr:IO.GenericIO
rm.Serial: Hdr:RISCOS
rm.Serial: Hdr:Machine.<Machine>
rm.Serial: Hdr:ModHand
rm.Serial: Hdr:HighFSI
rm.Serial: Hdr:DevNos
rm.Serial: Hdr:Services
rm.Serial: Hdr:Symbols
rm.Serial: Hdr:MsgTrans
rm.Serial: Hdr:Proc
rm.Serial: Hdr:Buffer
rm.Serial: Hdr:ResourceFS
rm.Serial: Hdr:DeviceFS
rm.Serial: Hdr:IO.IOEB
rm.Serial: Hdr:IO.IOC
rm.Serial: Hdr:RS423
rm.Serial: Hdr:IO.IOMDL
rm.Serial: Version
rm.Serial: s.errors
rm.Serial: s.macros
rm.Serial: s.main
rm.Serial: s.hardware
rm.Serial: s.interrupts
rm.Serial: s.devicecall
d125 30
@


4.1.7.1
log
@NCOS 1.06 Imported from Zip drive
@
text
@d94 30
a154 30
rm.Serial: Hdr:ListOpts
rm.Serial: Hdr:NdrDebug
rm.Serial: Hdr:Macros
rm.Serial: Hdr:System
rm.Serial: Hdr:SWIs
rm.Serial: Hdr:CPU.Generic26
rm.Serial: Hdr:IO.GenericIO
rm.Serial: Hdr:RISCOS
rm.Serial: Hdr:Machine.<Machine>
rm.Serial: Hdr:ModHand
rm.Serial: Hdr:HighFSI
rm.Serial: Hdr:DevNos
rm.Serial: Hdr:Services
rm.Serial: Hdr:Symbols
rm.Serial: Hdr:MsgTrans
rm.Serial: Hdr:Proc
rm.Serial: Hdr:Buffer
rm.Serial: Hdr:ResourceFS
rm.Serial: Hdr:DeviceFS
rm.Serial: Hdr:IO.IOEB
rm.Serial: Hdr:IO.IOC
rm.Serial: Hdr:RS423
rm.Serial: Hdr:IO.IOMDL
rm.Serial: Version
rm.Serial: s.errors
rm.Serial: s.macros
rm.Serial: s.main
rm.Serial: s.hardware
rm.Serial: s.interrupts
rm.Serial: s.devicecall
@


4.1.7.2
log
@Imported from SrcFiler
@
text
@a93 30
rm.Serial: Hdr:ListOpts
rm.Serial: Hdr:NdrDebug
rm.Serial: Hdr:Macros
rm.Serial: Hdr:System
rm.Serial: Hdr:SWIs
rm.Serial: Hdr:CPU.Generic26
rm.Serial: Hdr:IO.GenericIO
rm.Serial: Hdr:RISCOS
rm.Serial: Hdr:Machine.<Machine>
rm.Serial: Hdr:ModHand
rm.Serial: Hdr:HighFSI
rm.Serial: Hdr:DevNos
rm.Serial: Hdr:Services
rm.Serial: Hdr:Symbols
rm.Serial: Hdr:MsgTrans
rm.Serial: Hdr:Proc
rm.Serial: Hdr:Buffer
rm.Serial: Hdr:ResourceFS
rm.Serial: Hdr:DeviceFS
rm.Serial: Hdr:IO.IOEB
rm.Serial: Hdr:IO.IOC
rm.Serial: Hdr:RS423
rm.Serial: Hdr:IO.IOMDL
rm.Serial: Version
rm.Serial: s.errors
rm.Serial: s.macros
rm.Serial: s.main
rm.Serial: s.hardware
rm.Serial: s.interrupts
rm.Serial: s.devicecall
d125 30
@


4.1.5.1
log
@Import from SrcFiler
@
text
@@
