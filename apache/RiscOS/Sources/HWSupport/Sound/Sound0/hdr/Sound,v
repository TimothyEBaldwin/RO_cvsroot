head	4.8;
access;
symbols
	Sound0-1_72:4.8
	Sound0-1_71:4.6
	Sound0-1_70:4.5
	Sound0-1_69:4.5
	Sound0-1_68:4.5
	Sound0-1_67:4.4
	Sound0-1_66:4.3
	Sound0-1_65:4.3
	Sound0-1_64:4.2
	Sound0-1_63:4.2
	Sound0-1_62-4_8_4_4:4.2
	Sound0-1_62-4_8_4_3:4.2
	Sound0-1_62-4_8_4_2:4.2
	Sound0-1_62-4_8_4_1:4.2
	L72xx_AC97:4.2.0.4
	Sound0-1_62-4_8_2_1:4.2
	CL92xx:4.2.0.2
	Sound0-1_62:4.2
	Sound0-1_61:4.2
	Sound0-1_60:4.1
	Sound0-1_59:4.1
	dellis_autobuild_BaseSW:4.1
	Sound0-1_58:4.1
	sbrodie_sedwards_16Mar2000:4.1
	SoundDMA-1_57:4.1
	Sound0-1_57:4.1
	dcotton_autobuild_BaseSW:4.2
	Sound0-1_56:4.1
	Ursula_merge:4.1
	nturton_Sound0-1_54:4.1
	dcotton_sound0_MPTInitialBuild:4.1.7.1
	mstphens_UrsulaRiscPCBuild_20Nov98:4.1
	Ursula_RiscPC:4.1.0.8
	rthornb_UrsulaBuild-19Aug1998:4.1
	UrsulaBuild_FinalSoftload:4.1
	rthornb_UrsulaBuild-12Aug1998:4.1
	aglover_UrsulaBuild-05Aug1998:4.1
	rthornb_UrsulaBuild-29Jul1998:4.1
	rthornb_UrsulaBuild-22Jul1998:4.1
	rthornb_UrsulaBuild-15Jul1998:4.1
	rthornb_UrsulaBuild-07Jul1998:4.1
	rthornb_UrsulaBuild-17Jun1998:4.1
	rthornb_UrsulaBuild-03Jun1998:4.1
	rthornb_UrsulaBuild-27May1998:4.1
	rthornb_UrsulaBuild-21May1998:4.1
	rthornb_UrsulaBuild_01May1998:4.1
	afrost_NC2_Generic:4.1.7.1
	afrost_Funai01-33:4.1.7.1
	Spinner_RCA116:4.1.7.1
	Spinner_B20_2:4.1.7.1
	Spinner_19_3:4.1.7.1
	Spinner_B18:4.1.7.1
	Spinner_B17:4.1.7.1
	Spinner_B15:4.1.7.1
	Ursula:4.1.0.4
	Spin_merge_3Jul97:4.1.7.1
	Spinner_B14:4.1.7.1
	Spinner_B13:4.1.7.1
	Spinner_B12:4.1.7.1
	Spinner_B10:4.1.7.1
	Daytona:4.1.0.6
	Daytona_bp:4.1
	Ursula_bp:4.1
	Spinner_B7:4.1.7.1
	RO_3_71:4.1.3.1
	ARTtmp_merge:4.1.7.1
	Spin_3Apr97:4.1.7.1
	RCA_bp:4.1
	ARTtmp:4.1.7.1.0.2
	RCA:4.1.0.2
	Spin_merge:4.1.7.1
	MergeFiles:4.1.3.1
	RO_3_70:4.1.3.1
	NC_1_06:4.1.7.1
	Spinner:4.1.7
	Spin_xx:4.1.5
	NC_xx:4.1.5.1
	RO_3_60:4.1.1.1
	StrongARM:4.1.3
	Black:4.1.1;
locks; strict;
comment	@# @;


4.8
date	2016.06.08.21.40.06;	author jlee;	state Exp;
branches;
next	4.7;
commitid	1gBtFTlXIw5q2I9z;

4.7
date	2015.12.01.20.51.41;	author jlee;	state Exp;
branches;
next	4.6;
commitid	GxZRxKTY9hxsShLy;

4.6
date	2014.06.22.18.28.30;	author jlee;	state Exp;
branches;
next	4.5;
commitid	z1DZmpALTjHA1yFx;

4.5
date	2012.03.24.22.22.18;	author jlee;	state Exp;
branches;
next	4.4;
commitid	YvoPKrBfhdHYFbYv;

4.4
date	2012.03.10.09.22.27;	author rsprowson;	state Exp;
branches;
next	4.3;
commitid	aTbudoHvpImkOjWv;

4.3
date	2011.06.22.00.32.57;	author jlee;	state Exp;
branches;
next	4.2;
commitid	67KDTYbWvQEPiBov;

4.2
date	2001.03.06.15.11.54;	author ahodgkin;	state Exp;
branches;
next	4.1;

4.1
date	96.11.05.09.37.40;	author nturton;	state Exp;
branches
	4.1.1.1
	4.1.3.1
	4.1.5.1
	4.1.7.1;
next	;

4.1.1.1
date	96.11.05.09.37.40;	author nturton;	state Exp;
branches;
next	;

4.1.3.1
date	96.11.06.01.43.48;	author nturton;	state Exp;
branches;
next	;

4.1.5.1
date	96.11.21.12.03.58;	author nturton;	state Exp;
branches;
next	;

4.1.7.1
date	96.11.29.20.56.09;	author nturton;	state Exp;
branches;
next	;


desc
@@


4.8
log
@Update header to reflect Sound0HAL changes
Detail:
  hdr/Sound - Updated to match Sound0HAL-1_84; device selection/enumeration SWIs have been renamed to "Controller" to avoid ambiguous terminology
Admin:
  Untested


Version 1.72. Tagged as 'Sound0-1_72'
@
text
@; Copyright 1996 Acorn Computers Ltd
;
; Licensed under the Apache License, Version 2.0 (the "License");
; you may not use this file except in compliance with the License.
; You may obtain a copy of the License at
;
;     http://www.apache.org/licenses/LICENSE-2.0
;
; Unless required by applicable law or agreed to in writing, software
; distributed under the License is distributed on an "AS IS" BASIS,
; WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
; See the License for the specific language governing permissions and
; limitations under the License.
;
        SUBT    Exported Sound constants

OldOpt  SETA    {OPT}
        OPT     OptNoList+OptNoP1List

; ***********************************
; ***    C h a n g e   L i s t    ***
; ***********************************

; Date       Name  Description
; ----       ----  -----------
; 21-Jun-1988  SKS   Added Service sub-rc's, corrected SoundCMOS definition
;                    to fit reality
; 17-May-1994  AMcC  Changed to using the preferred SWI base symbols
; 29-Sep-1994  AMcC  Added new 16-bit Sound0 SWIs (from DOCN16)
; 12-Oct-1994  AMcC  Corrected some Sound2 SWI names
; 06-Mar-2001  ADH   Added Service_Sound reason codes 6 and 7
;

; +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
; Software base pointers

SoundLevel0Base         * SoundWorkSpace
SoundLevel0Reserved     * 16*4
SoundLevel1Base         * SoundLevel0Base + SoundLevel0Reserved

SoundPhysChannels       * 8
MaxNVoices              * 32
SoundSystemNIL          * &00000003


; SCCB Sound Channel Control Block
; 8 words (for LDMIA R9,{R0-R7}) is reasonable
; size constrained to exactly 256 bytes
                        ^ 0
SoundChannelAmpGateB    # 1 ; gate + 7-bit log amp.
SoundChannelVoiceIndexB # 1 ; index to voice table
SoundChannelInstanceB   # 1 ; Voice instance no.
SoundChannelFlagsB      # 1 ; control/status bit flags
SoundChannelPitch       # 4 ; phase acc
SoundChannelTimbre      # 4 ; phase acc
SoundChannelDuration    # 4 ; no. uS? (dec counter)
SoundChannelUserParam1  # 4 ;
SoundChannelUserParam2  # 4 ;
SoundChannelUserParam3  # 4 ;
SoundChannelUserParam4  # 4 ;
SoundChannelExtension   # 0 ; START HERE -> 256 BYTES
SoundChannelCBSize * 256
SoundChannelCBLSL * 8 ; SHIFT value to index SCCBs

; Level 1 data structure
; Level1 Sound DMA Control Block
; This block is skipped for the C header, the constants on the RHS of the # confuse Hdr2H.
;NoHdr2H{
                        ^ 0 ; SoundLevel1Base
SoundLevel1FillPtr      # 4 ; code^
SoundLevel1FixupPtr     # 4 ; code^
SoundLevel1LogTable     # 4
SoundLevel1AmpTable     # 4
SoundLevel1NChannels    # 1
SoundLevel1MaxAmp       # 1
SoundLevel1NVoices      # 1
SoundLevel1reservedB    # 1
SoundLevel1MasterPitch  # 4
SoundLevel1Queue        # 4
SoundLevel1SPARE        # 4 * 8
SoundLevel1VoiceTable   # 4 * (1 + MaxNVoices)
SoundLevel1ChannelTable    # SoundPhysChannels * SoundChannelCBSize
SoundLevel1ChannelTableEnd # 0
;NoHdr2H}


; Level 2 (VOICE) data structure
; SVCB Sound Voice Control Block
                        ^ 0
SoundVoiceFill          # 4 ; fill continuation entry
SoundVoiceUpdate        # 4 ; fill (with new params) coroutine entry
SoundVoiceGateOn        # 4 ; initiallise and fill
SoundVoiceGateOff       # 4 ; kill/release coroutine entry
SoundVoiceInst          # 4 ; instantiate voice
SoundVoiceFree          # 4 ; instance control
SoundVoiceInstall       # 4 ; code install
SoundVoiceTitle         # 4 ; name string
SoundVoiceDSize         # 4 ; instance data segment size
SoundVoiceIndex         # 4 ; table install segment size
SoundVoiceCBSize        # 0


; Channel Flags Byte: (31:24 of control word)
;
;   7                           0
; +---+---+---+---+---+---+---+---+
; | Q | K | I | F | A | V | F2| F1|
; +---+---+---+---+---+---+---+---+
; Z - Quiet (inactive)
; K - Kill Pending
; I - Initialise Pending
; F - Fill Pending
; A - Active Flag
; V - oVerrun Flag
; F2,F1 - 2-bit Flush Pending counter

SoundChannelGateOff      * 2_10000000 ; carefully priority-encoded
SoundChannelGateOn       * 2_01000000
SoundChannelUpdate       * 2_00100000
SoundChannelReserved     * 2_00010000
SoundChannelActive       * 2_00001000
SoundChannelOverrun      * 2_00000100
SoundChannelFlush2       * 2_00000010
SoundChannelFlush1       * 2_00000001
; composites
SoundChannelFlushPending * 2_00000011
SoundChannelForceFlush   * 2_00000010


; SoundCMOS bit allocation

;   7   6   5   4   3   2   1   0
; +---+---+---+---+---+---+---+---+
; | S |     L     |       V       |
; +---+---+---+---+---+---+---+---+

; S = 0/1 -> speaker off/on
; L = 3-bit 'loudness' field, 0..7 -> &01..&7F
; V = 4-bit default channel 0 voice, 0..15 -> 1..16


SWIClass SETS Sound0SWI_Name

        ^       Sound0SWI_Base

        AddSWI  Configure
        AddSWI  Enable
        AddSWI  Stereo
        AddSWI  Speaker
        AddSWI  Mode
        AddSWI  LinearHandler
        AddSWI  SampleRate
        AddSWI  ReadSysInfo
        AddSWI  SelectDefaultController
        AddSWI  EnumerateControllers
        AddSWI  ControllerInfo

        ^       Sound1SWI_Base

        AddSWI  Volume
        AddSWI  SoundLog
        AddSWI  LogScale
        AddSWI  InstallVoice
        AddSWI  RemoveVoice
        AddSWI  AttachVoice
        AddSWI  ControlPacked ; was 'Sound' but not in module!
        AddSWI  Tuning
        AddSWI  Pitch
        AddSWI  Control
        AddSWI  AttachNamedVoice
        AddSWI  ReadControlBlock
        AddSWI  WriteControlBlock

        ^       Sound2SWI_Base

        AddSWI  QInit
        AddSWI  QSchedule
        AddSWI  QRemove
        AddSWI  QFree
        AddSWI  QSDispatch
        AddSWI  QTempo
        AddSWI  QBeat
        AddSWI  QInterface


                                ^       0 ; Sound system service sub-rc's
Service_SoundLevel0Alive        #       1
Service_SoundLevel0Dying        #       1
Service_SoundLevel1Alive        #       1
Service_SoundLevel1Dying        #       1
Service_SoundLevel2Alive        #       1
Service_SoundLevel2Dying        #       1
Service_SharedSoundAlive        #       1
Service_SharedSoundDying        #       1
Service_SoundConfigChanging     #       1
Service_SoundEnabled            #       1
Service_SoundDisabled           #       1
Service_SoundAutoTune           #       1

; Sound_ReadSysInfo reason codes
; Start from 1 due to braindead Sound0 SWI dispatch not erroring on unknown SWI!
                                ^       1
Sound_RSI_Features              #       1
Sound_RSI_DefaultController     #       1

; Sound_RSI_Features flags
Sound_RSI_Feature_Service8910         * 1 ; Service calls 8/9/10 generated (SoundConfigChanging, SoundEnabled, SoundDisabled)
Sound_RSI_Feature_ControllerSelection * 2 ; SelectDefaultController, EnumerateControllers, ControllerInfo SWIs supported

; Sound_ControllerInfo reason codes
                                ^       0
Sound_CtlrInfo_DisplayName      #       1
Sound_CtlrInfo_MixerDevice      #       1
Sound_CtlrInfo_SampleRates      #       1


        OPT     OldOpt
        END
@


4.7
log
@Keep header in sync with Sound0HAL
Detail:
  Makefile - Export a C version of hdr/Sound
  hdr/Sound - Updated with new definitions from Sound0HAL
Admin:
  No functional changes to module
  Untested


Version 1.71. Retagged as 'Sound0-1_71'
@
text
@d154 3
a156 3
        AddSWI  SelectDefaultDevice
        AddSWI  EnumerateDevices
        AddSWI  DeviceInfo
d204 1
a204 1
Sound_RSI_DefaultDevice         #       1
d207 2
a208 2
Sound_RSI_Feature_Service8910     * 1 ; Service calls 8/9/10 generated (SoundConfigChanging, SoundEnabled, SoundDisabled)
Sound_RSI_Feature_DeviceSelection * 2 ; SelectDefaultDevice, EnumerateDevices, DeviceInfo SWIs supported
d210 1
a210 1
; Sound_DeviceInfo reason codes
d212 3
a214 2
Sound_DevInfo_DisplayName       #       1
Sound_DevInfo_MixerDevice       #       1
@


4.6
log
@Define Service_Sound reason code for broadcasting automatic tuning state
Detail:
  hdr/Sound - Add Service_SoundAutoTune definition, which SoundChannels will issue whenever automatic tuning is enabled or disabled
Admin:
  Untested
  Matches change made in Sound0HAL-1_77


Version 1.71. Tagged as 'Sound0-1_71'
@
text
@d67 2
d84 1
d154 3
d204 1
d207 8
a214 1
Sound_RSI_Feature_Service8910 * 1 ; Service calls 8/9/10 generated (SoundConfigChanging, SoundEnabled, SoundDisabled)
@


4.5
log
@Add support for sound starting/stopping/config changing service calls, and new Sound_ReadSysInfo SWI
Detail:
  hdr/Sound - Added definitions for new service calls and Sound_ReadSysInfo SWI
  s/Sound0 - Add support for new SWI/service calls. Adjust buffer size constraints in Sound0Enable.
Admin:
  Tested in IOMD ROM softload on RiscPC


Version 1.68. Tagged as 'Sound0-1_68'
@
text
@d192 1
@


4.4
log
@Service call name corrected.

Version 1.67. Tagged as 'Sound0-1_67'
@
text
@d150 1
d189 8
d198 2
@


4.3
log
@SoundDMA fix for IOMDHAL build
Detail:
  hdr/Sound - Changed SoundSystemNIL value to an appropriate value for the 32bit/HAL IOMD build.
Admin:
  Tested in ROM softload on RiscPC


Version 1.65. Tagged as 'Sound0-1_65'
@
text
@d187 1
a187 1
Servive_SharedSoundDying        #       1
@


4.2
log
@  Two new Service_Sound reason codes.
Detail:
  Service_Sound 6 (Service_SharedSoundAlive) and Service_Sound 7
  (SharedSoundDying) added for WSS extensions to SharedSound.
Admin:
  I believe SharedSound 0.61 or later will raise Service_Sound
  with these new reason codes.

Version 1.61. Tagged as 'Sound0-1_61'
@
text
@d43 1
a43 1
SoundSystemNIL          * &FC000003
@


4.1
log
@Initial revision
@
text
@d26 6
a31 5
; 21-Jun-88  SKS   Added Service sub-rc's, corrected SoundCMOS definition
;                  to fit reality
; 17-May-94  AMcC  Changed to using the preferred SWI base symbols
; 29-Sep-94  AMcC  Added new 16-bit Sound0 SWIs (from DOCN16)
; 12-Oct-94  AMcC  Corrected some Sound2 SWI names
d186 2
@


4.1.7.1
log
@NCOS 1.06 Imported from Zip drive
@
text
@@


4.1.5.1
log
@Import from SrcFiler
@
text
@@


4.1.3.1
log
@Import from cleaned 370 CD
@
text
@@


4.1.1.1
log
@Import from cleaned 360 CD
@
text
@@
