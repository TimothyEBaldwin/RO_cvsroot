head	4.9;
access;
symbols
	DeviceFS-0_73:4.9
	DeviceFS-0_72:4.9
	DeviceFS-0_71:4.9
	DeviceFS-0_70:4.9
	DeviceFS-0_69:4.9
	DeviceFS-0_68:4.9
	RO_5_07:4.9
	DeviceFS-0_67:4.9
	DeviceFS-0_66:4.9
	DeviceFS-0_65:4.9
	DeviceFS-0_64:4.9
	DeviceFS-0_63:4.9
	DeviceFS-0_62:4.9
	DeviceFS-0_61:4.9
	DeviceFS-0_60:4.8
	DeviceFS-0_59:4.8
	DeviceFS-0_58:4.8
	DeviceFS-0_57:4.7
	DeviceFS-0_56:4.7
	DeviceFS-0_55:4.7
	DeviceFS-0_54:4.7
	DeviceFS-0_53:4.7
	DeviceFS-0_52:4.7
	DeviceFS-0_51:4.7
	DeviceFS-0_50:4.7
	dellis_autobuild_BaseSW:4.7
	DeviceFS-0_49:4.7
	DeviceFS-0_48:4.7
	sbrodie_sedwards_16Mar2000:4.7
	DeviceFS-0_47:4.7
	dcotton_autobuild_BaseSW:4.8
	DeviceFS-0_46:4.7
	Ursula_merge:4.4
	DeviceFS-0_45:4.7
	mstphens_UrsulaRiscPCBuild_20Nov98:4.4
	Ursula_RiscPC:4.4.0.4
	DeviceFS-0_44:4.7
	DeviceFS-0_43:4.7
	DeviceFS-0_42:4.7
	DeviceFS-0_41:4.7
	rthornb_UrsulaBuild-19Aug1998:4.4
	UrsulaBuild_FinalSoftload:4.4
	rthornb_UrsulaBuild-12Aug1998:4.4
	aglover_UrsulaBuild-05Aug1998:4.4
	rthornb_UrsulaBuild-29Jul1998:4.4
	rthornb_UrsulaBuild-22Jul1998:4.4
	rthornb_UrsulaBuild-15Jul1998:4.4
	rthornb_UrsulaBuild-07Jul1998:4.4
	rthornb_UrsulaBuild-17Jun1998:4.4
	rthornb_UrsulaBuild-03Jun1998:4.4
	rthornb_UrsulaBuild-27May1998:4.4
	rthornb_UrsulaBuild-21May1998:4.4
	rthornb_UrsulaBuild_01May1998:4.4
	afrost_NC2_Generic:4.1.7.7
	Spinner:4.6.0.2
	Spin_merge:4.6
	Spin_merge_4Mar1998:4.1.7.2
	Spinner_4Mar1998:4.1.7
	DeviceFS_0_36:4.4
	Spinner_B20_2:4.1.7.4
	Spinner_19_3:4.1.7.4
	Spinner_B18:4.1.7.2
	Spinner_B17:4.1.7.2
	Spinner_B15:4.1.7.2
	Spinner_B14:4.1.7.2
	Spinner_B13:4.1.7.2
	Spinner_B12:4.1.7.2
	Spinner_B10:4.1.7.2
	Ursula:4.4.0.2
	Spin_merge_19May97:4.1.7.1
	Daytona:4.3.0.4
	Daytona_bp:4.3
	Ursula_bp:4.4
	Spin_merge_7May97:4.1.7.1
	ARTtmp_bp:4.1.7.1
	Spinner_B7:4.1.7.2
	RO_3_71:4.1.3.1
	ARTtmp_merge:4.1.7.1.2.1
	Spin_3Apr97:4.1.7.1
	ARTtmp:4.1.7.1.0.2
	RCA:4.2.0.4
	MergeFiles:4.1.3.1
	RO_3_70:4.1.3.1
	NC_1_06:4.1.7.1
	Spin_xx:4.1.5
	NC_xx:4.1.5.1
	RO_3_60:4.1.1.1
	StrongARM:4.1.3
	Black:4.1.1;
locks; strict;
comment	@# @;


4.9
date	2002.02.21.10.17.02;	author mboura;	state Exp;
branches;
next	4.8;

4.8
date	2001.09.03.13.41.18;	author dellis;	state Exp;
branches;
next	4.7;

4.7
date	98.09.21.11.10.30;	author kbracey;	state Exp;
branches;
next	4.6;

4.6
date	98.03.04.15.54.33;	author nturton;	state Exp;
branches;
next	4.5;

4.5
date	98.03.04.14.35.41;	author olove;	state Exp;
branches;
next	4.4;

4.4
date	97.05.19.13.06.08;	author kbracey;	state Exp;
branches;
next	4.3;

4.3
date	97.05.07.11.50.11;	author kbracey;	state Exp;
branches;
next	4.2;

4.2
date	97.01.21.16.18.59;	author nturton;	state Exp;
branches;
next	4.1;

4.1
date	96.11.05.09.35.30;	author nturton;	state Exp;
branches
	4.1.1.1
	4.1.3.1
	4.1.5.1
	4.1.7.1;
next	;

4.1.1.1
date	96.11.05.09.35.30;	author nturton;	state Exp;
branches;
next	;

4.1.3.1
date	96.11.06.01.19.58;	author nturton;	state Exp;
branches;
next	;

4.1.5.1
date	96.11.21.11.48.49;	author nturton;	state Exp;
branches;
next	;

4.1.7.1
date	96.11.29.20.44.24;	author nturton;	state Exp;
branches
	4.1.7.1.2.1;
next	4.1.7.2;

4.1.7.2
date	97.04.30.18.29.41;	author scormie;	state Exp;
branches;
next	4.1.7.3;

4.1.7.3
date	97.07.25.08.09.31;	author arodger;	state Exp;
branches;
next	4.1.7.4;

4.1.7.4
date	97.07.25.12.16.55;	author rbuckley;	state Exp;
branches;
next	4.1.7.5;

4.1.7.5
date	97.07.31.16.19.23;	author scormie;	state Exp;
branches;
next	4.1.7.6;

4.1.7.6
date	97.09.08.12.06.14;	author rbuckley;	state Exp;
branches;
next	4.1.7.7;

4.1.7.7
date	97.10.01.12.31.05;	author arodger;	state Exp;
branches;
next	;

4.1.7.1.2.1
date	97.04.16.10.53.22;	author blaughto;	state Exp;
branches;
next	;


desc
@@


4.9
log
@  DeviceFS wouldn't build
Detail:
  Debug switch missing
Admin:
  It does now build, but no other testing carried out.

Version 0.61. Tagged as 'DeviceFS-0_61'
@
text
@; > Version
;
; (Original version functionality shifted to VersionASM)
;
; controlling how and if debugging is allowed.
;
; hostvdu controls if the debugging goes via a host podule, debug is a global
; switch for debugging within the system.

                GBLL    debug
                GBLL    hostvdu

debug           SETL    false
hostvdu         SETL    false

fs              SETD    false           ; probably to do with sleeping
register        SETD    false           ; register a parent
registerdev     SETD    false           ; register a device
deregister      SETD    false           ; deregistering a device
enumdir         SETD    false           ; directory enumeration
sorting         SETD    false           ; directory sorting
open            SETD    false           ; opening obects within the directory structure
close           SETD    false           ; closing objects within the directory structure
inter           SETD    false           ; internationaliation
transmitchar    SETD    false           ; transmit char
special         SETD    false           ; debugging of special fields
args            SETD    false           ; fs_args
eof             SETD    false           ; fs_args eof check
file            SETD    false           ; fs_file ops
func            SETD    false           ; fs_func ops
gbpb            SETD    false           ; fs_gbpb ops

; Now some assembly constants about DeviceFS, ie. should it be the internation
; version or not.

                GBLL    international
international   SETL    true            ; internationalised version

                GBLL    FastBufferMan
FastBufferMan   SETL    true            ; use fast buffer manager

                GBLL    Use0PageForESC  ; get ESC state from 0 page rather than SWI
Use0PageForESC  SETL    false

		GBLL	wakeup_data_present  ; issue upcalls on data receipt
wakeup_data_present	SETL	true

		GBLL	issue_device_upcalls ; issue device stream upcalls
issue_device_upcalls	SETL	true

                GBLL    TWSleep         ; Call OS_UpCall 6 when idle
TWSleep         SETL    true
                END
@


4.8
log
@  Added new IOCTL reason codes and special field flags for sleeping devicefs.

Detail:
  DeviceFS has been enhanced with the ability to cooperate with Taskwindows
so as to allow multitasking to continue.  Any devicefs stream, if opened
with the special field entry 'sleep' will issue OS_UpCall 6 when it would
normally block.  A flag 'timeout' has also been added which will cause the
stream to issue a timeout error if it has slept for too long.

  These actions can be set using the generic IOCTLs 4 and 5, the former just
being a logical switch, the latter being the value in centiseconds for which
to sleep.

  There is also now a generic special field to specify non-blocking which may
be used as an alternative to the IOCTL.

Admin:
  Tested on a RiscPC.


Version 0.58. Tagged as 'DeviceFS-0_58'
@
text
@d16 1
@


4.7
log
@Makefile modified to use LocalRes$Path.
Changed to use srccommit.

Version 0.41. Tagged as 'DeviceFS-0_41'
@
text
@d42 1
a42 1
Use0PageForESC  SETL    true
d50 2
@


4.6
log
@Upped version to 0.40 to avoid conflicts with NC build
@
text
@d3 2
a4 9
                GBLA    Version
                GBLS    VString
                GBLS    Date

Version         SETA    040
VString         SETS    "0.40"
Date            SETS    "25 Feb 1998"


@


4.5
log
@Update Version number.
@
text
@d7 2
a8 2
Version         SETA    038
VString         SETS    "0.38"
@


4.4
log
@Spinner branch merged
@
text
@d7 3
a9 3
Version         SETA    036
VString         SETS    "0.36"
Date            SETS    "19 May 1997"
@


4.3
log
@ARTtmp branch folded
@
text
@d7 3
a9 3
Version         SETA    035
VString         SETS    "0.35"
Date            SETS    "13 Apr 1997"
@


4.2
log
@Version Spin_merge taken
@
text
@d7 3
a9 3
Version         SETA    034
VString         SETS    "0.34"
Date            SETS    "14 Jun 1996"
d21 1
a21 1
hostvdu         SETL    true
a37 1

@


4.1
log
@Initial revision
@
text
@d7 3
a9 3
Version         SETA    030
VString         SETS    "0.30"
Date            SETS    "31 Oct 1994"
d51 6
@


4.1.7.1
log
@NCOS 1.06 Imported from Zip drive
@
text
@d7 3
a9 3
Version         SETA    034
VString         SETS    "0.34"
Date            SETS    "14 Jun 1996"
a50 6

		GBLL	wakeup_data_present  ; issue upcalls on data receipt
wakeup_data_present	SETL	true

		GBLL	issue_device_upcalls ; issue device stream upcalls
issue_device_upcalls	SETL	true
@


4.1.7.2
log
@   Change logic on error handling slightly; check 'monitorTX available' flag
correctly; added error buffer.
@
text
@d7 3
a9 3
Version         SETA    035
VString         SETS    "0.35"
Date            SETS    "29 Apr 1997"
@


4.1.7.3
log
@Added Monitor TX check to flush buffer to avoid hangs.
@
text
@d7 3
a9 3
Version         SETA    036
VString         SETS    "0.36"
Date            SETS    "24 July 1997"
@


4.1.7.4
log
@Fixed bug introduced by change Alister made to fix printing stuff.
Needed to add a TST as processor flags got trashed.
@
text
@d7 3
a9 3
Version         SETA    037
VString         SETS    "0.37"
Date            SETS    "25 July 1997"
@


4.1.7.5
log
@Moved check for TXOK from checkeof to args_flush as it should only have
been called for TX streams and was not returning error pointers correctly.
@
text
@d7 3
a9 3
Version         SETA    038
VString         SETS    "0.38"
Date            SETS    "31 July 1997"
@


4.1.7.6
log
@Corrected date format to dd mmm yyyy.
@
text
@d9 1
a9 1
Date            SETS    "31 Jul 1997"
@


4.1.7.7
log
@changed the order of checking in the args_flush routine when checking for out ofpaper.
@
text
@d7 3
a9 3
Version         SETA    039
VString         SETS    "0.39"
Date            SETS    "1 Oct 1997"
@


4.1.7.1.2.1
log
@Added support for non-blocking block reads/writes (OS_GBPB 4 and 2). Added
new IOCtl group (0xff) and reason code (1) to enable non-blocking operation
for a stream. Fixed bug in upcall handler: DeviceThresh upcalls now sent with
OS_CallAVector instead of OS_UpCall so that interrupts don't get enabled.
@
text
@d7 3
a9 3
Version         SETA    035
VString         SETS    "0.35"
Date            SETS    "13 Apr 1997"
d21 1
a21 1
hostvdu         SETL    false
d38 1
@


4.1.5.1
log
@Import from SrcFiler
@
text
@d7 3
a9 3
Version         SETA    034
VString         SETS    "0.34"
Date            SETS    "14 Jun 1996"
a50 6

		GBLL	wakeup_data_present  ; issue upcalls on data receipt
wakeup_data_present	SETL	true

		GBLL	issue_device_upcalls ; issue device stream upcalls
issue_device_upcalls	SETL	true
@


4.1.3.1
log
@Import from cleaned 370 CD
@
text
@@


4.1.1.1
log
@Import from cleaned 360 CD
@
text
@@
