head	1.6;
access;
symbols
	OMAP3-1_18:1.6
	OMAP3-1_17:1.6
	OMAP3-1_16:1.6
	OMAP3-1_15:1.6
	OMAP3-1_14:1.6
	SMP:1.6.0.2
	SMP_bp:1.6
	OMAP3-1_13:1.6
	OMAP3-1_12:1.6
	OMAP3-1_11:1.6
	OMAP3-1_10:1.6
	OMAP3-1_09:1.6
	OMAP3-1_08:1.6
	OMAP3-1_07:1.6
	OMAP3-1_06:1.6
	OMAP3-1_05:1.6
	OMAP3-1_04:1.6
	OMAP3-1_03:1.6
	OMAP3-1_02:1.6
	OMAP3-1_01:1.6
	OMAP3-1_00:1.6
	OMAP3-0_99:1.6
	OMAP3-0_98:1.6
	OMAP3-0_97:1.6
	OMAP3-0_96:1.6
	OMAP3-0_95:1.6
	OMAP3-0_94:1.6
	OMAP3-0_93:1.6
	OMAP3-0_92:1.6
	OMAP3-0_91:1.6
	OMAP3-0_90:1.6
	OMAP3-0_89:1.6
	OMAP3-0_88:1.6
	OMAP3-0_87:1.6
	OMAP3-0_86:1.6
	OMAP3-0_85:1.6
	OMAP3-0_84:1.6
	OMAP3-0_83:1.6
	OMAP3-0_82:1.6
	OMAP3-0_81:1.6
	OMAP3-0_80:1.6
	OMAP3-0_79:1.6
	OMAP3-0_78:1.6
	OMAP3-0_77:1.6
	OMAP3-0_76:1.6
	OMAP3-0_75:1.6
	OMAP3-0_74:1.6
	OMAP3-0_73:1.6
	OMAP3-0_72:1.6
	OMAP3-0_71:1.6
	OMAP3-0_70:1.6
	OMAP3-0_69:1.6
	OMAP3-0_68:1.6
	OMAP3-0_67:1.6
	OMAP3-0_66:1.6
	OMAP3-0_65:1.6
	OMAP3-0_64:1.6
	OMAP3-0_63:1.6
	OMAP3-0_62:1.6
	OMAP3-0_61:1.6
	OMAP3-0_60:1.5
	OMAP3-0_59:1.5
	OMAP3-0_58:1.5
	OMAP3-0_57:1.5
	OMAP3-0_56:1.5
	OMAP3-0_55:1.5
	OMAP3-0_54:1.5
	OMAP3-0_53:1.5
	OMAP3-0_52:1.5
	OMAP3-0_51:1.5
	OMAP3-0_50:1.4
	OMAP3-0_49:1.4
	OMAP3-0_48:1.4
	OMAP3-0_47:1.4
	OMAP3-0_46:1.4
	OMAP3-0_45:1.4
	OMAP3-0_44:1.4
	OMAP3-0_43:1.4
	OMAP3-0_42:1.4
	OMAP3-0_41:1.4
	OMAP3-0_40:1.4
	OMAP3-0_39:1.4
	OMAP3-0_38:1.4
	OMAP3-0_37:1.4
	OMAP3-0_36:1.4
	OMAP3-0_35:1.4
	OMAP3-0_34:1.4
	OMAP3-0_33:1.4
	OMAP3-0_32:1.4
	OMAP3-0_31:1.3
	OMAP3-0_30:1.3
	OMAP3-0_29:1.3
	OMAP3-0_28:1.3
	OMAP3-0_27:1.3
	OMAP3-0_26:1.3
	OMAP3-0_25:1.3
	OMAP3-0_24:1.3
	OMAP3-0_23:1.3
	OMAP3-0_22:1.3
	OMAP3-0_21:1.3
	OMAP3-0_20:1.2
	OMAP3-0_19:1.2
	OMAP3-0_18:1.1
	OMAP3-0_17:1.1
	OMAP3-0_16:1.1
	OMAP3-0_15:1.1
	OMAP3-0_14:1.1
	OMAP3-0_13:1.1
	OMAP3-0_12:1.1
	OMAP3-0_11:1.1
	OMAP3-0_10:1.1
	OMAP3-0_09:1.1
	OMAP3-0_08:1.1
	OMAP3-0_07:1.1
	OMAP3-0_06:1.1
	OMAP3-0_05:1.1
	OMAP3-0_04:1.1
	OMAP3-0_03:1.1
	OMAP3-0_02:1.1
	OMAP3-0_01:1.1;
locks; strict;
comment	@# @;


1.6
date	2012.03.25.11.49.03;	author rsprowson;	state Exp;
branches;
next	1.5;
commitid	c99VvmwezV2J8gYv;

1.5
date	2011.11.29.22.46.13;	author jlee;	state Exp;
branches;
next	1.4;
commitid	bYJYUuZQ3ItlxhJv;

1.4
date	2010.09.14.20.58.47;	author jlee;	state Exp;
branches;
next	1.3;

1.3
date	2010.01.30.00.23.18;	author jlee;	state Exp;
branches;
next	1.2;

1.2
date	2010.01.24.02.49.29;	author jlee;	state Exp;
branches;
next	1.1;

1.1
date	2009.02.01.13.58.04;	author jlee;	state Exp;
branches;
next	;


desc
@@


1.6
log
@Line some things up.
To help OMAP4 tracking changes a number of the changes were purely cosmetic lining up differences, this change is where OMAP3 wasn't on a conventional column layout.

Version 0.61. Tagged as 'OMAP3-0_61'
@
text
@; Copyright 2009 Castle Technology Ltd
;
; Licensed under the Apache License, Version 2.0 (the "License");
; you may not use this file except in compliance with the License.
; You may obtain a copy of the License at
;
;     http://www.apache.org/licenses/LICENSE-2.0
;
; Unless required by applicable law or agreed to in writing, software
; distributed under the License is distributed on an "AS IS" BASIS,
; WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
; See the License for the specific language governing permissions and
; limitations under the License.
;
; UART1-4

UART_THR        *       &000
UART_RBR        *       &000
UART_IER        *       &004
UART_IIR        *       &008
UART_FCR        *       &008
UART_LCR        *       &00C
UART_MCR        *       &010
UART_LSR        *       &014
UART_MSR        *       &018
UART_MDR1       *       &020
UART_MDR2       *       &024
UART_SCR        *       &040
UART_SYSC       *       &054
UART_SYSS       *       &058

UART_DLL        *       &000
UART_DLM        *       &004

; IER
ERBI            *       2_00000001
ETBEI           *       2_00000010
ELSI            *       2_00000100
EDSSI           *       2_00001000

; FCR
FIFOEN          *       2_00000001
FIFORSTRX       *       2_00000010
FIFORSTTX       *       2_00000100
DMA             *       2_00001000
FIFOTHR         *       2_11000000
FIFOTHR_8       *       2_00000000
FIFOTHR_16      *       2_01000000
FIFOTHR_56      *       2_10000000
FIFOTHR_60      *       2_11000000

; LCR
WLS             *       2_00000011
WLS_5           *       2_00000000
WLS_6           *       2_00000001
WLS_7           *       2_00000010
WLS_8           *       2_00000011
STP             *       2_00000100
PEN             *       2_00001000
EPS             *       2_00010000
SPA             *       2_00100000
BCR             *       2_01000000
DLAB            *       2_10000000

; LSR
DR              *       2_00000001
OE              *       2_00000010
PE              *       2_00000100
FE              *       2_00001000
BI              *       2_00010000
THRE            *       2_00100000
TEMPT           *       2_01000000

; MCR
DTR             *       2_00000001
RTS             *       2_00000010
OUT2            *       2_00001000

; MSR
DCTS            *       2_00000001
DDSR            *       2_00000010
TERI            *       2_00000100
DDCD            *       2_00001000
CTS             *       2_00010000
DSR             *       2_00100000
RI              *       2_01000000
DCD             *       2_10000000

UARTCLK         *       48000000 ; CORE_48M_FCLK

UART1_IRQ       *       72
UART2_IRQ       *       73
UART3_IRQ       *       74
UART4_IRQ       *       80 ; AM/DM37x

        END
@


1.5
log
@Fix OMAP3 HAL UART code
Detail:
  hdr/UART - Added a couple more register addresses, removed incorrect FIFO64 flag
  hdr/omap3530 - Corrected UART 2 address
  s/Boot - Ensure we perform phys2log address conversion for all UART addresses, not just the first 3. Also avoid resetting the debug UART.
  s/UART - Fix HAL UART calls to obey the programming rules laid out in the TRM
  s/board - Change the order in which the UARTs are exposed to RISC OS so that they match the hardware order. HAL UART 0 is now OMAP UART1, etc.
Admin:
  Tested on rev A2 BB-xM


Version 0.51. Tagged as 'OMAP3-0_51'
@
text
@d96 1
a96 1
                END
@


1.4
log
@BeagleBoard-xM, TouchBook fixes
Detail:
  s/board, hdr/board, hdr/omap3530, hdr/UART - Add support for 4th UART available on AM/DM37x (i.e. BeagleBoard-xM)
  hdr/omap3530 - Add details of CONTROL_IDCODE register & known hawkeye/revision numbers for OMAP type/revision detection
  s/Boot, s/GPIO, hdr/GPIO, s/I2C, hdr/StaticWS - Allow TPS LED drivers to be used as (output-only) GPIOs. Add new polled I/O I2C function, and appropriate logic to make GPIO code use it instead of RISCOS_IICOpV if RISC OS hasn't finished initialising yet. Add code to initialise some extra BB/TB GPIOs on boot.
  s/Timers, hdr/Timers - Stop RISC OS from using GPTIMER9, because it's used to drive the screen backlight on the TouchBook
  s/Video - Use appropriate porch/sync limits on non-OMAP35x
  s/PRCM - Don't mess with the system clock divider when calculating system clock speed (AM/DM37x fix)
Admin:
  Tested on rev C2 beagleboard, rev A2 BB-xM (indirectly), rev C1 TouchBook


Version 0.32. Tagged as 'OMAP3-0_32'
@
text
@d26 2
d30 1
a45 1
FIFO64          *       2_00100000
@


1.3
log
@Various OMAP3 HAL power management improvements, plus add support for board config autodetection via Linux machine ID
Detail:
  s/board, hdr/board - Add Linux machine ID & available mixer channels to board config table
  s/Top - Add new entry point at offset &64, for booting as a fake Linux kernel. Searches the board config table until it finds a config matching the machine ID passed in R1. Also minor ROM copy optimisation, unsigned pointer comparison fixes
  s/Audio, hdr/Audio - Use board config to lock-out mixer channels that aren't connected to any hardware, to avoid excessive power drain or other problems if the channels get turned on. Also perform many other setting tweaks to tidy up default settings for unused mixer paths/channels.
  s/Video - Fix Video_Init logic when deciding whether to reset DSS, enable DSI PLL drift guard
  s/I2C - Increase I2C timeout values, since the previous values were perhaps a bit low
  s/Audio, s/I2C, s/Interrupts, s/RAM, s/SDMA, s/Timers, s/UART, hdr/UART, s/USB, s/Video - Enable autoidle/smart idle where possible to help save power.
Admin:
  Tested on rev C2 beagleboard


Version 0.21. Tagged as 'OMAP3-0_21'
@
text
@d15 1
a15 1
; UART1-3
d92 1
@


1.2
log
@Update OMAP HAL to support different board configs, plus use new YearLOIsGood flag to ensure correct RTC handling, plus other misc tidying
Detail:
  The OMAP HAL now has multiple entry points, one per board config. See Top.s/board.s for more info.
  audio.s - Moved APLL_CTL value to board config
  board.s - New file to list all the settings for the different board configs
  boot.s - Change HAL_Init to deal with the new board config stuff
  debug.s - Debug UART now specified in board config
  GPIO.s - A few utility functions for handling OMAP/TPS GPIO pins
  I2C.s - Update to use new board config struct
  RAM.s - Disable the beagleboard-specific RAM init code. Instead we'll just rely on u-boot to initialise all our RAM for us.
  RTC.s - Get rid of the magic numbers, and use the YearLOIsGood flag to indicate to RISC OS that YearLO is 2-digit BCD
  Top.s - Got rid of old debug code and rewrote initial flow to handle detecting & storing the board config
  UART.s - Update to use board config struct, support multiple UARTs
  USB.s - Get EHCI PHY power GPIO from board config
  Video.s - Get DVI framer power GPIO and max pixel rate from board config. Add 'PassiveVideo' option, to build a driver that doesn't alter the video output settings - should hopefully result in a usable display on Touch Book, etc.
  board.hdr - Definition of board config table struct
  GPIO.hdr - Add lots of macros for handling OMAP GPIO pins, new constants for OMAP/TPS GPIO
  I2C.hdr - Added I2C transfer block struct, HAL I2C API transfer states (both moved here from other source files)
  omap3530.hdr - Move/remove some unwanted constants, disable DebugChar for now
  StaticWS.hdr - Move I2C transfer block struct to I2C.hdr, add board config struct to HAL workspace, get rid of unused 64K AllocArea
  Timers.hdr - Tidy up constants a bit
  UART.hdr - Add UARTCLK (moved from StaticWS.hdr), UART IRQ #'s
  Makefile - add GPIO.s
Admin:
  Tested on rev C2 beagleboard. Board configs for other board types may be inaccurate in a couple of places.


Version 0.19. Tagged as 'OMAP3-0_19'
@
text
@d27 1
@


1.1
log
@Basic OMAP3 HAL
Detail:
  Performs startup procedure suitable for any location in ROM or RAM. UART, timer, counter, interrupt & debug functionality implemented. Video support incomplete and nonfunctional.
Admin:
  Tested with HALTester & RISC OS kernel under qemu-omap3


Version 0.01. Tagged as 'OMAP3-0_01'
@
text
@d86 6
@

