head	1.93;
access;
symbols
	OMAP3-0_89:1.92
	OMAP3-0_88:1.91
	OMAP3-0_87:1.90
	OMAP3-0_86:1.89
	OMAP3-0_85:1.88
	OMAP3-0_84:1.87
	OMAP3-0_83:1.86
	OMAP3-0_82:1.85
	OMAP3-0_81:1.84
	OMAP3-0_80:1.83
	OMAP3-0_79:1.82
	OMAP3-0_78:1.81
	OMAP3-0_77:1.80
	OMAP3-0_76:1.79
	OMAP3-0_75:1.78
	OMAP3-0_74:1.77
	OMAP3-0_73:1.76
	OMAP3-0_72:1.75
	OMAP3-0_71:1.74
	OMAP3-0_70:1.73
	OMAP3-0_69:1.72
	OMAP3-0_68:1.71
	OMAP3-0_67:1.70
	OMAP3-0_66:1.69
	OMAP3-0_65:1.68
	OMAP3-0_64:1.67
	OMAP3-0_63:1.66
	OMAP3-0_62:1.65
	OMAP3-0_61:1.64
	OMAP3-0_60:1.63
	OMAP3-0_59:1.62
	OMAP3-0_58:1.61
	OMAP3-0_57:1.60
	OMAP3-0_56:1.59
	OMAP3-0_55:1.58
	OMAP3-0_54:1.57
	OMAP3-0_53:1.56
	OMAP3-0_52:1.55
	OMAP3-0_51:1.54
	OMAP3-0_50:1.53
	OMAP3-0_49:1.52
	OMAP3-0_48:1.51
	OMAP3-0_47:1.50
	OMAP3-0_46:1.49
	OMAP3-0_45:1.48
	OMAP3-0_44:1.47
	OMAP3-0_43:1.46
	OMAP3-0_42:1.45
	OMAP3-0_41:1.44
	OMAP3-0_40:1.43
	OMAP3-0_39:1.42
	OMAP3-0_38:1.41
	OMAP3-0_37:1.40
	OMAP3-0_36:1.39
	OMAP3-0_35:1.38
	OMAP3-0_34:1.37
	OMAP3-0_33:1.36
	OMAP3-0_32:1.35
	OMAP3-0_31:1.34
	OMAP3-0_30:1.33
	OMAP3-0_29:1.32
	OMAP3-0_28:1.31
	OMAP3-0_27:1.30
	OMAP3-0_26:1.29
	OMAP3-0_25:1.28
	OMAP3-0_24:1.27
	OMAP3-0_23:1.26
	OMAP3-0_22:1.25
	OMAP3-0_21:1.24
	OMAP3-0_20:1.23
	OMAP3-0_19:1.22
	OMAP3-0_18:1.21
	OMAP3-0_17:1.20
	OMAP3-0_16:1.19
	OMAP3-0_15:1.18
	OMAP3-0_14:1.17
	OMAP3-0_13:1.16
	OMAP3-0_12:1.15
	OMAP3-0_11:1.14
	OMAP3-0_10:1.11
	OMAP3-0_09:1.10
	OMAP3-0_08:1.9
	OMAP3-0_07:1.8
	OMAP3-0_06:1.7
	OMAP3-0_05:1.6
	OMAP3-0_04:1.5
	OMAP3-0_03:1.4
	OMAP3-0_02:1.3
	OMAP3-0_01:1.2
	OMAP3-0_00:1.1;
locks; strict;
comment	@# @;


1.93
date	2013.11.01.18.52.52;	author rsprowson;	state dead;
branches;
next	1.92;
commitid	exT1lzL3WDXiEBbx;

1.92
date	2013.09.28.07.07.49;	author rsprowson;	state Exp;
branches;
next	1.91;
commitid	jSkqFhfWJkacQa7x;

1.91
date	2013.08.17.13.13.49;	author rsprowson;	state Exp;
branches;
next	1.90;
commitid	sIqq7KO5sExsdO1x;

1.90
date	2013.08.15.13.39.49;	author rsprowson;	state Exp;
branches;
next	1.89;
commitid	lNtJbslyvHNmqy1x;

1.89
date	2013.02.21.20.19.59;	author jlee;	state Exp;
branches;
next	1.88;
commitid	bT81ucbfWqcpg6Fw;

1.88
date	2013.01.22.23.24.10;	author jlee;	state Exp;
branches;
next	1.87;
commitid	Almuk1cqEHQnfgBw;

1.87
date	2013.01.13.20.35.04;	author jlee;	state Exp;
branches;
next	1.86;
commitid	ZhVfsWvYtPXiB5Aw;

1.86
date	2012.11.21.23.36.53;	author jlee;	state Exp;
branches;
next	1.85;
commitid	FEuG5wzxvhvijitw;

1.85
date	2012.10.07.23.06.09;	author jlee;	state Exp;
branches;
next	1.84;
commitid	7PiwdqwfsfurAvnw;

1.84
date	2012.09.30.16.36.37;	author jlee;	state Exp;
branches;
next	1.83;
commitid	mVbXtrwyVtNKEzmw;

1.83
date	2012.09.23.23.09.03;	author jlee;	state Exp;
branches;
next	1.82;
commitid	AFn1mbdgXAGk3Ilw;

1.82
date	2012.09.21.15.17.00;	author jlee;	state Exp;
branches;
next	1.81;
commitid	x7ZCrdwZgdjnvplw;

1.81
date	2012.08.07.22.16.29;	author jlee;	state Exp;
branches;
next	1.80;
commitid	1DvzzXQusUjYgFfw;

1.80
date	2012.07.22.10.28.47;	author bavison;	state Exp;
branches;
next	1.79;
commitid	4FfoPIH8qco4Sxdw;

1.79
date	2012.07.20.10.36.19;	author bavison;	state Exp;
branches;
next	1.78;
commitid	pb1TP6MQUItDYhdw;

1.78
date	2012.07.19.22.54.16;	author bavison;	state Exp;
branches;
next	1.77;
commitid	JeBh5elkrI7N5edw;

1.77
date	2012.07.18.23.02.39;	author jlee;	state Exp;
branches;
next	1.76;
commitid	gm1WcfapVdjFa6dw;

1.76
date	2012.07.16.23.39.39;	author bavison;	state Exp;
branches;
next	1.75;
commitid	OLnpnAANInplrQcw;

1.75
date	2012.07.09.07.23.27;	author rsprowson;	state Exp;
branches;
next	1.74;
commitid	7gpK5cMp8ToogRbw;

1.74
date	2012.07.08.22.47.05;	author bavison;	state Exp;
branches;
next	1.73;
commitid	whWpeQfuv9KfpObw;

1.73
date	2012.07.06.00.57.40;	author bavison;	state Exp;
branches;
next	1.72;
commitid	O3bKVLe2LQ22erbw;

1.72
date	2012.07.04.17.57.54;	author rsprowson;	state Exp;
branches;
next	1.71;
commitid	XMhv0CBs1aW0Wgbw;

1.71
date	2012.07.02.17.50.16;	author bavison;	state Exp;
branches;
next	1.70;
commitid	Ukt7tNPf83vnX0bw;

1.70
date	2012.06.11.22.42.56;	author jlee;	state Exp;
branches;
next	1.69;
commitid	progsLwVVKLDfl8w;

1.69
date	2012.06.07.23.15.12;	author bavison;	state Exp;
branches;
next	1.68;
commitid	AkxjZwpvyQFFyP7w;

1.68
date	2012.06.06.23.24.39;	author jlee;	state Exp;
branches;
next	1.67;
commitid	V8uU5ZGnsNVTDH7w;

1.67
date	2012.06.04.23.45.04;	author jlee;	state Exp;
branches;
next	1.66;
commitid	m70jrk0mZm9UOr7w;

1.66
date	2012.04.22.23.21.58;	author jlee;	state Exp;
branches;
next	1.65;
commitid	ijXjK5A9BHWF4V1w;

1.65
date	2012.04.08.22.37.45;	author jlee;	state Exp;
branches;
next	1.64;
commitid	3W6tvBOo1ezoh70w;

1.64
date	2012.03.25.11.48.58;	author rsprowson;	state Exp;
branches;
next	1.63;
commitid	c99VvmwezV2J8gYv;

1.63
date	2012.03.07.21.47.17;	author jlee;	state Exp;
branches;
next	1.62;
commitid	6ngNMpmvDflR10Wv;

1.62
date	2012.02.25.16.28.06;	author jlee;	state Exp;
branches;
next	1.61;
commitid	8PdHKiULlWJhCyUv;

1.61
date	2012.01.21.19.39.53;	author jlee;	state Exp;
branches;
next	1.60;
commitid	Ax0JFkQAJsPPN4Qv;

1.60
date	2012.01.15.08.37.17;	author rsprowson;	state Exp;
branches;
next	1.59;
commitid	x0ab4JAMToptkfPv;

1.59
date	2012.01.07.21.22.11;	author rsprowson;	state Exp;
branches;
next	1.58;
commitid	ZJYg3muaiybPOhOv;

1.58
date	2011.12.12.23.06.06;	author jlee;	state Exp;
branches;
next	1.57;
commitid	Xg97znkZPBiieXKv;

1.57
date	2011.12.11.20.05.37;	author jlee;	state Exp;
branches;
next	1.56;
commitid	qwIOyJsuN21ngOKv;

1.56
date	2011.12.06.00.53.04;	author jlee;	state Exp;
branches;
next	1.55;
commitid	GOsa7uJEOvnW24Kv;

1.55
date	2011.12.04.19.14.45;	author jlee;	state Exp;
branches;
next	1.54;
commitid	ITJDzEpHbl3ScUJv;

1.54
date	2011.11.29.22.46.08;	author jlee;	state Exp;
branches;
next	1.53;
commitid	bYJYUuZQ3ItlxhJv;

1.53
date	2011.11.06.13.51.15;	author jlee;	state Exp;
branches;
next	1.52;
commitid	xDHSfy5FwWIFjhGv;

1.52
date	2011.09.12.20.35.45;	author jlee;	state Exp;
branches;
next	1.51;
commitid	b4CSwApHlXY3kfzv;

1.51
date	2011.07.31.18.56.14;	author jlee;	state Exp;
branches;
next	1.50;
commitid	trdyxuPEj4eC9Itv;

1.50
date	2011.07.24.21.34.32;	author jlee;	state Exp;
branches;
next	1.49;
commitid	2eoDX0AwjB7SfPsv;

1.49
date	2011.05.30.22.43.39;	author jlee;	state Exp;
branches;
next	1.48;
commitid	9mPzaK1NaLZbpLlv;

1.48
date	2011.05.25.20.19.23;	author jlee;	state Exp;
branches;
next	1.47;
commitid	3j2efxRJLXkFL6lv;

1.47
date	2011.05.23.22.36.52;	author jlee;	state Exp;
branches;
next	1.46;
commitid	bnISDC4C6dEOARkv;

1.46
date	2011.05.22.19.35.59;	author jlee;	state Exp;
branches;
next	1.45;
commitid	VEzaKWvEB8QKCIkv;

1.45
date	2011.03.20.17.04.02;	author jlee;	state Exp;
branches;
next	1.44;
commitid	MYulLwX3WKwbOBcv;

1.44
date	2011.03.19.18.43.32;	author jlee;	state Exp;
branches;
next	1.43;
commitid	luFqb0o1sKujoucv;

1.43
date	2011.02.20.01.26.06;	author jlee;	state Exp;
branches;
next	1.42;

1.42
date	2011.02.19.22.26.25;	author jlee;	state Exp;
branches;
next	1.41;

1.41
date	2011.01.23.22.48.06;	author jlee;	state Exp;
branches;
next	1.40;

1.40
date	2010.12.04.16.57.42;	author jlee;	state Exp;
branches;
next	1.39;

1.39
date	2010.11.08.22.56.22;	author jlee;	state Exp;
branches;
next	1.38;

1.38
date	2010.11.08.20.27.18;	author jlee;	state Exp;
branches;
next	1.37;

1.37
date	2010.10.31.20.03.14;	author jlee;	state Exp;
branches;
next	1.36;

1.36
date	2010.10.26.23.27.05;	author jlee;	state Exp;
branches;
next	1.35;

1.35
date	2010.09.14.20.58.43;	author jlee;	state Exp;
branches;
next	1.34;

1.34
date	2010.08.14.21.35.26;	author jlee;	state Exp;
branches;
next	1.33;

1.33
date	2010.06.24.00.33.48;	author jlee;	state Exp;
branches;
next	1.32;

1.32
date	2010.06.24.00.29.34;	author jlee;	state Exp;
branches;
next	1.31;

1.31
date	2010.06.23.22.30.29;	author jlee;	state Exp;
branches;
next	1.30;

1.30
date	2010.04.03.20.23.27;	author jlee;	state Exp;
branches;
next	1.29;

1.29
date	2010.03.28.17.59.47;	author jlee;	state Exp;
branches;
next	1.28;

1.28
date	2010.03.20.01.40.17;	author jlee;	state Exp;
branches;
next	1.27;

1.27
date	2010.03.20.01.07.03;	author jlee;	state Exp;
branches;
next	1.26;

1.26
date	2010.02.28.19.47.10;	author jlee;	state Exp;
branches;
next	1.25;

1.25
date	2010.01.31.18.08.49;	author jlee;	state Exp;
branches;
next	1.24;

1.24
date	2010.01.30.00.23.17;	author jlee;	state Exp;
branches;
next	1.23;

1.23
date	2010.01.24.15.51.17;	author jlee;	state Exp;
branches;
next	1.22;

1.22
date	2010.01.24.02.49.24;	author jlee;	state Exp;
branches;
next	1.21;

1.21
date	2010.01.16.04.09.37;	author jlee;	state Exp;
branches;
next	1.20;

1.20
date	2009.11.29.19.28.06;	author jlee;	state Exp;
branches;
next	1.19;

1.19
date	2009.11.28.22.30.54;	author jlee;	state Exp;
branches;
next	1.18;

1.18
date	2009.11.07.03.22.44;	author jlee;	state Exp;
branches;
next	1.17;

1.17
date	2009.10.27.22.34.21;	author jlee;	state Exp;
branches;
next	1.16;

1.16
date	2009.07.23.01.02.57;	author jlee;	state Exp;
branches;
next	1.15;

1.15
date	2009.07.17.00.16.23;	author jlee;	state Exp;
branches;
next	1.14;

1.14
date	2009.07.02.19.37.03;	author jlee;	state Exp;
branches;
next	1.13;

1.13
date	2009.06.15.23.44.30;	author bavison;	state Exp;
branches;
next	1.12;

1.12
date	2009.06.11.21.04.44;	author bavison;	state Exp;
branches;
next	1.11;

1.11
date	2009.05.13.00.12.47;	author jlee;	state Exp;
branches;
next	1.10;

1.10
date	2009.05.10.18.53.32;	author jlee;	state Exp;
branches;
next	1.9;

1.9
date	2009.05.09.19.04.56;	author jlee;	state Exp;
branches;
next	1.8;

1.8
date	2009.04.23.23.35.05;	author jlee;	state Exp;
branches;
next	1.7;

1.7
date	2009.04.22.22.03.36;	author jlee;	state Exp;
branches;
next	1.6;

1.6
date	2009.04.10.22.05.46;	author jlee;	state Exp;
branches;
next	1.5;

1.5
date	2009.04.08.22.25.06;	author jlee;	state Exp;
branches;
next	1.4;

1.4
date	2009.03.06.23.35.38;	author jlee;	state Exp;
branches;
next	1.3;

1.3
date	2009.02.21.18.51.43;	author jlee;	state Exp;
branches;
next	1.2;

1.2
date	2009.02.01.13.58.02;	author jlee;	state Exp;
branches;
next	1.1;

1.1
date	2009.01.27.21.22.53;	author bavison;	state Exp;
branches;
next	;


desc
@@


1.93
log
@Refactor IIC calls to use RISCOS_IICOpV
- Comments and symbolic names for RTC register bits copied over from OMAP4 sources.
- Delete dead function ReadTimeForNVRAM.
- Use RTCFormatFlags_BCD_NeedsYearHelp flag for year 2070 compatibility.
- Moved CallOS macro into a header.
Tested on a Beagleboard xM, clock still worked over a power cycle.

Version 0.90. Tagged as 'OMAP3-0_90'
@
text
@;
; This file is automatically maintained by srccommit, do not edit manually.
; Last processed by srccommit version: 1.1.
;
                        GBLS    Module_MajorVersion
                        GBLA    Module_Version
                        GBLS    Module_MinorVersion
                        GBLS    Module_Date
                        GBLS    Module_FullVersion
                        GBLS    Module_ApplicationDate
                        GBLS    Module_HelpVersion
                        GBLS    Module_ComponentName
                        GBLS    Module_ComponentPath
Module_MajorVersion     SETS    "0.89"
Module_Version          SETA    89
Module_MinorVersion     SETS    ""
Module_Date             SETS    "28 Sep 2013"
Module_ApplicationDate  SETS    "28-Sep-13"
Module_ComponentName    SETS    "OMAP3"
Module_ComponentPath    SETS    "castle/RiscOS/Sources/HAL/OMAP3"
Module_FullVersion      SETS    "0.89"
Module_HelpVersion      SETS    "0.89 (28 Sep 2013)"
                        END
@


1.92
log
@Modification to RISCOS_IICOpV
Now assumes an IICStatus return, per Kernel-5_35-4_79_2_196.
I2C sources lined up to column 17.
Built, but not tested.

Version 0.89. Tagged as 'OMAP3-0_89'
@
text
@@


1.91
log
@Probe earlier, declare device later
Revision 0.87 moved the NVMemory probe too late for the kernel, which fell back to using its default table.
Fixes problem of apparently lost configuration
  http://www.riscosopen.org/forum/forums/4/topics/2063
Video_Init capitalised like the other initialisation functions.

Version 0.88. Tagged as 'OMAP3-0_88'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.88"
Module_Version          SETA    88
d17 2
a18 2
Module_Date             SETS    "17 Aug 2013"
Module_ApplicationDate  SETS    "17-Aug-13"
d21 2
a22 2
Module_FullVersion      SETS    "0.88"
Module_HelpVersion      SETS    "0.88 (17 Aug 2013)"
@


1.90
log
@Create placeholder NVMemory HAL device when EEPROM detected
The HAL device created is merely a dummy one, but presents any EEPROM detected for completeness of stuff the HAL knows about.

Version 0.87. Tagged as 'OMAP3-0_87'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.87"
Module_Version          SETA    87
d17 2
a18 2
Module_Date             SETS    "15 Aug 2013"
Module_ApplicationDate  SETS    "15-Aug-13"
d21 2
a22 2
Module_FullVersion      SETS    "0.87"
Module_HelpVersion      SETS    "0.87 (15 Aug 2013)"
@


1.89
log
@Disable SD card write protect sensing on Pandora
Detail:
  s/SDIO - Disabled SD write protect sensing on Pandora, as hardware faults can result in some units always reporting that cards are protected
Admin:
  Tested briefly on Pandora, write-protected cards can be written to
  Should fix issue reported on forums with unprotected cards being reported as read-only:
  http://www.riscosopen.org/forum/forums/5/topics/166?page=18#posts-19848


Version 0.86. Tagged as 'OMAP3-0_86'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.86"
Module_Version          SETA    86
d17 2
a18 2
Module_Date             SETS    "21 Feb 2013"
Module_ApplicationDate  SETS    "21-Feb-13"
d21 2
a22 2
Module_FullVersion      SETS    "0.86"
Module_HelpVersion      SETS    "0.86 (21 Feb 2013)"
@


1.88
log
@Implement HAL_IRQMax
Detail:
  s/Boot, s/Interrupts - Added HAL_IRQMax implementation, to ensure correct functionality with latest Kernel
Admin:
  Tested on BB-xM
  Requires Kernel-5_35-4_79_2_182


Version 0.85. Tagged as 'OMAP3-0_85'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.85"
Module_Version          SETA    85
d17 2
a18 2
Module_Date             SETS    "22 Jan 2013"
Module_ApplicationDate  SETS    "22-Jan-13"
d21 2
a22 2
Module_FullVersion      SETS    "0.85"
Module_HelpVersion      SETS    "0.85 (22 Jan 2013)"
@


1.87
log
@Program the gamma table in the Pandora's LCD
Detail:
  s/Video - Added code to program the gamma table in the Pandora's LCD, as the power-on settings aren't very good
  s/Boot - Initialise the LCD at the right time
  hdr/SPI - SPI register definitions, for programming the gamma table and (eventually) a full SPI driver
Admin:
  Tested on Pandora


Version 0.84. Tagged as 'OMAP3-0_84'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.84"
Module_Version          SETA    84
d17 2
a18 2
Module_Date             SETS    "13 Jan 2013"
Module_ApplicationDate  SETS    "13-Jan-13"
d21 2
a22 2
Module_FullVersion      SETS    "0.84"
Module_HelpVersion      SETS    "0.84 (13 Jan 2013)"
@


1.86
log
@Add BMU support for Pandora & TouchBook
Detail:
  s/BMU, Makefile - BMU HAL device implementations for the Pandora & TouchBook
  hdr/StaticWS - Reserve workspace for the BMU devices
  s/Boot - Add the BMU devices to HAL device initialisation. Move Enable_main_battery_charging into s/BMU.
Admin:
  Tested in ROM on BB-xM, Pandora, TouchBook


Version 0.83. Tagged as 'OMAP3-0_83'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.83"
Module_Version          SETA    83
d17 2
a18 2
Module_Date             SETS    "21 Nov 2012"
Module_ApplicationDate  SETS    "21-Nov-12"
d21 2
a22 2
Module_FullVersion      SETS    "0.83"
Module_HelpVersion      SETS    "0.83 (21 Nov 2012)"
@


1.85
log
@Switch to default clock speed before reset/power off. Place EHCI PHY in reset too.
Detail:
  hdr/CPUClk, hdr/SR37x, s/Boot, s/CPUClk, s/SR37x - Modifed CPU clock drivers to allow the core speed & voltage to be reset to the power on defaults prior to reset/poweroff. This fixes an issue seen on Pandora where Linux will often fail to boot after RISC OS has been run, presumably due to VDD1 being too low for the initial clock speed Linux switches to.
  s/Boot - Place EHCI PHY in reset prior to reset/power off. May help with a reported issue of USB host being unreliable after RISC OS has been run (although reset/poweroff should reset the GPIO anyway)
Admin:
  Tested on Pandora & BB-xM


Version 0.82. Tagged as 'OMAP3-0_82'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.82"
Module_Version          SETA    82
d17 2
a18 2
Module_Date             SETS    "08 Oct 2012"
Module_ApplicationDate  SETS    "08-Oct-12"
d21 2
a22 2
Module_FullVersion      SETS    "0.82"
Module_HelpVersion      SETS    "0.82 (08 Oct 2012)"
@


1.84
log
@Implement Pandora keyboard scan & audio support
Detail:
  s/PAudio, Makefile - Added Pandora audio driver. The Pandora uses a different audio setup to all the other OMAP boards, so to keep things simple the implementation is kept in its own file seperate from the main one.
  s/KbdMatrix, hdr/StaticWS - Implemented Pandora boot-time keyboard scan. This uses the keyboard matrix & GPIO keys instead of the USB libraries.
  s/Boot - Moved call to Audio_Init into the per-board HAL_InitDevices code so that Pandora can call PandoraAudio_Init instead.
  s/SDIO - For MMC1, avoid touching VSIM if the bus width is only 4 bits (i.e. on Pandora). On Pandora VSIM is used for the audio DAC instead.
Admin:
  Tested on Pandora


Version 0.81. Tagged as 'OMAP3-0_81'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.81"
Module_Version          SETA    81
d17 2
a18 2
Module_Date             SETS    "30 Sep 2012"
Module_ApplicationDate  SETS    "30-Sep-12"
d21 2
a22 2
Module_FullVersion      SETS    "0.81"
Module_HelpVersion      SETS    "0.81 (30 Sep 2012)"
@


1.83
log
@Configure Pandora battery charging
Detail:
  s/Boot - Under Linux the Pandora uses a similar battery charging setup to the TouchBook. Reuse our TouchBook battery charging setup code to set things up appropriately for the Pandora.
Admin:
  Tested on Pandora


Version 0.80. Tagged as 'OMAP3-0_80'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.80"
Module_Version          SETA    80
d17 2
a18 2
Module_Date             SETS    "23 Sep 2012"
Module_ApplicationDate  SETS    "23-Sep-12"
d21 2
a22 2
Module_FullVersion      SETS    "0.80"
Module_HelpVersion      SETS    "0.80 (23 Sep 2012)"
@


1.82
log
@Tidy up board-specific code. Improve Pandora support.
Detail:
  hdr/board, s/board, s/Boot - Tidied up board-specific code a bit by adding more board-specific function pointers to the BoardConfig struct instead of relying on manual board detection in code.
  s/board - Disable Pandora VideoGPIO as turning the LCD on & off seems to result in graphical corruption, most likely due to settings which were set by the SPI interface being lost.
  s/KbdMatrix, Makefile - New file for handling the Pandora's keyboard matrix (and anything else that may require keyboard matrix code in the HAL). Contains stub code for the boot-time keyboard scan, and code to register a keyboard HAL device for detection by the PandoraKey module.
  s/Boot - Add soft-off support for Pandora. Add Pandora-specific initialisation code to enable some extra power supplies (touchscreen, nubs, audio DAC, EHCI PHY)
  s/KbdScan - Use Pandora-specific keyboard scan code instead of USB code when running on Pandora
  s/SDIO - Correct sense of MMC activity LEDs on Pandora. Now only lit during periods of activity, to match behaviour of the Pandora Linux distro.
  s/Video - Add some switched out hack code to allow easier debugging of aborts that occur during ROM initialisation
Admin:
  Tested on Pandora, rev C2 BB, rev A2 BB-xM, rev C1 TouchBook


Version 0.79. Tagged as 'OMAP3-0_79'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.79"
Module_Version          SETA    79
d17 2
a18 2
Module_Date             SETS    "21 Sep 2012"
Module_ApplicationDate  SETS    "21-Sep-12"
d21 2
a22 2
Module_FullVersion      SETS    "0.79"
Module_HelpVersion      SETS    "0.79 (21 Sep 2012)"
@


1.81
log
@Temporarily disable TV-out on Pandora
Detail:
  s/board - Temporarily disable TV-out on Pandora, as the current TV detection code in OMAPVideo is believed to be causing false-positives with new some of the newer units.
Admin:
  Builds, but untested


Version 0.78. Tagged as 'OMAP3-0_78'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.78"
Module_Version          SETA    78
d17 2
a18 2
Module_Date             SETS    "07 Aug 2012"
Module_ApplicationDate  SETS    "07-Aug-12"
d21 2
a22 2
Module_FullVersion      SETS    "0.78"
Module_HelpVersion      SETS    "0.78 (07 Aug 2012)"
@


1.80
log
@  Fix for data abort in Pandora builds
Detail:
  MMC2 activate code was corrupting R4
Admin:
  Tested by making a beagleboard run the Pandora code variant

Version 0.77. Tagged as 'OMAP3-0_77'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.77"
Module_Version          SETA    77
d17 2
a18 2
Module_Date             SETS    "22 Jul 2012"
Module_ApplicationDate  SETS    "22-Jul-12"
d21 2
a22 2
Module_FullVersion      SETS    "0.77"
Module_HelpVersion      SETS    "0.77 (22 Jul 2012)"
@


1.79
log
@  Build fix
Detail:
  Oops, last change broke ADR range...
Admin:
  Checked that it builds this time

Version 0.76. Tagged as 'OMAP3-0_76'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.76"
Module_Version          SETA    76
d17 2
a18 2
Module_Date             SETS    "20 Jul 2012"
Module_ApplicationDate  SETS    "20-Jul-12"
d21 2
a22 2
Module_FullVersion      SETS    "0.76"
Module_HelpVersion      SETS    "0.76 (20 Jul 2012)"
@


1.78
log
@  Bugfix to SDHCI devices
Detail:
  The return values from the Activate entries were left uninitialised; at
  least in the case of Pandora MMC2, R0 happened to contain 0, which resulted
  in SDIODriver assuming the device had failed to initialise.
Admin:
  Untested, but a safe change.

Version 0.75. Tagged as 'OMAP3-0_75'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.75"
Module_Version          SETA    75
d17 2
a18 2
Module_Date             SETS    "19 Jul 2012"
Module_ApplicationDate  SETS    "19-Jul-12"
d21 2
a22 2
Module_FullVersion      SETS    "0.75"
Module_HelpVersion      SETS    "0.75 (19 Jul 2012)"
@


1.77
log
@Add support for TV detection
Detail:
  hdr/board, s/Video - Video device now implements the tvdet_func function for polling the TV detect GPIO
Admin:
  Tested on BB-xM with high processor vectors


Version 0.74. Tagged as 'OMAP3-0_74'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.74"
Module_Version          SETA    74
d21 2
a22 2
Module_FullVersion      SETS    "0.74"
Module_HelpVersion      SETS    "0.74 (19 Jul 2012)"
@


1.76
log
@  Another attempt at making the second MMC slot on Pandora work
Detail:
  Copied the pin mux settings and SD controller power-up code from the
  ZippySupport module. The Zippy uses a level shifter, like the Pandora,
  so this should have a decent chance of working. Issues might still remain
  with the card detect, since Pandora uses the TPS for this.
Admin:
  Builds, but untested.

Version 0.73. Tagged as 'OMAP3-0_73'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.73"
Module_Version          SETA    73
d17 2
a18 2
Module_Date             SETS    "17 Jul 2012"
Module_ApplicationDate  SETS    "17-Jul-12"
d21 2
a22 2
Module_FullVersion      SETS    "0.73"
Module_HelpVersion      SETS    "0.73 (17 Jul 2012)"
@


1.75
log
@Adopt revised HAL_PhysInfo API
Also spotted that USAT can be conditional in the I2C code.

Version 0.72. Tagged as 'OMAP3-0_72'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.72"
Module_Version          SETA    72
d17 2
a18 2
Module_Date             SETS    "09 Jul 2012"
Module_ApplicationDate  SETS    "09-Jul-12"
d21 2
a22 2
Module_FullVersion      SETS    "0.72"
Module_HelpVersion      SETS    "0.72 (09 Jul 2012)"
@


1.74
log
@  Another attempt to enable MMC2 on Pandora
Detail:
  An additional register write in the OMAP3 is required to loop back the
  clock from the external transciever chip. Thanks to "notaz" for the tip.
Admin:
  Builds OK, but untested

Version 0.71. Tagged as 'OMAP3-0_71'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.71"
Module_Version          SETA    71
d17 2
a18 2
Module_Date             SETS    "08 Jul 2012"
Module_ApplicationDate  SETS    "08-Jul-12"
d21 2
a22 2
Module_FullVersion      SETS    "0.71"
Module_HelpVersion      SETS    "0.71 (08 Jul 2012)"
@


1.73
log
@  Changes to MMC initialisation for Pandora
Detail:
  Forcibly sets the voltage for MMC2 level shifter to 3.0V.
  Attempts to configure TPS GPIO inputs in a way that might work.
Admin:
  Builds, but untested.

Version 0.70. Tagged as 'OMAP3-0_70'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.70"
Module_Version          SETA    70
d17 2
a18 2
Module_Date             SETS    "06 Jul 2012"
Module_ApplicationDate  SETS    "06-Jul-12"
d21 2
a22 2
Module_FullVersion      SETS    "0.70"
Module_HelpVersion      SETS    "0.70 (06 Jul 2012)"
@


1.72
log
@Refactor HAL_VideoIICOp to be ATPCS
No longer specified to return _kernel_oserror * implements GraphicsV 14.
Make use of IICStatus defines instead of local copies.
Rename HAL_Video_ to HAL_Video.
Tested on Beagleboard xM, reading EDID from Hyundai monitor.

Version 0.69. Tagged as 'OMAP3-0_69'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.69"
Module_Version          SETA    69
d17 2
a18 2
Module_Date             SETS    "04 Jul 2012"
Module_ApplicationDate  SETS    "04-Jul-12"
d21 2
a22 2
Module_FullVersion      SETS    "0.69"
Module_HelpVersion      SETS    "0.69 (04 Jul 2012)"
@


1.71
log
@  Added support for the SD slots and WiFi SDIO chip on the Pandora console
Detail:
  Information gathered from the "Pandora Hacker Guide" is a little sketchy
  so try with caution. Uniquely, the Pandora uses all 3 SD controllers on the
  OMAP3.
Admin:
  Checked that still functions on a beagleboard, but untested on Pandora!

Version 0.68. Tagged as 'OMAP3-0_68'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.68"
Module_Version          SETA    68
d17 2
a18 2
Module_Date             SETS    "02 Jul 2012"
Module_ApplicationDate  SETS    "02-Jul-12"
d21 2
a22 2
Module_FullVersion      SETS    "0.68"
Module_HelpVersion      SETS    "0.68 (02 Jul 2012)"
@


1.70
log
@Fix HAL_UARTModemControl. Tweak HAL_UARTStartUp.
Detail:
  s/UART:
  - HAL_UARTModemControl now uses the correct AND mask; previous code would have always had bit 0 of the mask set.
  - Fixed code in HAL_UARTModemControl that was testing for calls that don't write to the register
  - Removed code from HAL_UARTStartUp that was setting the OUT2 bit of MCR (that bit has a different purpose on OMAP, and won't do anything interesting unless another bit it set as well)
Admin:
  Tested on rev A2 BB-xM
  HAL now reports modem control lines changing correctly upon calls to HAL_UARTModemControl


Version 0.67. Tagged as 'OMAP3-0_67'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.67"
Module_Version          SETA    67
d17 2
a18 2
Module_Date             SETS    "11 Jun 2012"
Module_ApplicationDate  SETS    "11-Jun-12"
d21 2
a22 2
Module_FullVersion      SETS    "0.67"
Module_HelpVersion      SETS    "0.67 (11 Jun 2012)"
@


1.69
log
@  Added HAL devices for main board SDHCI controllers
Detail:
  * For Beagleboard and Beagleboard-xM, supports MMC1, and is tested
  * For DevKit8000, supports MMC1 (but untested)
  * For IGEPv2, supports MMC1 and MMC2 (but untested)
  * No support for controllers on other boards at the present time
Admin:
  Requires headers exported from SDIODriver

Version 0.66. Tagged as 'OMAP3-0_66'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.66"
Module_Version          SETA    66
d17 2
a18 2
Module_Date             SETS    "08 Jun 2012"
Module_ApplicationDate  SETS    "08-Jun-12"
d21 2
a22 2
Module_FullVersion      SETS    "0.66"
Module_HelpVersion      SETS    "0.66 (08 Jun 2012)"
@


1.68
log
@Sanitise HAL_USBControllerInfo
Detail:
  s/USB - For valid controllers, HAL_USBControllerInfo now always returns the correct USB struct size and fills in the controller type. The rest of the buffer is filled in only if the supplied size is large enough. This allows for proper probing of controllers without knowing the required buffer sizes beforehand.
Admin:
  Tested on rev A2 BB-xM


Version 0.65. Tagged as 'OMAP3-0_65'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.65"
Module_Version          SETA    65
d17 2
a18 2
Module_Date             SETS    "07 Jun 2012"
Module_ApplicationDate  SETS    "07-Jun-12"
d21 2
a22 2
Module_FullVersion      SETS    "0.65"
Module_HelpVersion      SETS    "0.65 (07 Jun 2012)"
@


1.67
log
@Add HAL_UARTDefault implementation. Delete old HAL video code. Add some SmartReflex tweaks.
Detail:
  hdr/board, s/board, s/Boot, s/UART - Added HAL_UARTDefault implementation, to allow OS_SerialOp to be used
  hdr/StaticWS, hdr/omap3530, s/Boot, s/Interrupts, s/Video - Removed old HAL video code. The OMAPVideo module is a much better video driver.
  s/SR37x - Add some SmartReflex tweaks which we can try if we run into any stability issues with the current code.
Admin:
  Tested on rev A2 BB-xM


Version 0.64. Tagged as 'OMAP3-0_64'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.64"
Module_Version          SETA    64
d17 2
a18 2
Module_Date             SETS    "05 Jun 2012"
Module_ApplicationDate  SETS    "05-Jun-12"
d21 2
a22 2
Module_FullVersion      SETS    "0.64"
Module_HelpVersion      SETS    "0.64 (05 Jun 2012)"
@


1.66
log
@Fix unreliable warm reset on some BB-xM boards. SmartReflex tweaks.
Detail:
  s/TPS - Added code to correctly configure the TPS/TWL to deal with warm resets. Required to make sure VDD1/VDD2 are set back to default when a reset occurs, thereby fixing the hang on reset that some people have been experiencing
  s/Boot - Add code to call TPS_Init
  s/SR37x - Improve debug code. Change initial OPP1G voltage from 1.35V to 1.38V, as recommended by datasheet
  s/KbdScan - Add a bit more debug output
Admin:
  Tested on rev C2 BB, A2 BB-xM, C1 TouchBook
  Fixes issue reported on forums with resets not working following addition of SmartReflex driver:
  http://www.riscosopen.org/forum/forums/4/topics/993


Version 0.63. Tagged as 'OMAP3-0_63'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.63"
Module_Version          SETA    63
d17 2
a18 2
Module_Date             SETS    "23 Apr 2012"
Module_ApplicationDate  SETS    "23-Apr-12"
d21 2
a22 2
Module_FullVersion      SETS    "0.63"
Module_HelpVersion      SETS    "0.63 (23 Apr 2012)"
@


1.65
log
@Add AM/DM37x SmartReflex driver
Detail:
  s/SR37x, hdr/SR37x - New files containing SmartReflex driver targeting AM/DM37x chips. Initialises SmartReflex for both VDD1 & VDD2, but currently only VDD1/DPLL1 settings can be adjusted at runtime (via CPUClk HAL device)
  Makefile - Add SR37x to object list
  hdr/CPUClk - Adjust OPPTbl_Max so CPUClk workspace size is >= SR37x workspace size (both drivers share their HAL workspace, since only one can be active at once)
  hdr/GPIO - Add TPS_GPPUPDCTR1 definition
  hdr/PRCM - Add SmartReflex related registers
  hdr/omap3530 - Add "control device status" register & extra AM/DM37x revision numbers
  s/CPUClk:
  - Modify CPUClk_PreInit to try initialising the SmartReflex driver.
  - Ensure SmartReflex is disabled in the TPS if using CPUClk driver.
  - Fix 'OPP60' typo in AMDM37x table.
  - Move DPLL adjustment code into its own function to allow it to be shared with SmartReflex driver.
  - Add a few ROUTs and ASSERTs for safety.
Admin:
  Both new & old CPUClk devices tested on BB-xM


Version 0.62. Tagged as 'OMAP3-0_62'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.62"
Module_Version          SETA    62
d17 2
a18 2
Module_Date             SETS    "08 Apr 2012"
Module_ApplicationDate  SETS    "08-Apr-12"
d21 2
a22 2
Module_FullVersion      SETS    "0.62"
Module_HelpVersion      SETS    "0.62 (08 Apr 2012)"
@


1.64
log
@Line some things up.
To help OMAP4 tracking changes a number of the changes were purely cosmetic lining up differences, this change is where OMAP3 wasn't on a conventional column layout.

Version 0.61. Tagged as 'OMAP3-0_61'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.61"
Module_Version          SETA    61
d17 2
a18 2
Module_Date             SETS    "25 Mar 2012"
Module_ApplicationDate  SETS    "25-Mar-12"
d21 2
a22 2
Module_FullVersion      SETS    "0.61"
Module_HelpVersion      SETS    "0.61 (25 Mar 2012)"
@


1.63
log
@Fix bug when linked against old kernels
Detail:
  s/Top - If a kernel which doesn't support compression was in use, a typo would lead to the ROM image size being calculated incorrectly, most likely causing the ROM relocation code to fail.
Admin:
  Tested on BB-xM
  Bug spotted by Willi Theiss


Version 0.60. Tagged as 'OMAP3-0_60'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.60"
Module_Version          SETA    60
d17 2
a18 2
Module_Date             SETS    "07 Mar 2012"
Module_ApplicationDate  SETS    "07-Mar-12"
d21 2
a22 2
Module_FullVersion      SETS    "0.60"
Module_HelpVersion      SETS    "0.60 (07 Mar 2012)"
@


1.62
log
@Add compressed ROM support. Add boot timing code. Other misc tweaks.
Detail:
  hdr/omap3530, s/Boot, s/KbdScan, s/Top, s/Video - Added code for profiling/timing the startup sequence, using the 32K system timer
  s/Boot - Ensure VAUX2 is enabled during EVM startup
  s/Boot, s/CPUClk - Go to full CPU speed during HAL_Init instead of HAL_InitDevices.
  s/KbdScan - Print out heap usage stats when debugging is enabled
  s/NVMemory - Skip probing for CMOS carrier board if JTAG is active
  s/RAM, s/Top - Use DMA to relocate the ROM image instead of simple memcpy code. Relocate compressed ROMs to a location suitable for decompression.
Admin:
  Tested with compressed & uncompressed OMAP3/OMAP3Live images


Version 0.59. Tagged as 'OMAP3-0_59'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.59"
Module_Version          SETA    59
d17 2
a18 2
Module_Date             SETS    "25 Feb 2012"
Module_ApplicationDate  SETS    "25-Feb-12"
d21 2
a22 2
Module_FullVersion      SETS    "0.59"
Module_HelpVersion      SETS    "0.59 (25 Feb 2012)"
@


1.61
log
@Add support for new HAL mixer 0.1 API. Improve mixer functionality.
Detail:
  hdr/Audio, s/Audio - The audio mixer now implements version 0.1 of the API, allowing it to return information about the min/max gain values supported by each channel.
  The code has also been updated to add support for an additional amplifier on the system audio channel, allowing for an extra +18dB volume boost
  Additionally, MixerGetMix will now return the clamped/rounded gain value that was last programmed to the hardware, instead of the unvalidated value the user supplied to MixerSetMix.
Admin:
  Tested in OMAP3 ROM


Version 0.58. Tagged as 'OMAP3-0_58'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.58"
Module_Version          SETA    58
d17 2
a18 2
Module_Date             SETS    "21 Jan 2012"
Module_ApplicationDate  SETS    "21-Jan-12"
d21 2
a22 2
Module_FullVersion      SETS    "0.58"
Module_HelpVersion      SETS    "0.58 (21 Jan 2012)"
@


1.60
log
@Add support for POR detection.
Harder than it should have been because someone wired the reset button up to the cold reset pin.
Now gets the OSStartFlags right so that delete-power-on et al are respected by the kernel.

Version 0.57. Tagged as 'OMAP3-0_57'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.57"
Module_Version          SETA    57
d17 2
a18 2
Module_Date             SETS    "15 Jan 2012"
Module_ApplicationDate  SETS    "15-Jan-12"
d21 2
a22 2
Module_FullVersion      SETS    "0.57"
Module_HelpVersion      SETS    "0.57 (15 Jan 2012)"
@


1.59
log
@Prep for SDFS and support for hardware CMOS adapter board.
To avoid conflicting use of the SDIO controller by higher level filing system (and the need for a HAL to somehow ask for a disc to be reinserted) this HAL onwards supports hardware CMOS attached via the JTAG connector.
On power up the presence and size of EEPROM is detected (sizes from 256 to 2048 bytes are understood corresponding to 24AA02 to 24AA16 family of parts).
If no EEPROM is found the HAL falls back to permitting a CMOS file to be loaded off the SD card, but crucially this is done by uboot before FileCore starts.
If no EEPROM is found, or the CMOS file looks suspicious, some fake CMOS is made and the kernel defaults used.
The "ProbeEESize" switch enables size probing, otherwise 256 bytes is assumed.
The "TryLoadedCMOS" switch enables use of a CMOS file from the SD card, if that's off and nothing is found the HAL declares that there is no CMOS at all!
The respective boot script needs the line
  fatload mmc 0:1 0x4020F000 cmos
adding to it, though the filename 'cmos' is arbitrary and only used as a suggestion.

Version 0.56. Tagged as 'OMAP3-0_56'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.56"
Module_Version          SETA    56
d17 2
a18 2
Module_Date             SETS    "07 Jan 2012"
Module_ApplicationDate  SETS    "07-Jan-12"
d21 2
a22 2
Module_FullVersion      SETS    "0.56"
Module_HelpVersion      SETS    "0.56 (07 Jan 2012)"
@


1.58
log
@Fix pop when disabling headset output. Tweak anti-pop ramp time.
Detail:
  s/Audio - Fixed the pop when disabling the headset output by making sure we wait for the correct amount of time after enabling/disabling the anti-pop ramp.
  Tweaked the anti-pop ramp time so toggling the output on & off (e.g. when changing sample rate) will only take 0.3s instead of 1.3s!
Admin:
  Tested on rev A2 BB-xM


Version 0.55. Tagged as 'OMAP3-0_55'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.55"
Module_Version          SETA    55
d17 2
a18 2
Module_Date             SETS    "12 Dec 2011"
Module_ApplicationDate  SETS    "12-Dec-11"
d21 2
a22 2
Module_FullVersion      SETS    "0.55"
Module_HelpVersion      SETS    "0.55 (12 Dec 2011)"
@


1.57
log
@NVMem fixes
Detail:
  c/NVMem - Fixed NVMem_C_write() to skip creating a CMOS file if the directory is full
  c/fat - Fixed FindDirectoryEntry() to ensure short_name[] is always terminated properly
  s/NVMemory - Only update the CMOS file if bytes have changed
  s/Boot - Fixed beagleboard revision detection GPIOs not being configured correctly
Admin:
  Tested on rev A2 BB-xM


Version 0.54. Tagged as 'OMAP3-0_54'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.54"
Module_Version          SETA    54
d17 2
a18 2
Module_Date             SETS    "11 Dec 2011"
Module_ApplicationDate  SETS    "11-Dec-11"
d21 2
a22 2
Module_FullVersion      SETS    "0.54"
Module_HelpVersion      SETS    "0.54 (11 Dec 2011)"
@


1.56
log
@NVMem tweaks and fixes
Detail:
  c/fat - Fixed ReadRootDirectoryBlock and WriteRootDirectoryBlock when dealing with FAT32 cards
  c/NVMem - Ensure FATbc.blocknum is initialised to an invalid value inside NVMem_C_write
  c/NVMem, c/far, h/NVMem - Change GetUInt() and GetUShort() to take data_area pointers instead of passing by reference, to reduce stack thrashing
Admin:
  Tested on rev A2 BB-xM
  Fixes supplied by Willi Theiss


Version 0.53. Tagged as 'OMAP3-0_53'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.53"
Module_Version          SETA    53
d17 2
a18 2
Module_Date             SETS    "06 Dec 2011"
Module_ApplicationDate  SETS    "06-Dec-11"
d21 2
a22 2
Module_FullVersion      SETS    "0.53"
Module_HelpVersion      SETS    "0.53 (06 Dec 2011)"
@


1.55
log
@Add preliminary OMAP3 EVM support. Fix HAL_UARTModemControl
Detail:
  hdr/board, s/Boot, s/Top, s/board - Added preliminary support for OMAP3 EVM boards. Only generation 2 boards are supported at the moment.
  s/UART - Fixed HAL_UARTModemControl to pay attention to the 'mask' parameter
Admin:
  Tested on rev A2 BB-xM. EVM support might not be fully working.


Version 0.52. Tagged as 'OMAP3-0_52'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.52"
Module_Version          SETA    52
d17 2
a18 2
Module_Date             SETS    "04 Dec 2011"
Module_ApplicationDate  SETS    "04-Dec-11"
d21 2
a22 2
Module_FullVersion      SETS    "0.52"
Module_HelpVersion      SETS    "0.52 (04 Dec 2011)"
@


1.54
log
@Fix OMAP3 HAL UART code
Detail:
  hdr/UART - Added a couple more register addresses, removed incorrect FIFO64 flag
  hdr/omap3530 - Corrected UART 2 address
  s/Boot - Ensure we perform phys2log address conversion for all UART addresses, not just the first 3. Also avoid resetting the debug UART.
  s/UART - Fix HAL UART calls to obey the programming rules laid out in the TRM
  s/board - Change the order in which the UARTs are exposed to RISC OS so that they match the hardware order. HAL UART 0 is now OMAP UART1, etc.
Admin:
  Tested on rev A2 BB-xM


Version 0.51. Tagged as 'OMAP3-0_51'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.51"
Module_Version          SETA    51
d17 2
a18 2
Module_Date             SETS    "29 Nov 2011"
Module_ApplicationDate  SETS    "29-Nov-11"
d21 2
a22 2
Module_FullVersion      SETS    "0.51"
Module_HelpVersion      SETS    "0.51 (29 Nov 2011)"
@


1.53
log
@Add Dave Higton's CMOS save code
Detail:
  Makefile - fixed warning about StdRules being included twice (via CModule)
  c/NVMem, c/fat, h/NVMem, h/common, h/fat, hdr/StaticWS, s/NVMemory, s/RTC - Added Dave Higton's code to create/update the 'CMOS' file on NVRAM writes
Admin:
  Tested on rev A2 BB-xM


Version 0.50. Tagged as 'OMAP3-0_50'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.50"
Module_Version          SETA    50
d17 2
a18 2
Module_Date             SETS    "06 Nov 2011"
Module_ApplicationDate  SETS    "06-Nov-11"
d21 2
a22 2
Module_FullVersion      SETS    "0.50"
Module_HelpVersion      SETS    "0.50 (06 Nov 2011)"
@


1.52
log
@OMAP3 HAL tweaks
Detail:
  hdr/Copro15ops - Correct encoding of ISH/ISHST variants of DMB/DSB instructions
  s/Top - Use RISCOS_InitARM to initialise the CPU instead of the (now out of date) custom code.
Admin:
  Tested on rev A2 BB-xM


Version 0.49. Tagged as 'OMAP3-0_49'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.49"
Module_Version          SETA    49
d17 2
a18 2
Module_Date             SETS    "12 Sep 2011"
Module_ApplicationDate  SETS    "12-Sep-11"
d21 2
a22 2
Module_FullVersion      SETS    "0.49"
Module_HelpVersion      SETS    "0.49 (12 Sep 2011)"
@


1.51
log
@Add new support for the new GPIO HAL device
Detail:
  hdr/board - Add information about determining the IGEP board revision
  hdr/StaticWS - Add workspace for storing the GPIO HAL device
  s/board - Update BeagleBoard entry to have a custom HAL device init func
  s/Boot - Fix HAL_Init to not configure GPIOs 171-173 if not running on a beagleboard. Update HAL_InitDevices to preserve the right registers and initialise the GPIO devices where appropriate.
  s/GPIO - Added GPIO_InitDevice function to do the actual initialisation
Admin:
  Tested on rev A2 BB-xM


Version 0.48. Tagged as 'OMAP3-0_48'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.48"
Module_Version          SETA    48
d17 2
a18 2
Module_Date             SETS    "31 Jul 2011"
Module_ApplicationDate  SETS    "31-Jul-11"
d21 2
a22 2
Module_FullVersion      SETS    "0.48"
Module_HelpVersion      SETS    "0.48 (31 Jul 2011)"
@


1.50
log
@Fix broken GPIO initialisation code
Detail:
  s/GPIO - GPIO_Init was broken and causing (silent) data aborts instead of clearing the GPIO module IRQ enable flags.
Admin:
  Tested on rev A2 BB-xM.
  Fixes issue reported by Willi Theiss.


Version 0.47. Tagged as 'OMAP3-0_47'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.47"
Module_Version          SETA    47
d17 2
a18 2
Module_Date             SETS    "24 Jul 2011"
Module_ApplicationDate  SETS    "24-Jul-11"
d21 2
a22 2
Module_FullVersion      SETS    "0.47"
Module_HelpVersion      SETS    "0.47 (24 Jul 2011)"
@


1.49
log
@Add timeout to audio init code
Detail:
  s/Audio - Added a timeout to the loop which waits for the McBSP FIFO to fill when starting the audio system.
Admin:
  This fixes the hang which can often occur if/when interrupts become enabled for any period of time during Service_PreReset.
  Tested on rev C2 beagleboard.


Version 0.46. Tagged as 'OMAP3-0_46'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.46"
Module_Version          SETA    46
d17 2
a18 2
Module_Date             SETS    "30 May 2011"
Module_ApplicationDate  SETS    "30-May-11"
d21 2
a22 2
Module_FullVersion      SETS    "0.46"
Module_HelpVersion      SETS    "0.46 (30 May 2011)"
@


1.48
log
@Be more thorough in GPIO initialisation
Detail:
  s/GPIO - The OMAP HAL now takes steps to make sure that the TPS GPIO controller is enabled, and that any GPIO-LEDs have the correct PWM settings. The TPS GPIO pull up/down settings are also initialised for the beagleboard.
Admin:
  Tested on rev C2 BB, A2 BB-xM, C BB-xM, C1 TouchBook


Version 0.45. Tagged as 'OMAP3-0_45'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.45"
Module_Version          SETA    45
d17 2
a18 2
Module_Date             SETS    "25 May 2011"
Module_ApplicationDate  SETS    "25-May-11"
d21 2
a22 2
Module_FullVersion      SETS    "0.45"
Module_HelpVersion      SETS    "0.45 (25 May 2011)"
@


1.47
log
@Add code to detect exact BeagleBoard revision, and to deal with new EHCI power controls on xM rev C
Detail:
  hdr/board - Definitions for GPIO values used to detect beagleboard revision
  s/Boot - Added code to detect BB revision via GPIO lines, in order to determine the correct setting for the TPS pin which controls the EHCI power
Admin:
  Tested on BB rev C2, BB-xM rev A2.
  BB xM rev C should work now!


Version 0.44. Tagged as 'OMAP3-0_44'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.44"
Module_Version          SETA    44
d17 2
a18 2
Module_Date             SETS    "23 May 2011"
Module_ApplicationDate  SETS    "23-May-11"
d21 2
a22 2
Module_FullVersion      SETS    "0.44"
Module_HelpVersion      SETS    "0.44 (23 May 2011)"
@


1.46
log
@Update OMAP3 HAL to support keyboard scan on boot, plus other changes
Detail:
  Makefile, s/KdbScan, hdr/StaticWS - Code to handle keyboard scanning, via the new HAL build of the USB drivers.
  s/Stubs - Removed old stub keyboard scan routines
  s/CPUClk - ADR -> ADRL to cope with new workspace layout
  s/Boot, s/Top, hdr/Post - Modified to use new HALSize variable for determining the HAL size. Trimmed dead code/definitions.
  s/Boot - FIQDebug code now copes with the different USER button GPIO used on the BB-xM
  s/board - Increased max pixel rate from 86.5MHz to 100MHz. This allows a wider range of screen modes to be used, although it is beyond the spec of the video controller, and not all boards will be able to reach 100MHz. This should match the value used in the initial ARMini units.
Admin:
  Tested on rev C2 BB, A2 BB-xM, C1 TouchBook
  Needs latest USB drivers, Kernel source, BuildSys & Env (not all of which have been checked in yet)


Version 0.43. Tagged as 'OMAP3-0_43'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.43"
Module_Version          SETA    43
d17 2
a18 2
Module_Date             SETS    "22 May 2011"
Module_ApplicationDate  SETS    "22-May-11"
d21 2
a22 2
Module_FullVersion      SETS    "0.43"
Module_HelpVersion      SETS    "0.43 (22 May 2011)"
@


1.45
log
@Fix OMAP3 IIC driver to flush RX/TX FIFOs before each transfer
Detail:
  s/I2C - The IIC driver now flushes the RX & TX FIFOs before each transfer. This ensures the correct data is sent/received following certain errors (e.g. NACK)
Admin:
  Tested on rev C1 TouchBook


Version 0.42. Tagged as 'OMAP3-0_42'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.42"
Module_Version          SETA    42
d17 2
a18 2
Module_Date             SETS    "20 Mar 2011"
Module_ApplicationDate  SETS    "20-Mar-11"
d21 2
a22 2
Module_FullVersion      SETS    "0.42"
Module_HelpVersion      SETS    "0.42 (20 Mar 2011)"
@


1.44
log
@Add CPUClk HAL device implementation
Detail:
  Makefile, s/CPUClk, hdr/CPUClk, s/Boot, hdr/StaticWS - Provide an implementation of the new HALDevice_CPUClk HAL device. Allows OMAP35x and DM37x CPU's to be set to any of the standard OPPs as listed in the datasheets. Doesn't yet support 1GHz on DM37x.
  hdr/NIC, hdr/PRCM, hdr/omap3530, s/TPS - Misc additions/tweaks/fixes.
Admin:
  Tested on rev C2 BB, A2 BB-xM, C1 TouchBook
  Requires latest PortableHAL & Kernel


Version 0.41. Tagged as 'OMAP3-0_41'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.41"
Module_Version          SETA    41
d17 2
a18 2
Module_Date             SETS    "19 Mar 2011"
Module_ApplicationDate  SETS    "19-Mar-11"
d21 2
a22 2
Module_FullVersion      SETS    "0.41"
Module_HelpVersion      SETS    "0.41 (19 Mar 2011)"
@


1.43
log
@Add support for new HAL_ExtMachineID call
Detail:
  s/Boot - Added support for the new HAL_ExtMachineID call, and changed HAL_MachineID to return 0's
Admin:
  Tested on rev A2 BB-xM


Version 0.40. Tagged as 'OMAP3-0_40'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.40"
Module_Version          SETA    40
d17 2
a18 2
Module_Date             SETS    "20 Feb 2011"
Module_ApplicationDate  SETS    "20-Feb-11"
d21 2
a22 2
Module_FullVersion      SETS    "0.40"
Module_HelpVersion      SETS    "0.40 (20 Feb 2011)"
@


1.42
log
@Update OMAP3 HAL to cope with kernel support for multiple IIC buses
Detail:
  s/I2C - Changed HAL_Video_IICOp to call RISCOS_IICOpV instead of using its own polling based transfer loop. Updated IIC_DoOp_Poll to work with multiple buses.
  s/board - Allow the OS to see the video IIC buses now that any transfers on them will be using OS_IICOp's queueing/re-entrancy code
Admin:
  Tested on rev A2 BB-xM


Version 0.39. Tagged as 'OMAP3-0_39'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.39"
Module_Version          SETA    39
d17 2
a18 2
Module_Date             SETS    "19 Feb 2011"
Module_ApplicationDate  SETS    "19-Feb-11"
d21 2
a22 2
Module_FullVersion      SETS    "0.39"
Module_HelpVersion      SETS    "0.39 (19 Feb 2011)"
@


1.41
log
@Add Dave Higton's SD/MMC & CMOS code
Detail:
  c/NVMem, c/fat, h/NVMem, h/common, h/fat - C code for reading a 'CMOS' file off the SD card on boot, for use as a CMOS RAM image
  c/CLib - Added extra functions needed by the SD/MMC driver
  s/NVMemory - Implementation of the HAL NVRAM API, for reading/writing the loaded CMOS file. The read/write functions handle RISC OS's CMOS address mangling, so that CMOS files saved by *SaveCMOS can be used as-is.
  hdr/StaticWS - Updated with workspace needed by the new code
  s/Boot - Initialise the CMOS cache on boot
  s/Stubs - Removed the stub NVRAM function
  Makefile - Added the new files
Admin:
  Tested on rev A2 BB-xM.


Version 0.38. Tagged as 'OMAP3-0_38'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.38"
Module_Version          SETA    38
d17 2
a18 2
Module_Date             SETS    "23 Jan 2011"
Module_ApplicationDate  SETS    "23-Jan-11"
d21 2
a22 2
Module_FullVersion      SETS    "0.38"
Module_HelpVersion      SETS    "0.38 (23 Jan 2011)"
@


1.40
log
@Fix RTC code to handle the case where only the date or only the time should be updated
Detail:
  s/RTC - RISC OS will set the time members and/or the date members of the RTCTimeStruct to -1 when it doesn't want them updating.
  So skip writing those entries to the RTC if they're not meant to be updated!
Admin:
  Tested on rev C2 beagle.
  Fixes issue reported on forums with setting date from BASIC:
  http://www.riscosopen.org/forum/forums/4/topics/521


Version 0.37. Tagged as 'OMAP3-0_37'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.37"
Module_Version          SETA    37
d17 2
a18 2
Module_Date             SETS    "04 Dec 2010"
Module_ApplicationDate  SETS    "04-Dec-10"
d21 2
a22 2
Module_FullVersion      SETS    "0.37"
Module_HelpVersion      SETS    "0.37 (04 Dec 2010)"
@


1.39
log
@Probable fix for IGEP video issues
Detail:
  s/board - filled in the VideoGPIO entry for the IGEP. From looking at recent linux sources it's quite clear that GPIO 170 is used for enabling the DVI framer, and 24 is used for resetting the EHCI controller.
Admin:
  Tested-ish on rev C2 beagleboard by setting GPIO 170 (pre-xM video GPIO) to an input shortly after boot (i.e. to the default setting, as it would be on an IGEP).
  IGEP-like display failures then followed, but everything went back to normal when the GPIO was set back to being an output.


Version 0.36. Tagged as 'OMAP3-0_36'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.36"
Module_Version          SETA    36
d17 2
a18 2
Module_Date             SETS    "08 Nov 2010"
Module_ApplicationDate  SETS    "08-Nov-10"
d21 2
a22 2
Module_FullVersion      SETS    "0.36"
Module_HelpVersion      SETS    "0.36 (08 Nov 2010)"
@


1.38
log
@Correct DM9000 NIC IRQ configuration
Detail:
  s/GPIO - The IRQ settings for the DevKit8000's NIC were wrong and should have been active-low, not active-high. This fixes that.
Admin:
  Tested by Stephen Leary with his NIC driver


Version 0.35. Tagged as 'OMAP3-0_35'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.35"
Module_Version          SETA    35
d21 2
a22 2
Module_FullVersion      SETS    "0.35"
Module_HelpVersion      SETS    "0.35 (08 Nov 2010)"
@


1.37
log
@Miscellaneous OMAP3 HAL updates
Detail:
  s/Boot - HAL_Reset now sets the PRM_RSTCTRL.RST_DPLL3 bit instead of the PRM_RSTCTRL_GS bit. This matches what Linux does, and seems to fix resets on the TouchBook.
  s/board - Changed TouchBook audio to use the hands-free output instead of the predriver. This fixes speaker output (although it's currently listed as "line out" by the sound setup configure plugin)
  hdr/board, s/board, s/Video - Update the LCDConfig struct to contain an entry for controlling LCD power/brightness. Hook up basic power controls for current machine types.
Admin:
  Tested on rev C2 beagleboard & C1 touchbook.
  Video changes mean that OMAPVideo 0.08 or newer is required.


Version 0.34. Tagged as 'OMAP3-0_34'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.34"
Module_Version          SETA    34
d17 2
a18 2
Module_Date             SETS    "31 Oct 2010"
Module_ApplicationDate  SETS    "31-Oct-10"
d21 2
a22 2
Module_FullVersion      SETS    "0.34"
Module_HelpVersion      SETS    "0.34 (31 Oct 2010)"
@


1.36
log
@Miscellaneous OMAP3 HAL improvements
Detail:
  hdr/board, s/board, s/Boot - Linux machine IDs are now defined via constants in hdr/board instead of magic numbers on a per-use basis
  s/Boot - Added video fix for BB-xM rev A3.
  s/Boot - Added code to enable tablet battery charging on TouchBook.
  s/Boot - Added support for power-off on TouchBook
  s/GPIO - Fixed bug in GPIOx_SetAsOutput that would prevent LEDs from being disabled properly
  s/I2C - Updated code to ignore BF interrupts. Added debugging code to help track down unexpected errors, and to check that IIC_DoOp_Poll is being called with interrupts disabled.
  s/SDMA - Call HAL_IRQClear when resetting the DMA controller device. This fixes the "previous IRQ not cleared" loop that would occur during RISC OS's pre-reset sequence
Admin:
  Tested on rev C2 beagleboard, C1 touchbook, A3 BBxM.
  Resets should now work reliably on all machines, except TouchBook, which still seems to hang. But on the bright side, the TouchBook is currently the only machine to support soft-off.


Version 0.33. Tagged as 'OMAP3-0_33'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.33"
Module_Version          SETA    33
d17 2
a18 2
Module_Date             SETS    "27 Oct 2010"
Module_ApplicationDate  SETS    "27-Oct-10"
d21 2
a22 2
Module_FullVersion      SETS    "0.33"
Module_HelpVersion      SETS    "0.33 (27 Oct 2010)"
@


1.35
log
@BeagleBoard-xM, TouchBook fixes
Detail:
  s/board, hdr/board, hdr/omap3530, hdr/UART - Add support for 4th UART available on AM/DM37x (i.e. BeagleBoard-xM)
  hdr/omap3530 - Add details of CONTROL_IDCODE register & known hawkeye/revision numbers for OMAP type/revision detection
  s/Boot, s/GPIO, hdr/GPIO, s/I2C, hdr/StaticWS - Allow TPS LED drivers to be used as (output-only) GPIOs. Add new polled I/O I2C function, and appropriate logic to make GPIO code use it instead of RISCOS_IICOpV if RISC OS hasn't finished initialising yet. Add code to initialise some extra BB/TB GPIOs on boot.
  s/Timers, hdr/Timers - Stop RISC OS from using GPTIMER9, because it's used to drive the screen backlight on the TouchBook
  s/Video - Use appropriate porch/sync limits on non-OMAP35x
  s/PRCM - Don't mess with the system clock divider when calculating system clock speed (AM/DM37x fix)
Admin:
  Tested on rev C2 beagleboard, rev A2 BB-xM (indirectly), rev C1 TouchBook


Version 0.32. Tagged as 'OMAP3-0_32'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.32"
Module_Version          SETA    32
d17 2
a18 2
Module_Date             SETS    "14 Sep 2010"
Module_ApplicationDate  SETS    "14-Sep-10"
d21 2
a22 2
Module_FullVersion      SETS    "0.32"
Module_HelpVersion      SETS    "0.32 (14 Sep 2010)"
@


1.34
log
@Add extra debugging code to OMAP3 HAL
Detail:
  s/Boot - The FIQDebug code can now be used to trigger the DebugCallstack code when the user button is pressed
Admin:
  Tested on rev C2 beagleboard


Version 0.31. Tagged as 'OMAP3-0_31'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.31"
Module_Version          SETA    31
d17 2
a18 2
Module_Date             SETS    "14 Aug 2010"
Module_ApplicationDate  SETS    "14-Aug-10"
d21 2
a22 2
Module_FullVersion      SETS    "0.31"
Module_HelpVersion      SETS    "0.31 (14 Aug 2010)"
@


1.33
log
@This time, put the GET directive in the right place, so it fixes all the compile errors and not just the ones AMU's dodgy dependency tracking reported

Version 0.30. Tagged as 'OMAP3-0_30'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.30"
Module_Version          SETA    30
d17 2
a18 2
Module_Date             SETS    "24 Jun 2010"
Module_ApplicationDate  SETS    "24-Jun-10"
d21 2
a22 2
Module_FullVersion      SETS    "0.30"
Module_HelpVersion      SETS    "0.30 (24 Jun 2010)"
@


1.32
log
@Fix OMAP3 HAL compilation - a required GET directive went AWOL

Version 0.29. Tagged as 'OMAP3-0_29'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.29"
Module_Version          SETA    29
d21 2
a22 2
Module_FullVersion      SETS    "0.29"
Module_HelpVersion      SETS    "0.29 (24 Jun 2010)"
@


1.31
log
@Update OMAP3 HAL to use correct instruction/memory barrier operations and to handle branch target predictors
Detail:
  hdr/Copro15ops - Added myISB, myDSB, myDMB macros to provide barrier functionality for ARMv6+
  s/Boot, s/Interrupts, s/RAM, s/Top, s/Video - updated to use correct barrier operations after CP15 writes, and to invalidate branch predictors where appropriate
Admin:
  Tested on rev C2 beagleboard


Version 0.28. Tagged as 'OMAP3-0_28'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.28"
Module_Version          SETA    28
d17 2
a18 2
Module_Date             SETS    "23 Jun 2010"
Module_ApplicationDate  SETS    "23-Jun-10"
d21 2
a22 2
Module_FullVersion      SETS    "0.28"
Module_HelpVersion      SETS    "0.28 (23 Jun 2010)"
@


1.30
log
@Reduce amount of IO space requested by OMAP HAL
Detail:
  hdr/Interrupts - moved MPU_INTC values into hdr/omap3530
  hdr/omap3530 - Revised L3_Size, L4_Size, etc. so that they indicate the size of the used area of the interconnects, rather than the size of the address space
  s/Boot - reworked HAL setup to take into account the fact that mapping in L4_Core no longer maps in L4_Wakeup and MPU_INTC. Also fixed DevKit NIC setup to request correct IO space size
Admin:
  Tested on rev C2 beagleboard. Should now use ~4MB of IO space instead of >=33MB


Version 0.27. Tagged as 'OMAP3-0_27'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.27"
Module_Version          SETA    27
d17 2
a18 2
Module_Date             SETS    "03 Apr 2010"
Module_ApplicationDate  SETS    "03-Apr-10"
d21 2
a22 2
Module_FullVersion      SETS    "0.27"
Module_HelpVersion      SETS    "0.27 (03 Apr 2010)"
@


1.29
log
@Fix OMAP HAL GPIO/NIC setup code
Detail:
  s/GPIO - Fixed use of invalid 'MSR <psr>,<rn>,<shift>' instruction in GPIOx_SetAndEnableIRQ. Fixed PSR flags that are used to calculate LEVELDETECT0 value.
  s/NIC - Fixed NICActivate to load NICGPIO_Mode before the HAL device ptr gets clobbered
Admin:
  Tested on rev C2 beagleboard, using IGEP config. NICActivate now appears to configure the GPIO controller properly.


Version 0.26. Tagged as 'OMAP3-0_26'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.26"
Module_Version          SETA    26
d17 2
a18 2
Module_Date             SETS    "28 Mar 2010"
Module_ApplicationDate  SETS    "28-Mar-10"
d21 2
a22 2
Module_FullVersion      SETS    "0.26"
Module_HelpVersion      SETS    "0.26 (28 Mar 2010)"
@


1.28
log
@Add basic GPIO init code to OMAP HAL
Detail:
  s/Boot, s/GPIO - Added some basic GPIO init code, to make sure there aren't any unexpected GPIO IRQs active
Admin:
  Tested on rev C2 beagleboard.


Version 0.25. Tagged as 'OMAP3-0_25'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.25"
Module_Version          SETA    25
d17 2
a18 2
Module_Date             SETS    "20 Mar 2010"
Module_ApplicationDate  SETS    "20-Mar-10"
d21 2
a22 2
Module_FullVersion      SETS    "0.25"
Module_HelpVersion      SETS    "0.25 (20 Mar 2010)"
@


1.27
log
@Add basic GPMC setup code and NIC HAL devices to OMAP HAL
Detail:
  s/GPMC, hdr/GPMC, hdr/StaticWS - basic code to reset the GPMC and configure chip selects
  s/NIC, hdr/NIC, hdr/StaticWS - code to expose any onboard NICs (SMSC9221, DM9000) to RISC OS as simple HAL devices.
  Makefile - added GPMC & NIC source files
  s/board, hdr/board - Expanded board config struct to include a pointer to extra code to call at the end of HAL_InitDevices, to allow board-specific devices to be initialised
  s/boot - Extra HAL_InitDevices code to set up the NICs on the IGEP/DevKit
  s/GPIO, hdr/GPIO - Improved functionality to allow GPIO IRQs to be used
  s/SDMA, s/Video - Tweaked the HAL device descriptors to indicate that the devices are on the L3 interconnect
Admin:
  Tested on rev C2 beagleboard. IGEP/DevKit entry points booted OK, but no attempts were made to look for or interact with the new HAL devices!


Version 0.24. Tagged as 'OMAP3-0_24'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.24"
Module_Version          SETA    24
d21 2
a22 2
Module_FullVersion      SETS    "0.24"
Module_HelpVersion      SETS    "0.24 (20 Mar 2010)"
@


1.26
log
@Update OMAP3 HAL to support new OMAPVideo module, plus other minor changes
Detail:
  hdr/StaticWS, hdr/Video, hdr/board, hdr/omap3530, s/Boot, s/Video, s/board - Add new HALDoesVideo switch to control whether the HAL provides the video driver or whether a HAL device is used to expose the video hardware to the OMAPVideo module. Switch defaults to the 'off' state, i.e. OMAPVideo provides the video driver. Also updated the board config struct to contain more detailed information about the video capabilities of each board.
  s/Audio - fix the FIFO underflow/overflow IRQ handler to disable the IRQ after the underflow/overflow has been detection. This prevents the OS from (potentially) getting stuck in a loop servicing the interrupt and never reaching the state where it can shut down & re-initialise the audio to fix the error properly.
  s/Debug - add DebugCallstack function that disables IRQs/FIQs and dumps the stack contents over the serial port
Admin:
  Tested on rev C2 beagleboard.


Version 0.23. Tagged as 'OMAP3-0_23'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.23"
Module_Version          SETA    23
d17 2
a18 2
Module_Date             SETS    "28 Feb 2010"
Module_ApplicationDate  SETS    "28-Feb-10"
d21 2
a22 2
Module_FullVersion      SETS    "0.23"
Module_HelpVersion      SETS    "0.23 (28 Feb 2010)"
@


1.25
log
@Change DevKit8000 USBGPIO setting
Detail:
  s/board - DevKit8000 USBGPIO setting has been changed from 255 (none) to GPIO 147.
  I'm still not convinced that GPIO147 is connected to anything, but if it works with that setting then we might as well use it.
Admin:
  Untested; but according to Tank it makes USB work.


Version 0.22. Tagged as 'OMAP3-0_22'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.22"
Module_Version          SETA    22
d17 2
a18 2
Module_Date             SETS    "31 Jan 2010"
Module_ApplicationDate  SETS    "31-Jan-10"
d21 2
a22 2
Module_FullVersion      SETS    "0.22"
Module_HelpVersion      SETS    "0.22 (31 Jan 2010)"
@


1.24
log
@Various OMAP3 HAL power management improvements, plus add support for board config autodetection via Linux machine ID
Detail:
  s/board, hdr/board - Add Linux machine ID & available mixer channels to board config table
  s/Top - Add new entry point at offset &64, for booting as a fake Linux kernel. Searches the board config table until it finds a config matching the machine ID passed in R1. Also minor ROM copy optimisation, unsigned pointer comparison fixes
  s/Audio, hdr/Audio - Use board config to lock-out mixer channels that aren't connected to any hardware, to avoid excessive power drain or other problems if the channels get turned on. Also perform many other setting tweaks to tidy up default settings for unused mixer paths/channels.
  s/Video - Fix Video_Init logic when deciding whether to reset DSS, enable DSI PLL drift guard
  s/I2C - Increase I2C timeout values, since the previous values were perhaps a bit low
  s/Audio, s/I2C, s/Interrupts, s/RAM, s/SDMA, s/Timers, s/UART, hdr/UART, s/USB, s/Video - Enable autoidle/smart idle where possible to help save power.
Admin:
  Tested on rev C2 beagleboard


Version 0.21. Tagged as 'OMAP3-0_21'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.21"
Module_Version          SETA    21
d17 2
a18 2
Module_Date             SETS    "30 Jan 2010"
Module_ApplicationDate  SETS    "30-Jan-10"
d21 2
a22 2
Module_FullVersion      SETS    "0.21"
Module_HelpVersion      SETS    "0.21 (30 Jan 2010)"
@


1.23
log
@Fix hang on boot in OMAP3 HAL
Detail:
  PRCM.s - This file missed my checkin last night. Contains some rather important code that was moved there from USB.s, for initialising DPLL5.
Admin:
  Tested on rev C2 beagleboard. HAL code in CVS should now match what's on my machine!


Version 0.20. Tagged as 'OMAP3-0_20'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.20"
Module_Version          SETA    20
d17 2
a18 2
Module_Date             SETS    "24 Jan 2010"
Module_ApplicationDate  SETS    "24-Jan-10"
d21 2
a22 2
Module_FullVersion      SETS    "0.20"
Module_HelpVersion      SETS    "0.20 (24 Jan 2010)"
@


1.22
log
@Update OMAP HAL to support different board configs, plus use new YearLOIsGood flag to ensure correct RTC handling, plus other misc tidying
Detail:
  The OMAP HAL now has multiple entry points, one per board config. See Top.s/board.s for more info.
  audio.s - Moved APLL_CTL value to board config
  board.s - New file to list all the settings for the different board configs
  boot.s - Change HAL_Init to deal with the new board config stuff
  debug.s - Debug UART now specified in board config
  GPIO.s - A few utility functions for handling OMAP/TPS GPIO pins
  I2C.s - Update to use new board config struct
  RAM.s - Disable the beagleboard-specific RAM init code. Instead we'll just rely on u-boot to initialise all our RAM for us.
  RTC.s - Get rid of the magic numbers, and use the YearLOIsGood flag to indicate to RISC OS that YearLO is 2-digit BCD
  Top.s - Got rid of old debug code and rewrote initial flow to handle detecting & storing the board config
  UART.s - Update to use board config struct, support multiple UARTs
  USB.s - Get EHCI PHY power GPIO from board config
  Video.s - Get DVI framer power GPIO and max pixel rate from board config. Add 'PassiveVideo' option, to build a driver that doesn't alter the video output settings - should hopefully result in a usable display on Touch Book, etc.
  board.hdr - Definition of board config table struct
  GPIO.hdr - Add lots of macros for handling OMAP GPIO pins, new constants for OMAP/TPS GPIO
  I2C.hdr - Added I2C transfer block struct, HAL I2C API transfer states (both moved here from other source files)
  omap3530.hdr - Move/remove some unwanted constants, disable DebugChar for now
  StaticWS.hdr - Move I2C transfer block struct to I2C.hdr, add board config struct to HAL workspace, get rid of unused 64K AllocArea
  Timers.hdr - Tidy up constants a bit
  UART.hdr - Add UARTCLK (moved from StaticWS.hdr), UART IRQ #'s
  Makefile - add GPIO.s
Admin:
  Tested on rev C2 beagleboard. Board configs for other board types may be inaccurate in a couple of places.


Version 0.19. Tagged as 'OMAP3-0_19'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.19"
Module_Version          SETA    19
d21 2
a22 2
Module_FullVersion      SETS    "0.19"
Module_HelpVersion      SETS    "0.19 (24 Jan 2010)"
@


1.21
log
@Add sound support to OMAP3 HAL, plus other changes
Detail:
  hdr/Audio, s/Audio, Makefile, hdr/StaticWS, s/Boot - Add sound support to OMAP3 HAL. Should work with a TPS65950 connected to I2C1/McBSP2, as per beagleboard.
  s/TPS, s/RTC - Moved TPSRead, TPSWrite functions out of s/RTC and into their own file
  hdr/SDMA, s/SDMA - Add support for packet-based transfer (for audio), improve debug code, remove TestRAMToRAM test code
  s/I2C - Update to handle spurious RDR interrupts as mentioned in OMAP3 errata
  s/Video - Enable support for the larger porch & sync timing registers found in OMAP3 ES3.1 and above
Admin:
  Tested on rev C2 beagleboard


Version 0.18. Tagged as 'OMAP3-0_18'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.18"
Module_Version          SETA    18
d17 2
a18 2
Module_Date             SETS    "16 Jan 2010"
Module_ApplicationDate  SETS    "16-Jan-10"
d21 2
a22 2
Module_FullVersion      SETS    "0.18"
Module_HelpVersion      SETS    "0.18 (16 Jan 2010)"
@


1.20
log
@Fix undefined instruction abort when booting OMAP HAL
Detail:
  I guess I didn't test this after all.
Admin:
  Tested on rev C2 beagleboard. (No, really, I mean it this time!)


Version 0.17. Tagged as 'OMAP3-0_17'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.17"
Module_Version          SETA    17
d17 2
a18 2
Module_Date             SETS    "29 Nov 2009"
Module_ApplicationDate  SETS    "29-Nov-09"
d21 2
a22 2
Module_FullVersion      SETS    "0.17"
Module_HelpVersion      SETS    "0.17 (29 Nov 2009)"
@


1.19
log
@OMAP3 DMA support, video device, debugging improvements
Detail:
  Boot.s - Make FIQDebug work again
  Boot.s - Add support for DMA & video devices
  Interrupts.s, hdr/omap3530 - Add 'ExtraDebugInterrupts' option
  hdr/SDMA, SDMA.s, Makefile - DMA code which presents itself to RISC OS as a set of single-buffered, interrupt-driven DMA channels.
  hdr/StaticWS - Add extra DMA, video & debug entries to workspace
  Interrupts.s - Add 'DebugDisablePrevious' debug option for more flexibility in tracking down noncleared IRQs with ExtraDebugInterrupts
  RAM.s - Use DMA to clear RAM on boot. RAM clear now takes less than 1 second on a rev C board, whereas before it used to take several.
  Video.s - Add simple HAL device to expose information needed by upcoming RISC OS module based video driver.
Admin:
  Tested on rev C2 beagleboard.


Version 0.16. Tagged as 'OMAP3-0_16'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.16"
Module_Version          SETA    16
d17 2
a18 2
Module_Date             SETS    "28 Nov 2009"
Module_ApplicationDate  SETS    "28-Nov-09"
d21 2
a22 2
Module_FullVersion      SETS    "0.16"
Module_HelpVersion      SETS    "0.16 (28 Nov 2009)"
@


1.18
log
@Fix bug in HAL_IRQDisable/HAL_FIQDisable in OMAP3 HAL
Detail:
  The code which checks if you've just disabled the active interrupt was broken and was dereferencing a bad pointer, causing (a) bad things, and (b) failure when alignment exceptions are turned on. This change fixes that, so the change I checked in a couple of hours ago won't cause the OS to crash anymore!
Admin:
  Tested on rev C2 beagleboard.


Version 0.15. Tagged as 'OMAP3-0_15'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.15"
Module_Version          SETA    15
d17 2
a18 2
Module_Date             SETS    "07 Nov 2009"
Module_ApplicationDate  SETS    "07-Nov-09"
d21 2
a22 2
Module_FullVersion      SETS    "0.15"
Module_HelpVersion      SETS    "0.15 (07 Nov 2009)"
@


1.17
log
@Basic HAL_Reset implementation for OMAP3 HAL
Detail:
  This implementation only supports resets - for power-off a more complex implementation will be required (involving talking to the TPS over I2C, AFAIK).
Admin:
  Tested on rev C2 beagleboard


Version 0.14. Tagged as 'OMAP3-0_14'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.14"
Module_Version          SETA    14
d17 2
a18 2
Module_Date             SETS    "27 Oct 2009"
Module_ApplicationDate  SETS    "27-Oct-09"
d21 2
a22 2
Module_FullVersion      SETS    "0.14"
Module_HelpVersion      SETS    "0.14 (27 Oct 2009)"
@


1.16
log
@Add HAL RTC support to OMAP3 kernel, improve IIC code
Detail:
  s/RTC - Implementation of new HAL RTC API. Uses the RTC built into the TWL/TPS companion chip.
  s/Boot - Initialise RTC HALDevice
  s/I2C - Add workaround for apparent hardware limitation of the OMAP I2C controllers; where appropriate multiple iic_transfers will now be merged together into one transfer, to ensure that a start bit is always sent at the start of each transfer
  hdr/omap3530 - Tweak DebugReg and DebugRegByte to allow LR to be output
  Makefile - add s.RTC to list of files. Fix GPADBG definition to not conflict with the 'gpa' folder that one of the makefile fragments creates.
Admin:
  Tested on rev C2 beagleboard


Version 0.13. Tagged as 'OMAP3-0_13'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.13"
Module_Version          SETA    13
d17 2
a18 2
Module_Date             SETS    "23 Jul 2009"
Module_ApplicationDate  SETS    "23-Jul-09"
d21 2
a22 2
Module_FullVersion      SETS    "0.13"
Module_HelpVersion      SETS    "0.13 (23 Jul 2009)"
@


1.15
log
@Add I2C support to OMAP3 HAL. Fix FIQ handling. Improve debugging code.
Detail:
  Makefile, s/Boot, s/I2C, hdr/I2C, hdr/StaticWS - Adds I2C support to the OMAP3 HAL, via both HAL_IIC* and HAL_Video_IICOp.
  s/Interrupts - Fix bug causing incorrect clearing of FIQs
  s/Debug, s/Boot, hdr/omap3530 - Improve debugging code, and add simple FIQ debugger that outputs the PC to the serial port when the beagleboard USER button is pressed
  s/Stubs - Remove old stub functions
Admin:
  Tested on rev C2 beagleboard


Version 0.12. Tagged as 'OMAP3-0_12'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.12"
Module_Version          SETA    12
d17 2
a18 2
Module_Date             SETS    "17 Jul 2009"
Module_ApplicationDate  SETS    "17-Jul-09"
d21 2
a22 2
Module_FullVersion      SETS    "0.12"
Module_HelpVersion      SETS    "0.12 (17 Jul 2009)"
@


1.14
log
@Update OMAP3 HAL to expose USB OTG controller via HAL_USBControllerInfo
Detail:
  hdr/StaticWS, s/Boot - Store logical address of OTG controller
  hdr/USB, s/USB - Expose OTG controller by HAL_USBControllerInfo API
Admin:
  Tested on Rev C2 beagleboard


Version 0.11. Tagged as 'OMAP3-0_11'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.11"
Module_Version          SETA    11
d17 2
a18 2
Module_Date             SETS    "02 Jul 2009"
Module_ApplicationDate  SETS    "02-Jul-09"
d21 2
a22 2
Module_FullVersion      SETS    "0.11"
Module_HelpVersion      SETS    "0.11 (02 Jul 2009)"
@


1.13
log
@  Build change
Detail:
  CPU version is no longer specified in the makefile - it's better to inherit
  it from the build environment now that we actually set it appropriately.
Admin:
  Built and briefly tested.

Version 0.10. Not tagged
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.10"
Module_Version          SETA    10
d17 2
a18 2
Module_Date             SETS    "16 Jun 2009"
Module_ApplicationDate  SETS    "16-Jun-09"
d21 2
a22 2
Module_FullVersion      SETS    "0.10"
Module_HelpVersion      SETS    "0.10 (16 Jun 2009)"
@


1.12
log
@  GET file pathnames changed
Detail:
  Uses suffixed file extensions for compatiblity with both objasm and asasm.
Admin:
  Supplied by Peter Naulls, tested at ROOL

Version 0.10. Not tagged
@
text
@d17 2
a18 2
Module_Date             SETS    "11 Jun 2009"
Module_ApplicationDate  SETS    "11-Jun-09"
d22 1
a22 1
Module_HelpVersion      SETS    "0.10 (11 Jun 2009)"
@


1.11
log
@OMAP3 HAL video tweaks & improvements
Detail:
  hdr/StaticWS - Add entries for max porch & sync values, in anticipation of future OMAP revisions increasing the limits from 8/6 bits to 12/8 bits.
  hdr/omap3530 - Add entry for CONTROL_IDCODE register for reading silicon revision
  s/Video - Increase max pixel rate from 65MHz to 75MHz (86.5MHz seems unstable). Add support for different max porch/sync values depending on hardware revision (currently disabled). Make mode change code more robust to try and fix corruption seen when changing mode too many times. Improve HAL_Video_VetMode to check for (HFP+HSW+HBP)*PCD > 8 limitation. Add a bit more debug code.
Admin:
  Tested on rev C2 beagleboard.


Version 0.10. Tagged as 'OMAP3-0_10'
@
text
@d17 2
a18 2
Module_Date             SETS    "13 May 2009"
Module_ApplicationDate  SETS    "13-May-09"
d22 1
a22 1
Module_HelpVersion      SETS    "0.10 (13 May 2009)"
@


1.10
log
@Fix OMAP3 HAL_Video_UpdatePointer to correctly handle images which aren't 32 pixels wide
Detail:
  s/Video - Rewritten pointer image update code to correctly read data from RISC OS's 32 pixel wide cursor buffer.
Admin:
  Tested on rev C2 beagleboard. Hourglass now appears properly!


Version 0.09. Tagged as 'OMAP3-0_09'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.09"
Module_Version          SETA    9
d17 2
a18 2
Module_Date             SETS    "10 May 2009"
Module_ApplicationDate  SETS    "10-May-09"
d21 2
a22 2
Module_FullVersion      SETS    "0.09"
Module_HelpVersion      SETS    "0.09 (10 May 2009)"
@


1.9
log
@OMAP3 HAL USB (EHCI) support, interrupt handling fixes
Detail:
  Makefile - added USB to objects list
  s/Boot, s/USB, hdr/StaticWS, hdr/USB - USB EHCI code
  s/Debug, s/Stubs, s/Timers, s/Top, s/UART, s/Video - Debugging tweaks and header dependency fixes
  s/Interrupts, hdr/omap3530 - Interrupt fixes & debugging code
  hdr/PRCM - typo fix
Admin:
  Tested on rev C2 beagleboard


Version 0.08. Tagged as 'OMAP3-0_08'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.08"
Module_Version          SETA    8
d17 2
a18 2
Module_Date             SETS    "09 May 2009"
Module_ApplicationDate  SETS    "09-May-09"
d21 2
a22 2
Module_FullVersion      SETS    "0.08"
Module_HelpVersion      SETS    "0.08 (09 May 2009)"
@


1.8
log
@OMAP3 HAL cache clean fix
Detail:
  s/Top - Fix cache clean code to iterate sets/ways/cache levels correctly
Admin:
  Tested on rev C2 beagleboard


Version 0.07. Tagged as 'OMAP3-0_07'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.07"
Module_Version          SETA    7
d17 2
a18 2
Module_Date             SETS    "24 Apr 2009"
Module_ApplicationDate  SETS    "24-Apr-09"
d21 2
a22 2
Module_FullVersion      SETS    "0.07"
Module_HelpVersion      SETS    "0.07 (24 Apr 2009)"
@


1.7
log
@OMAP3 HAL video support, safer RAM initialisation
Detail:
  Makefile - Enable compilation of s.video
  hdr/StaticWS - New workspace entries for video support
  hdr/Video - Typo fix, VENC registers
  s/Boot - Change initialisation order for video support
  s/Debug - Added DebugMemDump routine
  s/RAM - Added code to verify RAM config, to avoid crash if a board looks like a revision C but doesn't have the extra RAM
  s/Stubs - Disable stub video functions
  s/Video - Working video code, beginnings of TV-out code
Admin:
  Tested on rev C2 beagleboard. Video code may only function correctly if kernel is loaded via u-boot.


Version 0.06. Tagged as 'OMAP3-0_06'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.06"
Module_Version          SETA    6
d17 2
a18 2
Module_Date             SETS    "22 Apr 2009"
Module_ApplicationDate  SETS    "22-Apr-09"
d21 2
a22 2
Module_FullVersion      SETS    "0.06"
Module_HelpVersion      SETS    "0.06 (22 Apr 2009)"
@


1.6
log
@Fix RAM clear in OMAP3 HAL
Detail:
  s/RAM - Added v4 to register list in RAM clear routines to ensure correct amount of RAM is cleared
Admin:
  Tested on Rev C2 beagleboard


Version 0.05. Tagged as 'OMAP3-0_05'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.05"
Module_Version          SETA    5
d17 2
a18 2
Module_Date             SETS    "10 Apr 2009"
Module_ApplicationDate  SETS    "10-Apr-09"
d21 2
a22 2
Module_FullVersion      SETS    "0.05"
Module_HelpVersion      SETS    "0.05 (10 Apr 2009)"
@


1.5
log
@OMAP3 HAL Beagleboard Rev C support, further video work.
Detail:
  s/Boot - Fixes for rev C beagleboard. Added GPIO code.
  s/Debug - DebugHALPrint, DebugHALPrintReg routines
  s/PRCM - PRCM_GetFreqSel added
  s/RAM - Fixes for rev C beagleboard. Sped up RAM clear by using more regs.
  s/Top - Fixes for rev C beagleboard
  s/Video - Video code potentially complete, but full of bugs and so still disabled.
  hdr/GPIO - Added GPIO registers
  hdr/omap3530 - Fixes for rev C beagleboard, GPIO, debug macros, QEMU support for new video code
  hdr/SDRC - Typo fix
  hdr/StaticWS - GPIO, pixel rate entries added
  hdr/Video - DSI PLL registers added
Admin:
  Tested on rev C beagleboard.


Version 0.04. Tagged as 'OMAP3-0_04'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.04"
Module_Version          SETA    4
d17 2
a18 2
Module_Date             SETS    "08 Apr 2009"
Module_ApplicationDate  SETS    "08-Apr-09"
d21 2
a22 2
Module_FullVersion      SETS    "0.04"
Module_HelpVersion      SETS    "0.04 (08 Apr 2009)"
@


1.4
log
@OMAP3 HAL fixes and further video work
Detail:
  s/Boot - Store some workspace vars used by video code. Disable some debug output.
  s/Interrupts - Update HAL_IRQClear to allow clearing of VSync IRQ
  s/Top - Fix CP15 flags
  s/Video - Implemented majority of video code needed by kernel. Correct code for calculating and programming pixel clocks still required, so code remains disabled by default.
  hdr/PRCM - Correct typo
  hdr/StaticWS - Add video-related workspace entries
  hdr/Video - Add constants for mouse pointer image buffer size
Admin:
  Tested under qemu-omap3 and rev B6 beagleboard.


Version 0.03. Tagged as 'OMAP3-0_03'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.03"
Module_Version          SETA    3
d17 2
a18 2
Module_Date             SETS    "06 Mar 2009"
Module_ApplicationDate  SETS    "06-Mar-09"
d21 2
a22 2
Module_FullVersion      SETS    "0.03"
Module_HelpVersion      SETS    "0.03 (06 Mar 2009)"
@


1.3
log
@  OMAP3 HAL fixes and updates to allow booting on real hardware.
Detail:
  Makefile - add s.PRCM to objects
  s/Boot - Call PRCM_SetClocks during HAL_Init. Added (disabled) debugging code.
  s/Interrupts - Updated HAL_IRQSource, HAL_FIQSource to query ARM interrupt state instead of relying on INTC alone to detect whether an interrupt is firing or not.
  s/PRCM - Code to measure system clock frequency, store it for HAL purposes, and notify the OMAP of the frequency in order to ensure correct operation.
  s/Timers - Use measured system clock frequency as the timer frequency instead of hard-coded value. Return correct values from HAL_TimerPeriod.
  s/Top - Added (disabled) debugging code. Updated ARM initialisation to use correct cache cleaning procedure.
  s/Video - Further minor work towards completing video driver.
  hdr/CoPro15ops - Deprecate ARM_flush_* macros
  hdr/PRCM - Add more register addresses
  hdr/StaticWS - Add entried for PowerMan & 32K timer logical addresses, system clock speed
  hdr/Timers - remove incorrect, hard-coded timer frequency
  hdr/omap3530 - remove unused FlashCheck global, add DebugChar macro
Admin:
  Tested with HALTester and the RISC OS kernel using qemu-omap3.
  Tested with HALTester on a rev. B6 beagleboard.


Version 0.02. Tagged as 'OMAP3-0_02'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.02"
Module_Version          SETA    2
d17 2
a18 2
Module_Date             SETS    "21 Feb 2009"
Module_ApplicationDate  SETS    "21-Feb-09"
d21 2
a22 2
Module_FullVersion      SETS    "0.02"
Module_HelpVersion      SETS    "0.02 (21 Feb 2009)"
@


1.2
log
@Basic OMAP3 HAL
Detail:
  Performs startup procedure suitable for any location in ROM or RAM. UART, timer, counter, interrupt & debug functionality implemented. Video support incomplete and nonfunctional.
Admin:
  Tested with HALTester & RISC OS kernel under qemu-omap3


Version 0.01. Tagged as 'OMAP3-0_01'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.01"
Module_Version          SETA    1
d17 2
a18 2
Module_Date             SETS    "01 Feb 2009"
Module_ApplicationDate  SETS    "01-Feb-09"
d21 2
a22 2
Module_FullVersion      SETS    "0.01"
Module_HelpVersion      SETS    "0.01 (01 Feb 2009)"
@


1.1
log
@created by srccommit.
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "0.00"
Module_Version          SETA    0
d17 2
a18 2
Module_Date             SETS    "27 Jan 2009"
Module_ApplicationDate  SETS    "27-Jan-09"
d21 2
a22 2
Module_FullVersion      SETS    "0.00"
Module_HelpVersion      SETS    "0.00 (27 Jan 2009)"
@

