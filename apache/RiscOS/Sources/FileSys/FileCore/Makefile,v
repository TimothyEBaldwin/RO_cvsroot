head	4.6;
access;
symbols
	FileCore-3_75:4.6
	FileCore-3_74:4.6
	FileCore-3_73:4.6
	FileCore-3_72:4.6
	FileCore-3_71:4.6
	FileCore-3_70:4.6
	FileCore-3_69:4.6
	FileCore-3_68:4.6
	FileCore-3_67:4.6
	FileCore-3_66:4.6
	FileCore-3_65:4.6
	FileCore-3_64:4.6
	FileCore-3_63:4.6
	FileCore-3_62:4.6
	FileCore-3_61:4.6
	FileCore-3_60:4.6
	FileCore-3_59:4.6
	FileCore-3_58:4.6
	FileCore-3_57:4.6
	FileCore-3_56:4.6
	FileCore-3_55:4.6
	FileCore-3_54:4.6
	FileCore-3_53:4.6
	FileCore-3_52:4.6
	FileCore-3_51:4.6
	FileCore-3_50:4.6
	FileCore-3_49:4.6
	FileCore-3_48:4.5
	FileCore-3_47:4.5
	FileCore-3_46:4.5
	FileCore-3_45:4.5
	FileCore-3_44:4.5
	FileCore-3_43:4.5
	FileCore-3_42:4.5
	FileCore-3_41:4.5
	FileCore-3_40:4.5
	FileCore-3_39:4.5
	FileCore-3_38:4.5
	FileCore-3_37:4.5
	FileCore-3_36:4.5
	FileCore-3_35:4.5
	FileCore-3_34:4.5
	FileCore-3_33:4.5
	RO_5_07:4.5
	FileCore-3_32:4.5
	FileCore-3_31:4.5
	FileCore-3_30:4.5
	FileCore-3_29:4.5
	FileCore-3_28:4.4
	FileCore-3_25-4_9_2_2:4.4
	FileCore-3_27:4.4
	FileCore-3_26:4.4
	FileCore-3_22-4_6_2_1:4.4
	bavison_FileCore-3_22_dev_bp:4.4
	bavison_FileCore-3_22:4.4.0.4
	FileCore-3_25-4_9_2_1:4.4
	HAL:4.4.0.2
	FileCore-3_25:4.4
	FileCore-3_24:4.4
	FileCore-3_23:4.4
	dellis_autobuild_BaseSW:4.4
	FileCore-3_22:4.4
	Ursula_merge:4.1.4.4
	ROL_merge:4.1.4.4
	FileCore-3_21:4.4
	ROL_Ursula_merge:4.1.4.4
	Ursula_RiscPC_merge:4.1.4.4
	sbrodie_sedwards_16Mar2000:4.3
	dcotton_autobuild_BaseSW:4.5
	ROL_FileCore-3_21:4.1.4.4
	ROL_FileCore-3_20:4.1.4.4
	ROL:4.1.4.4.0.4
	ROL_bp:4.1.4.4
	Ursula_RiscPC_bp:4.1.4.4
	FileCore-3_18:4.1.4.4
	FileCore-3_01:4.3
	mstphens_UrsulaRiscPCBuild_20Nov98:4.1.4.4
	Ursula_RiscPC:4.1.4.4.0.2
	FileCore-3_00:4.2
	FileCore-2_99:4.2
	aglover_FileCore-3_17:4.1.4.4
	sproven_FileCore-3_16:4.1.4.4
	rthornb_UrsulaBuild-19Aug1998:4.1.4.4
	UrsulaBuild_FinalSoftload:4.1.4.4
	rthornb_UrsulaBuild-12Aug1998:4.1.4.4
	aglover_UrsulaBuild-05Aug1998:4.1.4.4
	rthornb_UrsulaBuild-29Jul1998:4.1.4.4
	rthornb_UrsulaBuild-22Jul1998:4.1.4.4
	rthornb_UrsulaBuild-15Jul1998:4.1.4.4
	rthornb_UrsulaBuild-07Jul1998:4.1.4.4
	rthornb_UrsulaBuild-17Jun1998:4.1.4.4
	rthornb_UrsulaBuild-03Jun1998:4.1.4.4
	rthornb_UrsulaBuild-27May1998:4.1.4.4
	rthornb_UrsulaBuild-21May1998:4.1.4.4
	sproven_FileCore-3_15:4.1.4.4
	sproven_314:4.1.4.4
	rthornb_UrsulaBuild_01May1998:4.1.4.4
	afrost_Funai01-33:4.1.7.2
	afrost_NC2_Generic:4.1.7.2
	sproven_313:4.1.4.4
	sproven_3_11:4.1.4.2
	sproven_3_10:4.1.4.2
	sproven_Ursula_3_09:4.1.4.2
	sproven_3_07:4.1.4.2
	sproven_3_06:4.1.4.2
	sproven_3_05:4.1.4.2
	sproven_3_04:4.1.4.2
	Spinner_RCA116:4.1.7.2
	sproven_3_03:4.1.4.2
	sproven_3_02:4.1.4.2
	sproven_3_01:4.1.4.2
	sproven_2_99:4.1.4.1
	sproven_2_98:4.1
	Spinner_B20_2:4.1.7.2
	Spinner_19_3:4.1.7.2
	Spinner_B18:4.1.7.2
	Spinner_B17:4.1.7.2
	Spinner_B15:4.1.7.2
	Spinner_B14:4.1.7.2
	Spinner_B13:4.1.7.2
	Spinner_B12:4.1.7.2
	Spinner_B10:4.1.7.2
	Daytona:4.1.0.6
	Daytona_bp:4.1
	Ursula:4.1.0.4
	Ursula_bp:4.1
	Spinner_B7:4.1.7.2
	RO_3_71:4.1.3.1
	ARTtmp_merge:4.1.7.2
	Spin_3Apr97:4.1.7.2
	RCA_bp:4.1
	ARTtmp:4.1.7.2.0.2
	RCA:4.1.0.2
	Spin_merge:4.1.7.1
	MergeFiles:4.1.3.1
	RO_3_70:4.1.3.1
	NC_1_06:4.1.7.1
	Spinner:4.1.7
	Spin_xx:4.1.5
	NC_xx:4.1.5.1
	RO_3_60:4.1.1.1
	StrongARM:4.1.3
	Black:4.1.1;
locks; strict;
comment	@# @;


4.6
date	2012.03.19.01.02.09;	author bavison;	state Exp;
branches;
next	4.5;
commitid	kiHA1sAUGttNKqXv;

4.5
date	2001.05.14.14.27.07;	author sbrodie;	state Exp;
branches;
next	4.4;

4.4
date	2000.05.09.11.36.41;	author sbrodie;	state Exp;
branches;
next	4.3;

4.3
date	99.08.05.10.32.09;	author kbracey;	state Exp;
branches;
next	4.2;

4.2
date	98.09.21.12.06.58;	author kbracey;	state Exp;
branches;
next	4.1;

4.1
date	96.11.05.09.32.03;	author nturton;	state Exp;
branches
	4.1.1.1
	4.1.3.1
	4.1.4.1
	4.1.5.1
	4.1.7.1;
next	;

4.1.1.1
date	96.11.05.09.32.03;	author nturton;	state Exp;
branches;
next	;

4.1.3.1
date	96.11.05.23.58.04;	author nturton;	state Exp;
branches;
next	;

4.1.4.1
date	97.08.14.13.12.10;	author sproven;	state Exp;
branches;
next	4.1.4.2;

4.1.4.2
date	97.09.16.14.46.11;	author sproven;	state Exp;
branches;
next	4.1.4.3;

4.1.4.3
date	98.03.26.14.09.42;	author rthornb;	state Exp;
branches;
next	4.1.4.4;

4.1.4.4
date	98.04.16.15.26.20;	author sproven;	state Exp;
branches;
next	;

4.1.5.1
date	96.11.21.12.32.38;	author nturton;	state Exp;
branches;
next	;

4.1.7.1
date	96.11.29.20.29.34;	author nturton;	state Exp;
branches;
next	4.1.7.2;

4.1.7.2
date	97.03.11.19.13.57;	author nturton;	state Exp;
branches;
next	4.1.7.3;

4.1.7.3
date	98.09.21.11.34.33;	author kbracey;	state Exp;
branches;
next	;


desc
@@


4.6
log
@  Reworked error code
Detail:
  Created a new exported header file, Hdr:FileCoreErr, which will serve as
  the single centralised location that defines the error numbers used in the
  low-level FileCore interfaces. s.Errors is now only used for allocating
  error blocks, not for defining error numbers. Also now exports C versions
  of both the pre-existing Hdr:FileCore and the new header.
Admin:
  No changes to the binary.

Version 3.49. Tagged as 'FileCore-3_49'
@
text
@# Copyright 1996 Acorn Computers Ltd
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
# Makefile for FileCore
#
# ***********************************
# ***    C h a n g e   L i s t    ***
# ***********************************
# Date       Name         Description
# ----       ----         -----------
# 14-May-01  SNB          Created.
#

COMPONENT = FileCore

HEADER1 = FileCore
HEADER2 = MultiFS
HEADER3 = FileCoreErr
ASMCHEADER1 = FileCore
CHEADER1 = FileCoreErr

EXPORTS = ${C_EXP_HDR}.FileCore ${C_EXP_HDR}.FileCoreErr

TOKHELPSRC = ${TOKENSOURCE}
HELPSRC    = HelpText

include StdTools
include AAsmModule

h.FileCoreErr: o.FileCoreErr
	${MKDIR} h
	${LD} -bin -o $@@ o.FileCoreErr
	SetType $@@ Text

o.FileCoreErr: s.FileCoreErr
	${MKDIR} o
	${AS} -o $@@ s.FileCoreErr -I<Hdr$Dir>.Global,<Hdr$Dir>.Interface

clean::
	@@IfThere h Then ${ECHO} ${WIPE} h ${WFLAGS}
	@@IfThere h Then ${WIPE} h ${WFLAGS}

# Dynamic dependencies:
@


4.5
log
@  Updated build structure to use the shared AAsmModule makefile.
  Updated to build using objasm instead of aasm.
  Sources changed to be objasm-compatible.
Admin:
  Requires Library 0.72 or later.
  Requires BuildSys 3.09 or later.
  Requires Env 0.65 or later.

Version 3.29. Tagged as 'FileCore-3_29'
@
text
@d29 5
d41 13
@


4.4
log
@  Merge of Ursula branch to the trunk.
Detail:
  This module represents the latest version of FileCore incorporating
    both the Ursula changes and the ROL changes as we have them to date.
  Changes from ROL-FileCore-3_21 are basically the stripping of trailling
    spaces and the change of Version to Module_Version in the conditionals.
    No other changes.
Admin:
  ROL branch tagged ROL_merge
  Ursula branch tagged Ursula_merge.
  Untested, but essentially the same as ROL-FileCore-3_21, so no problems
    expected.

Version 3.21. Tagged as 'FileCore-3_21'
@
text
@d22 1
a22 1
# 25-May-94  AMcC         Created.
a24 19
#
# Paths
#
EXP_HDR = <export$dir>

#
# Generic options:
#
MKDIR   = cdir
AS      = aasm
CP      = copy
RM      = remove
CCFLAGS = -c -depend !Depend -IC:
ASFLAGS = -throwback -depend !Depend -Stamp -quit -module -To $@@ -From
CPFLAGS = ~cfr~v

#
# Program specific options:
#
a25 40
SOURCE    = s.FileCore
TARGET    = rm.FileCore
EXPORTS   = ${EXP_HDR}.FileCore \
            ${EXP_HDR}.MultiFS

#
# Generic rules:
#
rom: ${TARGET}
        @@echo ${COMPONENT}: rom module built

export: ${EXPORTS}
        @@echo ${COMPONENT}: export complete

install_rom: ${TARGET}
        ${CP} ${TARGET} ${INSTDIR}.${COMPONENT} ${CPFLAGS}
        @@echo ${COMPONENT}: rom module installed

clean:
        ${RM} ${TARGET}
        ${RM} s.TokenHelp
        @@echo ${COMPONENT}: cleaned

resources: resources-${CMDHELP}
        @@echo ${COMPONENT}: resource files copied

resources_common:
        ${MKDIR} ${RESDIR}.${COMPONENT}
	TokenCheck LocalRes:Messages
        ${CP} LocalRes:Messages  ${RESDIR}.${COMPONENT}.Messages  ${CPFLAGS}

resources-None: resources_common
	@@

resources-: resources_common
	TokenCheck LocalRes:CmdHelp
	print LocalRes:CmdHelp { >> ${RESDIR}.${COMPONENT}.Messages }

${TARGET}: ${SOURCE} s.TokenHelp
        ${AS} ${ASFLAGS} ${SOURCE}
d27 2
a28 2
s.TokenHelp: Hdr:Tokens HelpText
        tokenise Hdr:Tokens HelpText $@@
d30 2
a31 2
${EXP_HDR}.FileCore: hdr.FileCore
        ${CP} hdr.FileCore $@@ ${CPFLAGS}
d33 2
a34 2
${EXP_HDR}.MultiFS: hdr.MultiFS
        ${CP} hdr.MultiFS $@@ ${CPFLAGS}
@


4.3
log
@Service call table change only merged in from Ursula branch.

Version 3.01. Tagged as 'FileCore-3_01'
@
text
@d38 1
a38 1
ASFLAGS = -depend !Depend -Stamp -quit -module -To $@@ -From
@


4.2
log
@Spinner branch merged.
Makefile changed to use LocalRes$Path.
Changed to use srccommit.
StrongARM flag now set to :LNOT:STB

Version 2.99. Tagged as 'FileCore-2_99'
@
text
@a95 58
rm.FileCore: VersionASM
rm.FileCore: Version
rm.FileCore: s.Fixes
rm.FileCore: s.AsmHdr
rm.FileCore: s.DevVersion
rm.FileCore: Hdr:ListOpts
rm.FileCore: Hdr:Macros
rm.FileCore: Hdr:System
rm.FileCore: Hdr:SWIs
rm.FileCore: Hdr:CPU.Generic26
rm.FileCore: Hdr:IO.GenericIO
rm.FileCore: Hdr:RISCOS
rm.FileCore: Hdr:CMOS
rm.FileCore: Hdr:Services
rm.FileCore: Hdr:ModHand
rm.FileCore: Hdr:FSNumbers
rm.FileCore: Hdr:HighFSI
rm.FileCore: Hdr:PublicWS
rm.FileCore: Hdr:Tokens
rm.FileCore: Hdr:Wimp
rm.FileCore: Hdr:UpCall
rm.FileCore: Hdr:LowFSi
rm.FileCore: Hdr:Heap
rm.FileCore: Hdr:FileCore
rm.FileCore: Hdr:MsgTrans
rm.FileCore: Hdr:FileTypes
rm.FileCore: Hdr:MultiFS
rm.FileCore: Hdr:NewErrors
rm.FileCore: Hdr:Territory
rm.FileCore: Hdr:Machine.<Machine>
rm.FileCore: Hdr:Machine.Machine
rm.FileCore: s.DebugOpts
rm.FileCore: s.MyMacros
rm.FileCore: s.Defns
rm.FileCore: s.FileCore00
rm.FileCore: s.Errors
rm.FileCore: s.FileCore05
rm.FileCore: s.FileCore15
rm.FileCore: s.FileCore20
rm.FileCore: s.FileCore25
rm.FileCore: s.FileCore30
rm.FileCore: s.FileCore31
rm.FileCore: s.FileCore32
rm.FileCore: s.FileCore33
rm.FileCore: s.FileCore35
rm.FileCore: s.FileCore40
rm.FileCore: s.FileCore45
rm.FileCore: s.TokenHelp
rm.FileCore: s.InitDieSvc
rm.FileCore: s.Commands
rm.FileCore: s.GenSWIs
rm.FileCore: s.MsgsStuff
rm.FileCore: s.FileCore60
rm.FileCore: s.FileCore70
rm.FileCore: s.FileCore80
rm.FileCore: s.FormSrvcs
rm.FileCore: s.FormSWIs
rm.FileCore: s.Identify
@


4.1
log
@Initial revision
@
text
@d68 4
a71 1
resources:
d73 9
a81 2
        ${CP} Resources.${LOCALE}.Messages  ${RESDIR}.${COMPONENT}.Messages  ${CPFLAGS}
        @@echo ${COMPONENT}: resource files copied
d96 1
d125 2
@


4.1.4.1
log
@Changes made to FileCore to support allowing idlen more than 15.  This allows
smaller LFAUs on discs.  The changes are not yet complete.  In particular, the
number of disc zones is limited to 255.  Some development testing has been
peformed, and the filing system is generally stable.  Areas which haven't
been fully tested include things like *Defect, FileCore_LayoutStructure,
FileCore_FloppyStructure, and the FileSwitch APIs for reading and examining
a disc's used space.

This version should not be used for any OS Builds with the BigMaps flag set
to true.  It should build as a normal version of FileCore with BigMaps and
BigDirs set to false.
@
text
@d38 1
a38 1
ASFLAGS = -throwback -depend !Depend -Stamp -quit -module -To $@@ -From
a114 2
rm.FileCore: Hdr:Debug
rm.FileCore: Hdr:HostFS
@


4.1.4.2
log
@Fixed a bug with NewClaimFree (and its use of SortDir) which caused problems
with 16 bit object ids.  Now copes with long ids correctly.

Started on bits of code for the long file names work.
@
text
@d115 2
a142 1
rm.FileCore: s.BigDirCode
@


4.1.4.3
log
@Removed dynamic dependancies from Makefiles and removed all reference to Prefix
@
text
@d86 56
@


4.1.4.4
log
@Now uses new Ursula service call mechanism.
@
text
@a85 56
rm.FileCore: Version
rm.FileCore: s.Fixes
rm.FileCore: s.AsmHdr
rm.FileCore: s.DevVersion
rm.FileCore: Hdr:ListOpts
rm.FileCore: Hdr:Macros
rm.FileCore: Hdr:System
rm.FileCore: Hdr:SWIs
rm.FileCore: Hdr:CPU.Generic26
rm.FileCore: Hdr:IO.GenericIO
rm.FileCore: Hdr:RISCOS
rm.FileCore: Hdr:CMOS
rm.FileCore: Hdr:Services
rm.FileCore: Hdr:ModHand
rm.FileCore: Hdr:FSNumbers
rm.FileCore: Hdr:HighFSI
rm.FileCore: Hdr:PublicWS
rm.FileCore: Hdr:Tokens
rm.FileCore: Hdr:Wimp
rm.FileCore: Hdr:UpCall
rm.FileCore: Hdr:LowFSi
rm.FileCore: Hdr:Heap
rm.FileCore: Hdr:FileCore
rm.FileCore: Hdr:MsgTrans
rm.FileCore: Hdr:FileTypes
rm.FileCore: Hdr:MultiFS
rm.FileCore: Hdr:NewErrors
rm.FileCore: Hdr:Territory
rm.FileCore: s.DebugOpts
rm.FileCore: s.MyMacros
rm.FileCore: s.Defns
rm.FileCore: s.FileCore00
rm.FileCore: s.Errors
rm.FileCore: s.FileCore05
rm.FileCore: s.FileCore15
rm.FileCore: s.FileCore20
rm.FileCore: s.FileCore25
rm.FileCore: s.FileCore30
rm.FileCore: s.FileCore31
rm.FileCore: s.FileCore32
rm.FileCore: s.FileCore33
rm.FileCore: s.FileCore35
rm.FileCore: s.FileCore40
rm.FileCore: s.FileCore45
rm.FileCore: s.TokenHelp
rm.FileCore: s.InitDieSvc
rm.FileCore: s.Commands
rm.FileCore: s.GenSWIs
rm.FileCore: s.MsgsStuff
rm.FileCore: s.FileCore60
rm.FileCore: s.FileCore70
rm.FileCore: s.FileCore80
rm.FileCore: s.FormSrvcs
rm.FileCore: s.FormSWIs
rm.FileCore: s.Identify
rm.FileCore: s.BigDirCode
@


4.1.7.1
log
@NCOS 1.06 Imported from Zip drive
@
text
@@


4.1.7.2
log
@Command line messages removed
@
text
@d68 1
a68 4
resources: resources-${CMDHELP}
        @@echo ${COMPONENT}: resource files copied

resources_common:
d71 1
a71 6

resources-None: resources_common
	@@

resources-: resources_common
	print Resources.${LOCALE}.CmdHelp { >> ${RESDIR}.${COMPONENT}.Messages }
@


4.1.7.3
log
@Makefile modified to use LocalRes$Path.
@
text
@d73 1
a73 2
	TokenCheck LocalRes:Messages
        ${CP} LocalRes:Messages  ${RESDIR}.${COMPONENT}.Messages  ${CPFLAGS}
d79 1
a79 2
	TokenCheck LocalRes:CmdHelp
	print LocalRes:CmdHelp { >> ${RESDIR}.${COMPONENT}.Messages }
@


4.1.5.1
log
@Import from SrcFiler
@
text
@@


4.1.3.1
log
@Import from cleaned 370 CD
@
text
@@


4.1.1.1
log
@Import from cleaned 360 CD
@
text
@@
