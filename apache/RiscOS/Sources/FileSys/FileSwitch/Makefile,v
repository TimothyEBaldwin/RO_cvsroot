head	4.10;
access;
symbols
	FileSwitch-2_87:4.10
	FileSwitch-2_86:4.10
	FileSwitch-2_85:4.10
	FileSwitch-2_84:4.10
	FileSwitch-2_83:4.10
	FileSwitch-2_82:4.10
	FileSwitch-2_81:4.10
	FileSwitch-2_80:4.10
	FileSwitch-2_79:4.9
	FileSwitch-2_78:4.9
	FileSwitch-2_77:4.9
	FileSwitch-2_76:4.9
	FileSwitch-2_75:4.9
	FileSwitch-2_74:4.9
	FileSwitch-2_73:4.9
	FileSwitch-2_72:4.9
	FileSwitch-2_71:4.9
	FileSwitch-2_70:4.9
	FileSwitch-2_69:4.9
	FileSwitch-2_68:4.9
	FileSwitch-2_67:4.9
	RO_5_07:4.9
	FileSwitch-2_66:4.9
	FileSwitch-2_65:4.9
	FileSwitch-2_64:4.9
	FileSwitch-2_63:4.9
	FileSwitch-2_62:4.9
	FileSwitch-2_61:4.9
	FileSwitch-2_60:4.9
	FileSwitch-2_59:4.9
	FileSwitch-2_58:4.9
	FileSwitch-2_57:4.8
	FileSwitch-2_56:4.7
	FileSwitch-2_55:4.7
	FileSwitch-2_54:4.7
	FileSwitch-2_53:4.7
	dellis_autobuild_BaseSW:4.6
	FileSwitch-2_52:4.6
	FileSwitch-2_51:4.6
	ROLtd-4_02:4.2.2.4
	FileSwitch-2_45:4.2.2.4
	Ursula_merge:4.2.2.4
	FileSwitch-2_50:4.6
	sbrodie_sedwards_16Mar2000:4.5
	FileSwitch-2_41:4.5
	dcotton_Spin_merge:4.1.7.3
	FileSwitch-2_40:4.4
	dcotton_autobuild_BaseSW:4.9
	FileSwitch-2_39:4.3
	FileSwitch-2_43:4.2.2.4
	Ursula_FileSwitch-2_42:4.2.2.4
	mstphens_UrsulaRiscPCBuild_20Nov98:4.2.2.4
	Ursula_RiscPC:4.2.2.4.0.2
	nicke_FileSwitch-2_29:4.1.7.3
	FileSwitch-2_38:4.3
	rthornb_UrsulaBuild-19Aug1998:4.2.2.4
	UrsulaBuild_FinalSoftload:4.2.2.4
	rthornb_UrsulaBuild-12Aug1998:4.2.2.4
	aglover_UrsulaBuild-05Aug1998:4.2.2.4
	rthornb_UrsulaBuild-29Jul1998:4.2.2.4
	rthornb_UrsulaBuild-22Jul1998:4.2.2.4
	rthornb_UrsulaBuild-15Jul1998:4.2.2.4
	rthornb_UrsulaBuild-07Jul1998:4.2.2.4
	rthornb_UrsulaBuild-17Jun1998:4.2.2.4
	rthornb_UrsulaBuild-03Jun1998:4.2.2.4
	rthornb_UrsulaBuild-27May1998:4.2.2.4
	rthornb_UrsulaBuild-21May1998:4.2.2.4
	rthornb_UrsulaBuild_01May1998:4.2.2.4
	afrost_Funai01-33:4.1.7.2
	afrost_NC2_Generic:4.1.7.2
	sproven_241:4.2.2.4
	sproven_2_40:4.2.2.3
	sproven_2_38:4.2.2.1
	Spinner_RCA116:4.1.7.2
	Spinner_B20_2:4.1.7.2
	Spinner_19_3:4.1.7.2
	Spinner_B18:4.1.7.2
	Spinner_B17:4.1.7.2
	Spinner_B15:4.1.7.2
	Spinner_B14:4.1.7.2
	Spinner_B13:4.1.7.2
	Spinner_B12:4.1.7.2
	Spinner_B10:4.1.7.2
	Daytona:4.2.0.6
	Daytona_bp:4.2
	Ursula:4.2.0.2
	Ursula_bp:4.2
	Spinner_B7:4.1.7.2
	RO_3_71:4.1.3.1
	ARTtmp_merge:4.1.7.2
	Spin_3Apr97:4.1.7.2
	RCA_bp:4.2
	ARTtmp:4.1.7.2.0.2
	RCA:4.2.0.4
	Spin_merge:4.1.7.1
	MergeFiles:4.1.3.1
	RO_3_70:4.1.3.1
	NC_1_06:4.1.7.1
	Spinner:4.1.7
	Spin_xx:4.1.5
	NC_xx:4.1.5.1
	RO_3_60:4.1.1.1
	StrongARM:4.1.3
	Black:4.1.1;
locks; strict;
comment	@# @;


4.10
date	2012.12.09.17.45.17;	author rsprowson;	state Exp;
branches;
next	4.9;
commitid	zUKgh5086ltOMzvw;

4.9
date	2001.04.17.13.15.13;	author dcotton;	state Exp;
branches;
next	4.8;

4.8
date	2001.04.17.11.29.44;	author dcotton;	state Exp;
branches;
next	4.7;

4.7
date	2001.03.01.13.57.39;	author sforrest;	state Exp;
branches;
next	4.6;

4.6
date	2000.03.20.14.30.45;	author kbracey;	state Exp;
branches;
next	4.5;

4.5
date	2000.03.01.16.11.15;	author sbrodie;	state Exp;
branches;
next	4.4;

4.4
date	99.11.15.09.52.02;	author dcotton;	state Exp;
branches;
next	4.3;

4.3
date	98.10.22.13.35.21;	author nturton;	state Exp;
branches;
next	4.2;

4.2
date	97.01.14.17.11.34;	author nturton;	state Exp;
branches
	4.2.2.1;
next	4.1;

4.1
date	96.11.05.09.32.40;	author nturton;	state Exp;
branches
	4.1.1.1
	4.1.3.1
	4.1.5.1
	4.1.7.1;
next	;

4.2.2.1
date	98.03.26.14.09.51;	author rthornb;	state Exp;
branches;
next	4.2.2.2;

4.2.2.2
date	98.03.27.12.42.39;	author mstphens;	state Exp;
branches;
next	4.2.2.3;

4.2.2.3
date	98.04.07.11.07.18;	author sproven;	state Exp;
branches;
next	4.2.2.4;

4.2.2.4
date	98.04.16.14.48.59;	author sproven;	state Exp;
branches;
next	;

4.1.1.1
date	96.11.05.09.32.40;	author nturton;	state Exp;
branches;
next	;

4.1.3.1
date	96.11.06.00.48.51;	author nturton;	state Exp;
branches;
next	;

4.1.5.1
date	96.11.21.12.35.59;	author nturton;	state Exp;
branches;
next	;

4.1.7.1
date	96.11.29.20.32.40;	author nturton;	state Exp;
branches;
next	4.1.7.2;

4.1.7.2
date	97.03.11.19.14.05;	author nturton;	state Exp;
branches;
next	4.1.7.3;

4.1.7.3
date	98.09.16.14.48.54;	author kbracey;	state Exp;
branches;
next	;


desc
@@


4.10
log
@Add LowFSI to C exports

Version 2.80. Not tagged
@
text
@# Copyright 1996 Acorn Computers Ltd
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
# Makefile for FileSwitch
#
# *************************************
# ***     C h a n g e   L i s t     ***
# *************************************
# Date         Name         Description
# ----         ----         -----------
# 11-Apr-2001  DSC          Created.
#

COMPONENT = FileSwitch

HEADER1     = LowFSI
HEADER2     = HighFSI
# C headers to generate from the assembler sources
ASMCHEADER1 = LowFSI
ASMCHEADER2 = HighFSI
EXPORTS     = ${C_EXP_HDR}.${ASMCHEADER1} ${C_EXP_HDR}.${ASMCHEADER2}

TOKHELPSRC  = ${TOKENSOURCE}
HELPSRC     = HelpSrc

include StdTools
include AAsmModule

# Dynamic dependencies:
@


4.9
log
@    Now works.

Detail:
    The version of Stewart's notes that I was using to convert the component
to support ObjAsm was out of date, and hence missed out a couple of sections
on converting Asm headers to C headers and tokenisation. This would only have
been picked up when building straight out of CVS. A classic case of RTLM
(read the latest manual). However, doing this work showed up a bit missing
from Stewart's notes, so it is really a case of RTLMWSHWI, or read the latest
manual when Stewart has written it). ;-)
    The makefile has been altered to ensure that the correct operations occur.

Admin:
    Not tested in a build. Checked the logs from running export headers,
libs, resources and rom phases against a pre-objasm build and verified that
all the same steps are occuring.

Version 2.58. Tagged as 'FileSwitch-2_58'
@
text
@d30 3
a32 2
ASMCHEADER1 = HighFSI
EXPORTS      = ${C_EXP_HDR}.${ASMCHEADER1}
@


4.8
log
@    Altered to use shared makefiles and ObjAsm.

Detail:
    As above. No other changes.

Admin:
    Tested in a Lazarus build.

Version 2.57. Tagged as 'FileSwitch-2_57'
@
text
@d27 8
a34 2
HEADER1 = LowFSI
HEADER2 = HighFSI
@


4.7
log
@Should've removed StripDepnd support from Makefile, since I moved the
support to MkClean.  Now removed.

Retagged as FileSwitch-2_53.
@
text
@d17 6
a22 6
# ***********************************
# ***    C h a n g e   L i s t    ***
# ***********************************
# Date       Name         Description
# ----       ----         -----------
# 25-May-94  AMcC         Created.
a24 20
#
# Paths
#
EXP_HDR = <export$dir>
C_EXP_HDR = <cexport$dir>.Interface.h

#
# Generic options:
#
MKDIR   = cdir
AS      = aasm
CP      = copy
RM      = remove
CCFLAGS = -c -depend !Depend -IC:
ASFLAGS = -depend !Depend -Stamp -quit -module -To $@@ -From 
CPFLAGS = ~cfr~v

#
# Program specific options:
#
a25 51
SOURCE    = s.FileSwitch
TARGET    = rm.FileSwitch
EXPORTS   = ${EXP_HDR}.LowFSI \
            ${EXP_HDR}.HighFSI \
            ${C_EXP_HDR}.HighFSI
# Add LowFSI if ever required - Hdr2H doesn't like it yet

#
# Generic rules:
#
rom: ${TARGET}
        @@echo ${COMPONENT}: rom module built

export: ${EXPORTS}
        @@echo ${COMPONENT}: export complete

install_rom: ${TARGET}
        ${CP} ${TARGET} ${INSTDIR}.${COMPONENT} ${CPFLAGS}
        @@echo ${COMPONENT}: rom module installed

clean:
        ${RM} ${TARGET}
        ${RM} s.TokHelpSrc
        @@echo ${COMPONENT}: cleaned

resources: resources-${CMDHELP}
        @@echo ${COMPONENT}: resource files copied

resources_common:
        ${MKDIR} ${RESDIR}.${COMPONENT}
        TokenCheck LocalRes:Messages
        ${CP} LocalRes:Messages  ${RESDIR}.${COMPONENT}.Messages  ${CPFLAGS}

resources-None: resources_common
	@@

resources-: resources_common
        TokenCheck LocalRes:CmdHelp
	print LocalRes:CmdHelp { >> ${RESDIR}.${COMPONENT}.Messages }

${TARGET}: ${SOURCE} s.TokHelpSrc
        ${AS} ${ASFLAGS} ${SOURCE}

s.TokHelpSrc: Hdr:Tokens HelpSrc
        tokenise Hdr:Tokens HelpSrc $@@

${EXP_HDR}.LowFSI: hdr.LowFSI
        ${CP} hdr.LowFSI $@@ ${CPFLAGS}

${EXP_HDR}.HighFSI: hdr.HighFSI
        ${CP} hdr.HighFSI $@@ ${CPFLAGS}
d27 2
a28 3
${C_EXP_HDR}.LowFSI: hdr.LowFSI
        ${MKDIR} ${C_EXP_HDR}
        perl Build:Hdr2H hdr.LowFSI $@@
d30 2
a31 3
${C_EXP_HDR}.HighFSI: hdr.HighFSI
        ${MKDIR} ${C_EXP_HDR}
        perl Build:Hdr2H hdr.HighFSI $@@
@


4.6
log
@  Ursula branch merged.
Detail:
  Full merge of Ursula branch. Path length limited to 256 if a compile-time
  check says SVCSTK is still &01C02000.

  Fix to bug introduced in RISC OS 3.70 - any errors returned by FSEntry_File
  255 were ignored.
  Some changes from RISC OS Ltd still to come.
Admin:
  Untested.

Version 2.50. Tagged as 'FileSwitch-2_50'
@
text
@a37 1
STRIP   = stripdepnd
a68 1
        ${STRIP}
@


4.5
log
@  Exports C version of the HighFSI header file.
Detail:
  FileSwitch runs Hdr2H on its hdr.HighFSI file to export reason code
    symbols for the filing system SWIs.
Admin:
  Required by IPConfig 0.27 and later

Version 2.41. Tagged as 'FileSwitch-2_41'
@
text
@d40 1
a40 1
ASFLAGS = -depend !Depend -Stamp -quit -module -To $@@ -From
@


4.4
log
@	Merged the latest changes on Spinner branch.

Detail:
	Needed the localres alterations off the Spinner branch that had been
added since the branch was last merged.
	Added strdepend to the clean phase.

Admin:
	Built locally and on a Funai4 build machine.

Version 2.40. Tagged as 'FileSwitch-2_40'
@
text
@d29 1
d50 3
a52 1
            ${EXP_HDR}.HighFSI
d99 8
@


4.3
log
@Now copes with SWI OS_SynchroniseCodeAreas returning an error.  The old
code preserved the V bit, but trashed r0.

Version 2.38. Tagged as 'FileSwitch-2_38'
@
text
@d37 1
d67 1
d70 4
a73 1
resources:
d75 9
a83 2
        ${CP} Resources.${LOCALE}.Messages  ${RESDIR}.${COMPONENT}.Messages  ${CPFLAGS}
        @@echo ${COMPONENT}: resource files copied
@


4.2
log
@Module merged
@
text
@a85 57
rm.FileSwitch: s.FileSwHdr
rm.FileSwitch: Hdr:ListOpts
rm.FileSwitch: Hdr:Macros
rm.FileSwitch: Hdr:System
rm.FileSwitch: Hdr:SWIs
rm.FileSwitch: Hdr:CPU.Generic26
rm.FileSwitch: Hdr:IO.GenericIO
rm.FileSwitch: Hdr:RISCOS
rm.FileSwitch: Hdr:Machine.<Machine>
rm.FileSwitch: Hdr:CMOS
rm.FileSwitch: Hdr:ModHand
rm.FileSwitch: Hdr:Services
rm.FileSwitch: Hdr:FSNumbers
rm.FileSwitch: Hdr:HighFSI
rm.FileSwitch: Hdr:NewErrors
rm.FileSwitch: Hdr:Heap
rm.FileSwitch: Hdr:Variables
rm.FileSwitch: Hdr:EnvNumbers
rm.FileSwitch: Hdr:Proc
rm.FileSwitch: Hdr:PublicWS
rm.FileSwitch: Hdr:Tokens
rm.FileSwitch: Hdr:FileTypes
rm.FileSwitch: Hdr:VduExt
rm.FileSwitch: Hdr:UpCall
rm.FileSwitch: Hdr:LowFSi
rm.FileSwitch: Hdr:Wimp
rm.FileSwitch: Hdr:MsgTrans
rm.FileSwitch: Hdr:Territory
rm.FileSwitch: s.DebugOpts
rm.FileSwitch: s.FileSwBody
rm.FileSwitch: Version
rm.FileSwitch: HelpSrc
rm.FileSwitch: s.FSCommands
rm.FileSwitch: s.FSErrors
rm.FileSwitch: s.FSCommon
rm.FileSwitch: s.MsgsStuff
rm.FileSwitch: s.SysVars
rm.FileSwitch: s.Canonical
rm.FileSwitch: s.Ensure
rm.FileSwitch: s.FileTypes
rm.FileSwitch: s.DirStore
rm.FileSwitch: s.FSPath
rm.FileSwitch: s.TopPath
rm.FileSwitch: s.FSUtils
rm.FileSwitch: s.FSUtils2
rm.FileSwitch: s.FSUtils3
rm.FileSwitch: s.FSControl
rm.FileSwitch: s.CtrlUtils
rm.FileSwitch: s.FSCtrl2
rm.FileSwitch: s.StreamBits
rm.FileSwitch: s.OSFile
rm.FileSwitch: s.OSFind
rm.FileSwitch: s.OSBGetBPut
rm.FileSwitch: s.OSGBPB
rm.FileSwitch: s.OSArgs
rm.FileSwitch: s.LowLevel
rm.FileSwitch: s.FSShared
@


4.2.2.1
log
@Removed dynamic dependancies from Makefiles and removed all reference to Prefix
@
text
@d86 57
@


4.2.2.2
log
@add code to use pre-allocated blocks rather than stressing SysHeap
  (speed up - see MercifulToSysHeap)
update service handler to Ursula format
@
text
@a85 1

@


4.2.2.3
log
@Fixed bug whereby *info <filename> (where the filename is not wildcarded)
gives the error "buffer overflow".  Error also fixed for *fileinfo.
@
text
@a86 57
rm.FileSwitch: s.FileSwHdr
rm.FileSwitch: Hdr:ListOpts
rm.FileSwitch: Hdr:Macros
rm.FileSwitch: Hdr:System
rm.FileSwitch: Hdr:SWIs
rm.FileSwitch: Hdr:CPU.Generic26
rm.FileSwitch: Hdr:IO.GenericIO
rm.FileSwitch: Hdr:RISCOS
rm.FileSwitch: Hdr:Machine.<Machine>
rm.FileSwitch: Hdr:CMOS
rm.FileSwitch: Hdr:ModHand
rm.FileSwitch: Hdr:Services
rm.FileSwitch: Hdr:FSNumbers
rm.FileSwitch: Hdr:HighFSI
rm.FileSwitch: Hdr:NewErrors
rm.FileSwitch: Hdr:Heap
rm.FileSwitch: Hdr:Variables
rm.FileSwitch: Hdr:EnvNumbers
rm.FileSwitch: Hdr:Proc
rm.FileSwitch: Hdr:PublicWS
rm.FileSwitch: Hdr:Tokens
rm.FileSwitch: Hdr:FileTypes
rm.FileSwitch: Hdr:VduExt
rm.FileSwitch: Hdr:UpCall
rm.FileSwitch: Hdr:LowFSi
rm.FileSwitch: Hdr:Wimp
rm.FileSwitch: Hdr:MsgTrans
rm.FileSwitch: Hdr:Territory
rm.FileSwitch: s.DebugOpts
rm.FileSwitch: s.FileSwBody
rm.FileSwitch: Version
rm.FileSwitch: HelpSrc
rm.FileSwitch: s.FSCommands
rm.FileSwitch: s.FSErrors
rm.FileSwitch: s.FSCommon
rm.FileSwitch: s.MsgsStuff
rm.FileSwitch: s.SysVars
rm.FileSwitch: s.Canonical
rm.FileSwitch: s.Ensure
rm.FileSwitch: s.FileTypes
rm.FileSwitch: s.DirStore
rm.FileSwitch: s.FSPath
rm.FileSwitch: s.TopPath
rm.FileSwitch: s.FSUtils
rm.FileSwitch: s.FSUtils2
rm.FileSwitch: s.FSUtils3
rm.FileSwitch: s.FSControl
rm.FileSwitch: s.CtrlUtils
rm.FileSwitch: s.FSCtrl2
rm.FileSwitch: s.StreamBits
rm.FileSwitch: s.OSFile
rm.FileSwitch: s.OSFind
rm.FileSwitch: s.OSBGetBPut
rm.FileSwitch: s.OSGBPB
rm.FileSwitch: s.OSArgs
rm.FileSwitch: s.LowLevel
rm.FileSwitch: s.FSShared
@


4.2.2.4
log
@Updated the FSControl code to make the copy operation use a dynamic area,
instead of the free pool.  The maximum size of this dynamic area is set as
the size of the 'next' slot.  This prevents the problems associated with
*copy where it will claim all the free memory, thus stoppping for example
filecore from growing its directory buffer, or zap from growing its dynamic
area.  This makes multiple *copies in task windows usable.
@
text
@d38 1
a38 1
ASFLAGS = -depend !Depend -Stamp -quit -module -To $@@ -From 
@


4.1
log
@Initial revision
@
text
@d94 1
@


4.1.7.1
log
@NCOS 1.06 Imported from Zip drive
@
text
@a93 1
rm.FileSwitch: Hdr:Machine.<Machine>
@


4.1.7.2
log
@Command line messages removed
@
text
@d68 1
a68 4
resources: resources-${CMDHELP}
        @@echo ${COMPONENT}: resource files copied

resources_common:
d71 1
a71 6

resources-None: resources_common
	@@

resources-: resources_common
	print Resources.${LOCALE}.CmdHelp { >> ${RESDIR}.${COMPONENT}.Messages }
@


4.1.7.3
log
@Modified Makefile to use LocalRes$Path.
@
text
@d73 1
a73 2
        TokenCheck LocalRes:Messages
        ${CP} LocalRes:Messages  ${RESDIR}.${COMPONENT}.Messages  ${CPFLAGS}
d79 1
a79 2
        TokenCheck LocalRes:CmdHelp
	print LocalRes:CmdHelp { >> ${RESDIR}.${COMPONENT}.Messages }
a102 1
rm.FileSwitch: Hdr:Machine.Machine
@


4.1.5.1
log
@Import from SrcFiler
@
text
@@


4.1.3.1
log
@Import from cleaned 370 CD
@
text
@@


4.1.1.1
log
@Import from cleaned 360 CD
@
text
@@
