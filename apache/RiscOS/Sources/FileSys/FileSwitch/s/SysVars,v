head	4.4;
access;
symbols
	FileSwitch-2_87:4.4
	FileSwitch-2_86:4.4
	FileSwitch-2_85:4.4
	FileSwitch-2_84:4.4
	FileSwitch-2_83:4.4
	FileSwitch-2_82:4.3
	FileSwitch-2_81:4.3
	FileSwitch-2_80:4.3
	FileSwitch-2_79:4.3
	FileSwitch-2_78:4.3
	FileSwitch-2_77:4.3
	FileSwitch-2_76:4.3
	FileSwitch-2_75:4.3
	FileSwitch-2_74:4.3
	FileSwitch-2_73:4.3
	FileSwitch-2_72:4.3
	FileSwitch-2_71:4.2
	FileSwitch-2_70:4.2
	FileSwitch-2_69:4.2
	FileSwitch-2_68:4.2
	FileSwitch-2_67:4.2
	RO_5_07:4.2
	FileSwitch-2_66:4.2
	FileSwitch-2_65:4.2
	FileSwitch-2_64:4.2
	FileSwitch-2_63:4.2
	FileSwitch-2_62:4.2
	FileSwitch-2_61:4.2
	FileSwitch-2_60:4.2
	FileSwitch-2_59:4.2
	FileSwitch-2_58:4.2
	FileSwitch-2_57:4.2
	FileSwitch-2_56:4.2
	FileSwitch-2_55:4.2
	FileSwitch-2_54:4.2
	FileSwitch-2_53:4.2
	dellis_autobuild_BaseSW:4.2
	FileSwitch-2_52:4.2
	FileSwitch-2_51:4.1
	ROLtd-4_02:4.1
	FileSwitch-2_45:4.1
	Ursula_merge:4.1
	FileSwitch-2_50:4.1
	sbrodie_sedwards_16Mar2000:4.1
	FileSwitch-2_41:4.1
	dcotton_Spin_merge:4.1.7.1
	FileSwitch-2_40:4.1
	dcotton_autobuild_BaseSW:4.2
	FileSwitch-2_39:4.1
	FileSwitch-2_43:4.1
	Ursula_FileSwitch-2_42:4.1
	mstphens_UrsulaRiscPCBuild_20Nov98:4.1
	Ursula_RiscPC:4.1.0.8
	nicke_FileSwitch-2_29:4.1.7.1
	FileSwitch-2_38:4.1
	rthornb_UrsulaBuild-19Aug1998:4.1
	UrsulaBuild_FinalSoftload:4.1
	rthornb_UrsulaBuild-12Aug1998:4.1
	aglover_UrsulaBuild-05Aug1998:4.1
	rthornb_UrsulaBuild-29Jul1998:4.1
	rthornb_UrsulaBuild-22Jul1998:4.1
	rthornb_UrsulaBuild-15Jul1998:4.1
	rthornb_UrsulaBuild-07Jul1998:4.1
	rthornb_UrsulaBuild-17Jun1998:4.1
	rthornb_UrsulaBuild-03Jun1998:4.1
	rthornb_UrsulaBuild-27May1998:4.1
	rthornb_UrsulaBuild-21May1998:4.1
	rthornb_UrsulaBuild_01May1998:4.1
	afrost_Funai01-33:4.1.7.1
	afrost_NC2_Generic:4.1.7.1
	sproven_241:4.1
	sproven_2_40:4.1
	sproven_2_38:4.1
	Spinner_RCA116:4.1.7.1
	Spinner_B20_2:4.1.7.1
	Spinner_19_3:4.1.7.1
	Spinner_B18:4.1.7.1
	Spinner_B17:4.1.7.1
	Spinner_B15:4.1.7.1
	Spinner_B14:4.1.7.1
	Spinner_B13:4.1.7.1
	Spinner_B12:4.1.7.1
	Spinner_B10:4.1.7.1
	Daytona:4.1.0.6
	Daytona_bp:4.1
	Ursula:4.1.0.4
	Ursula_bp:4.1
	Spinner_B7:4.1.7.1
	RO_3_71:4.1.3.1
	ARTtmp_merge:4.1.7.1
	Spin_3Apr97:4.1.7.1
	RCA_bp:4.1
	ARTtmp:4.1.7.1.0.2
	RCA:4.1.0.2
	Spin_merge:4.1.7.1
	MergeFiles:4.1.3.1
	RO_3_70:4.1.3.1
	NC_1_06:4.1.7.1
	Spinner:4.1.7
	Spin_xx:4.1.5
	NC_xx:4.1.5.1
	RO_3_60:4.1.1.1
	StrongARM:4.1.3
	Black:4.1.1;
locks; strict;
comment	@# @;


4.4
date	2015.01.16.00.29.45;	author jlee;	state Exp;
branches;
next	4.3;
commitid	PLSp6MQXUxH0nb6y;

4.3
date	2011.11.27.11.59.32;	author rsprowson;	state Exp;
branches;
next	4.2;
commitid	SMknibmDFieq1YIv;

4.2
date	2000.03.20.15.57.45;	author kbracey;	state Exp;
branches;
next	4.1;

4.1
date	96.11.05.09.32.52;	author nturton;	state Exp;
branches
	4.1.1.1
	4.1.3.1
	4.1.5.1
	4.1.7.1;
next	;

4.1.1.1
date	96.11.05.09.32.52;	author nturton;	state Exp;
branches;
next	;

4.1.3.1
date	96.11.06.00.52.44;	author nturton;	state Exp;
branches;
next	;

4.1.5.1
date	96.11.21.12.37.08;	author nturton;	state Exp;
branches;
next	;

4.1.7.1
date	96.11.29.20.33.41;	author nturton;	state Exp;
branches;
next	;


desc
@@


4.4
log
@Escape some dollars
Detail:
  s/CtrlUtils, s/DirStore, s/FSCtrl2, s/FSPath, s/FileSwBody, s/SysVars - Escape some dollars contained in strings to avoid warnings from objasm
Admin:
  Resulting binary unchanged


Version 2.83. Retagged as 'FileSwitch-2_83'
@
text
@; Copyright 1996 Acorn Computers Ltd
;
; Licensed under the Apache License, Version 2.0 (the "License");
; you may not use this file except in compliance with the License.
; You may obtain a copy of the License at
;
;     http://www.apache.org/licenses/LICENSE-2.0
;
; Unless required by applicable law or agreed to in writing, software
; distributed under the License is distributed on an "AS IS" BASIS,
; WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
; See the License for the specific language governing permissions and
; limitations under the License.
;
        SUBT    > NewSrc.SysVars

; This file deals with the specifics of setting FileSwitch system variables
;
; Construct variables of the form
;
; FileSwitch$<fs>$<dir>$Special
; and
; FileSwitch$<fs>$<dir>$DiscAndPath
;
; Where <dir> is one of:
; Current
; Previous
; UserRoot
; Root
; Library
;
fsw_dirsprefix          DCB     "FileSwitch$", 0
fsw_dirspart_separator  DCB     "$", 0
fsw_dirsspecial_postfix DCB     "$$Special", 0
fsw_dirspath_postfix    DCB     "$$DiscAndPath", 0
fsw_dirspart_current    DCB     "Current", 0
fsw_dirspart_previous   DCB     "Previous", 0
fsw_dirspart_userroot   DCB     "UserRoot", 0
fsw_dirspart_library    DCB     "Library", 0

fsw_currentfs           DCB     "FileSwitch$$CurrentFilingSystem", 0
fsw_tempfs              DCB     "FileSwitch$$TemporaryFilingSystem", 0

Default_RootD_Path              DCB     "$",CR
Default_LibD_Path               DCB     "$.Library",CR
Default_LibD_Whan_Path          DCB     "%",CR
Default_URD_Path                DCB     "$",CR
Default_URD_Whan_Path           DCB     "&",CR
Default_CSD_Path                DCB     "$",CR
Default_CSD_Whan_Path           DCB     "&",CR
Default_PSD_Path                DCB     "$",CR
Default_PSD_Whan_Path           DCB     "&",CR

        ALIGN

; ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;
; ReadTempFS
;
; In    -
;
; Out   r0 -> tempfs or Nowt, flags preserved or
;       VS and error set
;
ReadTempFS EntryS "r1-r4, fscb"
        addr    r0, fsw_tempfs
10
        addr    r3, anull
        BL      SReadVariableToBuffer
        MOV     r4, #1                  ; Disallow :, # and -
        BLVC    FindFSName
        MOVVC   r0, fscb
        ADD     sp, sp, r2
        EXITS   VC
        EXIT

; ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;
; ReadCurrentFS
;
; In    -
;
; Out   r0 -> currentfs or Nowt, flags preserved or
;       VS and error set
;
ReadCurrentFS ALTENTRY
        addr    r0, fsw_currentfs
        B       %BT10

; ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;
; SetTempFS
;
; In    r2 -> tempfs to set or Nowt
;
; Out   - and TempFS set, flags preserved, or
;       VS and error set
;
SetTempFS EntryS "r0,r1,r2,r4"
        addr    r0, fsw_tempfs
10
        TEQ     r2, #Nowt
        MOVEQ   r1, #NULL
        ADDNE   r1, r2, #fscb_name
        MOV     r4, #VarType_String
 [ debugsysvars
        DSTRING r0, "Setting ",cc
        DSTRING r1, " to "
 ]
        BL      SSetVariable
        EXITS   VC
        BL      CopyErrorExternal
        STR     r0, [sp, #Proc_RegOffset]
        EXIT

; ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;
; SetCurrentFS
;
; In    r2 -> currentfs to set or Nowt
;
; Out   - and CurrentFS set, or
;       VS and error set
;
SetCurrentFS ALTENTRY
        addr    r0, fsw_currentfs
        B       %BT10

        END
@


4.3
log
@assert -> ASSERT.
Collapse old switches.
Remove 'Version' GBLA.
*COUNT summary now says "total 1234 bytes" not "1234 bytes" to match *COPY
Empty *COUNT syntax message corrected.
Binary identical to last version (messages different clearly).

Version 2.72. Tagged as 'FileSwitch-2_72'
@
text
@d34 2
a35 2
fsw_dirsspecial_postfix DCB     "$Special", 0
fsw_dirspath_postfix    DCB     "$DiscAndPath", 0
d41 2
a42 2
fsw_currentfs           DCB     "FileSwitch$CurrentFilingSystem", 0
fsw_tempfs              DCB     "FileSwitch$TemporaryFilingSystem", 0
@


4.2
log
@  32-bit compatible.
Admin:
  Tested on a 32-bit system; untested on 26-bit, and merge with Ursula branch
  untested.

Version 2.52. Tagged as 'FileSwitch-2_52'
@
text
@a16 5
 [ Version >= 170
; The entire contents of this file were introduced in version 170



a128 2
 ]

@


4.1
log
@Initial revision
@
text
@d70 1
a70 1
ReadTempFS ENTRY "r1-r4, fscb"
d104 1
a104 1
SetTempFS ENTRY "r0,r1,r2,r4"
d118 1
a118 1
        STR     r0, [sp]
@


4.1.7.1
log
@NCOS 1.06 Imported from Zip drive
@
text
@@


4.1.5.1
log
@Import from SrcFiler
@
text
@@


4.1.3.1
log
@Import from cleaned 370 CD
@
text
@@


4.1.1.1
log
@Import from cleaned 360 CD
@
text
@@
