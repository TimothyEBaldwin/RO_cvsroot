head	4.46;
access;
symbols
	FileSwitch-2_87:4.46
	FileSwitch-2_86:4.45
	FileSwitch-2_85:4.44
	FileSwitch-2_84:4.43
	FileSwitch-2_83:4.42
	FileSwitch-2_82:4.41
	FileSwitch-2_81:4.40
	FileSwitch-2_80:4.39
	FileSwitch-2_79:4.36
	FileSwitch-2_78:4.35
	FileSwitch-2_77:4.34
	FileSwitch-2_76:4.33
	FileSwitch-2_75:4.32
	FileSwitch-2_74:4.31
	FileSwitch-2_73:4.30
	FileSwitch-2_72:4.29
	FileSwitch-2_71:4.28
	FileSwitch-2_70:4.27
	FileSwitch-2_69:4.26
	FileSwitch-2_68:4.25
	FileSwitch-2_67:4.24
	RO_5_07:4.22
	FileSwitch-2_66:4.22
	FileSwitch-2_65:4.21
	FileSwitch-2_64:4.20
	FileSwitch-2_63:4.19
	FileSwitch-2_62:4.18
	FileSwitch-2_61:4.17
	FileSwitch-2_60:4.16
	FileSwitch-2_59:4.15
	FileSwitch-2_58:4.14
	FileSwitch-2_57:4.13
	FileSwitch-2_56:4.12
	FileSwitch-2_55:4.11
	FileSwitch-2_54:4.10
	FileSwitch-2_53:4.9
	dellis_autobuild_BaseSW:4.8
	FileSwitch-2_52:4.8
	Ursula_merge:4.7
	FileSwitch-2_51:4.7
	FileSwitch-2_50:4.6
	sbrodie_sedwards_16Mar2000:4.5
	FileSwitch-2_41:4.5
	FileSwitch-2_40:4.4
	dcotton_autobuild_BaseSW:4.20
	FileSwitch-2_39:4.3
	FileSwitch-2_38:4.2;
locks; strict;
comment	@# @;


4.46
date	2018.06.08.08.09.29;	author rsprowson;	state Exp;
branches;
next	4.45;
commitid	qYabIIAebGnw5sFA;

4.45
date	2017.09.03.22.15.36;	author jlee;	state Exp;
branches;
next	4.44;
commitid	bCZ4383ZWTOOHN5A;

4.44
date	2017.04.15.08.13.59;	author rool;	state Exp;
branches;
next	4.43;
commitid	OJ0rXo55IfB5ABNz;

4.43
date	2016.05.08.16.56.44;	author jlee;	state Exp;
branches;
next	4.42;
commitid	zhv5KtXcvPVZsH5z;

4.42
date	2014.11.11.20.28.10;	author jlee;	state Exp;
branches;
next	4.41;
commitid	NZkC5gAmQsqF7OXx;

4.41
date	2013.03.11.21.11.04;	author rsprowson;	state Exp;
branches;
next	4.40;
commitid	qH6q1SKEMrc3YpHw;

4.40
date	2013.01.13.17.43.24;	author jlee;	state Exp;
branches;
next	4.39;
commitid	iHKjwZpRiFhpE4Aw;

4.39
date	2013.01.05.21.51.16;	author rsprowson;	state Exp;
branches;
next	4.38;
commitid	H3x0sYCiOc2oh4zw;

4.38
date	2012.12.09.17.45.18;	author rsprowson;	state Exp;
branches;
next	4.37;
commitid	zUKgh5086ltOMzvw;

4.37
date	2012.12.02.10.44.55;	author rsprowson;	state Exp;
branches;
next	4.36;
commitid	hRmAmkUWjKKxGDuw;

4.36
date	2012.11.19.22.17.20;	author rsprowson;	state Exp;
branches;
next	4.35;
commitid	xASlUbHx3WqZV1tw;

4.35
date	2012.07.15.20.19.59;	author bavison;	state Exp;
branches;
next	4.34;
commitid	dn9GdxUheRLPmHcw;

4.34
date	2012.07.09.00.34.22;	author jlee;	state Exp;
branches;
next	4.33;
commitid	8AIOp0ZoVqs30Pbw;

4.33
date	2012.04.09.16.45.10;	author jlee;	state Exp;
branches;
next	4.32;
commitid	edYrr1amaoxrid0w;

4.32
date	2012.02.20.08.14.19;	author rsprowson;	state Exp;
branches;
next	4.31;
commitid	ylegcWjjKuNQ2STv;

4.31
date	2011.11.27.13.01.31;	author rsprowson;	state Exp;
branches;
next	4.30;
commitid	25EwnBluEgTKmYIv;

4.30
date	2011.11.27.12.59.32;	author rsprowson;	state Exp;
branches;
next	4.29;
commitid	nl4tAOdAxOs5mYIv;

4.29
date	2011.11.27.11.59.20;	author rsprowson;	state Exp;
branches;
next	4.28;
commitid	SMknibmDFieq1YIv;

4.28
date	2011.11.27.11.56.11;	author rsprowson;	state Exp;
branches;
next	4.27;
commitid	K4NCQAqLgaBl0YIv;

4.27
date	2011.10.20.20.17.47;	author rsprowson;	state Exp;
branches;
next	4.26;
commitid	Y5wScswtCs4a08Ev;

4.26
date	2011.10.16.11.29.37;	author rsprowson;	state Exp;
branches;
next	4.25;
commitid	MacYcSTahAyWczDv;

4.25
date	2011.08.04.21.27.51;	author jlee;	state Exp;
branches;
next	4.24;
commitid	IhtTEsao98YEReuv;

4.24
date	2009.06.15.23.01.33;	author bavison;	state Exp;
branches;
next	4.23;

4.23
date	2009.06.11.21.00.14;	author bavison;	state Exp;
branches;
next	4.22;

4.22
date	2004.07.01.14.44.40;	author kbracey;	state Exp;
branches;
next	4.21;

4.21
date	2002.12.12.15.41.57;	author kbracey;	state Exp;
branches;
next	4.20;

4.20
date	2001.08.20.17.02.30;	author dellis;	state Exp;
branches;
next	4.19;

4.19
date	2001.06.04.09.28.39;	author sbrodie;	state Exp;
branches;
next	4.18;

4.18
date	2001.06.02.20.49.35;	author sbrodie;	state Exp;
branches;
next	4.17;

4.17
date	2001.05.30.17.22.12;	author sbrodie;	state Exp;
branches;
next	4.16;

4.16
date	2001.05.14.14.45.32;	author dellis;	state Exp;
branches;
next	4.15;

4.15
date	2001.05.10.12.06.54;	author kbracey;	state Exp;
branches;
next	4.14;

4.14
date	2001.04.17.13.15.13;	author dcotton;	state Exp;
branches;
next	4.13;

4.13
date	2001.04.17.11.29.45;	author dcotton;	state Exp;
branches;
next	4.12;

4.12
date	2001.04.04.12.17.23;	author dellis;	state Exp;
branches;
next	4.11;

4.11
date	2001.04.03.17.39.39;	author bavison;	state Exp;
branches;
next	4.10;

4.10
date	2001.03.19.10.12.42;	author sbrodie;	state Exp;
branches;
next	4.9;

4.9
date	2001.03.01.13.45.45;	author sforrest;	state Exp;
branches;
next	4.8;

4.8
date	2000.03.20.15.57.41;	author kbracey;	state Exp;
branches;
next	4.7;

4.7
date	2000.03.20.15.02.57;	author kbracey;	state Exp;
branches;
next	4.6;

4.6
date	2000.03.20.14.30.45;	author kbracey;	state Exp;
branches;
next	4.5;

4.5
date	2000.03.01.16.11.16;	author sbrodie;	state Exp;
branches;
next	4.4;

4.4
date	99.11.15.09.52.02;	author dcotton;	state Exp;
branches;
next	4.3;

4.3
date	99.08.04.14.50.41;	author kbracey;	state Exp;
branches;
next	4.2;

4.2
date	98.10.22.13.35.23;	author nturton;	state Exp;
branches;
next	4.1;

4.1
date	98.10.22.13.18.43;	author nturton;	state Exp;
branches;
next	;


desc
@@


4.46
log
@Fix for missing monitor name after load
The code path that filing systems the register with dontuseload omitted the line printed when *OPT 1 is non-zero.
In particular this meant FileCore (which has the fsinfo word flag set) didn't report any monitor name.
For dontusesave, the initial call to do the equivalent of *Create covers the output even though it's a bit early. However, the flag check appeared to be inverted, so an FS with it set would call OS_File, and one clear would call OS_GBPB.

FileSwHdr.s: Remove use_fsfile_Save and use_fsfile_Load switches, since clients declare at runtime what their preference is (since RISC OS 3).
LowLevel.s: Extract monitor name reporting code, replace with function call to common code.
FSShared.s: Common function ReportMonitor.
OSFile.s: After doing a load via OS_GBPB call the monitor name reporting code. Tune up the StrongARM code flush code a little to not need R5 as a temporary. Fix inverted sense of dontusesave.

Version 2.87. Tagged as 'FileSwitch-2_87'
@
text
@/* (2.87)
 *
 * This file is automatically maintained by srccommit, do not edit manually.
 * Last processed by srccommit version: 1.1.
 *
 */
#define Module_MajorVersion_CMHG        2.87
#define Module_MinorVersion_CMHG        
#define Module_Date_CMHG                08 Jun 2018

#define Module_MajorVersion             "2.87"
#define Module_Version                  287
#define Module_MinorVersion             ""
#define Module_Date                     "08 Jun 2018"

#define Module_ApplicationDate          "08-Jun-18"

#define Module_ComponentName            "FileSwitch"
#define Module_ComponentPath            "castle/RiscOS/Sources/FileSys/FileSwitch"

#define Module_FullVersion              "2.87"
#define Module_HelpVersion              "2.87 (08 Jun 2018)"
#define Module_LibraryVersionInfo       "2:87"
@


4.45
log
@Eliminate global OS_SynchroniseCodeAreas
Detail:
  s/FSControl - Change the post-Service_UKCompression call to OS_SynchroniseCodeAreas to be a ranged up rather than a global one.
Admin:
  Tested on iMx6
  Improves performance with SMP ROMs, where global D-cache clean isn't really possible


Version 2.86. Tagged as 'FileSwitch-2_86'
@
text
@d1 1
a1 1
/* (2.86)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.86
d9 1
a9 1
#define Module_Date_CMHG                03 Sep 2017
d11 2
a12 2
#define Module_MajorVersion             "2.86"
#define Module_Version                  286
d14 1
a14 1
#define Module_Date                     "03 Sep 2017"
d16 1
a16 1
#define Module_ApplicationDate          "03-Sep-17"
d21 3
a23 3
#define Module_FullVersion              "2.86"
#define Module_HelpVersion              "2.86 (03 Sep 2017)"
#define Module_LibraryVersionInfo       "2:86"
@


4.44
log
@Fix to OS_FSControl 13 when no territory is loaded
Detail:
  PRM2-97 describes filing system name matching as case insensitive. However, the Internat_LowerCase macro is a no-op when there's no case conversion table, such as prior to the territory loading.
  Change FindFSName to use an case insensitive ASCII match until the territory starts.
  Fixes a problem with EtherUSB failing to start because it was using Devices: (rather than devices:). A global search of the sources shows SerMouse and the Kernel would also be affected.
Admin:
  Submission from Colin Granville.

Version 2.85. Tagged as 'FileSwitch-2_85'
@
text
@d1 1
a1 1
/* (2.85)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.85
d9 1
a9 1
#define Module_Date_CMHG                15 Apr 2017
d11 2
a12 2
#define Module_MajorVersion             "2.85"
#define Module_Version                  285
d14 1
a14 1
#define Module_Date                     "15 Apr 2017"
d16 1
a16 1
#define Module_ApplicationDate          "15-Apr-17"
d21 3
a23 3
#define Module_FullVersion              "2.85"
#define Module_HelpVersion              "2.85 (15 Apr 2017)"
#define Module_LibraryVersionInfo       "2:85"
@


4.43
log
@Avoid unnecessary remainder calculations
Detail:
  s/CtrlUtils, s/OSGBPB - Avoid unnecessary remainder calculations in DivRem macro
Admin:
  Tested on Cortex-A15


Version 2.84. Tagged as 'FileSwitch-2_84'
@
text
@d1 1
a1 1
/* (2.84)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.84
d9 1
a9 1
#define Module_Date_CMHG                08 May 2016
d11 2
a12 2
#define Module_MajorVersion             "2.84"
#define Module_Version                  284
d14 1
a14 1
#define Module_Date                     "08 May 2016"
d16 1
a16 1
#define Module_ApplicationDate          "08-May-16"
d21 3
a23 3
#define Module_FullVersion              "2.84"
#define Module_HelpVersion              "2.84 (08 May 2016)"
#define Module_LibraryVersionInfo       "2:84"
@


4.42
log
@Fix buffer overflow in *cat when dealing with long paths. Fix spurious errors when examining files with certain load addresses
Detail:
  s/CtrlUtils - Increase MaxFilenameSpace (used to reserve stack space for *cat directory path) from 400 bytes to StaticName_length (i.e. 1K)
  s/FileTypes - Avoid IsFileTyped erroneously returning with V set if r2 is within a certain range (e.g. &7ff00000). Now all exits go via code that ensures V is clear.
Admin:
  Tested on Raspberry Pi


Version 2.83. Tagged as 'FileSwitch-2_83'
@
text
@d1 1
a1 1
/* (2.83)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.83
d9 1
a9 1
#define Module_Date_CMHG                11 Nov 2014
d11 2
a12 2
#define Module_MajorVersion             "2.83"
#define Module_Version                  283
d14 1
a14 1
#define Module_Date                     "11 Nov 2014"
d16 1
a16 1
#define Module_ApplicationDate          "11-Nov-14"
d21 3
a23 3
#define Module_FullVersion              "2.83"
#define Module_HelpVersion              "2.83 (11 Nov 2014)"
#define Module_LibraryVersionInfo       "2:83"
@


4.41
log
@Increase maximum supported buffer size to 4k
LowFSI: Max_BuffSize define changed.
FileSwBody: Module workspace claim changed to claim Max_BuffSize in addition to the workspace required, so that all the variables in the workspace remain within ADR range.
OSFind: Vetting of acceptable buffer sizes now produced with a WHILE/WEND loop.
StreamBits: Changed to use 'free' flag rather then comparing with 'Nowt'.
MkClean/MkRom: Throwback enabled.

Tested in IOMD ROM, workspace manually inspected as OK.

Version 2.82. Tagged as 'FileSwitch-2_82'
@
text
@d1 1
a1 1
/* (2.82)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.82
d9 1
a9 1
#define Module_Date_CMHG                11 Mar 2013
d11 2
a12 2
#define Module_MajorVersion             "2.82"
#define Module_Version                  282
d14 1
a14 1
#define Module_Date                     "11 Mar 2013"
d16 1
a16 1
#define Module_ApplicationDate          "11-Mar-13"
d21 3
a23 3
#define Module_FullVersion              "2.82"
#define Module_HelpVersion              "2.82 (11 Mar 2013)"
#define Module_LibraryVersionInfo       "2:82"
@


4.40
log
@Automatically adjust wimpslot when running AIFs via FSControl 4
Detail:
  s/FSCommon - Adjust ValidateR2R5_WriteToCoreCodeLoad to try and increase the wimpslot if it isn't already big enough to contain the region being validated (i.e. the program being loaded)
  s/FSControl - FSControl 4 now checks AIF memory limts and tries to extend wimpslot as necessary both before and after decompression. An extra 8K is added to the calculated memory requirements to take into account memory which isn't declared in the header (root stack chunk?) which is required by SCL initialisation.
Admin:
  Tested in Iyonix ROM softload
  This should eliminate most/all of the "No writeable memory at this address", abort on data transfer, and "Not enough memory for C library" errors users receive due to the wimpslot being too small when all they want to do is run a program


Version 2.81. Tagged as 'FileSwitch-2_81'
@
text
@d1 1
a1 1
/* (2.81)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.81
d9 1
a9 1
#define Module_Date_CMHG                13 Jan 2013
d11 2
a12 2
#define Module_MajorVersion             "2.81"
#define Module_Version                  281
d14 1
a14 1
#define Module_Date                     "13 Jan 2013"
d16 1
a16 1
#define Module_ApplicationDate          "13-Jan-13"
d21 3
a23 3
#define Module_FullVersion              "2.81"
#define Module_HelpVersion              "2.81 (13 Jan 2013)"
#define Module_LibraryVersionInfo       "2:81"
@


4.39
log
@Added missing 'close' subreason to defines for OS_Find
Checked with a ROM build for conflicts, no clashes seen.

Version 2.80. Not tagged
@
text
@d1 1
a1 1
/* (2.80)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.80
d9 1
a9 1
#define Module_Date_CMHG                05 Jan 2013
d11 2
a12 2
#define Module_MajorVersion             "2.80"
#define Module_Version                  280
d14 1
a14 1
#define Module_Date                     "05 Jan 2013"
d16 1
a16 1
#define Module_ApplicationDate          "05-Jan-13"
d21 3
a23 3
#define Module_FullVersion              "2.80"
#define Module_HelpVersion              "2.80 (05 Jan 2013)"
#define Module_LibraryVersionInfo       "2:80"
@


4.38
log
@Add LowFSI to C exports

Version 2.80. Not tagged
@
text
@d9 1
a9 1
#define Module_Date_CMHG                09 Dec 2012
d14 1
a14 1
#define Module_Date                     "09 Dec 2012"
d16 1
a16 1
#define Module_ApplicationDate          "09-Dec-12"
d22 1
a22 1
#define Module_HelpVersion              "2.80 (09 Dec 2012)"
@


4.37
log
@Fix dereference of duff FS control block when resolving badly formed paths
In OS_Find there is a call to TopPath_DoBusinessToPath in DoTheOpen, any V set exits from this are propagated to the user correctly.
Non V set exits (ie. the object type is returned) are passed to DoTheOpen_Common which in turn calls TryToOpenFile. TryToOpenFile (if fscb is not Nowt) dereferences it to get at the info word.
A problem exists where TopPath_DoBusinessToPath fails the policing check - when multipart paths are permitted (such as OS_Find) it swallows the error, steps the path, and eventually exits with an object type 0. However, this code path never sets up the fscb.
So when TryToOpenFile dereferences it (in testing it seemed to have some address in the kernel lingering) depending on your luck the fsinfo_alwaysopen bit might be set. This in turn triggers a forced call to the low level FS entry point, and the entry point is some garbage address leading to an abort.
The minimalist test cases were
 SYS"OS_Find",&41,"MyName","MyPath$"
 SYS"OS_Find",&49,"MyName","MyPath$"
both of which fail the policing step because the incorrect use of the path type bits mean the attempted name becomes MyPath$MyName and you can't have '$' in the middle of a filename. Other more complex examples exist, including having a multipart path where one of the path elements in invalid.
Solved here by setting fscb up to a default (valid) value.
Fixes ticket #287.

Version 2.80. Tagged as 'FileSwitch-2_80'
@
text
@d9 1
a9 1
#define Module_Date_CMHG                02 Dec 2012
d14 1
a14 1
#define Module_Date                     "02 Dec 2012"
d16 1
a16 1
#define Module_ApplicationDate          "02-Dec-12"
d22 1
a22 1
#define Module_HelpVersion              "2.80 (02 Dec 2012)"
@


4.36
log
@Make internal calls to EnsureFileSize saturate at 0xFFFFFFFF rather than error
The corresponding external interface, OS_Args 6, takes a byte size in R2 which is passed on verbatim. However, when FileSwitch wants to do the same operation it rounds up to the nearest buffer size and complains the operation can't complete ("File too big") when the same operation through OS_Args would succeed.
Internally FileSwitch doesn't actually use the allocated size for anything (other than to avoid unnecesary ensures, and to cache the value for read back via OS_Args 4), so the full byte range of R2 is now allowed internally as well as externally.
FSEntry_Open may also pass back 0xFFFFFFFF as the allocated size on opening similarly.
FSEntry_Args 7 and FSEntry_Args 4 are the corresponding low level API, these are unchanged in meaning.

The FSEntry_Args 8, write 0s to file (usually triggered by extending with EXT#handle=number), is defined as always passing the file offset as a multiple of the buffer size, and the number of 0s to write as a multiple of the buffer size. To allow this to write up to 4G of 0s while not spilling over R3, FileSwitch now splits such a call into one buffer, followed by the remainder.

Tested with LanManFS 2.38, checking operations are split appropriately.

Version 2.79. Tagged as 'FileSwitch-2_79'
@
text
@d1 1
a1 1
/* (2.79)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.79
d9 1
a9 1
#define Module_Date_CMHG                19 Nov 2012
d11 2
a12 2
#define Module_MajorVersion             "2.79"
#define Module_Version                  279
d14 1
a14 1
#define Module_Date                     "19 Nov 2012"
d16 1
a16 1
#define Module_ApplicationDate          "19-Nov-12"
d21 3
a23 3
#define Module_FullVersion              "2.79"
#define Module_HelpVersion              "2.79 (19 Nov 2012)"
#define Module_LibraryVersionInfo       "2:79"
@


4.35
log
@  Bugfix to *Copy
Detail:
  With *Copy A, and the related SWI OS_FSControl 26 with R3 bit 9 clear, if
  a directory was copied over an image file, the contents of the directory
  would be copied (assuming recursive) but then when the attributes were
  copied over, the directory's filetype (usually FFD, Data) and user access
  bits (both 0) were copied to the destination image file, rendering it
  unusable.
Admin:
  Tested on a Raspberry Pi with the DOS partition in the standard disc image.

Version 2.78. Tagged as 'FileSwitch-2_78'
@
text
@d1 1
a1 1
/* (2.78)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.78
d9 1
a9 1
#define Module_Date_CMHG                15 Jul 2012
d11 2
a12 2
#define Module_MajorVersion             "2.78"
#define Module_Version                  278
d14 1
a14 1
#define Module_Date                     "15 Jul 2012"
d16 1
a16 1
#define Module_ApplicationDate          "15-Jul-12"
d21 3
a23 3
#define Module_FullVersion              "2.78"
#define Module_HelpVersion              "2.78 (15 Jul 2012)"
#define Module_LibraryVersionInfo       "2:78"
@


4.34
log
@Fix a couple of null/bad pointer dereferences
Detail:
  s/FSControl - faff_boot_option_startup (OS_FSControl 47/48) was acting as if it was given a path variable in r3, but neither of those calls use path variables, leading to aborts in some situations due to random bits of memory being peeked at.
  s/FSUtils - When CopyWildObject performs a single object copy, it wasn't taking into account the fact that the src/dest leafname pointers could be null, potentially causing a crash if high processor vectors are in use.
Since I'm not 100% sure what the correct course of action is (in the case I saw it crash, both src and dest leafnames were null), and there aren't any bugs I know of with file copies using the wrong names, the code now uses the dest leafname if the dest leafname is null.
This sounds wrong, but matches the behaviour of the old code, since byte &00000000 is highly unlikely to contain a '*' character
Admin:
  Tested on BB-xM with high processor vectors


Version 2.77. Tagged as 'FileSwitch-2_77'
@
text
@d1 1
a1 1
/* (2.77)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.77
d9 1
a9 1
#define Module_Date_CMHG                09 Jul 2012
d11 2
a12 2
#define Module_MajorVersion             "2.77"
#define Module_Version                  277
d14 1
a14 1
#define Module_Date                     "09 Jul 2012"
d16 1
a16 1
#define Module_ApplicationDate          "09-Jul-12"
d21 3
a23 3
#define Module_FullVersion              "2.77"
#define Module_HelpVersion              "2.77 (09 Jul 2012)"
#define Module_LibraryVersionInfo       "2:77"
@


4.33
log
@Fix TopPath_DoBusinessToPath leaking memory on error
Detail:
  s/TopPath - Code which attempted to free the cleaned up user's path incorrectly assumed that it could find the string via the stacked R0. However stacked regs R0-R6 get updated with the found objects details, so we need to store a copy of the users R0 elsewhere and free the string via that instead.
Admin:
  Fixes OS_FSControl 37 (and other operations?) filling the system heap if given paths which will generate errors (e.g. if drive empty/missing)


Version 2.76. Tagged as 'FileSwitch-2_76'
@
text
@d1 1
a1 1
/* (2.76)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.76
d9 1
a9 1
#define Module_Date_CMHG                09 Apr 2012
d11 2
a12 2
#define Module_MajorVersion             "2.76"
#define Module_Version                  276
d14 1
a14 1
#define Module_Date                     "09 Apr 2012"
d16 1
a16 1
#define Module_ApplicationDate          "09-Apr-12"
d21 3
a23 3
#define Module_FullVersion              "2.76"
#define Module_HelpVersion              "2.76 (09 Apr 2012)"
#define Module_LibraryVersionInfo       "2:76"
@


4.32
log
@Fix bug in OS_Args R0=R1=0 when no temporary filing system is selected.
Was returning internal value 'Nowt' instead of zero.
This bug seems to have appeared in FileSwitch 1.70 in RISC OS 3.00 and as such for backwards compatibility the value 0 and the value 0x40000000 should be taken to mean 'none'.

Version 2.75. Tagged as 'FileSwitch-2_75'
@
text
@d1 1
a1 1
/* (2.75)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.75
d9 1
a9 1
#define Module_Date_CMHG                20 Feb 2012
d11 2
a12 2
#define Module_MajorVersion             "2.75"
#define Module_Version                  275
d14 1
a14 1
#define Module_Date                     "20 Feb 2012"
d16 1
a16 1
#define Module_ApplicationDate          "20-Feb-12"
d21 3
a23 3
#define Module_FullVersion              "2.75"
#define Module_HelpVersion              "2.75 (20 Feb 2012)"
#define Module_LibraryVersionInfo       "2:75"
@


4.31
log
@Add OS_FSControl 58 to enumerate handles, does OS_Args 7 and 254 in one hit.

Version 2.74. Tagged as 'FileSwitch-2_74'
@
text
@d1 1
a1 1
/* (2.74)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.74
d9 1
a9 1
#define Module_Date_CMHG                27 Nov 2011
d11 2
a12 2
#define Module_MajorVersion             "2.74"
#define Module_Version                  274
d14 1
a14 1
#define Module_Date                     "27 Nov 2011"
d16 1
a16 1
#define Module_ApplicationDate          "27-Nov-11"
d21 3
a23 3
#define Module_FullVersion              "2.74"
#define Module_HelpVersion              "2.74 (27 Nov 2011)"
#define Module_LibraryVersionInfo       "2:74"
@


4.30
log
@*COUNT and *COPY summaries cope with > 32 bit totals.
Delete dead macro.
Ammend OS_FSControl 28 API to aloow report of 64 bit results.
On failing to get any memory at all for *COPY an attempt is made to grab an 'excessive' amount of RMA to get an error message, but this was only requesting 32MB which is now quite feasible - now asks for 2GB.

Version 2.73. Tagged as 'FileSwitch-2_73'
@
text
@d1 1
a1 1
/* (2.73)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.73
d11 2
a12 2
#define Module_MajorVersion             "2.73"
#define Module_Version                  273
d21 3
a23 3
#define Module_FullVersion              "2.73"
#define Module_HelpVersion              "2.73 (27 Nov 2011)"
#define Module_LibraryVersionInfo       "2:73"
@


4.29
log
@assert -> ASSERT.
Collapse old switches.
Remove 'Version' GBLA.
*COUNT summary now says "total 1234 bytes" not "1234 bytes" to match *COPY
Empty *COUNT syntax message corrected.
Binary identical to last version (messages different clearly).

Version 2.72. Tagged as 'FileSwitch-2_72'
@
text
@d1 1
a1 1
/* (2.72)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.72
d11 2
a12 2
#define Module_MajorVersion             "2.72"
#define Module_Version                  272
d21 3
a23 3
#define Module_FullVersion              "2.72"
#define Module_HelpVersion              "2.72 (27 Nov 2011)"
#define Module_LibraryVersionInfo       "2:72"
@


4.28
log
@Fixed up a deprecated push (in OSBgetBput), untangled two STM single reg (in OSFile).
Delete unused 'KernelFSW'.
HighFSI
 Retire some crusty definitions
 Reserve OS_FSControl reason codes used by ROL

Version 2.71. Tagged as 'FileSwitch-2_71'
@
text
@d1 1
a1 1
/* (2.71)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.71
d11 2
a12 2
#define Module_MajorVersion             "2.71"
#define Module_Version                  271
d21 3
a23 3
#define Module_FullVersion              "2.71"
#define Module_HelpVersion              "2.71 (27 Nov 2011)"
#define Module_LibraryVersionInfo       "2:71"
@


4.27
log
@Fix for *COPY finishing too early with files > 2G
Same drill, V was being set or not preserved when it shouldn't or should be. In light of this all locations that do CMP/SUBS/ADDS involving fileptr/extent/anything ending in size or length have been reviewed and ammended where needed.
Trim some dead code.
Discard 'Version' file.

Version 2.70. Tagged as 'FileSwitch-2_70'
@
text
@d1 1
a1 1
/* (2.70)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.70
d9 1
a9 1
#define Module_Date_CMHG                20 Oct 2011
d11 2
a12 2
#define Module_MajorVersion             "2.70"
#define Module_Version                  270
d14 1
a14 1
#define Module_Date                     "20 Oct 2011"
d16 1
a16 1
#define Module_ApplicationDate          "20-Oct-11"
d21 3
a23 3
#define Module_FullVersion              "2.70"
#define Module_HelpVersion              "2.70 (20 Oct 2011)"
#define Module_LibraryVersionInfo       "2:70"
@


4.26
log
@Fix OS_Args 1 and OS_GBPB 3/4 for files > 2G.
In OS_Args 1 a compare was followed by a conditional store, but with files > 2G some circumstances end up with VS so the store wasn't taken.
In OS_GBPB 3/4 the assessment of how much could be done was based on adding the current fileptr to the request but not respecting the carry out. Reordered the equation to get this calculation right.
Changed a signed compare of a byte variable to use unsigned so auditing of signed condition codes is clearer.
Corrected spelling of 'openning'.
Fix copy_srchandle and copy_dsthandle to not assume handles fit in 1 byte.
Tested on a variety of contrived file sizes at the boundaries of 2G and 4G.

Version 2.69. Tagged as 'FileSwitch-2_69'
@
text
@d1 1
a1 1
/* (2.69)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.69
d9 1
a9 1
#define Module_Date_CMHG                16 Oct 2011
d11 2
a12 2
#define Module_MajorVersion             "2.69"
#define Module_Version                  269
d14 1
a14 1
#define Module_Date                     "16 Oct 2011"
d16 1
a16 1
#define Module_ApplicationDate          "16-Oct-11"
d21 3
a23 3
#define Module_FullVersion              "2.69"
#define Module_HelpVersion              "2.69 (16 Oct 2011)"
#define Module_LibraryVersionInfo       "2:69"
@


4.25
log
@Update to work with zero page relocation
Detail:
  s/FileSwBody, s/FileSwHdr - Try getting DomainId pointer via OS_ReadSysInfo 6 before falling back on legacy address. Store result in workspace for speedy lookup.
  s/FSCommon - Use workspace DomainId pointer
  s/CtrlUtils - Update int_ConstructFullPathWithoutFSAndSpecial to not attempt to append the contents of null string pointers.
  s/FSControl - Update AppendStringIfNotNull to ignore null pointers
  s/LowLevel - Update CallFSFile_Given to not try copying from null special field strings
Admin:
  Tested on rev A2 BB-xM.
  AFAIK the null pointer bugs are all FileSwitch bugs and not bugs in whatever called FileSwitch, although I may be wrong. Not entirely sure how some of the code managed to read strings from null pointers without creating garbage filenames as a result!


Version 2.68. Tagged as 'FileSwitch-2_68'
@
text
@d1 1
a1 1
/* (2.68)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.68
d9 1
a9 1
#define Module_Date_CMHG                04 Aug 2011
d11 2
a12 2
#define Module_MajorVersion             "2.68"
#define Module_Version                  268
d14 1
a14 1
#define Module_Date                     "04 Aug 2011"
d16 1
a16 1
#define Module_ApplicationDate          "04-Aug-11"
d21 3
a23 3
#define Module_FullVersion              "2.68"
#define Module_HelpVersion              "2.68 (04 Aug 2011)"
#define Module_LibraryVersionInfo       "2:68"
@


4.24
log
@  Bugfix to OS_File 5
Detail:
  s.LowLevel: STRNE should have been STRNEB. Looks like this meant that
  OS_File 5 was broken if the object name contained a filing system special
  field.
  Added ENTRY directive to permit building of GPA debug listing.
Admin:
  Built but not tested (should be a safe change).

Version 2.67. Tagged as 'FileSwitch-2_67'
@
text
@d1 1
a1 1
/* (2.67)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.67
d9 1
a9 1
#define Module_Date_CMHG                15 Jun 2009
d11 2
a12 2
#define Module_MajorVersion             "2.67"
#define Module_Version                  267
d14 1
a14 1
#define Module_Date                     "15 Jun 2009"
d16 1
a16 1
#define Module_ApplicationDate          "15-Jun-09"
d21 3
a23 3
#define Module_FullVersion              "2.67"
#define Module_HelpVersion              "2.67 (15 Jun 2009)"
#define Module_LibraryVersionInfo       "2:67"
@


4.23
log
@  GET file pathnames changed
Detail:
  Uses suffixed file extensions for compatiblity with both objasm and asasm.
Admin:
  Supplied by Peter Naulls, tested at ROOL

Version 2.66. Not tagged
@
text
@d1 1
a1 1
/* (2.66)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.66
d9 1
a9 1
#define Module_Date_CMHG                11 Jun 2009
d11 2
a12 2
#define Module_MajorVersion             "2.66"
#define Module_Version                  266
d14 1
a14 1
#define Module_Date                     "11 Jun 2009"
d16 1
a16 1
#define Module_ApplicationDate          "11-Jun-09"
d21 3
a23 3
#define Module_FullVersion              "2.66"
#define Module_HelpVersion              "2.66 (11 Jun 2009)"
#define Module_LibraryVersionInfo       "2:66"
@


4.22
log
@Some OS_SynchroniseCodeArea calls weren't quite passing the correct address
ranges.

Version 2.66. Tagged as 'FileSwitch-2_66'
@
text
@d4 1
a4 1
 * Last processed by srccommit version: 1.68.
d9 1
a9 1
#define Module_Date_CMHG                01 Jul 2004
d14 1
a14 1
#define Module_Date                     "01 Jul 2004"
d16 1
a16 1
#define Module_ApplicationDate          "01-Jul-04"
d19 1
a19 1
#define Module_ComponentPath            "RiscOS/Sources/FileSys/FileSwitch"
d22 1
a22 1
#define Module_HelpVersion              "2.66 (01 Jul 2004)"
@


4.21
log
@More 32-bit fixes; all to do with coping with the system heap, ROM etc
being in new places - these are now checked at run-time.

Version 2.65. Tagged as 'FileSwitch-2_65'
@
text
@d1 1
a1 1
/* (2.65)
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.65
d9 1
a9 1
#define Module_Date_CMHG                12 Dec 2002
d11 2
a12 2
#define Module_MajorVersion             "2.65"
#define Module_Version                  265
d14 1
a14 1
#define Module_Date                     "12 Dec 2002"
d16 1
a16 1
#define Module_ApplicationDate          "12-Dec-02"
d21 3
a23 3
#define Module_FullVersion              "2.65"
#define Module_HelpVersion              "2.65 (12 Dec 2002)"
#define Module_LibraryVersionInfo       "2:65"
@


4.20
log
@  Fixed bug in memory allocation check code.

Detail:
  Code has been added to fileswitch to detect whether there is sufficient
memory for a program to execute, and report a sensible error rather than
aborting in it's initialistion code.  This implicitly relied on R12 in
the error routines, which was being corrupted.  R12 register usage has now
replaced by other safe registers.

  This was exacerbated by incorrectly formed AIF headers, such as those
generated by at least some versions of the Easy C Linker, which don't have
correct entries for the size of the data areas of the file.

Admin:
  Tested on a RPC.  The system appears to work correctly, and malformed AIF
headers cause the error to be raised without other harm.


Version 2.64. Tagged as 'FileSwitch-2_64'
@
text
@d1 1
a1 1
/* (2.64)
d4 1
d7 1
a7 1
#define Module_MajorVersion_CMHG        2.64
d9 1
a9 1
#define Module_Date_CMHG                20 Aug 2001
d11 2
a12 2
#define Module_MajorVersion             "2.64"
#define Module_Version                  264
d14 1
a14 1
#define Module_Date                     "20 Aug 2001"
d16 1
a16 2
#define Module_ApplicationDate2         "20-Aug-01"
#define Module_ApplicationDate4         "20-Aug-2001"
d21 3
a23 2
#define Module_FullVersion              "2.64"
#define Module_HelpVersion              "2.64 (20 Aug 2001)"
@


4.19
log
@  Third time lucky.
Admin:
  Tested - and it doesn't result in FileCore in use errors any more.


Version 2.63. Tagged as 'FileSwitch-2_63'
@
text
@d1 1
a1 1
/* (2.63)
d6 1
a6 1
#define Module_MajorVersion_CMHG        2.63
d8 1
a8 1
#define Module_Date_CMHG                04 Jun 2001
d10 2
a11 2
#define Module_MajorVersion             "2.63"
#define Module_Version                  263
d13 1
a13 1
#define Module_Date                     "04 Jun 2001"
d15 2
a16 2
#define Module_ApplicationDate2         "04-Jun-01"
#define Module_ApplicationDate4         "04-Jun-2001"
d21 2
a22 2
#define Module_FullVersion              "2.63"
#define Module_HelpVersion              "2.63 (04 Jun 2001)"
@


4.18
log
@  The check I added in the previous version didn't work :-(
Detail:
  R12 cannot be corrupted until FileSwitch is committed to starting the
    new application.  Changed code to not use R12 any more until it is
    100% sure that the application is going to be launched come what may.
Admin:
  Not built; not tested - but version 2.61 is not useful.  Should work now.


Version 2.62. Tagged as 'FileSwitch-2_62'
@
text
@d1 1
a1 1
/* (2.62)
d6 1
a6 1
#define Module_MajorVersion_CMHG        2.62
d8 1
a8 1
#define Module_Date_CMHG                02 Jun 2001
d10 2
a11 2
#define Module_MajorVersion             "2.62"
#define Module_Version                  262
d13 1
a13 1
#define Module_Date                     "02 Jun 2001"
d15 2
a16 2
#define Module_ApplicationDate2         "02-Jun-01"
#define Module_ApplicationDate4         "02-Jun-2001"
d21 2
a22 2
#define Module_FullVersion              "2.62"
#define Module_HelpVersion              "2.62 (02 Jun 2001)"
@


4.17
log
@  AIF image header checks improved.
Detail:
  AIF headers declare how much space they are going to need in addition
    to the size of the executable on the filesystem.  This information
    is now extracted by FileSwitch to validate that the memory limit
    will not be exceeded.
Admin:
  Built.  Not tested.


Version 2.61. Tagged as 'FileSwitch-2_61'
@
text
@d1 1
a1 1
/* (2.61)
d6 1
a6 1
#define Module_MajorVersion_CMHG        2.61
d8 1
a8 1
#define Module_Date_CMHG                30 May 2001
d10 2
a11 2
#define Module_MajorVersion             "2.61"
#define Module_Version                  261
d13 1
a13 1
#define Module_Date                     "30 May 2001"
d15 2
a16 2
#define Module_ApplicationDate2         "30-May-01"
#define Module_ApplicationDate4         "30-May-2001"
d21 2
a22 2
#define Module_FullVersion              "2.61"
#define Module_HelpVersion              "2.61 (30 May 2001)"
@


4.16
log
@  Closing a file now allows the underlying filing system to object,
preventing the file from being closed.

Detail:
  The error return from the underlying filing system wasn't being used to
prevent the fileswitch record for the open file being removed.  This resulted
in the underlying filing system not being able to prevent closure of a file
handle.  This behaviour is relied upon by PipeFS when it returns an error
from the Sleep No More UpCall.

Admin:
  Tested on RPC.  Note that the 32 bit build doesn't work on the 26 bit
desktop for no identified reason.
Version 2.60. Tagged as 'FileSwitch-2_60'
@
text
@d1 1
a1 1
/* (2.60)
d6 1
a6 1
#define Module_MajorVersion_CMHG        2.60
d8 1
a8 1
#define Module_Date_CMHG                14 May 2001
d10 2
a11 2
#define Module_MajorVersion             "2.60"
#define Module_Version                  260
d13 1
a13 1
#define Module_Date                     "14 May 2001"
d15 2
a16 2
#define Module_ApplicationDate2         "14-May-01"
#define Module_ApplicationDate4         "14-May-2001"
d21 2
a22 2
#define Module_FullVersion              "2.60"
#define Module_HelpVersion              "2.60 (14 May 2001)"
@


4.15
log
@Two minor 32-bit fixes.

Version 2.59. Tagged as 'FileSwitch-2_59'
@
text
@d1 1
a1 1
/* (2.59)
d6 1
a6 1
#define Module_MajorVersion_CMHG        2.59
d8 1
a8 1
#define Module_Date_CMHG                10 May 2001
d10 2
a11 2
#define Module_MajorVersion             "2.59"
#define Module_Version                  259
d13 1
a13 1
#define Module_Date                     "10 May 2001"
d15 2
a16 2
#define Module_ApplicationDate2         "10-May-01"
#define Module_ApplicationDate4         "10-May-2001"
d21 2
a22 2
#define Module_FullVersion              "2.59"
#define Module_HelpVersion              "2.59 (10 May 2001)"
@


4.14
log
@    Now works.

Detail:
    The version of Stewart's notes that I was using to convert the component
to support ObjAsm was out of date, and hence missed out a couple of sections
on converting Asm headers to C headers and tokenisation. This would only have
been picked up when building straight out of CVS. A classic case of RTLM
(read the latest manual). However, doing this work showed up a bit missing
from Stewart's notes, so it is really a case of RTLMWSHWI, or read the latest
manual when Stewart has written it). ;-)
    The makefile has been altered to ensure that the correct operations occur.

Admin:
    Not tested in a build. Checked the logs from running export headers,
libs, resources and rom phases against a pre-objasm build and verified that
all the same steps are occuring.

Version 2.58. Tagged as 'FileSwitch-2_58'
@
text
@d1 1
a1 1
/* (2.58)
d6 1
a6 1
#define Module_MajorVersion_CMHG        2.58
d8 1
a8 1
#define Module_Date_CMHG                17 Apr 2001
d10 2
a11 2
#define Module_MajorVersion             "2.58"
#define Module_Version                  258
d13 1
a13 1
#define Module_Date                     "17 Apr 2001"
d15 2
a16 2
#define Module_ApplicationDate2         "17-Apr-01"
#define Module_ApplicationDate4         "17-Apr-2001"
d21 2
a22 2
#define Module_FullVersion              "2.58"
#define Module_HelpVersion              "2.58 (17 Apr 2001)"
@


4.13
log
@    Altered to use shared makefiles and ObjAsm.

Detail:
    As above. No other changes.

Admin:
    Tested in a Lazarus build.

Version 2.57. Tagged as 'FileSwitch-2_57'
@
text
@d1 1
a1 1
/* (2.57)
d6 1
a6 1
#define Module_MajorVersion_CMHG        2.57
d10 2
a11 2
#define Module_MajorVersion             "2.57"
#define Module_Version                  257
d21 2
a22 2
#define Module_FullVersion              "2.57"
#define Module_HelpVersion              "2.57 (17 Apr 2001)"
@


4.12
log
@  Fixed some data aborts on OS_Args calls

Detail:
  OS_Args 8 and 9 (ImageStampIS and IOCtl) didn't check that the file handle
passed to them was legitimate and hence would cause data aborts as they tried
to access non existant structures.

Admin:
  Not tested.  Two lines of assembler copied into each function to test
whether the file handle is valid from other similar calls.

Version 2.56. Tagged as 'FileSwitch-2_56'
@
text
@d1 1
a1 1
/* (2.56)
d6 1
a6 1
#define Module_MajorVersion_CMHG        2.56
d8 1
a8 1
#define Module_Date_CMHG                04 Apr 2001
d10 2
a11 2
#define Module_MajorVersion             "2.56"
#define Module_Version                  256
d13 1
a13 1
#define Module_Date                     "04 Apr 2001"
d15 2
a16 2
#define Module_ApplicationDate2         "04-Apr-01"
#define Module_ApplicationDate4         "04-Apr-2001"
d21 2
a22 2
#define Module_FullVersion              "2.56"
#define Module_HelpVersion              "2.56 (04 Apr 2001)"
@


4.11
log
@  Minor bugfix.
Detail:
  UpCall 3 (ModifyingFile) is no longer issued by OS_File 24 (ReadBlockSize).
Admin:
  Not tested.

Version 2.55. Tagged as 'FileSwitch-2_55'
@
text
@d1 1
a1 1
/* (2.55)
d6 1
a6 1
#define Module_MajorVersion_CMHG        2.55
d8 1
a8 1
#define Module_Date_CMHG                03 Apr 2001
d10 2
a11 2
#define Module_MajorVersion             "2.55"
#define Module_Version                  255
d13 1
a13 1
#define Module_Date                     "03 Apr 2001"
d15 2
a16 2
#define Module_ApplicationDate2         "03-Apr-01"
#define Module_ApplicationDate4         "03-Apr-2001"
d21 2
a22 2
#define Module_FullVersion              "2.55"
#define Module_HelpVersion              "2.55 (03 Apr 2001)"
@


4.10
log
@  hdr/LowFSI was not objasm-compatible!
Detail:
  It is not legal for lines to end in \ unless the intention is that the
    line be rejoined.  This caused a structure member to be missing in the
    filing system header file which could have caused absolute havoc.
  Assertions are dead useful ...
Admin:
  Built.
  Required by SystemDevices 1.30 or later (and other components)

Version 2.54. Tagged as 'FileSwitch-2_54'
@
text
@d1 1
a1 1
/* (2.54)
d6 1
a6 1
#define Module_MajorVersion_CMHG        2.54
d8 1
a8 1
#define Module_Date_CMHG                19 Mar 2001
d10 2
a11 2
#define Module_MajorVersion             "2.54"
#define Module_Version                  254
d13 1
a13 1
#define Module_Date                     "19 Mar 2001"
d15 2
a16 2
#define Module_ApplicationDate2         "19-Mar-01"
#define Module_ApplicationDate4         "19-Mar-2001"
d21 2
a22 2
#define Module_FullVersion              "2.54"
#define Module_HelpVersion              "2.54 (19 Mar 2001)"
@


4.9
log
@
  * Removed dependency on obsolete STB flag.

Detail:

  * No longer relies on the STB flag; instead utilises "Hdr:UserIF.<UserIF>"
    to provide the Embedded_UI flag.

    The only difference between Desktop and Embedded builds is that the
    filing system name is NOT printed on Embedded builds upon Service_Reset.

Admin:

  * Built and tested on Lazarus 32-bit build.  Code is binary identical to
    previous versions the relied on the STB flag in both the Desktop and
    Embedded cases.

  * Requires HdrSrc 1.17 or later.

Version 2.53. Tagged as 'FileSwitch-2_53'
@
text
@d1 1
a1 1
/* (2.53)
d6 1
a6 1
#define Module_MajorVersion_CMHG        2.53
d8 1
a8 1
#define Module_Date_CMHG                01 Mar 2001
d10 2
a11 2
#define Module_MajorVersion             "2.53"
#define Module_Version                  253
d13 1
a13 1
#define Module_Date                     "01 Mar 2001"
d15 2
a16 2
#define Module_ApplicationDate2         "01-Mar-01"
#define Module_ApplicationDate4         "01-Mar-2001"
d21 2
a22 2
#define Module_FullVersion              "2.53"
#define Module_HelpVersion              "2.53 (01 Mar 2001)"
@


4.8
log
@  32-bit compatible.
Admin:
  Tested on a 32-bit system; untested on 26-bit, and merge with Ursula branch
  untested.

Version 2.52. Tagged as 'FileSwitch-2_52'
@
text
@d1 1
a1 1
/* (2.52)
d6 1
a6 1
#define Module_MajorVersion_CMHG        2.52
d8 1
a8 1
#define Module_Date_CMHG                20 Mar 2000
d10 2
a11 2
#define Module_MajorVersion             "2.52"
#define Module_Version                  252
d13 1
a13 1
#define Module_Date                     "20 Mar 2000"
d15 8
a22 1
#define Module_FullVersion              "2.52"
@


4.7
log
@  RISC OS Ltd changes merged onto trunk.
Detail:
  (extracted from BuffyLog)
  * Fixed problem with > 67 character filenames in OS_FSControl 26-28.
    buffer now fixed at 256 characters but lengths are now checked.

  * Paths may now be of any length without crashing fileswitch. On some
    occasions errors will be returned for long filenames (usually
    buffer overflow), but it will never crash. This does not stop other
    code (usually upcall handlers) from crashing the machine.
Admin:
  Not tested (TM). Shout at me if it doesn't work.

Version 2.51. Tagged as 'FileSwitch-2_51'
@
text
@d1 1
a1 1
/* (2.51)
d6 1
a6 1
#define Module_MajorVersion_CMHG        2.51
d10 2
a11 2
#define Module_MajorVersion             "2.51"
#define Module_Version                  251
d15 1
a15 1
#define Module_FullVersion              "2.51"
@


4.6
log
@  Ursula branch merged.
Detail:
  Full merge of Ursula branch. Path length limited to 256 if a compile-time
  check says SVCSTK is still &01C02000.

  Fix to bug introduced in RISC OS 3.70 - any errors returned by FSEntry_File
  255 were ignored.
  Some changes from RISC OS Ltd still to come.
Admin:
  Untested.

Version 2.50. Tagged as 'FileSwitch-2_50'
@
text
@d1 1
a1 1
/* (2.50)
d6 1
a6 1
#define Module_MajorVersion_CMHG        2.50
d10 2
a11 2
#define Module_MajorVersion             "2.50"
#define Module_Version                  250
d15 1
a15 1
#define Module_FullVersion              "2.50"
@


4.5
log
@  Exports C version of the HighFSI header file.
Detail:
  FileSwitch runs Hdr2H on its hdr.HighFSI file to export reason code
    symbols for the filing system SWIs.
Admin:
  Required by IPConfig 0.27 and later

Version 2.41. Tagged as 'FileSwitch-2_41'
@
text
@d1 1
a1 1
/* (2.41)
d6 1
a6 1
#define Module_MajorVersion_CMHG        2.41
d8 1
a8 1
#define Module_Date_CMHG                01 Mar 2000
d10 2
a11 2
#define Module_MajorVersion             "2.41"
#define Module_Version                  241
d13 1
a13 1
#define Module_Date                     "01 Mar 2000"
d15 1
a15 1
#define Module_FullVersion              "2.41"
@


4.4
log
@	Merged the latest changes on Spinner branch.

Detail:
	Needed the localres alterations off the Spinner branch that had been
added since the branch was last merged.
	Added strdepend to the clean phase.

Admin:
	Built locally and on a Funai4 build machine.

Version 2.40. Tagged as 'FileSwitch-2_40'
@
text
@d1 1
a1 1
/* (2.40)
d6 3
a8 3
#define Module_MajorVersion_CMHG     	2.40
#define Module_MinorVersion_CMHG	
#define Module_Date_CMHG      		15 Nov 1999
d10 4
a13 4
#define Module_MajorVersion     	"2.40"
#define Module_Version                  240
#define Module_MinorVersion		""
#define Module_Date      		"15 Nov 1999"
d15 1
a15 1
#define Module_FullVersion              "2.40"
@


4.3
log
@Merged in service call table only from Ursula branch.

Version 2.39. Tagged as 'FileSwitch-2_39'
@
text
@d1 1
a1 1
/* (2.39)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	2.39
d8 1
a8 1
#define Module_Date_CMHG      		04 Aug 1999
d10 2
a11 2
#define Module_MajorVersion     	"2.39"
#define Module_Version                  239
d13 1
a13 1
#define Module_Date      		"04 Aug 1999"
d15 1
a15 1
#define Module_FullVersion              "2.39"
@


4.2
log
@Now copes with SWI OS_SynchroniseCodeAreas returning an error.  The old
code preserved the V bit, but trashed r0.

Version 2.38. Tagged as 'FileSwitch-2_38'
@
text
@d1 1
a1 1
/* (2.38)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	2.38
d8 1
a8 1
#define Module_Date_CMHG      		22 Oct 1998
d10 2
a11 2
#define Module_MajorVersion     	"2.38"
#define Module_Version                  238
d13 1
a13 1
#define Module_Date      		"22 Oct 1998"
d15 1
@


4.1
log
@created by srccommit.
@
text
@d1 1
a1 1
/* (2.37)
d6 1
a6 1
#define Module_MajorVersion_CMHG     	2.37
d10 2
a11 2
#define Module_MajorVersion     	"2.37"
#define Module_Version                  237
@
