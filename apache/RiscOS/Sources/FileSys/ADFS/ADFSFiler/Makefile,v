head	4.12;
access;
symbols
	ADFSFiler-1_12:4.12
	ADFSFiler-1_11:4.12
	ADFSFiler-1_10:4.12
	ADFSFiler-1_09:4.11
	ADFSFiler-1_08:4.11
	ADFSFiler-1_07:4.11
	ADFSFiler-1_06:4.10
	ADFSFiler-1_05:4.10
	ADFSFiler-1_04:4.9
	ADFSFiler-1_03:4.8
	ADFSFiler-1_02:4.8
	ADFSFiler-1_01:4.8
	ADFSFiler-1_00:4.8
	ADFSFiler-0_99:4.7
	ADFSFiler-0_98:4.7
	RO_5_07:4.6
	ADFSFiler-0_97:4.6
	ADFSFiler-0_96:4.5
	ADFSFiler-0_95:4.5
	ADFSFiler-0_94:4.5
	ADFSFiler-0_93:4.4
	ADFSFiler-0_92:4.3
	ADFSFiler-0_91:4.3
	ADFSFiler-0_90:4.2
	ADFSFiler-0_89:4.2
	Ursula_merge:4.1.4.1
	ADFSFiler-0_88:4.1.4.1
	Ursula_RiscPC_merge:4.1.4.1
	mstphens_UrsulaRiscPCBuild_20Nov98:4.1.4.1
	Ursula_RiscPC:4.1.4.1.0.2
	rthornb_UrsulaBuild-19Aug1998:4.1.4.1
	UrsulaBuild_FinalSoftload:4.1.4.1
	rthornb_UrsulaBuild-12Aug1998:4.1.4.1
	aglover_UrsulaBuild-05Aug1998:4.1.4.1
	rthornb_UrsulaBuild-29Jul1998:4.1.4.1
	rthornb_UrsulaBuild-22Jul1998:4.1.4.1
	rthornb_UrsulaBuild-15Jul1998:4.1.4.1
	rthornb_UrsulaBuild-07Jul1998:4.1.4.1
	rthornb_UrsulaBuild-17Jun1998:4.1.4.1
	rthornb_UrsulaBuild-03Jun1998:4.1.4.1
	rthornb_UrsulaBuild-27May1998:4.1.4.1
	rleggett_ADFSFiler-0_87:4.1.4.1
	rthornb_UrsulaBuild-21May1998:4.1.4.1
	rthornb_UrsulaBuild_01May1998:4.1.4.1
	Spinner_RCA116:4.1.7.1
	Spinner_B20_2:4.1.7.1
	Spinner_19_3:4.1.7.1
	Spinner_B18:4.1.7.1
	Spinner_B17:4.1.7.1
	Spinner_B15:4.1.7.1
	Spinner_B14:4.1.7.1
	Spinner_B13:4.1.7.1
	Spinner_B12:4.1.7.1
	Spinner_B10:4.1.7.1
	Daytona:4.1.0.6
	Daytona_bp:4.1
	Ursula:4.1.0.4
	Ursula_bp:4.1
	Spinner_B7:4.1.7.1
	RO_3_71:4.1.3.1
	ARTtmp_merge:4.1.7.1
	Spin_3Apr97:4.1.7.1
	RCA_bp:4.1
	ARTtmp:4.1.7.1.0.2
	RCA:4.1.0.2
	Spin_merge:4.1.7.1
	MergeFiles:4.1.3.1
	RO_3_70:4.1.3.1
	NC_1_06:4.1.7.1
	Spinner:4.1.7
	Spin_xx:4.1.5
	NC_xx:4.1.5.1
	RO_3_60:4.1.1.1
	StrongARM:4.1.3
	Black:4.1.1;
locks; strict;
comment	@# @;


4.12
date	2016.05.29.13.38.32;	author rsprowson;	state Exp;
branches;
next	4.11;
commitid	p4dSk4hA9LA9Hn8z;

4.11
date	2013.08.25.09.42.40;	author rsprowson;	state Exp;
branches;
next	4.10;
commitid	sbTH9MvAIK05NO2x;

4.10
date	2012.08.30.16.55.17;	author rsprowson;	state Exp;
branches;
next	4.9;
commitid	M5b5YtItUjpWKAiw;

4.9
date	2012.04.14.01.02.32;	author bavison;	state Exp;
branches;
next	4.8;
commitid	kz9ocYqopho5VL0w;

4.8
date	2010.03.01.23.24.35;	author jlee;	state Exp;
branches;
next	4.7;

4.7
date	2005.02.01.01.26.58;	author jballance;	state Exp;
branches;
next	4.6;

4.6
date	2003.06.05.14.10.05;	author bavison;	state Exp;
branches;
next	4.5;

4.5
date	2003.05.08.19.29.19;	author bavison;	state Exp;
branches;
next	4.4;

4.4
date	2003.03.11.21.28.52;	author rsprowson;	state Exp;
branches;
next	4.3;

4.3
date	2002.11.14.23.04.55;	author kbracey;	state Exp;
branches;
next	4.2;

4.2
date	2000.07.11.09.34.30;	author kbracey;	state Exp;
branches;
next	4.1;

4.1
date	96.11.05.09.31.40;	author nturton;	state Exp;
branches
	4.1.1.1
	4.1.3.1
	4.1.4.1
	4.1.5.1
	4.1.7.1;
next	;

4.1.1.1
date	96.11.05.09.31.40;	author nturton;	state Exp;
branches;
next	;

4.1.3.1
date	96.11.05.23.37.22;	author nturton;	state Exp;
branches;
next	;

4.1.4.1
date	98.03.26.14.09.22;	author rthornb;	state Exp;
branches;
next	;

4.1.5.1
date	96.11.21.12.31.04;	author nturton;	state Exp;
branches;
next	;

4.1.7.1
date	96.11.29.20.26.27;	author nturton;	state Exp;
branches;
next	;


desc
@@


4.12
log
@Remove use of RESOURCEEXTRA & PRIVATEMSGS
Requires BuildSys-6_91.

Version 1.10. Tagged as 'ADFSFiler-1_10'
@
text
@# Copyright 1996 Acorn Computers Ltd
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
# Makefile for ADFSFiler
#
# ***********************************
# ***    C h a n g e   L i s t    ***
# ***********************************
# Date       Name         Description
# ----       ----         -----------
# 25-May-94  AMcC         Created.
#

COMPONENT    ?= ADFSFiler
ROM_SOURCE    = s.ADFSFiler
CUSTOMRES     = custom

ifeq (${TEMPLATES},yes)
WANTTEMPLATES = resources_templates
endif

ifeq (${COMPONENT},SCSIFiler)
SUFFIX        = S
else
ifeq (${COMPONENT},SDFSFiler)
SUFFIX        = SD
endif
endif

ifeq (${TARGET},ThemeDefs)
CUSTOMSA      = custom
CUSTOMEXP     = custom
install:
        ${MKDIR} ${INSTDIR}.${USERIF}
        | Give the sprites for the requested theme if present
        IfThere Resources.SCSI.${USERIF} Then ${CP} Resources.SCSI.${USERIF} ${INSTDIR}.${USERIF}.SCSIFiler ${CPFLAGS}
        IfThere Resources.SDFS.${USERIF} Then ${CP} Resources.SDFS.${USERIF} ${INSTDIR}.${USERIF}.SDFSFiler ${CPFLAGS}
        @@${ECHO} ${COMPONENT}: disc theme resources installed
endif

include StdTools
include AAsmModule

${MERGEDMSGS}::
        ${MKDIR} ${MERGEDRDIR}.${TARGET}
        ${TOKENCHECK} LocalRes:Messages${SUFFIX}
        ${CP} LocalRes:Messages${SUFFIX} $@@ ${CPFLAGS}
        IfThere LocalRes:CmdHelp${SUFFIX} Then ${TOKENCHECK} LocalRes:CmdHelp${SUFFIX}
        IfThere LocalRes:CmdHelp${SUFFIX} Then ${FAPPEND} $@@ LocalRes:Messages LocalRes:CmdHelp${SUFFIX}

#
# For all:
#
resources: resources_${COMPONENT} ${MERGEDMSGS} resources_mkdir
        ${CP} ${MERGEDMSGS} ${RESFSDIR}.Messages ${CPFLAGS}

resources_mkdir:
        ${MKDIR} ${RESFSDIR}

resources_templates:
        ${CP} LocalRes:Templates ${RESFSDIR}.Templates ${CPFLAGS}

#
# For ADFSFiler: templates + merged messages, sprites are in the Wimp pool
#
resources_ADFSFiler: resources_templates
        @@${NOP}

#
# For SCSIFiler: sprites + merged messages, templates shared with ADFS unless requested explicitly
#
resources_SCSIFiler: ${WANTTEMPLATES}
        ${CP} Resources.SCSI.${USERIF} ${RESFSDIR}.Sprites ${CPFLAGS}

#
# For SDFSFiler: sprites + merged messages, templates shared with ADFS unless requested explicitly
#
resources_SDFSFiler: ${WANTTEMPLATES}
        ${CP} Resources.SDFS.${USERIF} ${RESFSDIR}.Sprites ${CPFLAGS}

# Dynamic dependencies:
@


4.11
log
@Import of alternate sprites for Ursula and Morris4 themes
Makefile changed to pick the sprite from ${USERIF}.
New target 'ThemeDefs' for installing the copy on disc.

Version 1.07. Tagged as 'ADFSFiler-1_07'
@
text
@d25 4
a28 4
COMPONENT       ?= ADFSFiler
ROM_SOURCE       = s.ADFSFiler
RESOURCEEXTRA    = resources_${COMPONENT}
PRIVATEMSGS      = yes
d30 9
a38 1
PRIVATETEMPLATES = resources_templates
d42 2
a43 3
CUSTOMSA         = custom
CUSTOMEXP        = custom

a49 3

export:
        @@${ECHO} ${COMPONENT}: nothing to export when target is ${TARGET}
d55 19
d78 1
a78 1
        ${NOP}
d83 1
a83 2
resources_SCSIFiler: ${MERGEDMSGS} ${PRIVATETEMPLATES}
        ${CP} ${MERGEDMSGS} ${RESFSDIR}.Messages ${CPFLAGS}
d89 1
a89 2
resources_SDFSFiler: ${MERGEDMSGS} ${PRIVATETEMPLATES}
        ${CP} ${MERGEDMSGS} ${RESFSDIR}.Messages ${CPFLAGS}
a91 24
#
# Static dependencies:
#
o.${MACHINE}._Messages_.ADFSFiler:
        ${MKDIR} ${MERGEDMDIR}
        ${TOUCH} $@@
        IfThere LocalRes:Messages Then ${CP} LocalRes:Messages $@@ ${CPFLAGS}
        IfThere LocalRes:CmdHelp Then ${TOKENCHECK} LocalRes:CmdHelp
        IfThere LocalRes:CmdHelp Then ${CAT} LocalRes:CmdHelp { >> $@@ }

o.${MACHINE}._Messages_.SCSIFiler:
        ${MKDIR} ${MERGEDMDIR}
        ${TOUCH} $@@
        IfThere LocalRes:MessagesS Then ${CP} LocalRes:MessagesS $@@ ${CPFLAGS}
        IfThere LocalRes:CmdHelpS Then ${TOKENCHECK} LocalRes:CmdHelpS
        IfThere LocalRes:CmdHelpS Then ${CAT} LocalRes:CmdHelpS { >> $@@ }

o.${MACHINE}._Messages_.SDFSFiler:
        ${MKDIR} ${MERGEDMDIR}
        ${TOUCH} $@@
        IfThere LocalRes:MessagesSD Then ${CP} LocalRes:MessagesSD $@@ ${CPFLAGS}
        IfThere LocalRes:CmdHelpSD Then ${TOKENCHECK} LocalRes:CmdHelpSD
        IfThere LocalRes:CmdHelpSD Then ${CAT} LocalRes:CmdHelpSD { >> $@@ }

@


4.10
log
@Import of filer icons for removeable SCSI drives (USB) and SD cards from Richard Hallas
Translated 'SDFS' messages into German.
Dummy resources run performed, no runtime testing.

Version 1.05. Tagged as 'ADFSFiler-1_05'
@
text
@d33 15
d55 1
a55 1
        @@|
d62 1
a62 1
        ${INSTRES} -I Resources.${LOCALE},Resources.UK,Resources ${RESFSDIR} SCSI.Sprites
d69 1
a69 1
        ${INSTRES} -I Resources.${LOCALE},Resources.UK,Resources ${RESFSDIR} SDFS.Sprites
@


4.9
log
@  New build variant, and some bugfixes for the SCSI variant.
Detail:
  * Added the ability to build SDFSFiler. Interrim sprite kindly furnished
    by Steve Revill.
  * Backup menu item is now always shaded for SCSIFS (and SDFS) since these
    filing systems are not currently supported by the backup code.
  * Share menu is shaded for SCSI::5 - SCSI::7 since there are no CMOS bits
    for those drives.
  * Fixed a bug where selecting "Not shared" for SCSI::4 didn't update CMOS.
Admin:
  Tested on a beagleboard.

Version 1.04. Tagged as 'ADFSFiler-1_04'
@
text
@d25 7
a31 4
COMPONENT ?= ADFSFiler
ROM_SOURCE = s.ADFSFiler
RESOURCEEXTRA = resources_${COMPONENT}
PRIVATEMSGS = yes
d36 3
d42 4
a45 1
resources_SCSIFiler: ${MERGEDMSGS}
d47 1
a47 3
        IfThere LocalRes:^.Zip Then ${CP} LocalRes:^.Zip ${RESFSDIR}.Sprites ${CPFLAGS}
        IfThere LocalRes:^.Zip11 Then ${CP} LocalRes:^.Zip11 ${RESFSDIR}.Sprites11 ${CPFLAGS}
        IfThere LocalRes:^.Zip22 Then ${CP} LocalRes:^.Zip22 ${RESFSDIR}.Sprites22 ${CPFLAGS}
d49 6
a54 7
ifeq (${SCSITEMPLATES},yes)
resources_SCSIFiler: resources_templates
endif

resources_SDFSFiler: ${MERGEDMSGS}
	${CP} ${MERGEDMSGS} ${RESFSDIR}.Messages ${CPFLAGS}
	${INSTRES} -I Resources.${LOCALE},Resources.UK,Resources ${RESFSDIR} SDFS.Sprites [SDFS.Sprites11] [SDFS.Sprites22] Templates
d56 3
@


4.8
log
@Modify ADFSFiler/SCSIFiler sources so that SCSIFiler is no longer dependent on ADFSFiler's resources and resource path variable
Detail:
  s/ADFSFiler - Instead of blindly loading its templates from ADFSFiler:Templates, SCSIFiler now tries two locations - SCSFiler:Templates and ADFSFiler:Templates
  Makefile - By specifying the 'SCSITEMPLATES=yes' option, the shared templates file will now be placed in SCSIFiler's resources instead of just ADFSFiler's.
  Together these changes allow ADFS-less builds (e.g. OMAP) to avoid including the ADFSFiler module in their ROM, thus saving a bit of extra space and avoiding any issues caused by ADFSFiler not behaving sensibly when the ADFS module isn't present
Admin:
  Tested on rev C2 beagleboard.


Version 1.00. Tagged as 'ADFSFiler-1_00'
@
text
@d46 4
d64 7
@


4.7
log
@        Amended Makefile to include sprites required for SCSIFiler ROM build
Detail:
Admin:  castle added IP


Version 0.98. Tagged as 'ADFSFiler-0_98'
@
text
@d42 4
@


4.6
log
@Resources phase now works properly again, for both ADFSFiler and SCSIFiler.
Now hourglasses round the [AD|SCSI]FS_DescribeDisc that causes the initial
mount of a new disc.

Version 0.97. Tagged as 'ADFSFiler-0_97'
@
text
@d38 3
@


4.5
log
@  Merged in SCSIFiler.
Detail:
  SCSIFiler was obviously adapted from ADFSFiler sources, so the obvious
  approach to getting an up-to-date SCSIFiler is to make it a build variant
  of ADFSFiler. Run amu with
    COMPONENT=SCSIFiler ASFLAGS="-PD \"SCSI SETL {TRUE}\""
  to build SCSIFiler.
Admin:
  Overhauled versioning because SCSIFiler is already somewhat ahead of
  ADFSFiler in version numbers, and we don't want to bump ADFSFiler's version
  up too much jusr because of this. They will automatically remain a fixed
  distance apart.

Version 0.94. Tagged as 'ADFSFiler-0_94'
@
text
@d27 1
a27 3
RESOURCEEXTRAADFSFiler = resources_templates
RESOURCEEXTRASCSIFiler =
RESOURCEEXTRA = RESOURCEEXTRA${COMPONENT}
d32 6
@


4.4
log
@Fix from Kevin for the verifying of "BigDiscs",erm,so they actually
work.
Fix for problem when the disc is so knackered that the transition
between formatting -> verifying failed,used to free the "fm_" block
which on return to the polling routine lead to trying to read a bum
area of memory.

Version 0.93. Tagged as 'ADFSFiler-0_93'
@
text
@d25 6
a30 2
COMPONENT = ADFSFiler
RESOURCEEXTRA = resources_templates
d35 13
a47 41
# Dynamic dependencies:o.Tungsten.ADFSFiler: s.ADFSFiler
o.Tungsten.ADFSFiler: Hdr:ListOpts
o.Tungsten.ADFSFiler: Hdr:Macros
o.Tungsten.ADFSFiler: Hdr:System
o.Tungsten.ADFSFiler: Hdr:SWIs
o.Tungsten.ADFSFiler: Hdr:CPU.Generic26
o.Tungsten.ADFSFiler: Hdr:Machine.<Machine>
o.Tungsten.ADFSFiler: Hdr:Machine.Machine
o.Tungsten.ADFSFiler: Hdr:CPU.Generic32
o.Tungsten.ADFSFiler: Hdr:IO.GenericIO
o.Tungsten.ADFSFiler: Hdr:RISCOS
o.Tungsten.ADFSFiler: Hdr:ModHand
o.Tungsten.ADFSFiler: Hdr:Machine.<Machine>
o.Tungsten.ADFSFiler: Hdr:Machine.Machine
o.Tungsten.ADFSFiler: Hdr:CMOS
o.Tungsten.ADFSFiler: Hdr:FSNumbers
o.Tungsten.ADFSFiler: Hdr:HighFSI
o.Tungsten.ADFSFiler: Hdr:NewErrors
o.Tungsten.ADFSFiler: Hdr:Wimp
o.Tungsten.ADFSFiler: Hdr:WimpSpace
o.Tungsten.ADFSFiler: Hdr:Messages
o.Tungsten.ADFSFiler: Hdr:Sprite
o.Tungsten.ADFSFiler: Hdr:VduExt
o.Tungsten.ADFSFiler: Hdr:Variables
o.Tungsten.ADFSFiler: Hdr:Proc
o.Tungsten.ADFSFiler: Hdr:Services
o.Tungsten.ADFSFiler: Hdr:MsgTrans
o.Tungsten.ADFSFiler: Hdr:MsgMenus
o.Tungsten.ADFSFiler: Hdr:ADFS
o.Tungsten.ADFSFiler: Hdr:Territory
o.Tungsten.ADFSFiler: Hdr:FileCore
o.Tungsten.ADFSFiler: Hdr:MultiFS
o.Tungsten.ADFSFiler: Hdr:UpCall
o.Tungsten.ADFSFiler: Hdr:ResourceFS
o.Tungsten.ADFSFiler: Hdr:ShareD
o.Tungsten.ADFSFiler: Hdr:ExtraLong
o.Tungsten.ADFSFiler: Version
o.Tungsten.ADFSFiler: VersionASM
o.Tungsten.ADFSFiler: Hdr:NdrDebug
o.Tungsten.ADFSFiler: s.Format
o.Tungsten.ADFSFiler: s.Backup
@


4.3
log
@32 bit flag added
Fix for a pair of SWINE which caused verify to complain of "disc drive
not known" at every 512 Mbyte boundary.

Version 0.91. Tagged as 'ADFSFiler-0_91'
@
text
@d31 43
a73 1
# Dynamic dependencies:@


4.2
log
@Ursula branch merged. Changed to use srccommit.

Version 0.89. Tagged as 'ADFSFiler-0_89'
@
text
@a24 14
#
# Generic options:
#
MKDIR   = cdir
AS      = aasm
CP      = copy
RM      = remove
CCFLAGS = -c -depend !Depend -IC:
ASFLAGS = -depend !Depend -Stamp -quit -module -To $@@ -From
CPFLAGS = ~cfr~v

#
# Program specific options:
#
d26 1
a26 25
SOURCE    = s.ADFSFiler
TARGET    = rm.ADFSFiler

#
# Generic rules:
#
rom: ${TARGET}
        @@echo ${COMPONENT}: rom module built

export: 
        @@echo ${COMPONENT}: export complete

install_rom: ${TARGET}
        ${CP} ${TARGET} ${INSTDIR}.${COMPONENT} ${CPFLAGS}
        @@echo ${COMPONENT}: rom module installed

clean:
        ${RM} ${TARGET}
        @@echo ${COMPONENT}: cleaned

resources:
        ${MKDIR} ${RESDIR}.${COMPONENT}
        ${CP} Resources.${LOCALE}.Messages  ${RESDIR}.${COMPONENT}.Messages  ${CPFLAGS}
        ${CP} Resources.${LOCALE}.Templates ${RESDIR}.${COMPONENT}.Templates ${CPFLAGS}
        @@echo ${COMPONENT}: resource files copied
d28 2
a29 2
${TARGET}: ${SOURCE}
        ${AS} ${ASFLAGS} ${SOURCE}
d31 1
a31 1
# Dynamic dependencies:
@


4.1
log
@Initial revision
@
text
@a69 34
rm.ADFSFiler: Hdr:ListOpts
rm.ADFSFiler: Hdr:Macros
rm.ADFSFiler: Hdr:System
rm.ADFSFiler: Hdr:SWIs
rm.ADFSFiler: Hdr:CPU.Generic26
rm.ADFSFiler: Hdr:IO.GenericIO
rm.ADFSFiler: Hdr:RISCOS
rm.ADFSFiler: Hdr:ModHand
rm.ADFSFiler: Hdr:CMOS
rm.ADFSFiler: Hdr:FSNumbers
rm.ADFSFiler: Hdr:HighFSI
rm.ADFSFiler: Hdr:NewErrors
rm.ADFSFiler: Hdr:Wimp
rm.ADFSFiler: Hdr:WimpSpace
rm.ADFSFiler: Hdr:Messages
rm.ADFSFiler: Hdr:Sprite
rm.ADFSFiler: Hdr:VduExt
rm.ADFSFiler: Hdr:Variables
rm.ADFSFiler: Hdr:Proc
rm.ADFSFiler: Hdr:Services
rm.ADFSFiler: Hdr:MsgTrans
rm.ADFSFiler: Hdr:MsgMenus
rm.ADFSFiler: Hdr:ADFS
rm.ADFSFiler: Hdr:Territory
rm.ADFSFiler: Hdr:FileCore
rm.ADFSFiler: Hdr:MultiFS
rm.ADFSFiler: Hdr:UpCall
rm.ADFSFiler: Hdr:ResourceFS
rm.ADFSFiler: Hdr:ShareD
rm.ADFSFiler: Hdr:ExtraLong
rm.ADFSFiler: Version
rm.ADFSFiler: Hdr:NdrDebug
rm.ADFSFiler: s.Format
rm.ADFSFiler: s.Backup
@


4.1.4.1
log
@Removed dynamic dependancies from Makefiles and removed all reference to Prefix
@
text
@d70 34
@


4.1.7.1
log
@NCOS 1.06 Imported from Zip drive
@
text
@@


4.1.5.1
log
@Import from SrcFiler
@
text
@@


4.1.3.1
log
@Import from cleaned 370 CD
@
text
@@


4.1.1.1
log
@Import from cleaned 360 CD
@
text
@@
