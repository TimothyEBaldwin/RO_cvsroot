head	4.8;
access;
symbols
	DOSFS-1_14:4.8
	DOSFS-1_13:4.8
	DOSFS-1_12:4.8
	DOSFS-1_11:4.8
	DOSFS-1_10:4.8
	DOSFS-1_09:4.8
	DOSFS-1_08:4.8
	DOSFS-1_07:4.8
	DOSFS-1_06:4.8
	DOSFS-1_05:4.8
	DOSFS-1_04:4.8
	DOSFS-1_03:4.7
	DOSFS-1_02:4.7
	DOSFS-1_01:4.7
	DOSFS-1_00:4.7
	DOSFS-0_99:4.6
	DOSFS-0_98:4.6
	DOSFS-0_97:4.6
	DOSFS-0_96:4.5
	DOSFS-0_95:4.5
	DOSFS-0_94:4.5
	DOSFS-0_93:4.5
	DOSFS-0_92:4.5
	DOSFS-0_91:4.5
	DOSFS-0_90:4.5
	DOSFS-0_89:4.5
	DOSFS-0_88:4.5
	DOSFS-0_87:4.5
	DOSFS-0_86:4.5
	DOSFS-0_85:4.5
	DOSFS-0_84:4.5
	DOSFS-0_83:4.5
	DOSFS-0_82:4.5
	DOSFS-0_81:4.5
	DOSFS-0_80:4.5
	DOSFS-0_79:4.5
	RO_5_07:4.5
	DOSFS-0_78:4.5
	DOSFS-0_77:4.5
	DOSFS-0_76:4.5
	DOSFS-0_75:4.5
	DOSFS-0_74:4.5
	DOSFS-0_73:4.5
	DOSFS-0_72:4.4
	DOSFS-0_71:4.4
	DOSFS-0_70:4.4
	DOSFS-0_69:4.4
	DOSFS-0_68:4.4
	DOSFS-0_67:4.4
	DOSFS-0_66:4.4
	DOSFS-0_65:4.4
	dellis_autobuild_BaseSW:4.3
	sbrodie_sedwards_16Mar2000:4.3
	dcotton_autobuild_BaseSW:4.4
	DOSFS-0_64:4.3
	mstphens_UrsulaRiscPCBuild_20Nov98:4.2
	Ursula_RiscPC:4.2.0.8
	nicke_DOSFS_0_63:4.1.7.1
	rthornb_UrsulaBuild-19Aug1998:4.2
	UrsulaBuild_FinalSoftload:4.2
	rthornb_UrsulaBuild-12Aug1998:4.2
	aglover_UrsulaBuild-05Aug1998:4.2
	rthornb_UrsulaBuild-29Jul1998:4.2
	rthornb_UrsulaBuild-22Jul1998:4.2
	hsimons_BOCA-1_2-Release:4.1.7.1
	rthornb_UrsulaBuild-15Jul1998:4.2
	rthornb_UrsulaBuild-07Jul1998:4.2
	rthornb_UrsulaBuild-17Jun1998:4.2
	rthornb_UrsulaBuild-03Jun1998:4.2
	rthornb_UrsulaBuild-27May1998:4.2
	rthornb_UrsulaBuild-21May1998:4.2
	rthornb_UrsulaBuild_01May1998:4.2
	Spinner_RCA116:4.1.7.1
	Spinner_B20_2:4.1.7.1
	Spinner_19_3:4.1.7.1
	Spinner_B18:4.1.7.1
	Spinner_B17:4.1.7.1
	Spinner_B15:4.1.7.1
	Spinner_B14:4.1.7.1
	Spinner_B13:4.1.7.1
	Spinner_B12:4.1.7.1
	Spinner_B10:4.1.7.1
	Daytona:4.2.0.6
	Daytona_bp:4.2
	Ursula:4.2.0.2
	Ursula_bp:4.2
	Spinner_B7:4.1.7.1
	RO_3_71:4.1.3.1
	ARTtmp_merge:4.1.7.1
	Spin_3Apr97:4.1.7.1
	RCA_bp:4.2
	ARTtmp:4.1.7.1.0.2
	RCA:4.2.0.4
	Spin_merge:4.1.7.1
	MergeFiles:4.1.3.1
	RO_3_70:4.1.3.1
	NC_1_06:4.1.7.1
	Spinner:4.1.7
	Spin_xx:4.1.5
	NC_xx:4.1.5.1
	RO_3_60:4.1.1.1
	StrongARM:4.1.3
	Black:4.1.1;
locks; strict;
comment	@# @;


4.8
date	2014.05.31.17.21.05;	author rsprowson;	state Exp;
branches;
next	4.7;
commitid	7CKbqkXT93CimICx;

4.7
date	2013.01.13.18.55.04;	author rsprowson;	state Exp;
branches;
next	4.6;
commitid	3lYJMhP8ONWX25Aw;

4.6
date	2012.12.07.14.26.00;	author rsprowson;	state Exp;
branches;
next	4.5;
commitid	vz81mkusjqgpKivw;

4.5
date	2003.03.06.17.11.06;	author rsprowson;	state Exp;
branches;
next	4.4;

4.4
date	2001.08.08.14.56.40;	author kbracey;	state Exp;
branches;
next	4.3;

4.3
date	98.11.25.12.52.53;	author kbracey;	state Exp;
branches;
next	4.2;

4.2
date	97.01.14.17.14.14;	author nturton;	state Exp;
branches;
next	4.1;

4.1
date	96.11.05.09.33.03;	author nturton;	state Exp;
branches
	4.1.1.1
	4.1.3.1
	4.1.5.1
	4.1.7.1;
next	;

4.1.1.1
date	96.11.05.09.33.03;	author nturton;	state Exp;
branches;
next	;

4.1.3.1
date	96.11.06.00.54.54;	author nturton;	state Exp;
branches;
next	;

4.1.5.1
date	96.11.21.12.37.37;	author nturton;	state Exp;
branches;
next	;

4.1.7.1
date	96.11.29.20.34.07;	author nturton;	state Exp;
branches;
next	;


desc
@@


4.8
log
@Don't subscribe to service calls you do nothing with
0x42 and 0x68 removed from service call table and service call handler.

Version 1.04. Tagged as 'DOSFS-1_04'
@
text
@; Copyright 1996 Acorn Computers Ltd
;
; Licensed under the Apache License, Version 2.0 (the "License");
; you may not use this file except in compliance with the License.
; You may obtain a copy of the License at
;
;     http://www.apache.org/licenses/LICENSE-2.0
;
; Unless required by applicable law or agreed to in writing, software
; distributed under the License is distributed on an "AS IS" BASIS,
; WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
; See the License for the specific language governing permissions and
; limitations under the License.
;
;> cmhg.DOSFShdr
; ---------------------------------------------------------------------------
; This is the definition for the DOSFS (RISC OS MultiFS C Module)
; ---------------------------------------------------------------------------
; The "swi-chunk-base-number" should be updated to the correct value
; ---------------------------------------------------------------------------

#include "VersionNum"

help-string:  DOSFS Module_MajorVersion_CMHG Module_MinorVersion_CMHG
title-string: DOSFS
date-string:  Module_Date_CMHG
#ifdef ROM
library-initialisation-code: _dosfs_initialisemodule
service-call-handler:  fs_service 0x11 0x12 0x27 0x40 0x5C      0x69 0x6A 0x6B 0x6C
#else
service-call-handler:  fs_service 0x11 0x12 0x27 0x40 0x5C 0x60 0x69 0x6A 0x6B 0x6C
#endif
initialisation-code:   init_fs
finalisation-code:     shutdown_fs
swi-chunk-base-number: 0x44B00
swi-handler-code:      fs_swi
swi-decoding-table:    DOSFS DiscFormat LayoutStructure
international-help-file: "Resources:$.Resources.DOSFS.Messages"
command-keyword-table: fs_commands
; DOSMap                -- MSDOS extension to RISC OS filetype mapping
  DOSMap(min-args:0,max-args:2,gstrans-map:0xFF,international:,
         help-text:"HDOSMAP",
         invalid-syntax:"SDOSMAP"
  ),

; CopyBoot              -- Copy boot block between floppies
  CopyBoot(min-args:2,max-args:2,gstrans-map:0xFF,international:,
           help-text:"HDOSCPB",
           invalid-syntax:"SDOSCPB"
  )

; ---------------------------------------------------------------------------
@


4.7
log
@Allow RAM builds with messages in, fix for saving to images > 2G
RAM build include messages.
Removed atexit() handler, in favour of finalisation-code option in CMHG file.
Changed cluster rounding in saveFILE() to deal with extents > 2G.

Version 1.00. Tagged as 'DOSFS-1_00'
@
text
@d29 1
a29 1
service-call-handler:  fs_service 0x11 0x12 0x27 0x40 0x42 0x5C      0x68 0x69 0x6A 0x6B 0x6C
d31 1
a31 1
service-call-handler:  fs_service 0x11 0x12 0x27 0x40 0x42 0x5C 0x60 0x68 0x69 0x6A 0x6B 0x6C
@


4.6
log
@Makefile recreated from fragments
Replaced 'lk' register name with 'lr', now APCS is not set to -none.
Inverted the sense of the conditional in CMHG file, following the more common ROM predefine use (eg. the Toolbox).
Removed obsolete NoFAT32 obey files - the switch remains but there's little point omitting that now (since the switch actually leaves most of the code in anyway).
Tested in IOMD ROM build (export, resources, ROM phases) mounting a DOS floppy and 1GB image file.

Version 0.97. Tagged as 'DOSFS-0_97'
@
text
@d15 1
a15 1
;> m.DOSFShdr
d29 3
d34 1
a34 1
service-call-handler:  fs_service 0x11 0x12 0x27 0x40 0x42 0x5C 0x68 0x69 0x6A 0x6B 0x6C
@


4.5
log
@Assumption that TRUE was -1 in the filetype lookup removed,this was
causing filetype 0 to be overriden to FE4.
Module date string now got from VersionNum file so I don't have to keep
remembering to stamp the CMHG file.

Version 0.73. Tagged as 'DOSFS-0_73'
@
text
@d27 1
a27 1
#ifndef RAM
@


4.4
log
@Fixed to build RAM version correctly without the "Cannot be RAM loaded" check.
Modified "Cannot be RAM loaded" check to work correctly with recent versions
of CMHG - was branching through zero.

Version 0.65. Tagged as 'DOSFS-0_65'
@
text
@d24 1
a24 1
help-string: DOSFS Module_MajorVersion_CMHG Module_MinorVersion_CMHG
d26 1
d30 2
a31 2
initialisation-code: init_fs
service-call-handler: fs_service 0x11 0x12 0x27 0x40 0x42 0x5C 0x68 0x69 0x6A 0x6B 0x6C
d33 2
a34 2
swi-handler-code: fs_swi
swi-decoding-table: DOSFS DiscFormat LayoutStructure
@


4.3
log
@Changed to use srccommit.
Updated for Link 5.07 and CMHG 5.16. Fixed to not overwrite command tail.
Changed to use LocalRes$Path.
German resources imported.

Version 0.64. Tagged as 'DOSFS-0_64'
@
text
@d26 1
d28 1
@


4.2
log
@RiscOS 3.70 version taken
@
text
@d22 3
a24 1
help-string: DOSFS 0.63
@


4.1
log
@Initial revision
@
text
@d22 1
a22 1
help-string: DOSFS 0.62
@


4.1.7.1
log
@NCOS 1.06 Imported from Zip drive
@
text
@@


4.1.5.1
log
@Import from SrcFiler
@
text
@@


4.1.3.1
log
@Import from cleaned 370 CD
@
text
@d22 1
a22 1
help-string: DOSFS 0.63
@


4.1.1.1
log
@Import from cleaned 360 CD
@
text
@@
