head	4.21;
access;
symbols
	ChangeFSI-1_35:4.19
	ChangeFSI-1_34:4.18
	ChangeFSI-1_33:4.17
	ChangeFSI-1_32:4.16
	ChangeFSI-1_31:4.15
	ChangeFSI-1_30:4.14
	ChangeFSI-1_29:4.13
	ChangeFSI-1_28:4.12
	ChangeFSI-1_27:4.11
	ChangeFSI-1_26:4.10
	ChangeFSI-1_25:4.9
	ChangeFSI-1_24:4.8
	ChangeFSI-1_23:4.7
	ChangeFSI-1_22:4.6
	ChangeFSI-1_21:4.5
	ChangeFSI-1_20:4.4
	ChangeFSI-1_19:4.3
	ChangeFSI-1_18:4.2
	ChangeFSI-1_12:4.1;
locks; strict;
comment	@# @;


4.21
date	2012.10.27.10.14.27;	author rsprowson;	state dead;
branches;
next	4.20;
commitid	R4KdNe7filALF0qw;

4.20
date	2012.10.27.10.08.44;	author rsprowson;	state Exp;
branches;
next	4.19;
commitid	C96UYSpKbn6SD0qw;

4.19
date	2012.10.27.08.36.45;	author rsprowson;	state Exp;
branches;
next	4.18;
commitid	ALcyTnn03VCj80qw;

4.18
date	2012.09.25.10.01.47;	author rsprowson;	state Exp;
branches;
next	4.17;
commitid	4BjjEoy3sr2gDTlw;

4.17
date	2012.08.27.08.24.19;	author rsprowson;	state Exp;
branches;
next	4.16;
commitid	KenWVoLfq2LB1aiw;

4.16
date	2012.08.11.09.50.16;	author rsprowson;	state Exp;
branches;
next	4.15;
commitid	yJut5YGH9GSY07gw;

4.15
date	2012.01.14.23.07.06;	author srevill;	state Exp;
branches;
next	4.14;
commitid	AE6Zix19poNRacPv;

4.14
date	2010.11.06.17.21.12;	author rsprowson;	state Exp;
branches;
next	4.13;

4.13
date	2009.10.24.22.42.48;	author jlee;	state Exp;
branches;
next	4.12;

4.12
date	2009.06.07.21.17.06;	author bavison;	state Exp;
branches;
next	4.11;

4.11
date	2008.10.17.13.14.18;	author srevill;	state Exp;
branches;
next	4.10;

4.10
date	2008.10.06.15.22.21;	author srevill;	state Exp;
branches;
next	4.9;

4.9
date	2008.06.15.11.47.47;	author srevill;	state Exp;
branches;
next	4.8;

4.8
date	2007.01.22.17.06.13;	author srevill;	state Exp;
branches;
next	4.7;

4.7
date	2004.11.10.22.30.36;	author srevill;	state Exp;
branches;
next	4.6;

4.6
date	2003.06.02.10.50.22;	author rsprowson;	state Exp;
branches;
next	4.5;

4.5
date	2003.02.07.22.06.42;	author rsprowson;	state Exp;
branches;
next	4.4;

4.4
date	2003.01.20.10.21.50;	author rsprowson;	state Exp;
branches;
next	4.3;

4.3
date	2002.11.12.15.32.24;	author rsprowson;	state Exp;
branches;
next	4.2;

4.2
date	2002.11.05.19.01.53;	author rsprowson;	state Exp;
branches;
next	4.1;

4.1
date	2002.11.05.18.39.11;	author rsprowson;	state Exp;
branches;
next	;


desc
@@


4.21
log
@Removed unused VersionASM
@
text
@;
; This file is automatically maintained by srccommit, do not edit manually.
; Last processed by srccommit version: 1.1.
;
                        GBLS    Module_MajorVersion
                        GBLA    Module_Version
                        GBLS    Module_MinorVersion
                        GBLS    Module_Date
                        GBLS    Module_FullVersion
                        GBLS    Module_ApplicationDate
                        GBLS    Module_HelpVersion
                        GBLS    Module_ComponentName
                        GBLS    Module_ComponentPath
Module_MajorVersion     SETS    "1.36"
Module_Version          SETA    136
Module_MinorVersion     SETS    ""
Module_Date             SETS    "27 Oct 2012"
Module_ApplicationDate  SETS    "27-Oct-12"
Module_ComponentName    SETS    "ChangeFSI"
Module_ComponentPath    SETS    "mixed/RiscOS/Sources/Apps/ChangeFSI"
Module_FullVersion      SETS    "1.36"
Module_HelpVersion      SETS    "1.36 (27 Oct 2012)"
                        END
@


4.20
log
@Changed to use MessageTrans for messages

Version 1.36. Tagged as 'ChangeFSI-1_36'
@
text
@@


4.19
log
@Reimport sources as text to allow diffing
For earlier history look in the attic at 'ChangeFSI,ffb'.
Makefile adjusted to use StdTools where possible.

Version 1.35. Tagged as 'ChangeFSI-1_35'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "1.35"
Module_Version          SETA    135
d21 2
a22 2
Module_FullVersion      SETS    "1.35"
Module_HelpVersion      SETS    "1.35 (27 Oct 2012)"
@


4.18
log
@Update Shell code from Library-1_58
* Now does an OS_SynchroniseCodeAreas before jumping to Shell_Job (and back again)
* Removed the attempted Arthur 1.20 support - it was attempting to support this using the 'X' form of XOS_ChangeEnvironment, except that that SWI name wouldn't lookup on Arthur. Doh!

Version 1.34. Tagged as 'ChangeFSI-1_34'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "1.34"
Module_Version          SETA    134
d17 2
a18 2
Module_Date             SETS    "25 Sep 2012"
Module_ApplicationDate  SETS    "25-Sep-12"
d21 2
a22 2
Module_FullVersion      SETS    "1.34"
Module_HelpVersion      SETS    "1.34 (25 Sep 2012)"
@


4.17
log
@Fix processing of new format sprites with palettes
* Function 'newropal' was treating palette entries as &00BBGGRR when they are stored as &BBGGRR00, leading to generally wrong colours all round.
* Also, 256 entry palettes were not distinguished from 64 entry palettes, so files from Paint (which seems to prefer 64 entry ones) were generally black due to reading of the end of the palette.
* Added text to the info string stating if the input sprite contained a palette.
* Fixed template buffer overrun when filename is truncated to 12 letters (to formulate a sprite name), the template only reserved 12 letters and hence use of '$' operater in BASIC overran and messed up the border validation.
Tested with a number of 180dpi 'new' format sprites in 8bpp and 4bpp with and without palettes.

Version 1.33. Tagged as 'ChangeFSI-1_33'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "1.33"
Module_Version          SETA    133
d17 2
a18 2
Module_Date             SETS    "27 Aug 2012"
Module_ApplicationDate  SETS    "27-Aug-12"
d21 2
a22 2
Module_FullVersion      SETS    "1.33"
Module_HelpVersion      SETS    "1.33 (27 Aug 2012)"
@


4.16
log
@Minor rework to run on RISC OS 3.6 as advertised
During 32 bitting some MRS/MSRs were added, but these don't assemble with the BASIC that is implied by the RMEnsure in !Run.
Changed 25 occurrences to use a macro instead.
Removed attribution from !Run/!Boot copied to the user.
Some dead definitions removed from the makefile.

Version 1.32. Tagged as 'ChangeFSI-1_32'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "1.32"
Module_Version          SETA    132
d17 2
a18 2
Module_Date             SETS    "11 Aug 2012"
Module_ApplicationDate  SETS    "11-Aug-12"
d21 2
a22 2
Module_FullVersion      SETS    "1.32"
Module_HelpVersion      SETS    "1.32 (11 Aug 2012)"
@


4.15
log
@Replace "-wipe" with "x wipe" in makefiles to remove annoying errors.

Version 1.31. Tagged as 'ChangeFSI-1_31'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "1.31"
Module_Version          SETA    131
d17 2
a18 2
Module_Date             SETS    "14 Jan 2012"
Module_ApplicationDate  SETS    "14-Jan-12"
d21 2
a22 2
Module_FullVersion      SETS    "1.31"
Module_HelpVersion      SETS    "1.31 (14 Jan 2012)"
@


4.14
log
@Reorder evaluation of whether to use built in JPEG decode or djpeg.
Before, the candidate JPEG file was prescanned and a decision made as to whether that was too hard for CFSIjpeg to do or not. This lead to duplicated tests when (a little later on at 'WHEN 3700:') the file is prescanned anyway - plus this implictly encoded the capabilities of CFSIjpeg into the BASIC code.
Now, the CFSIjpeg binary is loaded at the first detection of a JPEG file and the scan done up front using its built in routine.
This isn't a performance penalty since the area (jpeg%) was never freed anyway so there is now no need to load it later, which has the additional benefit that it is now possible to detect CFSIjpeg missing and fall back to djpeg rather than reporting an error.
Fixed an 'end of file' error spotted in testing when djpeg fails to produce an output it does actually create a scrap file of zero length which is now checked for too.

Version 1.30. Tagged as 'ChangeFSI-1_30'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "1.30"
Module_Version          SETA    130
d17 2
a18 2
Module_Date             SETS    "06 Nov 2010"
Module_ApplicationDate  SETS    "06-Nov-10"
d21 2
a22 2
Module_FullVersion      SETS    "1.30"
Module_HelpVersion      SETS    "1.30 (06 Nov 2010)"
@


4.13
log
@Bulk import of missing !Sprites11 files

Version 1.29. Tagged as 'ChangeFSI-1_29'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "1.29"
Module_Version          SETA    129
d17 2
a18 2
Module_Date             SETS    "24 Oct 2009"
Module_ApplicationDate  SETS    "24-Oct-09"
d21 2
a22 2
Module_FullVersion      SETS    "1.29"
Module_HelpVersion      SETS    "1.29 (24 Oct 2009)"
@


4.12
log
@  ChangeFSI changes
Detail:
  Main ChangeFSI program changed to assemble new instructions on ROL OS
  versions without "No such mnemonic" error. Also changed to handle
  _Version: token in messages file.

  Added "stripdepnd Makefile" to !MkClean.

  Makefile locks destination !Sprites and !Sprites22 files, because
  everything else is being locked.

  Makefile altered to use new centalised awkscript to keep version numbers
  updated. (Note that ChangeFSI has a slightly odd makefile, so this
  shouldn't be used as an example of how to modify Makefiles to use the new
  awk version script.)

  Window menu fixed to be style guide compliant.
Admin:
  Requires Library 1.32
  Tested on RiscPC RO402
Notes:
  Changes by James Lampard.

Version 1.28. Tagged as 'ChangeFSI-1_28'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "1.28"
Module_Version          SETA    128
d17 2
a18 2
Module_Date             SETS    "07 Jun 2009"
Module_ApplicationDate  SETS    "07-Jun-09"
d21 2
a22 2
Module_FullVersion      SETS    "1.28"
Module_HelpVersion      SETS    "1.28 (07 Jun 2009)"
@


4.11
log
@  Fixed a bug from earlier commit.
Detail:
  In the reformatting work, MOVEQ instructions got broken into MOVE Q which
  clearly won't work.
Admin:
  Appears to work now.

Version 1.27. Tagged as 'ChangeFSI-1_27'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "1.27"
Module_Version          SETA    127
d17 2
a18 2
Module_Date             SETS    "17 Oct 2008"
Module_ApplicationDate  SETS    "17-Oct-08"
d21 2
a22 2
Module_FullVersion      SETS    "1.27"
Module_HelpVersion      SETS    "1.27 (17 Oct 2008)"
@


4.10
log
@  Merged change from Castle source repository.
Detail:
  Increased maximum image size from around 19 MiB to 64 MiB to avoid data
  aborts. This won't fix the problem but it does move it away a bit.
Detail:
  Untested - but presumably worked for Castle.

Version 1.26. Tagged as 'ChangeFSI-1_26'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "1.26"
Module_Version          SETA    126
d17 2
a18 2
Module_Date             SETS    "06 Oct 2008"
Module_ApplicationDate  SETS    "06-Oct-08"
d21 2
a22 2
Module_FullVersion      SETS    "1.26"
Module_HelpVersion      SETS    "1.26 (06 Oct 2008)"
@


4.9
log
@  Source code reformat and tweak to sprite output.
Detail:
- Reformatted the main source code so that it can be read by humans.

- Verified that it builds something which is functionally identical.

- Modified default max DA size to be a bit more useful for modern images.

- Changed sprite file output to name the sprite after the leafname of the source
  image (e.g. if source is "photo/jpg" the sprite in the sprite file is "photo").
  This is arguably much more useful than calling it after the processing options.
Admin:
  Untested but crunched BASIC compared by eye with previous revision.

Version 1.25. Tagged as 'ChangeFSI-1_25'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "1.25"
Module_Version          SETA    125
d17 2
a18 2
Module_Date             SETS    "15 Jun 2008"
Module_ApplicationDate  SETS    "15-Jun-08"
d21 2
a22 2
Module_FullVersion      SETS    "1.25"
Module_HelpVersion      SETS    "1.25 (15 Jun 2008)"
@


4.8
log
@  Minor tweaks to build and install correctly.
Detail:
  Some changes were required in order for this component to build and install
  correctly with the newer cc.
Admin:
  Tested in Iyonix 'Disc' build using ROOL 'BuildEnv' build environment

Version 1.24. Tagged as 'ChangeFSI-1_24'
@
text
@d3 1
a3 1
; Last processed by srccommit version: 1.2.
d14 2
a15 2
Module_MajorVersion     SETS    "1.24"
Module_Version          SETA    124
d17 2
a18 2
Module_Date             SETS    "22 Jan 2007"
Module_ApplicationDate  SETS    "22-Jan-07"
d20 3
a22 3
Module_ComponentPath    SETS    "RiscOS/Sources/Apps/ChangeFSI"
Module_FullVersion      SETS    "1.24"
Module_HelpVersion      SETS    "1.24 (22 Jan 2007)"
@


4.7
log
@  Fixed fault reported on newsgroups
Detail:
  If ChangeFSI program was used as a BASIC LIBRARY, calls to it would fail with
  "Unknown or missing variable" due to the use of spop% which isn't defined in
  library usage.

  Also fixed install rule in makefile to use "do mkdir -p" rather than "cdir".
Admin:
  Tested - seems to still work!

Version 1.23. Tagged as 'ChangeFSI-1_23'
@
text
@d3 1
a3 1
; Last processed by srccommit version: 1.68.
d14 2
a15 2
Module_MajorVersion     SETS    "1.23"
Module_Version          SETA    123
d17 2
a18 2
Module_Date             SETS    "10 Nov 2004"
Module_ApplicationDate  SETS    "10-Nov-04"
d21 2
a22 2
Module_FullVersion      SETS    "1.23"
Module_HelpVersion      SETS    "1.23 (10 Nov 2004)"
@


4.6
log
@Removed another 2 debugging SWI WriteI's missed earlier.
Choices are now read from Choices: not <Choices$Write>
Changed FNChangeFSI so that -1 is used to determine where the workspace
comes from,rather than taking any -ve number.This now matches the docs.
Jiggled "output" template.

Version 1.22. Tagged as 'ChangeFSI-1_22'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "1.22"
Module_Version          SETA    122
d17 2
a18 2
Module_Date             SETS    "02 Jun 2003"
Module_ApplicationDate  SETS    "02-Jun-03"
d21 2
a22 2
Module_FullVersion      SETS    "1.22"
Module_HelpVersion      SETS    "1.22 (02 Jun 2003)"
@


4.5
log
@Fixes for work done by the keyboard fairy.
Outputting sprites to 256 greyscales gave an unknown or missing variable
due to ms$ instead of m$ in an IF statement.
A comment added to table lookup mode contained colons inside assembler
brackets.
Finally figured out why the bottom corner of the screen sometimes gets
messed up,there was a SWIEQ 256+ASC"A" festering in the B&W lookup table
code (been in for years!).

Version 1.21. Tagged as 'ChangeFSI-1_21'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "1.21"
Module_Version          SETA    121
d17 2
a18 2
Module_Date             SETS    "07 Feb 2003"
Module_ApplicationDate  SETS    "07-Feb-03"
d21 2
a22 2
Module_FullVersion      SETS    "1.21"
Module_HelpVersion      SETS    "1.21 (07 Feb 2003)"
@


4.4
log
@Added btpc 4.1 support,though the detection in the main program has
always been there the binary vanished sometime round 1995.
Added abridged info on BTPC to the appropriate docs,plus docs updates
to reflect interesting information which seems to have been
progressively removed with time.
Yucky sprites added,Sprites23 deleted.
The output window now remembers where it was last opened instead of
always jumping to the middle of the screen.
You no longer need to be in a specific screen depth for any operation,
before (particularly using special mode "r") it needed to read the
palette in a particular mode - now if it realises it cannot it will look
for a default palette in its Palettes directory and only then give an
error.
Reinstated 256 colour special mode "t",this has always been missing the
4096 colour lookup table and most of the support for it was removed in
about 1992 though the assembler remained leading to a "No such variable"
error when trying to use it.GenCFSIict produces the table.

Version 1.20. Tagged as 'ChangeFSI-1_20'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "1.20"
Module_Version          SETA    120
d17 2
a18 2
Module_Date             SETS    "20 Jan 2003"
Module_ApplicationDate  SETS    "20-Jan-03"
d21 2
a22 2
Module_FullVersion      SETS    "1.20"
Module_HelpVersion      SETS    "1.20 (20 Jan 2003)"
@


4.3
log
@Nuked a BICEQS in the shell code that got missed.
Choices now stored in choices$write not locally.
pcdtemp spool file now put in wimp$scrapdir not locally.
Removed binary stored hpcdtoppm (now built from sources).
Added tests directory which contain some useful test images for Changefsi
Port of newer "hpcdtoppm",the bits changed from the original are all
demarked by "RISCOS_TWEAK".

Version 1.19. Tagged as 'ChangeFSI-1_19'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "1.19"
Module_Version          SETA    119
d17 2
a18 2
Module_Date             SETS    "12 Nov 2002"
Module_ApplicationDate  SETS    "12-Nov-02"
d21 2
a22 2
Module_FullVersion      SETS    "1.19"
Module_HelpVersion      SETS    "1.19 (12 Nov 2002)"
@


4.2
log
@Lost the sources to 1.15 somewhere,and RISC OS 4 came with 1.17.
Output template reworked
Zoom template swiped from !Paint
Infobox and saveas box swiped from !Edit
Improved error messages for unsupported formats
Hyphenated the date (also now derived at build time from the VersionNum
file)
Assembler stamped on to remove 26 bit code (uses MRS and MSR,hence ARM6
or later,but the RMEnsure of Utility module catches this).
Rejigged a few ADRs which were no longer in range due to the above.
Added ChangeFSI alias to !Boot file,it's always been documented as being
available...
Took 6b of the IJG jpeg code,and updated the JPEGinfo file accordingly
3dtemplate renamed as Template3d
Eliminated some dead documentation which never went on the disc image
anyway
Bug fix for CLI use when output is an S16 sprite,no default x dpi or y dpi
was assumed leading to an infinitely narrow infinitely tall sprite.
REM'd out the sketchy support for S24,a mythical 24 bpp packed sprite and
tweaked the docs to read S32 which you can actually generate!
Now handles progressive JPEGs (merged from a patched CFSI from RComp's
webpages).
Adds TechnoI video digitiser reading (untested)
Adds P8 reading (untested)
Merged the useful bits from RISC OS Ltd's sources,which seem to be
pretty unchanged from V1.15.
 * Missing hpcdtoppm sources,so no 32 bit there
 * Missing btpc sources,so no 32 bit there

Version 1.18. Tagged as 'ChangeFSI-1_18'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "1.18"
Module_Version          SETA    118
d17 2
a18 2
Module_Date             SETS    "05 Nov 2002"
Module_ApplicationDate  SETS    "05-Nov-02"
d21 2
a22 2
Module_FullVersion      SETS    "1.18"
Module_HelpVersion      SETS    "1.18 (05 Nov 2002)"
@


4.1
log
@Added VersionASM and VersionNum
@
text
@d3 1
d10 1
a10 2
                        GBLS    Module_ApplicationDate2
                        GBLS    Module_ApplicationDate4
d14 2
a15 2
Module_MajorVersion     SETS    "1.12"
Module_Version          SETA    112
d17 2
a18 3
Module_Date             SETS    "13 Mar 1995"
Module_ApplicationDate2 SETS    "13-Mar-95"
Module_ApplicationDate4 SETS    "13-Mar-1995"
d21 2
a22 2
Module_FullVersion      SETS    "1.12"
Module_HelpVersion      SETS    "1.12 (13 Mar 1995)"
@

