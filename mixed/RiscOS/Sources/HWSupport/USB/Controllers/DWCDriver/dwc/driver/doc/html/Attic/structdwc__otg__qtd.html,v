head	1.2;
access;
symbols
	DWCDriver-0_08:1.1
	DWCDriver-0_07:1.1
	DWCDriver-0_06:1.1
	DWCDriver-0_05:1.1
	DWCDriver-0_04:1.1
	DWCDriver-0_03:1.1
	DWCDriver-0_02:1.1
	DWCDriver-0_01:1.1;
locks; strict;
comment	@# @;


1.2
date	2012.09.17.16.34.15;	author jlee;	state dead;
branches;
next	1.1;
commitid	DXVFy2WJjyak3Ukw;

1.1
date	2012.06.03.15.13.55;	author jlee;	state Exp;
branches;
next	;
commitid	ZZ9X1FvMWAU11h7w;


desc
@@


1.2
log
@Update to version 3.00 of DWC_otg
Detail:
  This big batch of changes brings us in line with rev 70428950df of the Raspberry Pi Linux github.
  Briefly:
  * Deleted HTML docs as they're a waste of space
  * Dropped the SOF fix (which we never used anyway)
  * Dropped our implementation of the microframe scheduling patch, in favour of their implementation
  * Updated to version 3.00 of the DWC sources. Hard to tell what useful changes this brings, due to API tweaks resulting in pretty much every file being littered with changes.
Admin:
  Tested on Raspberry Pi with high processor vectors
  This new version seems like it might be a bit more sensitive to insufficient power supplies. Beware!


Version 0.09. Tagged as 'DWCDriver-0_09'
@
text
@<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>DesignWare USB 2.0 OTG Controller (DWC_otg) Device Driver: dwc_otg_qtd Struct Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li id="current"><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li><a href="functions.html"><span>Data&nbsp;Fields</span></a></li>
  </ul></div>
<h1>dwc_otg_qtd Struct Reference</h1><!-- doxytag: class="dwc_otg_qtd" -->A Queue Transfer Descriptor (QTD) holds the state of a bulk, control, interrupt, or isochronous transfer.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="dwc__otg__hcd_8h-source.html">dwc_otg_hcd.h</a>&gt;</code>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="aac18e92835ac0678a83d023660f1560"></a><!-- doxytag: member="dwc_otg_qtd::DWC_CIRCLEQ_ENTRY" ref="aac18e92835ac0678a83d023660f1560" args="(dwc_otg_qtd) qtd_list_entry" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdwc__otg__qtd.html#aac18e92835ac0678a83d023660f1560">DWC_CIRCLEQ_ENTRY</a> (<a class="el" href="structdwc__otg__qtd.html">dwc_otg_qtd</a>) qtd_list_entry</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This list of QTDs. <br></td></tr>
<tr><td colspan="2"><br><h2>Data Fields</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdwc__otg__qtd.html#e912f256e01165b573c26262247a5eff">data_toggle</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Determines the PID of the next data packet for the data phase of control transfers.  <a href="#e912f256e01165b573c26262247a5eff"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="5189ec9c992974d20477481eaf96d0bb"></a><!-- doxytag: member="dwc_otg_qtd::control_phase" ref="5189ec9c992974d20477481eaf96d0bb" args="" -->
<a class="el" href="dwc__otg__hcd_8h.html#be7c5653ee5e9d33855d2513f31b56a5">dwc_otg_control_phase_e</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdwc__otg__qtd.html#5189ec9c992974d20477481eaf96d0bb">control_phase</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Current phase for control transfers (Setup, Data, or Status). <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="6355e968a4d36edce3e22c89ac7b5001"></a><!-- doxytag: member="dwc_otg_qtd::complete_split" ref="6355e968a4d36edce3e22c89ac7b5001" args="" -->
uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdwc__otg__qtd.html#6355e968a4d36edce3e22c89ac7b5001">complete_split</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Keep track of the current split type for FS/LS endpoints on a HS Hub. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="badffe465e850133c62c8f7e539f3fca"></a><!-- doxytag: member="dwc_otg_qtd::ssplit_out_xfer_count" ref="badffe465e850133c62c8f7e539f3fca" args="" -->
uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdwc__otg__qtd.html#badffe465e850133c62c8f7e539f3fca">ssplit_out_xfer_count</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">How many bytes transferred during SSPLIT OUT. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="18eeb9c647049aec468bf9a7861c873f"></a><!-- doxytag: member="dwc_otg_qtd::error_count" ref="18eeb9c647049aec468bf9a7861c873f" args="" -->
uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdwc__otg__qtd.html#18eeb9c647049aec468bf9a7861c873f">error_count</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Holds the number of bus errors that have occurred for a transaction within this transfer. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">uint16_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdwc__otg__qtd.html#c67d5f885976d0698f20d113d32b4b30">isoc_frame_index</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Index of the next frame descriptor for an isochronous transfer.  <a href="#c67d5f885976d0698f20d113d32b4b30"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ab224d64d72f2ef4f10e722ebcfa29a6"></a><!-- doxytag: member="dwc_otg_qtd::isoc_split_pos" ref="ab224d64d72f2ef4f10e722ebcfa29a6" args="" -->
uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdwc__otg__qtd.html#ab224d64d72f2ef4f10e722ebcfa29a6">isoc_split_pos</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Position of the ISOC split on full/low speed. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="839371940a7e34365e2272f3214b7e34"></a><!-- doxytag: member="dwc_otg_qtd::isoc_split_offset" ref="839371940a7e34365e2272f3214b7e34" args="" -->
uint16_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdwc__otg__qtd.html#839371940a7e34365e2272f3214b7e34">isoc_split_offset</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Position of the ISOC split in the buffer for the current frame. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="7e7767808e8eb9d71de0db00f57553f9"></a><!-- doxytag: member="dwc_otg_qtd::urb" ref="7e7767808e8eb9d71de0db00f57553f9" args="" -->
<a class="el" href="structdwc__otg__hcd__urb.html">dwc_otg_hcd_urb</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdwc__otg__qtd.html#7e7767808e8eb9d71de0db00f57553f9">urb</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">URB for this transfer. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f80ddcfb6edbe83a3991dd67c93a47e4"></a><!-- doxytag: member="dwc_otg_qtd::qh" ref="f80ddcfb6edbe83a3991dd67c93a47e4" args="" -->
<a class="el" href="structdwc__otg__qh.html">dwc_otg_qh</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdwc__otg__qtd.html#f80ddcfb6edbe83a3991dd67c93a47e4">qh</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c1d73f1d48eeabbdc198ad28c0882bc1"></a><!-- doxytag: member="dwc_otg_qtd::in_process" ref="c1d73f1d48eeabbdc198ad28c0882bc1" args="" -->
uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdwc__otg__qtd.html#c1d73f1d48eeabbdc198ad28c0882bc1">in_process</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Indicates if this QTD is currently processed by HW. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ef3021e617cf1f448bd23b1f7ab3859b"></a><!-- doxytag: member="dwc_otg_qtd::n_desc" ref="ef3021e617cf1f448bd23b1f7ab3859b" args="" -->
uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdwc__otg__qtd.html#ef3021e617cf1f448bd23b1f7ab3859b">n_desc</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of DMA descriptors for this QTD. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">uint16_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdwc__otg__qtd.html#c296d49e3615e35c06b83e7febc31943">isoc_frame_index_last</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Last activated frame(packet) index.  <a href="#c296d49e3615e35c06b83e7febc31943"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
A Queue Transfer Descriptor (QTD) holds the state of a bulk, control, interrupt, or isochronous transfer. 
<p>
A single QTD is created for each URB (of one of these types) submitted to the HCD. The transfer associated with a QTD may require one or multiple transactions.<p>
A QTD is linked to a Queue Head, which is entered in either the non-periodic or periodic schedule for execution. When a QTD is chosen for execution, some or all of its transactions may be executed. After execution, the state of the QTD is updated. The QTD may be retired if all its transactions are complete or if an error occurred. Otherwise, it remains in the schedule so more transactions can be executed later. 
<p>

<p>
Definition at line <a class="el" href="dwc__otg__hcd_8h-source.html#l00191">191</a> of file <a class="el" href="dwc__otg__hcd_8h-source.html">dwc_otg_hcd.h</a>.<hr><h2>Field Documentation</h2>
<a class="anchor" name="e912f256e01165b573c26262247a5eff"></a><!-- doxytag: member="dwc_otg_qtd::data_toggle" ref="e912f256e01165b573c26262247a5eff" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t <a class="el" href="structdwc__otg__qtd.html#e912f256e01165b573c26262247a5eff">dwc_otg_qtd::data_toggle</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Determines the PID of the next data packet for the data phase of control transfers. 
<p>
Ignored for other transfer types.<br>
 One of the following values:<ul>
<li>DWC_OTG_HC_PID_DATA0</li><li>DWC_OTG_HC_PID_DATA1 </li></ul>

<p>
Definition at line <a class="el" href="dwc__otg__hcd_8h-source.html#l00199">199</a> of file <a class="el" href="dwc__otg__hcd_8h-source.html">dwc_otg_hcd.h</a>.
</div>
</div><p>
<a class="anchor" name="c67d5f885976d0698f20d113d32b4b30"></a><!-- doxytag: member="dwc_otg_qtd::isoc_frame_index" ref="c67d5f885976d0698f20d113d32b4b30" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t <a class="el" href="structdwc__otg__qtd.html#c67d5f885976d0698f20d113d32b4b30">dwc_otg_qtd::isoc_frame_index</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Index of the next frame descriptor for an isochronous transfer. 
<p>
A frame descriptor describes the buffer position and length of the data to be transferred in the next scheduled (micro)frame of an isochronous transfer. It also holds status for that transaction. The frame index starts at 0. 
<p>
Definition at line <a class="el" href="dwc__otg__hcd_8h-source.html#l00224">224</a> of file <a class="el" href="dwc__otg__hcd_8h-source.html">dwc_otg_hcd.h</a>.
</div>
</div><p>
<a class="anchor" name="c296d49e3615e35c06b83e7febc31943"></a><!-- doxytag: member="dwc_otg_qtd::isoc_frame_index_last" ref="c296d49e3615e35c06b83e7febc31943" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t <a class="el" href="structdwc__otg__qtd.html#c296d49e3615e35c06b83e7febc31943">dwc_otg_qtd::isoc_frame_index_last</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Last activated frame(packet) index. 
<p>
Used in Descriptor DMA mode only. 
<p>
Definition at line <a class="el" href="dwc__otg__hcd_8h-source.html#l00250">250</a> of file <a class="el" href="dwc__otg__hcd_8h-source.html">dwc_otg_hcd.h</a>.
</div>
</div><p>
<hr>The documentation for this struct was generated from the following file:<ul>
<li><a class="el" href="dwc__otg__hcd_8h-source.html">dwc_otg_hcd.h</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Tue May 5 02:22:49 2009 for DesignWare USB 2.0 OTG Controller (DWC_otg) Device Driver by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
@


1.1
log
@Add initial version of DWCDriver - USB driver for Synopsys DWC OTG controllers
Detail:
  A fairly simple wrapper for Synopsys's open source "DWC_otg" Linux driver, based around a GPL-free version of the DWC_otg 2.90a sources received from the Raspberry Pi foundation.
  Instead of interfacing with the Linux USB stack a new host interface layer has been implemented to allow it to talk to the standard BSD-derived RISC OS stack.
  RTSupport is used to provide the threading functionality that the DWC driver relies upon.
  Interesting files:
  - c/cmodule, h/cmodule - Main module frontend
  - c/dwc_common_riscos, h/dwc_common_riscos - Implementation of the OS support layer required by the DWC driver
  - c/dwc_otg_riscos, h/dwc_otg_riscos - Core code for the BSD driver implementation, driver init/shutdown, and for handling calls from the DWC host driver to us
  - c/port - Some support functions required by BSD-style code inherited from the other USB drivers
  - c/softc_device - Code to handle requests from the BSD layer to attached USB devices
  - c/softc_root - Code to handle requests from the BSD layer to the controller root hub
  - dwc/doc/* - Original Synopsys release notes & user guide pdfs
  - dwc/driver/*, dwc/dwc_common_port/* - Synopsys code and documentation. A few tweaks were required to allow it to compile under Norcroft, but otherwise it's functionally equivalent to the original sources.
Admin:
  Tested in BCM2835 ROM
  There are a few loose ends still to tidy up (search for "DWCTODO"), mainly regarding implementation of Isochronous support, but otherwise the driver seems stable enough for daily use.


Version 0.01. Tagged as 'DWCDriver-0_01'
@
text
@@

