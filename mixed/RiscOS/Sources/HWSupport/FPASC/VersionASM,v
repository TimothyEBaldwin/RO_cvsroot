head	4.31;
access;
symbols
	FPASC-4_36:4.30
	FPASC-4_35:4.29
	FPASC-4_34:4.28
	FPASC-4_33-1:4.27
	FPASC-4_33:4.27
	FPASC-4_32:4.26
	FPASC-4_31:4.25
	FPASC-4_30:4.24
	FPASC-4_29:4.23
	FPASC-4_28-2:4.22
	FPASC-4_28:4.21
	FPASC-4_27:4.20
	FPASC-4_26:4.19
	FPASC-4_25:4.18
	FPASC-4_24:4.17
	FPASC-4_23:4.16
	RO_5_07:4.15
	FPASC-4_22:4.15
	FPASC-4_21:4.14
	FPASC-4_20:4.13
	FPASC-4_19:4.12
	FPASC-4_18:4.11
	FPASC-4_17:4.10
	FPASC-4_16:4.9
	FPASC-4_15:4.8
	FPASC-4_14:4.7
	dellis_autobuild_BaseSW:4.6
	FPASC-4_13:4.6
	FPASC-4_12:4.5
	FPASC-4_10-4_3_2_2:4.3.2.2
	sbrodie_sedwards_16Mar2000:4.4
	kbracey_32bit_merge:4.3.2.1
	FPASC-4_11:4.4
	FPASC-4_10-4_3_2_1:4.3.2.1
	kbracey_32bit:4.3.0.2
	dcotton_autobuild_BaseSW:4.10
	FPASC-4_10:4.3
	FPASC-4_09:4.2;
locks; strict;
comment	@# @;


4.31
date	2018.04.12.01.01.29;	author bavison;	state Exp;
branches;
next	4.30;
commitid	g5vTCT2S9rhiy5yA;

4.30
date	2017.12.12.14.26.29;	author jlee;	state Exp;
branches;
next	4.29;
commitid	UcqjHjbUqubBTBiA;

4.29
date	2016.04.13.22.32.38;	author jlee;	state Exp;
branches;
next	4.28;
commitid	CyjAU0Wubmt38w2z;

4.28
date	2016.02.29.10.00.45;	author bavison;	state Exp;
branches;
next	4.27;
commitid	OLjIl08n38PNnNWy;

4.27
date	2015.02.02.11.37.04;	author bavison;	state Exp;
branches;
next	4.26;
commitid	Zo3qrxJgPWP3wq8y;

4.26
date	2013.05.31.19.00.18;	author jlee;	state Exp;
branches;
next	4.25;
commitid	MkHF99Q2X6ELDORw;

4.25
date	2013.01.27.17.27.05;	author rsprowson;	state Exp;
branches;
next	4.24;
commitid	s568crYEpbWU6SBw;

4.24
date	2012.05.10.15.15.53;	author bavison;	state Exp;
branches;
next	4.23;
commitid	TrmRv9xOuOI2Ob4w;

4.23
date	2011.08.06.20.20.14;	author jlee;	state Exp;
branches;
next	4.22;
commitid	RGwDCySu9G6uquuv;

4.22
date	2010.06.23.22.26.21;	author jlee;	state Exp;
branches;
next	4.21;

4.21
date	2009.12.04.15.29.18;	author srevill;	state Exp;
branches;
next	4.20;

4.20
date	2009.04.30.00.11.10;	author bavison;	state Exp;
branches;
next	4.19;
commitid	e0SQqnrv0k2PlYLt;

4.19
date	2006.06.19.16.19.20;	author jballance;	state Exp;
branches;
next	4.18;

4.18
date	2005.03.16.11.44.15;	author kbracey;	state Exp;
branches;
next	4.17;

4.17
date	2005.01.25.13.02.18;	author kbracey;	state Exp;
branches;
next	4.16;

4.16
date	2004.09.21.17.10.30;	author kbracey;	state Exp;
branches;
next	4.15;

4.15
date	2004.06.20.14.59.20;	author mhobbs;	state Exp;
branches;
next	4.14;

4.14
date	2004.01.26.17.29.17;	author kbracey;	state Exp;
branches;
next	4.13;

4.13
date	2003.02.21.14.35.23;	author kbracey;	state Exp;
branches;
next	4.12;

4.12
date	2002.04.12.13.42.15;	author srevill;	state Exp;
branches;
next	4.11;

4.11
date	2002.03.04.17.35.35;	author kbracey;	state Exp;
branches;
next	4.10;

4.10
date	2001.08.31.11.06.07;	author kbracey;	state Exp;
branches;
next	4.9;

4.9
date	2001.07.25.16.18.50;	author kbracey;	state Exp;
branches;
next	4.8;

4.8
date	2001.05.31.13.23.04;	author kbracey;	state Exp;
branches;
next	4.7;

4.7
date	2000.10.02.16.02.01;	author kbracey;	state Exp;
branches;
next	4.6;

4.6
date	2000.03.24.11.16.19;	author kbracey;	state Exp;
branches;
next	4.5;

4.5
date	2000.03.24.10.53.14;	author kbracey;	state Exp;
branches;
next	4.4;

4.4
date	99.11.26.14.37.31;	author sbrodie;	state Exp;
branches;
next	4.3;

4.3
date	99.08.03.17.56.44;	author kbracey;	state Exp;
branches
	4.3.2.1;
next	4.2;

4.2
date	98.09.21.12.36.45;	author kbracey;	state Exp;
branches;
next	4.1;

4.1
date	98.09.21.12.22.00;	author kbracey;	state Exp;
branches;
next	;

4.3.2.1
date	99.11.23.17.19.11;	author kbracey;	state Exp;
branches;
next	;


desc
@@


4.31
log
@  Updated to build using shared makefiles
Detail:
  Makefile rewritten. All the changes elsewhere reflect the fact that
  CoreDir, VeneerDir and FileExt are now passed in from the makefile,
  since that has visibility of filespec differences between OSes.


Version 4.36. Not tagged
@
text
@;
; This file is automatically maintained by srccommit, do not edit manually.
; Last processed by srccommit version: 1.1.
;
                        GBLS    Module_MajorVersion
                        GBLA    Module_Version
                        GBLS    Module_MinorVersion
                        GBLS    Module_Date
                        GBLS    Module_FullVersion
                        GBLS    Module_ApplicationDate
                        GBLS    Module_HelpVersion
                        GBLS    Module_ComponentName
                        GBLS    Module_ComponentPath
Module_MajorVersion     SETS    "4.36"
Module_Version          SETA    436
Module_MinorVersion     SETS    ""
Module_Date             SETS    "12 Apr 2018"
Module_ApplicationDate  SETS    "12-Apr-18"
Module_ComponentName    SETS    "FPASC"
Module_ComponentPath    SETS    "mixed/RiscOS/Sources/HWSupport/FPASC"
Module_FullVersion      SETS    "4.36"
Module_HelpVersion      SETS    "4.36 (12 Apr 2018)"
                        END
@


4.30
log
@Avoid self-modification for 26bit RAM builds
Detail:
  riscos/Makefile - tweak FPEAnchor handling so that 26bit RAM builds use the legacy low FPEAnchor location instead of storing FPEAnchor locally. This results in a read-only module that can be used in custom ROMs, and saves a few bytes of space.
Admin:
  Tested via building PlingSystem and checking FPEAnchorType is set correctly


Version 4.36. Tagged as 'FPASC-4_36'
@
text
@d17 2
a18 2
Module_Date             SETS    "12 Dec 2017"
Module_ApplicationDate  SETS    "12-Dec-17"
d22 1
a22 1
Module_HelpVersion      SETS    "4.36 (12 Dec 2017)"
@


4.29
log
@Fix handling of instructions that fail the condition code check (take 2)
Detail:
  coresrc/s/fpeundef - Fix FPEUndefHandler to make sure FPEReturn is called with Rwp pointing to the current context, not the global workspace. If the instruction which failed the condition code check was followed by one which passes the check, we'd end up trying to interpret the global workspace as a FP context, leading to unpredictable results (e.g. workspace corruption if the instruction writes to a register)
Admin:
  Tested on Raspberry Pi 3
  Fixes issue seen where "ADFLTD F1,F1,F0 : MVFS F0,F1" was corrupting the FPE context pointer due to MVFS writing to F0, causing a crash on all following FP instructions
  Also likely to fix issue reported on forums:
  https://www.riscosopen.org/forum/forums/11/topics/5265


Version 4.35. Tagged as 'FPASC-4_35'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.35"
Module_Version          SETA    435
d17 2
a18 2
Module_Date             SETS    "13 Apr 2016"
Module_ApplicationDate  SETS    "13-Apr-16"
d21 2
a22 2
Module_FullVersion      SETS    "4.35"
Module_HelpVersion      SETS    "4.35 (13 Apr 2016)"
@


4.28
log
@  Support ARMv8 (and potentially some ARMv7) cores, and a bugfix.
Detail:
  * In ARMv7 onwards, the undefined instruction processor vector can be
    entered for untaken conditional architecturally undefined instructions
    (and for these purposes, all FPA instructions can be considered
    architecturally undefined) so we now need to perform the condition code
    check in software even for the first FPA instruction in a run.
  * There were a few cases where the FPEmulator module itself does some
    untaken FPA instructions (to access a hardware FPA) before its undefined
    instruction handler is installed. These have been replaced with
    conditional branches over on the opposite condition.
  * Related bugfix: since ARMv5, the "NV" condition code space has been
    considered to represent different instruction encodings and because
    there were never any MCR2, CDP2 etc instructions for the FPA
    coprocessor, these cause the CPU to take the undefined instruction
    processor vector. But due to the nature of the previous condition code
    checks in our undefined instruction handler, an NV instruction that was
    first in a run of FPA instructions would always be executed, while one
    that was later in a run of FPA instructions would never be. This has
    now been changed so that they all generate an undefined instruction
    exception on ARMv5 onwards, wherever they are found.
Admin:
  Tested on Raspberry Pi 3.

Version 4.34. Tagged as 'FPASC-4_34'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.34"
Module_Version          SETA    434
d17 2
a18 2
Module_Date             SETS    "29 Feb 2016"
Module_ApplicationDate  SETS    "29-Feb-16"
d21 2
a22 2
Module_FullVersion      SETS    "4.34"
Module_HelpVersion      SETS    "4.34 (29 Feb 2016)"
@


4.27
log
@  Add Raspberry Pi 2 support
Detail:
  The Raspberry Pi ROM now joins the IOMD ROM in supporting multiple
  architectures, in this case ARMv6 and ARMv7. This has been achieved by
  creating a new machine type specific for Raspberry Pi. The old ARM11ZF
  machine type remains for builds that are ARM11-only.

Version 4.33. Tagged as 'FPASC-4_33'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.33"
Module_Version          SETA    433
d17 2
a18 2
Module_Date             SETS    "02 Feb 2015"
Module_ApplicationDate  SETS    "02-Feb-15"
d21 2
a22 2
Module_FullVersion      SETS    "4.33"
Module_HelpVersion      SETS    "4.33 (02 Feb 2015)"
@


4.26
log
@Fix interaction with undefined instruction environment handler in pre-RISC OS 3.5 builds
Detail:
  Code restructuring performed in FPASC-4_12 resulted in an unintentional change in behaviour on ARM2/ARM3 systems when FPEmulator attempts to pass on an abort to the next claimant of the undefined instruction vector.
  Specifically, FPEmulator's startup code was making a note of the address of the current undef environment handler, instead of the address of the pointer to the current handler. This meant that if OS_ChangeEnvironment was used to change the handler once FPEmulator had been loaded, the new handler would never get called - only the old handler would get called.
  On later systems this bug didn't occur as (a) the kernel has a veneer around the undef environment handler (instead of branching straight to the current claimant from the undef vector), and (b) OS_ClaimProcessorVector tells FPEmulator directly where to go next instead of the module having to try and guess for itself.
  File changes:
  - vensrc/riscos/start: Adjust handling of "LDR PC,xxx" undef vector so that the address being loaded from is cached instead of the contents of the address. Construct special code to use when the FPEmulator context is disabled and we want to immediately pass along the abort.
  - vensrc/riscos/globalws: Reserve workspace for storing the passalong code
Admin:
  Tested on RISC OS 3.1 under ArcEm
  ARM3 detection routines which rely on the undef environment handler now work correctly instead of failing with undefined instruction errors
  No impact on builds targeting RISC OS 3.5+ as all changes are wrapped in [ :LNOT: Arm600 ]


Version 4.32. Tagged as 'FPASC-4_32'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.32"
Module_Version          SETA    432
d17 2
a18 2
Module_Date             SETS    "31 May 2013"
Module_ApplicationDate  SETS    "31-May-13"
d21 2
a22 2
Module_FullVersion      SETS    "4.32"
Module_HelpVersion      SETS    "4.32 (31 May 2013)"
@


4.25
log
@IOMD moved to distinct machine
Comments updated in CortexA8/CortexA9/STB55/STB5cx/Tungsten.
Machine '32' offers SoftOnly now.
Removed fpemedusa and Phoebe.
Removed some proliferating !MkROM obey files.

Version 4.31. Tagged as 'FPASC-4_31'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.31"
Module_Version          SETA    431
d17 2
a18 2
Module_Date             SETS    "27 Jan 2013"
Module_ApplicationDate  SETS    "27-Jan-13"
d21 2
a22 2
Module_FullVersion      SETS    "4.31"
Module_HelpVersion      SETS    "4.31 (27 Jan 2013)"
@


4.24
log
@  Added an ARM11ZF build of the FPEmulator for Raspberry Pi builds
Detail:
  Settings are cloned from Tungsten, CortexA8 and other modern machines.
Admin:
  Untested, but Adrian and John have done identical changes and they report
  success.

Version 4.30. Tagged as 'FPASC-4_30'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.30"
Module_Version          SETA    430
d17 2
a18 2
Module_Date             SETS    "10 May 2012"
Module_ApplicationDate  SETS    "10-May-12"
d21 2
a22 2
Module_FullVersion      SETS    "4.30"
Module_HelpVersion      SETS    "4.30 (10 May 2012)"
@


4.23
log
@Update to work with zero page relocation
Detail:
  Unlike most modules which can just store the zero page pointers in their workspace, FPEmulator is a bit trickier since the zero page pointers are needed from within abort handlers and other places where the module workspace pointer is hard to come by (in fact, FPEmulator uses FPEAnchor to store the module workspace pointer)
  So rather than break/rework lots of perfectly good code, there are now three different FPEmulator builds available, selected via the new FPEAnchorType option:
  * FPEAnchorType=Low will select a build suitable for machines with FPEAnchor at its original location in zero page. This is the default for ROM builds.
  * FPEAnchorType=High will select a build suitable for the FPEAnchor location (&ffff0ff4) that's used with zero page relocation. Machines with relocated zero page must specify this option in their components file.
  * FPEAnchorType=Local will select a build suitable for softloading. Rather than rely on using a zero page location for storing the workspace pointer, the module just stores it within itself. This option is selected automatically for RAM builds and can't be overriden via the components file.
  File changes:
  riscos/Makefile - Reworked makefile to support the new options
  riscos/FPEMacros - Updated AdrWS macro to work with FPEAnchorType=Local
  riscos/options - For non-local builds, declare the appropriate value for FPEAnchor
  riscos/start - Use appropriate FPEAnchor initialisation code
Admin:
  All 3 configs tested (ROM builds on BB-xM, RAM softload on Iyonix)


Version 4.29. Tagged as 'FPASC-4_29'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.29"
Module_Version          SETA    429
d17 2
a18 2
Module_Date             SETS    "06 Aug 2011"
Module_ApplicationDate  SETS    "06-Aug-11"
d21 2
a22 2
Module_FullVersion      SETS    "4.29"
Module_HelpVersion      SETS    "4.29 (06 Aug 2011)"
@


4.22
log
@Add CortexA8 configuration file needed for OMAP3 FPASC builds
Detail:
  riscos/s/CortexA8 - Made a copy of the Tungsten FPASC config file for use with Cortex/OMAP ROM builds
Admin:
  Tested on rev C2 beagleboard.
  Not tagged - no functional changes.


Version 4.28. Not tagged
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.28"
Module_Version          SETA    428
d17 2
a18 2
Module_Date             SETS    "23 Jun 2010"
Module_ApplicationDate  SETS    "23-Jun-10"
d21 2
a22 2
Module_FullVersion      SETS    "4.28"
Module_HelpVersion      SETS    "4.28 (23 Jun 2010)"
@


4.21
log
@FPEmulator post-indexed load via r13 in non-USR modes fix
Detail:
  This change fixes ticket #225 (post-indexed LDFD via r13 sometimes reading
  corrupted values).

Version 4.28. Tagged as 'FPASC-4_28'
@
text
@d17 2
a18 2
Module_Date             SETS    "04 Dec 2009"
Module_ApplicationDate  SETS    "04-Dec-09"
d20 1
a20 1
Module_ComponentPath    SETS    "closed/RiscOS/Sources/HWSupport/FPASC"
d22 1
a22 1
Module_HelpVersion      SETS    "4.28 (04 Dec 2009)"
@


4.20
log
@  Change to build options.
Detail:
  Machine=32 is now built so that it doesn't use UMULL. This is because we
  now require it to operate on ARMv3 Risc PCs and A7000(+).
Admin:
  Untested, but should be low risk.

Version 4.27. Tagged as 'FPASC-4_27'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.27"
Module_Version          SETA    427
d17 2
a18 2
Module_Date             SETS    "30 Apr 2009"
Module_ApplicationDate  SETS    "30-Apr-09"
d20 3
a22 3
Module_ComponentPath    SETS    "RiscOS/Sources/HWSupport/FPASC"
Module_FullVersion      SETS    "4.27"
Module_HelpVersion      SETS    "4.27 (30 Apr 2009)"
@


4.19
log
@	added Tungsten 2 component
Detail:
Admin:


Version 4.26. Tagged as 'FPASC-4_26'
@
text
@d3 1
a3 1
; Last processed by srccommit version: 1.2.
d14 2
a15 2
Module_MajorVersion     SETS    "4.26"
Module_Version          SETA    426
d17 2
a18 2
Module_Date             SETS    "19 Jun 2006"
Module_ApplicationDate  SETS    "19-Jun-06"
d21 2
a22 2
Module_FullVersion      SETS    "4.26"
Module_HelpVersion      SETS    "4.26 (19 Jun 2006)"
@


4.18
log
@Added STB55 Machine config file.

Version 4.25. Tagged as 'FPASC-4_25'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.25"
Module_Version          SETA    425
d17 2
a18 2
Module_Date             SETS    "16 Mar 2005"
Module_ApplicationDate  SETS    "16-Mar-05"
d21 2
a22 2
Module_FullVersion      SETS    "4.25"
Module_HelpVersion      SETS    "4.25 (16 Mar 2005)"
@


4.17
log
@Added options file for STB5cx, removed obsolete ones for Iyonix and Ursula
(already replaced by Tungsten and Phoebe).

Version 4.24. Tagged as 'FPASC-4_24'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.24"
Module_Version          SETA    424
d17 2
a18 2
Module_Date             SETS    "25 Jan 2005"
Module_ApplicationDate  SETS    "25-Jan-05"
d21 2
a22 2
Module_FullVersion      SETS    "4.24"
Module_HelpVersion      SETS    "4.24 (25 Jan 2005)"
@


4.16
log
@Fixed an error in "UseCLZ" case (ie thus affecting only Iyonix currently),
which broke certain denormalised cases of multiply, divide and remainder.

Problem originally reported on Iyonix discussion group (failed Paranoia tesst).

Version 4.23. Tagged as 'FPASC-4_23'
@
text
@d3 1
a3 1
; Last processed by srccommit version: 1.68.
d14 2
a15 2
Module_MajorVersion     SETS    "4.23"
Module_Version          SETA    423
d17 2
a18 2
Module_Date             SETS    "21 Sep 2004"
Module_ApplicationDate  SETS    "21-Sep-04"
d21 2
a22 2
Module_FullVersion      SETS    "4.23"
Module_HelpVersion      SETS    "4.23 (21 Sep 2004)"
@


4.15
log
@  Changed Makefile to refer to 'machine' rather than 'system' and add support for STB5
Detail:
  Files modified: riscos.Makefile, MkRom310, MkRom350, MkRom, MkRomIyx
  Files added: riscos.MkRom380, MkRomUrs
               s.Phoebe, STB5, Tungsten
Admin:
  Upated from Kev's machine by Mike H.

Version 4.22. Tagged as 'FPASC-4_22'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.22"
Module_Version          SETA    422
d17 2
a18 2
Module_Date             SETS    "20 Jun 2004"
Module_ApplicationDate  SETS    "20-Jun-04"
d21 2
a22 2
Module_FullVersion      SETS    "4.22"
Module_HelpVersion      SETS    "4.22 (20 Jun 2004)"
@


4.14
log
@* Denormalised numbers now held consistently in their nominal precision.
  MVF/MNF/ABS of a denormalised number without a change of precision
  treated specially, much like signalling NaNs. This prevents spurious
  underflow traps if they're enabled. Previously

       ; Underflow traps on
       LDFS    F0,DenormalisedSingle
       MVFS    F0,F0

  or

       ; Underflow traps off
       LDFD    F0,SmallestNormalDouble
       MUFD    F0,F0,#0.5
       ; Turn underflow traps on
       STFD    F0,xxx

  would have generated traps.

* LDFP/STFP rearrangement of NaN significands reinstated, as DDT
  can now make use of it.

* Typos in over/underflow code for LDFP corrected.

* Makefile changed to build in rm.${SYSTEM} instead of rm.${MACHINE}.

* Experimental dynamic rounding controls added to FPSR (for emulator
  only). Currently disabled; does not affect LDFP or STFP yet.

Version 4.21. Tagged as 'FPASC-4_21'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.21"
Module_Version          SETA    421
d17 2
a18 2
Module_Date             SETS    "26 Jan 2004"
Module_ApplicationDate  SETS    "26-Jan-04"
d21 2
a22 2
Module_FullVersion      SETS    "4.21"
Module_HelpVersion      SETS    "4.21 (26 Jan 2004)"
@


4.13
log
@Bug fix in STFP - minor error at bottom of word.
New switch to allow use of CLZ.
Added Docs.

Version 4.20. Tagged as 'FPASC-4_20'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.20"
Module_Version          SETA    420
d17 2
a18 2
Module_Date             SETS    "21 Feb 2003"
Module_ApplicationDate  SETS    "21-Feb-03"
d21 2
a22 2
Module_FullVersion      SETS    "4.20"
Module_HelpVersion      SETS    "4.20 (21 Feb 2003)"
@


4.12
log
@  * Fixed install phase;
  * Moved stripdepnd out of Makefile;
  * Variants passed on amu command line.
Detail:
  * You can now specify the precise build variant of the FPEmulator by passing
    System=... and FPE_APCS=... on the amu command line. There are now more
    files in riscos.s to set the options for various types (as per Wimp).
    The default FPE as was is now built with: System="RO380" FPE_APCS="3/32bit"
Admin:
  Builds.
Version 4.19. Tagged as 'FPASC-4_19'
@
text
@d3 1
a3 1
; Last processed by srccommit version: 1.62.
d10 1
a10 2
                        GBLS    Module_ApplicationDate2
                        GBLS    Module_ApplicationDate4
d14 2
a15 2
Module_MajorVersion     SETS    "4.19"
Module_Version          SETA    419
d17 2
a18 3
Module_Date             SETS    "12 Apr 2002"
Module_ApplicationDate2 SETS    "12-Apr-02"
Module_ApplicationDate4 SETS    "12-Apr-2002"
d21 2
a22 2
Module_FullVersion      SETS    "4.19"
Module_HelpVersion      SETS    "4.19 (12 Apr 2002)"
@


4.11
log
@Two changes to ARM's version 1.17 core:
* Generated NaNs were always negative - they were supposed to have a sign
  based on the operands. As a side effect, some internal routines were not
  obeying their advertised API - this has been corrected.
* Generated NaNs no longer contained a reason code - this was a deliberate
  ARM change, but I'm going to have a philosophical disagreement and reverse
  it.

Version 4.18. Tagged as 'FPASC-4_18'
@
text
@d15 2
a16 2
Module_MajorVersion     SETS    "4.18"
Module_Version          SETA    418
d18 3
a20 3
Module_Date             SETS    "04 Mar 2002"
Module_ApplicationDate2 SETS    "04-Mar-02"
Module_ApplicationDate4 SETS    "04-Mar-2002"
d23 2
a24 2
Module_FullVersion      SETS    "4.18"
Module_HelpVersion      SETS    "4.18 (04 Mar 2002)"
@


4.10
log
@FPEmulator_LoadContext didn't work due to a slight register muddle.

Version 4.17. Tagged as 'FPASC-4_17'
@
text
@d3 1
d15 2
a16 2
Module_MajorVersion     SETS    "4.17"
Module_Version          SETA    417
d18 3
a20 3
Module_Date             SETS    "31 Aug 2001"
Module_ApplicationDate2 SETS    "31-Aug-01"
Module_ApplicationDate4 SETS    "31-Aug-2001"
d23 2
a24 2
Module_FullVersion      SETS    "4.17"
Module_HelpVersion      SETS    "4.17 (31 Aug 2001)"
@


4.9
log
@Import of new FPASC sources from ARM (upgrading from 1.07 to 1.13).
No new functionality or speed boosts - just accuracy improvements and bug
fixes. See comments in coresrc.s.toplevel for details.

Version 4.16. Tagged as 'FPASC-4_16'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.16"
Module_Version          SETA    416
d17 3
a19 3
Module_Date             SETS    "25 Jul 2001"
Module_ApplicationDate2 SETS    "25-Jul-01"
Module_ApplicationDate4 SETS    "25-Jul-2001"
d22 2
a23 2
Module_FullVersion      SETS    "4.16"
Module_HelpVersion      SETS    "4.16 (25 Jul 2001)"
@


4.8
log
@Added check to make sure we ignore undefined instruction exceptions generated
while in Thumb state.

Version 4.15. Tagged as 'FPASC-4_15'
@
text
@d14 2
a15 2
Module_MajorVersion     SETS    "4.15"
Module_Version          SETA    415
d17 3
a19 3
Module_Date             SETS    "31 May 2001"
Module_ApplicationDate2 SETS    "31-May-01"
Module_ApplicationDate4 SETS    "31-May-2001"
d22 2
a23 2
Module_FullVersion      SETS    "4.15"
Module_HelpVersion      SETS    "4.15 (31 May 2001)"
@


4.7
log
@* Fixes to allow correct builds for 26-bit systems (RISC OS 3.1) and 32-bit
  systems using the 32-bit core (RISC OS 3.5-3.7).

Version 4.14. Tagged as 'FPASC-4_14'
@
text
@d12 4
a15 2
Module_MajorVersion     SETS    "4.14"
Module_Version          SETA    414
d17 7
a23 5
Module_Date             SETS    "02 Oct 2000"
Module_ApplicationDate2 SETS    "02-Oct-00"
Module_ApplicationDate4 SETS    "02-Oct-2000"
Module_FullVersion      SETS    "4.14"
Module_HelpVersion      SETS    "4.14 (02 Oct 2000)"
@


4.6
log
@  Fixed error in multiply routine reported by RISC OS Ltd.
Detail:
  When the long multiply option was added on the Ursula branch, an inexplicable
  change to a single instruction in the original non-long multiply code
  appeared.
  Result would have been slightly inaccurate multiplies when both operands
  had more than 32 bits of mantissa.
  Original code restored.

Version 4.13. Tagged as 'FPASC-4_13'
@
text
@d9 5
a13 2
Module_MajorVersion     SETS    "4.13"
Module_Version          SETA    413
d15 5
a19 2
Module_Date             SETS    "24 Mar 2000"
Module_FullVersion      SETS    "4.13"
@


4.5
log
@  Multiple context version of FP emulator and FPA support code - FP in
  callbacks and interrupts can now be yours.

  Exception dumps now available (integer and FP).

Detail:
* Changed to multiple-context version of the core. This will allow floating-
  point to be used safely in callbacks and interrupt routines (as long as
  you call the appropriate context changing SWIs). This activates the
  dormant SWIs FPEmulator_ChangeContext, FPEmulator_ContextLength and
  FPEmulator_InitContext. FPEmulator_DeactivateContext and
  FPEmulator_ActivateContext now have full functionality.

* Added new SWI interfaces to core: FPEmulator_Abort, FPEmulator_LoadContext
  and FPEmulator_SaveContext.

* On FP exceptions, integer registers are copied into the exception dump area.
  (TO DO: registers are USR mode ones - should take pains to figure out
  SVC or IRQ ones as required).

* The FPEmulator now has an exception dump area for floating point registers -
  a suitable version of Debugger will show these with *ShowFPRegs.

* FPEmulator_ChangeContext and FPEmulator_DeactivateContext now return -1
  for the default context.

* Run time detection of SVC stack position added.

* No longer creates a MessageTrans descriptor on the stack.

* Removed broken STM^ fudge from the FPA veneer, as the only StrongARMs that
  need it can't use the FPA.

* Fixed a typo in core_abort.

* Stopped continuous emulation runs crossing 4K page boundaries, with a view
  to improving abort handling.

* Use of DREG debugging macros fixed (line endings were being inserted in the
  wrong place).

* Prototype code to catch aborts inside the emulator and change the registers
  to make it look like the emulated instruction aborted. This is cute, but
  causes problems with anything like Ursula's lazy task-swapping. Really this
  needs to be done only on fatal aborts. Compiled out for now.

Version 4.12. Tagged as 'FPASC-4_12'
@
text
@d9 2
a10 2
Module_MajorVersion     SETS    "4.12"
Module_Version          SETA    412
d13 1
a13 1
Module_FullVersion      SETS    "4.12"
@


4.4
log
@  Merge of FPEmulator which uses the new macros in HdrSrc 0.63
Detail:
  Now 32-bit module compatible.
Admin:
  Tested the 26-bit build in the Customer F5 build.
  32-bit build tested on prototype 32-bit RISC OS.


Version 4.11. Tagged as 'FPASC-4_11'
@
text
@d4 10
a13 10
			GBLS	Module_MajorVersion
			GBLA    Module_Version
			GBLS	Module_MinorVersion
			GBLS	Module_Date
			GBLS	Module_FullVersion
Module_MajorVersion	SETS    "4.11"
Module_Version          SETA    411
Module_MinorVersion	SETS	""
Module_Date		SETS    "26 Nov 1999"
Module_FullVersion      SETS    "4.11"
@


4.3
log
@Ursula branch merged. This contains:
  Use of UMULL (compiled out).
  Service call table.
  Runs in UND32 mode (requires latest Kernel), giving a speed boost.

Version 4.10. Tagged as 'FPASC-4_10'
@
text
@d9 2
a10 2
Module_MajorVersion	SETS    "4.10"
Module_Version          SETA    410
d12 2
a13 2
Module_Date		SETS    "03 Aug 1999"
Module_FullVersion      SETS    "4.10"
@


4.3.2.1
log
@ObjASM 3.12 syntax warning fixes.
32-bit compatible, hopefully.
Requires HdrSrc.

Version 4.10, 4.3.2.1. Tagged as 'FPASC-4_10-4_3_2_1'
@
text
@d11 3
a13 3
Module_MinorVersion	SETS	"4.3.2.1"
Module_Date		SETS    "23 Nov 1999"
Module_FullVersion      SETS    "4.10 (4.3.2.1)"
@


4.2
log
@Makefile modified to use LocalRes$Path.
Changed to use srccommit.
German resources added.

Version 4.09. Tagged as 'FPASC-4_09'
@
text
@d8 3
a10 2
Module_MajorVersion	SETS    "4.09"
Module_Version          SETA    409
d12 3
a14 2
Module_Date		SETS    "21 Sep 1998"
		        END
@


4.1
log
@created by srccommit.
@
text
@d8 2
a9 2
Module_MajorVersion	SETS    "4.08"
Module_Version          SETA    408
@
