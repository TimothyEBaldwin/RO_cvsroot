head	4.2;
access;
symbols
	TCPIPLibs-5_66:4.2
	TCPIPLibs-5_65:4.2
	TCPIPLibs-5_64:4.2
	TCPIPLibs-5_63:4.2
	TCPIPLibs-5_62:4.2
	TCPIPLibs-5_61:4.2
	TCPIPLibs-5_60:4.2
	TCPIPLibs-5_59:4.2
	TCPIPLibs-5_58:4.2
	TCPIPLibs-5_57:4.2
	TCPIPLibs-5_56:4.2
	TCPIPLibs-5_55:4.2
	TCPIPLibs-5_54:4.2
	TCPIPLibs-5_53:4.2
	TCPIPLibs-5_52:4.2
	TCPIPLibs-5_51:4.2
	TCPIPLibs-5_50:4.2
	TCPIPLibs-5_49:4.2
	RO_5_07:4.2
	TCPIPLibs-5_48:4.2
	TCPIPLibs-5_47:4.2
	TCPIPLibs-5_46:4.2
	TCPIPLibs-5_45:4.2
	TCPIPLibs-5_44:4.2
	TCPIPLibs-5_43:4.2
	TCPIPLibs-5_42:4.2
	TCPIPLibs-5_41:4.2
	TCPIPLibs-5_40:4.2
	TCPIPLibs-5_39:4.2
	dellis_autobuild_BaseSW:4.2
	TCPIPLibs-5_38:4.2
	TCPIPLibs-5_37:4.2
	TCPIPLibs-5_36:4.2
	sbrodie_sedwards_16Mar2000:4.2
	TCPIPLibs-5_35:4.2
	TCPIPLibs-5_34:4.2
	TCPIPLibs-5_33:4.2
	TCPIPLibs-5_32:4.2
	TCPIPLibs-5_31:4.2
	dcotton_autobuild_BaseSW:4.2
	TCPIPLibs-5_30:4.2
	TCPIPLibs-5_29:4.2
	TCPIPLibs-5_28:4.2
	TCPIPLibs-5_27:4.2
	TCPIPLibs-5_26:4.2
	TCPIPLibs-5_25:4.2
	TCPIPLibs-5_24:4.2
	TCPIPLibs-5_23:4.2
	TCPIPLibs-5_22:4.2
	TCPIPLibs-5_21:4.2
	TCPIPLibs-5_20:4.2
	TCPIPLibs-5_19:4.2
	TCPIPLibs-5_18:4.2
	TCPIPLibs-5_17:4.2
	TCPIPLibs-5_16:4.2
	TCPIPLibs-5_15:4.2
	TCPIPLibs-5_14:4.2
	TCPIPLibs-5_13:4.2
	TCPIPLibs-5_12:4.2
	TCPIPLibs-5_11:4.2
	TCPIPLibs-5_10:4.2
	TCPIPLibs-5_09:4.2
	TCPIPLibs-5_08:4.2
	TCPIPLibs-5_07:4.2
	TCPIPLibs-5_06:4.2
	TCPIPLibs-5_05:4.2
	TCPIPLibs-5_04:4.2
	TCPIPLibs-5_03:4.2
	mstphens_UrsulaRiscPCBuild_20Nov98:4.2
	Ursula_RiscPC:4.2.0.6
	TCPIPLibs-5_02:4.2
	TCPIPLibs-5_01:4.2
	nicke_TCPIPLibs_25-9-98:4.2
	TCPIPLibs-5_00:4.2
	rthornb_UrsulaBuild-19Aug1998:4.2
	UrsulaBuild_FinalSoftload:4.2
	rthornb_UrsulaBuild-12Aug1998:4.2
	aglover_UrsulaBuild-05Aug1998:4.2
	rthornb_UrsulaBuild-29Jul1998:4.2
	rthornb_UrsulaBuild-22Jul1998:4.2
	Spinner:4.2
	Internet_5_07:4.2
	rthornb_UrsulaBuild-15Jul1998:4.2
	rthornb_UrsulaBuild-07Jul1998:4.2
	rthornb_UrsulaBuild-17Jun1998:4.2
	rthornb_UrsulaBuild-03Jun1998:4.2
	rthornb_UrsulaBuild-27May1998:4.2
	rthornb_UrsulaBuild-21May1998:4.2
	Ursula_bp:4.2
	Ursula:4.2.0.4
	Ursula_19May1998_bp:4.2
	Ursula_19May1998:4.2.0.2
	rthornb_UrsulaBuild_01May1998:4.2
	celkins_Internet_506:4.2
	afrost_NC2_Generic:4.1.7.1
	afrost_Funai01-33:4.1.7.1
	Internet_505:4.2
	Spinner_RCA116:4.1.7.1
	Spinner_B20_2:4.1.7.1
	Spinner_19_3:4.1.7.1
	Spinner_B18:4.1.7.1
	Spinner_B17:4.1.7.1
	Spinner_B15:4.1.7.1
	Spinner_B14:4.1.7.1
	Spinner_B13:4.1.7.1
	Spinner_B12:4.1.7.1
	Spinner_B10:4.1.7.1
	Spin_merge:4.1.7.1
	Daytona:4.1.0.6
	Daytona_bp:4.1
	Spinner_B7:4.1.7.1
	ARTtmp_merge:4.1.7.1
	Spin_3Apr97:4.1.7.1
	RCA_bp:4.1
	ARTtmp:4.1.7.1.0.4
	RCA:4.1.0.2
	import:4.1.7.1;
locks; strict;
comment	@# @;


4.2
date	97.05.21.03.16.35;	author kbracey;	state Exp;
branches;
next	4.1;

4.1
date	97.03.06.14.27.38;	author rbuckley;	state Exp;
branches
	4.1.7.1;
next	;

4.1.7.1
date	97.03.06.14.27.38;	author rbuckley;	state Exp;
branches;
next	;


desc
@@


4.2
log
@Spinner branch merged.
$Id, $Source and $Header markers removed.
@
text
@/*
 * Copyright (c) 1988 Acorn Computers Ltd., Cambridge, England
 *
 * :RCS Log discontinued:
 * Revision 1.1  95/01/11  10:21:35  kwelton
 * Initial revision
 * 
 * Revision 1.9  89/06/21  08:24:09  mark
 * Value of PRIO_SOFTVTE dropped a lot - now below all of
 * FDC, soft-clock and soft-net.  This may well improve net
 * performance in a context of lots of screen output, and is
 * certainly much more reasonable.
 * 
 * Revision 1.8  89/06/09  15:15:26  mark
 * Added PRIO_I2C for CMOS device access protection.
 * 
 * Revision 1.7  89/04/28  15:09:47  mark
 * Changed to suit new XCB manager.
 * 
 * Revision 1.6  89/04/12  12:51:01  jwills
 * Added a soft interrupt for the SCSI driver.
 * 
 * Revision 1.5  88/11/30  02:09:13  keith
 * Mark's new interrupt handling stuff
 * 
 * Revision 1.4  88/11/11  08:36:19  keith
 * Added recursive inclusion protection, and exported MAXSPL since int_prio_tbl
 * has now moved down to page 0.
 * 
 * Revision 1.3  88/06/17  20:07:27  beta
 * Acorn Unix initial beta version
 * 
 */
/*
 *      ARM Interrupt interface - interrupt control structures
 *
 *      Author: J.M. Collins, Xi Software Ltd 1986.
 *      Revised: Mark Taunton, Acorn Computers Ltd, 1988.
 */

#ifndef __INT_HNDLR__
#define __INT_HNDLR__

/*
 * Interrupt source types: one byte is allocated in the mask values
 * for each type.  The order here matches ordering from least-sig
 * byte to most-sig byte.  One of these values is passed to
 * decl_interrupt (), along with a bit-mask for that source.
 */
#define INT_IRQA        0
#define INT_IRQB        1
#define INT_XCB         2
#define INT_SOFT        3

#define INT_BIT(mask,type) ((mask) << ((type) * 8))
#define SINT_SHIFT      (INT_SOFT * 8)

/* Define hardware force-interrupt bit (needs ioc.h)  */
#define SOFTINT_BIT     INT_BIT(IRQA_FORCE,INT_IRQA)

/*
 * At most 8 soft-ints can be defined as things currently 
 * stand: 1 << 7 would be the last.  This could be modified
 * by using some spare XCB type bits for soft-ints, and
 * adjusting the INT_xxx and SOFTINT_BIT macros above.
 */
#define SOFTCLOCKMASK   (1 << 0)
#define SOFTNETMASK     (1 << 1)
#define SOFTFDCMASK     (1 << 2)
#define SOFTVTEOUTPUT   (1 << 3)
#define SOFTSERIAL      (1 << 4)
#define SOFTSCSIMASK    (1 << 5)

/*
 * To declare an interrupt, the routine
 *
 *      decl_interrupt(&thing, level, type)
 *
 * is called with the following structure as 'thing'.
 */

struct int_hndlr
{
    unsigned int        ih_mask;                /* Mask (gets mangled) */
    void                (*ih_fn)();             /* Function to call */
    int                 ih_farg;                /* Argument to pass */
    struct int_hndlr   *ih_next;                /* Next one */
};

/*
 *      This is the vector of masks or-ed from each of the declared
 *      interrupts for each priority level.
 */

struct int_prio_tbl
{
    struct int_prio_tbl *ip_next;       /* link to next lower active level */
    unsigned int        ip_this_level;  /* bits for this level only */
    unsigned int        ip_cum_bits;    /* bits for all levels < this */
    struct int_hndlr    *ip_chain;      /* handler chain */
};

/* Head of chain of active int levels */
extern struct int_prio_tbl  *first_irq;

/* Hardware int priority table */
extern struct int_prio_tbl  int_prio_tbl[];

/* Or of bits for pending software interrupts. This is unshifted. */
extern unsigned int  sint_pending;

#define  PRIO_0         0x00
#define  PRIO_1         0x01
#define  PRIO_SOFTVTE   0x07
#define  PRIO_SOFTCLOCK 0x08
#define  PRIO_FDC       0x09                    /* floppy low-priority */
#define  PRIO_SOFTNET   0x0c
#define  PRIO_I2C       0x0f                    /* for i2c i/o activities */
#define  PRIO_ET        0x10
#define  PRIO_4         0x14
#define  PRIO_5         0x15
#define  PRIO_BIO       0x15
#define  PRIO_TTY       0x15
#define  PRIO_SCSI      PRIO_BIO
#define  PRIO_WINC      PRIO_BIO
#define  PRIO_CENT      PRIO_TTY
#define  PRIO_SOUND     0x15
#define  PRIO_6         0x16
#define  PRIO_IMP       0x16                    /* ? */
#define  PRIO_VFLY      0x16
#define  PRIO_7         0x17
#define  PRIO_HITTY     0x17
#define  PRIO_CLOCK     0x18
#define  PRIO_HIGH      0x1F                    /* maximum priority */
#define  MAX_SPL        0x1F                    /* defined maximum */

#endif 

/* EOF int_hndlr.h */
@


4.1
log
@Initial revision
@
text
@a1 3
 * $Header: /ax/networking:include/int_hndlr.h:networking  1.1  $
 * $Source: /ax/networking:include/int_hndlr.h: $
 *
@


4.1.7.1
log
@Imported from Babel
@
text
@@
